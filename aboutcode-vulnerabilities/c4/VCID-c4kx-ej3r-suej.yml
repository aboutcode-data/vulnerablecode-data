vulnerability_id: VCID-c4kx-ej3r-suej
aliases:
  - CVE-2024-52292
  - GHSA-cw6g-qmjq-6w2w
summary: "Craft CMS Arbitrary System File Read\n### Summary\nBy abusing the mail notification\
  \ template it is possible to read arbitrary operating system files. \n\n### Details\nThe [dataUrl](https://craftcms.com/docs/3.x/dev/functions.html#dataurl)\
  \ function can be exploited if an attacker has write permissions on system notification templates.\
  \ This function accepts an absolute file path, reads the file's content, and converts it into\
  \ a Base64-encoded string. By embedding this function within a system notification template,\
  \ the attacker can exfiltrate the Base64-encoded file content through a triggered system email\
  \ notification. Once the email is received, the Base64 payload can be decoded, allowing the\
  \ attacker to read arbitrary files on the server.\n\nRequirements:\n* write permissions to\
  \ system notification templates\n* ability to trigger a corresponding system email\n\n###\
  \ PoC\n1) Modify a template to contain the following twig template string:\n```twig\n{{ dataUrl('/var/www/web/.env')\
  \ }}\n```\n2) Trigger the corresponding notification email (e.g. by resetting a password)\n\
  3) Receive the email and decode the base64 string\n\nMail received:\n![Bildschirmfoto 2024-09-05\
  \ um 16 20 41](https://github.com/user-attachments/assets/24dc5196-6847-4006-b7ef-8cd10d659c30)\n\
  \nDecoded string:\n![Bildschirmfoto 2024-09-05 um 16 28 24](https://github.com/user-attachments/assets/1913a475-5277-49b9-9210-2f3fcd3b9bf1)\n\
  \n\n### Impact\n1) Exposure of Sensitive Information: Arbitrary file read can lead to the\
  \ exposure of sensitive data such as configuration files (e.g., /etc/passwd, .env, config.php),\
  \ which may contain credentials, API keys, or database passwords. This can provide the attacker\
  \ with further access to the system or connected services.\n\n2) Privilege Escalation: If\
  \ the attacker is able to read files that contain privileged information, such as credentials\
  \ for other systems or applications, they may be able to escalate their privileges beyond\
  \ what the web admin role originally allowed, potentially gaining full control over the server\
  \ or other related systems.\n\n3) Server Compromise: Access to files like SSH keys, private\
  \ certificates, or system configuration files can lead to the complete compromise of the underlying\
  \ server. With this information, an attacker could remotely log in to the server or impersonate\
  \ it in secure communications.\n\n4) Exfiltration of User Data: The ability to read arbitrary\
  \ files may allow an attacker to access user data, such as stored passwords, session tokens,\
  \ or private information (like uploaded files or logs), leading to a breach of confidentiality\
  \ and violating privacy regulations (e.g., GDPR)."
severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11755'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.21106'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20783'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20798'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20804'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.21085'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20985'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20909'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20630'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20448'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20593'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20483'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20559'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20565'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20553'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17426'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17288'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17235'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17381'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17401'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17436'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17452'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.1741'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17396'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17441'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17439'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22194'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22205'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22176'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22166'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22161'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22148'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22099'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22035'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.193'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19355'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19335'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24307'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24327'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.2431'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24296'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24318'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24309'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.30549'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-cw6g-qmjq-6w2w
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/craftcms/cms
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/craftcms/cms
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/craftcms/cms/security/advisories/GHSA-cw6g-qmjq-6w2w
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/craftcms/cms/security/advisories/GHSA-cw6g-qmjq-6w2w
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/craftcms/cms/security/advisories/GHSA-cw6g-qmjq-6w2w
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-11-13T18:52:42Z/
    published_at: None
    url: https://github.com/craftcms/cms/security/advisories/GHSA-cw6g-qmjq-6w2w
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-52292
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-52292
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-52292
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-52292
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
  - CWE-552
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-52292
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/security/advisories/GHSA-cw6g-qmjq-6w2w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-52292
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-cw6g-qmjq-6w2w
    reference_type:
    reference_id: GHSA-cw6g-qmjq-6w2w
