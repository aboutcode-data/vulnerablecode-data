vulnerability_id: VCID-c41j-jcga-aaaj
aliases:
  - GHSA-v8gq-5grq-9728
summary: |
  mozjpeg DecompressScanlines::read_scanlines is Unsound
  This issue and vector is similar to [RUSTSEC-2020-0029] of `rgb` crate which `mozjpeg` depends on.

  Affected versions of `mozjpeg` crate allow creating instances of any type `T` from bytes,
  and do not correctly constrain `T` to the types for which it is safe to do so.

  Examples of safety violation possible for a type `T`:

  * `T` contains a reference type, and it constructs a pointer to an invalid, arbitrary memory address.
  * `T` requires a safety and/or validity invariant for its construction that may be violated.

  The issue was fixed in 0.8.19 by using safer types and involving `rgb` dependency bump.

  [RUSTSEC-2020-0029]: https://rustsec.org/advisories/RUSTSEC-2020-0029.html
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-v8gq-5grq-9728
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ImageOptim/mozjpeg-rust
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ImageOptim/mozjpeg-rust/issues/10
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2020-0165.html
weaknesses: []
references:
  - url: https://github.com/ImageOptim/mozjpeg-rust
    reference_type:
    reference_id:
  - url: https://github.com/ImageOptim/mozjpeg-rust/issues/10
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2020-0165.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-v8gq-5grq-9728
    reference_type:
    reference_id: GHSA-v8gq-5grq-9728
