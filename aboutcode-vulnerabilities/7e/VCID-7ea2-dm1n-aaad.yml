vulnerability_id: VCID-7ea2-dm1n-aaad
aliases:
  - CVE-2024-26996
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  usb: gadget: f_ncm: Fix UAF ncm object at re-bind after usb ep transport error

  When ncm function is working and then stop usb0 interface for link down,
  eth_stop() is called. At this piont, accidentally if usb transport error
  should happen in usb_ep_enable(), 'in_ep' and/or 'out_ep' may not be enabled.

  After that, ncm_disable() is called to disable for ncm unbind
  but gether_disconnect() is never called since 'in_ep' is not enabled.

  As the result, ncm object is released in ncm unbind
  but 'dev->port_usb' associated to 'ncm->port' is not NULL.

  And when ncm bind again to recover netdev, ncm object is reallocated
  but usb0 interface is already associated to previous released ncm object.

  Therefore, once usb0 interface is up and eth_start_xmit() is called,
  released ncm object is dereferrenced and it might cause use-after-free memory.

  [function unlink via configfs]
    usb0: eth_stop dev->port_usb=ffffff9b179c3200
    --> error happens in usb_ep_enable().
    NCM: ncm_disable: ncm=ffffff9b179c3200
    --> no gether_disconnect() since ncm->port.in_ep->enabled is false.
    NCM: ncm_unbind: ncm unbind ncm=ffffff9b179c3200
    NCM: ncm_free: ncm free ncm=ffffff9b179c3200   <-- released ncm

  [function link via configfs]
    NCM: ncm_alloc: ncm alloc ncm=ffffff9ac4f8a000
    NCM: ncm_bind: ncm bind ncm=ffffff9ac4f8a000
    NCM: ncm_set_alt: ncm=ffffff9ac4f8a000 alt=0
    usb0: eth_open dev->port_usb=ffffff9b179c3200  <-- previous released ncm
    usb0: eth_start dev->port_usb=ffffff9b179c3200 <--
    eth_start_xmit()
    --> dev->wrap()
    Unable to handle kernel paging request at virtual address dead00000000014f

  This patch addresses the issue by checking if 'ncm->netdev' is not NULL at
  ncm_disable() to call gether_disconnect() to deassociate 'dev->port_usb'.
  It's more reasonable to check 'ncm->netdev' to call gether_connect/disconnect
  rather than check 'ncm->port.in_ep->enabled' since it might not be enabled
  but the gether connection might be established.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26996.json
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22828'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22681'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22742'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22793'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22844'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22842'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22818'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.2281'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22799'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22812'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22845'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22837'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22831'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30522'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30533'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30515'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.3049'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30482'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30485'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30558'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30415'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.3037'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30518'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30534'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30523'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30551'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30509'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.52292'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26996
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26996.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-26996
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26996
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0588bbbd718a8130b98c54518f1e0b569ce60a93
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6334b8e4553cc69f51e383c9de545082213d785e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7250326cbb1f4f90391ac511a126b936cefb5bb7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7f67c2020cb08499c400abf0fc32c65e4d9a09ca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f356fd0cbd9c9cbd0854657a80d1608d0d732db3
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4EZ6PJW7VOZ224TD7N4JZNU6KV32ZJ53/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DAMSOZXJEPUOXW33WZYWCVAY7Z5S7OOY/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GCBZZEC7L7KTWWAS2NLJK6SO3IZIL4WW/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2278308
    reference_type:
    reference_id: 2278308
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26996
    reference_type:
    reference_id: CVE-2024-26996
  - url: https://usn.ubuntu.com/6893-1/
    reference_type:
    reference_id: USN-6893-1
  - url: https://usn.ubuntu.com/6893-2/
    reference_type:
    reference_id: USN-6893-2
  - url: https://usn.ubuntu.com/6893-3/
    reference_type:
    reference_id: USN-6893-3
  - url: https://usn.ubuntu.com/6898-1/
    reference_type:
    reference_id: USN-6898-1
  - url: https://usn.ubuntu.com/6898-2/
    reference_type:
    reference_id: USN-6898-2
  - url: https://usn.ubuntu.com/6898-3/
    reference_type:
    reference_id: USN-6898-3
  - url: https://usn.ubuntu.com/6898-4/
    reference_type:
    reference_id: USN-6898-4
  - url: https://usn.ubuntu.com/6917-1/
    reference_type:
    reference_id: USN-6917-1
  - url: https://usn.ubuntu.com/6918-1/
    reference_type:
    reference_id: USN-6918-1
  - url: https://usn.ubuntu.com/6919-1/
    reference_type:
    reference_id: USN-6919-1
  - url: https://usn.ubuntu.com/6927-1/
    reference_type:
    reference_id: USN-6927-1
  - url: https://usn.ubuntu.com/7019-1/
    reference_type:
    reference_id: USN-7019-1
