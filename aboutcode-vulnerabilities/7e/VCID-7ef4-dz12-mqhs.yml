vulnerability_id: VCID-7ef4-dz12-mqhs
aliases:
  - CVE-2025-21880
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drm/xe/userptr:
  fix EFAULT handling  Currently we treat EFAULT from hmm_range_fault() as a non-fatal error
  when called from xe_vm_userptr_pin() with the idea that we want to avoid killing the entire
  vm and chucking an error, under the assumption that the user just did an unmap or something,
  and has no intention of actually touching that memory from the GPU.  At this point we have
  already zapped the PTEs so any access should generate a page fault, and if the pin fails there
  also it will then become fatal.  However it looks like it''s possible for the userptr vma
  to still be on the rebind list in preempt_rebind_work_func(), if we had to retry the pin again
  due to something happening in the caller before we did the rebind step, but in the meantime
  needing to re-validate the userptr and this time hitting the EFAULT.  This explains an internal
  user report of hitting:  [  191.738349] WARNING: CPU: 1 PID: 157 at drivers/gpu/drm/xe/xe_res_cursor.h:158
  xe_pt_stage_bind.constprop.0+0x60a/0x6b0 [xe] [  191.738551] Workqueue: xe-ordered-wq preempt_rebind_work_func
  [xe] [  191.738616] RIP: 0010:xe_pt_stage_bind.constprop.0+0x60a/0x6b0 [xe] [  191.738690]
  Call Trace: [  191.738692]  <TASK> [  191.738694]  ? show_regs+0x69/0x80 [  191.738698]  ?
  __warn+0x93/0x1a0 [  191.738703]  ? xe_pt_stage_bind.constprop.0+0x60a/0x6b0 [xe] [  191.738759]  ?
  report_bug+0x18f/0x1a0 [  191.738764]  ? handle_bug+0x63/0xa0 [  191.738767]  ? exc_invalid_op+0x19/0x70
  [  191.738770]  ? asm_exc_invalid_op+0x1b/0x20 [  191.738777]  ? xe_pt_stage_bind.constprop.0+0x60a/0x6b0
  [xe] [  191.738834]  ? ret_from_fork_asm+0x1a/0x30 [  191.738849]  bind_op_prepare+0x105/0x7b0
  [xe] [  191.738906]  ? dma_resv_reserve_fences+0x301/0x380 [  191.738912]  xe_pt_update_ops_prepare+0x28c/0x4b0
  [xe] [  191.738966]  ? kmemleak_alloc+0x4b/0x80 [  191.738973]  ops_execute+0x188/0x9d0 [xe]
  [  191.739036]  xe_vm_rebind+0x4ce/0x5a0 [xe] [  191.739098]  ? trace_hardirqs_on+0x4d/0x60
  [  191.739112]  preempt_rebind_work_func+0x76f/0xd00 [xe]  Followed by NPD, when running some
  workload, since the sg was never actually populated but the vma is still marked for rebind
  when it should be skipped for this special EFAULT case. This is confirmed to fix the user
  report.  v2 (MattB):  - Move earlier. v3 (MattB):  - Update the commit message to make it
  clear that this indeed fixes the    issue.  (cherry picked from commit 6b93cb98910c826c2e2004942f8b060311e43618)'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-21880.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02028'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02117'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.01727'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03381'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03384'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03393'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03428'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03436'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03442'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03435'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0343'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04273'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04307'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0434'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04323'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04338'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04321'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04317'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04275'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04281'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04282'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04283'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04294'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0339'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03378'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03377'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04773'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-21880.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-21880
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/51cc278f8ffacd5f9dc7d13191b81b912829db59
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a9f4fa3a7efa65615ff7db13023ac84516e99e21
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/daad16d0a538fa938e344fd83927bbcfcd8a66ec
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355400
    reference_type:
    reference_id: 2355400
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21880
    reference_type:
    reference_id: CVE-2025-21880
