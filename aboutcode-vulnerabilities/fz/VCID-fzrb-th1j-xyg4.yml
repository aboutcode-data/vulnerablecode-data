vulnerability_id: VCID-fzrb-th1j-xyg4
aliases:
  - CVE-2024-10978
summary: Incorrect privilege assignment in PostgreSQL allows a less-privileged application user
  to view or change different rows from those intended.  An attack requires the application
  to use SET ROLE, SET SESSION AUTHORIZATION, or an equivalent feature.  The problem arises
  when an application query uses parameters from the attacker or conveys query results to the
  attacker.  If that query reacts to current_setting('role') or the current user ID, it may
  modify or return data as though the session had not used SET ROLE or SET SESSION AUTHORIZATION.  The
  attacker does not control which incorrect user ID applies.  Query text from less-privileged
  sources is not a concern here, because SET ROLE and SET SESSION AUTHORIZATION are not sandboxes
  for unvetted queries.  Versions before PostgreSQL 17.1, 16.5, 15.9, 14.14, 13.17, and 12.21
  are affected.
severities:
  - score: '4.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-10978.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23517'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.2355'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.2354'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.235'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25238'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25214'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29318'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29385'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29433'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29432'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29372'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29351'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29314'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29338'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.2932'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29313'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29323'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29293'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29291'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29642'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.37384'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.37343'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.37465'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.37476'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.3748'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.37505'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.37475'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.37445'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.37458'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '0.00552'
    scoring_system: epss
    scoring_elements: '0.51128'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-10978
  - score: '4.2'
    scoring_system: cvssv3
    scoring_elements: '[''AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N'']'
    published_at: None
    url: https://www.postgresql.org/support/security/CVE-2024-10978/
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://www.postgresql.org/support/security/CVE-2024-10978/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-11-14T18:53:38Z/
    published_at: None
    url: https://www.postgresql.org/support/security/CVE-2024-10978/
weaknesses:
  - CWE-266
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-10978.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-10978
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-10978
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/11/msg00018.html
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/about/news/postgresql-171-165-159-1414-1317-and-1221-released-2955/
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/message-id/173171334532.1547978.1518068370217143844%40wrigleys.postgresql.org
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/support/security/CVE-2024-10978/
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1088687
    reference_type:
    reference_id: 1088687
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2326251
    reference_type:
    reference_id: 2326251
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:17.0:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:17.0:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:17.0:beta1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:17.0:beta1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:17.0:beta2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:17.0:beta2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:17.0:beta3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:17.0:beta3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:17.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:17.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-10978
    reference_type:
    reference_id: CVE-2024-10978
  - url: https://security.gentoo.org/glsa/202412-12
    reference_type:
    reference_id: GLSA-202412-12
  - url: https://access.redhat.com/errata/RHSA-2024:10785
    reference_type:
    reference_id: RHSA-2024:10785
  - url: https://access.redhat.com/errata/RHSA-2024:10787
    reference_type:
    reference_id: RHSA-2024:10787
  - url: https://access.redhat.com/errata/RHSA-2024:10788
    reference_type:
    reference_id: RHSA-2024:10788
  - url: https://access.redhat.com/errata/RHSA-2024:10791
    reference_type:
    reference_id: RHSA-2024:10791
  - url: https://access.redhat.com/errata/RHSA-2024:10830
    reference_type:
    reference_id: RHSA-2024:10830
  - url: https://access.redhat.com/errata/RHSA-2024:10831
    reference_type:
    reference_id: RHSA-2024:10831
  - url: https://access.redhat.com/errata/RHSA-2024:10832
    reference_type:
    reference_id: RHSA-2024:10832
  - url: https://usn.ubuntu.com/7132-1/
    reference_type:
    reference_id: USN-7132-1
  - url: https://usn.ubuntu.com/7358-1/
    reference_type:
    reference_id: USN-7358-1
