vulnerability_id: VCID-nxmp-he99-aaah
aliases:
  - GHSA-95rx-m9m5-m94v
summary: |
  ASA-2024-006: ValidateVoteExtensions helper function in Cosmos SDK may allow incorrect voting power assumptions
  ## ASA-2024-006: ValidateVoteExtensions helper function may allow incorrect voting power assumptions

  **Component**: Cosmos SDK
  **Criticality**: High
  **Affected Versions**: Cosmos SDK versions <= 0.50.4, on 0.50 branches
  **Affected Users**: Chain developers, Validator and Node operators
  **Impact**: Elevation of Privilege

  ## Summary

  The default `ValidateVoteExtensions` helper function infers total voting power based off of the injected `VoteExtension`, which are injected by the proposer.  If your chain utilizes the `ValidateVoteExtensions` helper in `ProcessProposal`, a dishonest proposer can potentially mutate voting power of each validator it includes in the injected `VoteExtension`, which could have potentially unexpected or negative consequences on modified state.  Additional validation on injected `VoteExtension` data was added to confirm voting power against the state machine.

  ## Next Steps for Impacted Parties

  If you are a chain developer on an affected version of the Cosmos SDK, it is advised to update to the latest available version of the Cosmos SDK for your project.  Once a patched version is available, it is recommended that network operators upgrade.

  A Github Security Advisory for this issue is available in the Cosmos-SDK [repository](https://github.com/cosmos/cosmos-sdk/security/advisories/GHSA-95rx-m9m5-m94v). For more information about Cosmos SDK, see https://docs.cosmos.network/.
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/cosmos/cosmos-sdk
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cosmos/cosmos-sdk
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/cosmos/cosmos-sdk/commit/4467110df40797ebe916c23ebfd45c9ee7583897
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cosmos/cosmos-sdk/commit/4467110df40797ebe916c23ebfd45c9ee7583897
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/cosmos/cosmos-sdk/releases/tag/v0.50.5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cosmos/cosmos-sdk/releases/tag/v0.50.5
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/cosmos/cosmos-sdk/security/advisories/GHSA-95rx-m9m5-m94v
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cosmos/cosmos-sdk/security/advisories/GHSA-95rx-m9m5-m94v
weaknesses:
  - CWE-20
references:
  - url: https://github.com/cosmos/cosmos-sdk
    reference_type:
    reference_id:
  - url: https://github.com/cosmos/cosmos-sdk/commit/4467110df40797ebe916c23ebfd45c9ee7583897
    reference_type:
    reference_id:
  - url: https://github.com/cosmos/cosmos-sdk/releases/tag/v0.50.5
    reference_type:
    reference_id:
  - url: https://github.com/cosmos/cosmos-sdk/security/advisories/GHSA-95rx-m9m5-m94v
    reference_type:
    reference_id:
