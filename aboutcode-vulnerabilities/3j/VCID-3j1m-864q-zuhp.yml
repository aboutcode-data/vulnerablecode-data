vulnerability_id: VCID-3j1m-864q-zuhp
aliases:
  - CVE-2024-56128
  - GHSA-p7c9-8xx8-h74f
summary: |
  Incorrect Implementation of Authentication Algorithm in Apache Kafka's SCRAM implementation.

  Issue Summary:
  Apache Kafka's implementation of the Salted Challenge Response Authentication Mechanism (SCRAM) did not fully adhere to the requirements of RFC 5802 [1].
  Specifically, as per RFC 5802, the server must verify that the nonce sent by the client in the second message matches the nonce sent by the server in its first message.
  However, Kafka's SCRAM implementation did not perform this validation.

  Impact:
  This vulnerability is exploitable only when an attacker has plaintext access to the SCRAM authentication exchange. However, the usage of SCRAM over plaintext is strongly
  discouraged as it is considered an insecure practice [2]. Apache Kafka recommends deploying SCRAM exclusively with TLS encryption to protect SCRAM exchanges from interception [3].
  Deployments using SCRAM with TLS are not affected by this issue.

  How to Detect If You Are Impacted:
  If your deployment uses SCRAM authentication over plaintext communication channels (without TLS encryption), you are likely impacted.
  To check if TLS is enabled, review your server.properties configuration file for listeners property. If you have SASL_PLAINTEXT in the listeners, then you are likely impacted.

  Fix Details:
  The issue has been addressed by introducing nonce verification in the final message of the SCRAM authentication exchange to ensure compliance with RFC 5802.

  Affected Versions:
  Apache Kafka versions 0.10.2.0 through 3.9.0, excluding the fixed versions below.

  Fixed Versions:
  3.9.0
  3.8.1
  3.7.2

  Users are advised to upgrade to 3.7.2 or later to mitigate this issue.

  Recommendations for Mitigation:
  Users unable to upgrade to the fixed versions can mitigate the issue by:
  - Using TLS with SCRAM Authentication:
  Always deploy SCRAM over TLS to encrypt authentication exchanges and protect against interception.
  - Considering Alternative Authentication Mechanisms:
  Evaluate alternative authentication mechanisms, such as PLAIN, Kerberos or OAuth with TLS, which provide additional layers of security.
severities:
  - score: '7.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-56128.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.13487'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10879'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10971'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11008'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.1372'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11041'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11019'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11012'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11004'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10987'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10998'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10964'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10929'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10923'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10804'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.10847'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.13639'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.13543'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17751'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17781'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17763'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17723'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17717'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17729'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17739'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.1776'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17762'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17756'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.187'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://datatracker.ietf.org/doc/html/rfc5802
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://datatracker.ietf.org/doc/html/rfc5802
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-18T16:15:35Z/
    published_at: None
    url: https://datatracker.ietf.org/doc/html/rfc5802
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://datatracker.ietf.org/doc/html/rfc5802#section-9
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://datatracker.ietf.org/doc/html/rfc5802#section-9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-18T16:15:35Z/
    published_at: None
    url: https://datatracker.ietf.org/doc/html/rfc5802#section-9
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p7c9-8xx8-h74f
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/apache/kafka
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/kafka
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/apache/kafka/commit/2cbc5bd3ca22185d9cd357c9db23a2cfb43a0fff
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/kafka/commit/2cbc5bd3ca22185d9cd357c9db23a2cfb43a0fff
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://kafka.apache.org/documentation/#security_sasl_scram_security
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://kafka.apache.org/documentation/#security_sasl_scram_security
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-18T16:15:35Z/
    published_at: None
    url: https://kafka.apache.org/documentation/#security_sasl_scram_security
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://lists.apache.org/thread/84dh4so32lwn7wr6c5s9mwh381vx9wkw
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/84dh4so32lwn7wr6c5s9mwh381vx9wkw
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-18T16:15:35Z/
    published_at: None
    url: https://lists.apache.org/thread/84dh4so32lwn7wr6c5s9mwh381vx9wkw
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56128
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56128
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/12/18/3
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/12/18/3
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-303
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-56128.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-56128
    reference_type:
    reference_id:
  - url: https://github.com/apache/kafka
    reference_type:
    reference_id:
  - url: https://github.com/apache/kafka/commit/2cbc5bd3ca22185d9cd357c9db23a2cfb43a0fff
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/12/18/3
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2333013
    reference_type:
    reference_id: 2333013
  - url: https://lists.apache.org/thread/84dh4so32lwn7wr6c5s9mwh381vx9wkw
    reference_type:
    reference_id: 84dh4so32lwn7wr6c5s9mwh381vx9wkw
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56128
    reference_type:
    reference_id: CVE-2024-56128
  - url: https://github.com/advisories/GHSA-p7c9-8xx8-h74f
    reference_type:
    reference_id: GHSA-p7c9-8xx8-h74f
  - url: https://datatracker.ietf.org/doc/html/rfc5802
    reference_type:
    reference_id: rfc5802
  - url: https://datatracker.ietf.org/doc/html/rfc5802#section-9
    reference_type:
    reference_id: rfc5802#section-9
  - url: https://kafka.apache.org/documentation/#security_sasl_scram_security
    reference_type:
    reference_id: '#security_sasl_scram_security'
