vulnerability_id: VCID-4gxz-axtz-93a6
aliases:
  - CVE-2022-50346
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ext4: init quota
  for ''old.inode'' in ''ext4_rename''  Syzbot found the following issue: ext4_parse_param:
  s_want_extra_isize=128 ext4_inode_info_init: s_want_extra_isize=32 ext4_rename: old.inode=ffff88823869a2c8
  old.dir=ffff888238699828 new.inode=ffff88823869d7e8 new.dir=ffff888238699828 __ext4_mark_inode_dirty:
  inode=ffff888238699828 ea_isize=32 want_ea_size=128 __ext4_mark_inode_dirty: inode=ffff88823869a2c8
  ea_isize=32 want_ea_size=128 ext4_xattr_block_set: inode=ffff88823869a2c8 ------------[ cut
  here ]------------ WARNING: CPU: 13 PID: 2234 at fs/ext4/xattr.c:2070 ext4_xattr_block_set.cold+0x22/0x980
  Modules linked in: RIP: 0010:ext4_xattr_block_set.cold+0x22/0x980 RSP: 0018:ffff888227d3f3b0
  EFLAGS: 00010202 RAX: 0000000000000001 RBX: ffff88823007a000 RCX: 0000000000000000 RDX: 0000000000000a03
  RSI: 0000000000000040 RDI: ffff888230078178 RBP: 0000000000000000 R08: 000000000000002c R09:
  ffffed1075c7df8e R10: ffff8883ae3efc6b R11: ffffed1075c7df8d R12: 0000000000000000 R13: ffff88823869a2c8
  R14: ffff8881012e0460 R15: dffffc0000000000 FS:  00007f350ac1f740(0000) GS:ffff8883ae200000(0000)
  knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00007f350a6ed6a0
  CR3: 0000000237456000 CR4: 00000000000006e0 DR0: 0000000000000000 DR1: 0000000000000000 DR2:
  0000000000000000 DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 Call Trace:  <TASK>  ?
  ext4_xattr_set_entry+0x3b7/0x2320  ? ext4_xattr_block_set+0x0/0x2020  ? ext4_xattr_set_entry+0x0/0x2320  ?
  ext4_xattr_check_entries+0x77/0x310  ? ext4_xattr_ibody_set+0x23b/0x340  ext4_xattr_move_to_block+0x594/0x720  ext4_expand_extra_isize_ea+0x59a/0x10f0  __ext4_expand_extra_isize+0x278/0x3f0  __ext4_mark_inode_dirty.cold+0x347/0x410  ext4_rename+0xed3/0x174f  vfs_rename+0x13a7/0x2510  do_renameat2+0x55d/0x920  __x64_sys_rename+0x7d/0xb0  do_syscall_64+0x3b/0xa0  entry_SYSCALL_64_after_hwframe+0x72/0xdc  As
  ''ext4_rename'' will modify ''old.inode'' ctime and mark inode dirty, which may trigger expand
  ''extra_isize'' and allocate block. If inode didn''t init quota will lead to warning.  To
  solve above issue, init ''old.inode'' firstly in ''ext4_rename''.'
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50346.json
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.0269'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02686'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08102'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08012'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.0806'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1284'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12998'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12977'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.13012'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12901'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12889'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12939'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1299'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.13006'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1297'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12942'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12561'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1267'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12667'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12844'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12845'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14276'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14207'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14315'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14323'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14284'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14281'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14286'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14407'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14359'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14294'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
  - score: '4.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50346.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50346
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-50346
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2395861
    reference_type:
    reference_id: 2395861
