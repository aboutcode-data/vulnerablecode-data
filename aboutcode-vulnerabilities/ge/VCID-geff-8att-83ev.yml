vulnerability_id: VCID-geff-8att-83ev
aliases:
  - CVE-2025-59349
  - GHSA-8425-8r2f-mrv6
summary: |
  Dragonfly's directories created via os.MkdirAll are not checked for permissions
  ### Impact

  DragonFly2 uses the os.MkdirAll function to create certain directory paths with specific access permissions. This function does not perform any permission checks when a given directory path already exists. This allows a local attacker to create a directory to be used later by DragonFly2 with broad permissions before DragonFly2 does so, potentially allowing the attacker to tamper with the files.

  Eve has unprivileged access to the machine where Alice uses DragonFly2. Eve watches the commands executed by Alice and introduces new directories/paths with 0777 permissions before DragonFly2 does so. Eve can then delete and forge files in that directory to change the results of further commands executed by Alice.

  ### Patches

  - Dragonfy v2.1.0 and above.

  ### Workarounds

  There are no effective workarounds, beyond upgrading.

  ### References

  A third party security audit was performed by Trail of Bits, you can see the [full report](https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf).

  If you have any questions or comments about this advisory, please email us at [dragonfly-maintainers@googlegroups.com](mailto:dragonfly-maintainers@googlegroups.com).
severities:
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01276'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01288'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01669'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01675'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01693'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01678'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01679'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01677'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0168'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01635'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01628'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01673'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01788'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01651'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01661'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01708'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01715'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0173'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02443'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02484'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02506'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02405'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02392'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.0239'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02403'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02408'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02422'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02437'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03916'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03928'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly
  - score: 2
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-18T17:35:44Z/
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: 2
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-8425-8r2f-mrv6
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-8425-8r2f-mrv6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-18T17:35:44Z/
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-8425-8r2f-mrv6
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59349
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3964
weaknesses:
  - CWE-276
  - CWE-732
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-59349
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-8425-8r2f-mrv6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59349
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3964
    reference_type:
    reference_id:
