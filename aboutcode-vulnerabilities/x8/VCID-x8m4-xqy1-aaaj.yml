vulnerability_id: VCID-x8m4-xqy1-aaaj
aliases:
  - CVE-2024-31573
  - GHSA-chfm-68vv-pvw5
summary: |
  XMLUnit for Java has Insecure Defaults when Processing XSLT Stylesheets
  ### Impact
  When performing XSLT transformations XMLUnit for Java did not disable XSLT extension functions by default. Depending on the XSLT processor being used this could allow arbitrary code to be executed when XMLUnit is used to transform data with a stylesheet who's source can not be trusted. If the stylesheet can be provided externally this may even lead to a remote code execution.

  ## Patches
  Users are advised to upgrade to XMLUnit for Java 2.10.0 where the default has been changed by means of https://github.com/xmlunit/xmlunit/commit/b81d48b71dfd2868bdfc30a3e17ff973f32bc15b

  ### Workarounds
  XMLUnit's main use-case is performing tests on code that generates or processes XML. Most users will not use it to perform arbitrary XSLT transformations.

  Users running XSLT transformations with untrusted stylesheets should explicitly use XMLUnit's APIs to pass in a pre-configured TraX `TransformerFactory` with extension functions disabled via features and attributes. The required `setFactory` or `setTransformerFactory` methods have been available since XMLUnit for Java 2.0.0.

  ### References
  [Bug Report](https://github.com/xmlunit/xmlunit/issues/264)
  [JAXP Security Guide](https://docs.oracle.com/en/java/javase/22/security/java-api-xml-processing-jaxp-security-guide.html#GUID-E345AA09-801E-4B95-B83D-7F0C452538AA)
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.oracle.com/en/java/javase/22/security/java-api-xml-processing-jaxp-security-guide.html#GUID-E345AA09-801E-4B95-B83D-7F0C452538AA
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-chfm-68vv-pvw5
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xmlunit/xmlunit
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xmlunit/xmlunit/commit/b81d48b71dfd2868bdfc30a3e17ff973f32bc15b
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xmlunit/xmlunit/issues/264
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xmlunit/xmlunit/security/advisories/GHSA-chfm-68vv-pvw5
weaknesses:
  - CWE-937
  - CWE-1035
references:
  - url: https://docs.oracle.com/en/java/javase/22/security/java-api-xml-processing-jaxp-security-guide.html#GUID-E345AA09-801E-4B95-B83D-7F0C452538AA
    reference_type:
    reference_id:
  - url: https://github.com/xmlunit/xmlunit
    reference_type:
    reference_id:
  - url: https://github.com/xmlunit/xmlunit/commit/b81d48b71dfd2868bdfc30a3e17ff973f32bc15b
    reference_type:
    reference_id:
  - url: https://github.com/xmlunit/xmlunit/issues/264
    reference_type:
    reference_id:
  - url: https://github.com/xmlunit/xmlunit/security/advisories/GHSA-chfm-68vv-pvw5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-31573
    reference_type:
    reference_id: CVE-2024-31573
  - url: https://github.com/advisories/GHSA-chfm-68vv-pvw5
    reference_type:
    reference_id: GHSA-chfm-68vv-pvw5
