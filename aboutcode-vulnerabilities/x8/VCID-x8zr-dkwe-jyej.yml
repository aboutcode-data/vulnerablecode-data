vulnerability_id: VCID-x8zr-dkwe-jyej
aliases:
  - CVE-2023-53317
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ext4: fix WARNING
  in mb_find_extent  Syzbot found the following issue:  EXT4-fs: Warning: mounting with data=journal
  disables delayed allocation, dioread_nolock, O_DIRECT and fast_commit support! EXT4-fs (loop0):
  orphan cleanup on readonly fs ------------[ cut here ]------------ WARNING: CPU: 1 PID: 5067
  at fs/ext4/mballoc.c:1869 mb_find_extent+0x8a1/0xe30 Modules linked in: CPU: 1 PID: 5067 Comm:
  syz-executor307 Not tainted 6.2.0-rc1-syzkaller #0 Hardware name: Google Google Compute Engine/Google
  Compute Engine, BIOS Google 10/26/2022 RIP: 0010:mb_find_extent+0x8a1/0xe30 fs/ext4/mballoc.c:1869
  RSP: 0018:ffffc90003c9e098 EFLAGS: 00010293 RAX: ffffffff82405731 RBX: 0000000000000041 RCX:
  ffff8880783457c0 RDX: 0000000000000000 RSI: 0000000000000041 RDI: 0000000000000040 RBP: 0000000000000040
  R08: ffffffff82405723 R09: ffffed10053c9402 R10: ffffed10053c9402 R11: 1ffff110053c9401 R12:
  0000000000000000 R13: ffffc90003c9e538 R14: dffffc0000000000 R15: ffffc90003c9e2cc FS:  0000555556665300(0000)
  GS:ffff8880b9900000(0000) knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
  CR2: 000056312f6796f8 CR3: 0000000022437000 CR4: 00000000003506e0 DR0: 0000000000000000 DR1:
  0000000000000000 DR2: 0000000000000000 DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
  Call Trace:  <TASK>  ext4_mb_complex_scan_group+0x353/0x1100 fs/ext4/mballoc.c:2307  ext4_mb_regular_allocator+0x1533/0x3860
  fs/ext4/mballoc.c:2735  ext4_mb_new_blocks+0xddf/0x3db0 fs/ext4/mballoc.c:5605  ext4_ext_map_blocks+0x1868/0x6880
  fs/ext4/extents.c:4286  ext4_map_blocks+0xa49/0x1cc0 fs/ext4/inode.c:651  ext4_getblk+0x1b9/0x770
  fs/ext4/inode.c:864  ext4_bread+0x2a/0x170 fs/ext4/inode.c:920  ext4_quota_write+0x225/0x570
  fs/ext4/super.c:7105  write_blk fs/quota/quota_tree.c:64 [inline]  get_free_dqblk+0x34a/0x6d0
  fs/quota/quota_tree.c:130  do_insert_tree+0x26b/0x1aa0 fs/quota/quota_tree.c:340  do_insert_tree+0x722/0x1aa0
  fs/quota/quota_tree.c:375  do_insert_tree+0x722/0x1aa0 fs/quota/quota_tree.c:375  do_insert_tree+0x722/0x1aa0
  fs/quota/quota_tree.c:375  dq_insert_tree fs/quota/quota_tree.c:401 [inline]  qtree_write_dquot+0x3b6/0x530
  fs/quota/quota_tree.c:420  v2_write_dquot+0x11b/0x190 fs/quota/quota_v2.c:358  dquot_acquire+0x348/0x670
  fs/quota/dquot.c:444  ext4_acquire_dquot+0x2dc/0x400 fs/ext4/super.c:6740  dqget+0x999/0xdc0
  fs/quota/dquot.c:914  __dquot_initialize+0x3d0/0xcf0 fs/quota/dquot.c:1492  ext4_process_orphan+0x57/0x2d0
  fs/ext4/orphan.c:329  ext4_orphan_cleanup+0xb60/0x1340 fs/ext4/orphan.c:474  __ext4_fill_super
  fs/ext4/super.c:5516 [inline]  ext4_fill_super+0x81cd/0x8700 fs/ext4/super.c:5644  get_tree_bdev+0x400/0x620
  fs/super.c:1282  vfs_get_tree+0x88/0x270 fs/super.c:1489  do_new_mount+0x289/0xad0 fs/namespace.c:3145  do_mount
  fs/namespace.c:3488 [inline]  __do_sys_mount fs/namespace.c:3697 [inline]  __se_sys_mount+0x2d3/0x3c0
  fs/namespace.c:3674  do_syscall_x64 arch/x86/entry/common.c:50 [inline]  do_syscall_64+0x3d/0xb0
  arch/x86/entry/common.c:80  entry_SYSCALL_64_after_hwframe+0x63/0xcd  Add some debug information:
  mb_find_extent: mb_find_extent block=41, order=0 needed=64 next=0 ex=0/41/1@3735929054 64
  64 7 block_bitmap: ff 3f 0c 00 fc 01 00 00 d2 3d 00 00 00 00 00 00 ff ff ff ff ff ff ff ff
  ff ff ff ff ff ff ff ff  Acctually, blocks per group is 64, but block bitmap indicate at least
  has 128 blocks. Now, ext4_validate_block_bitmap() didn''t check invalid block''s bitmap if
  set. To resolve above issue, add check like fsck "Padding at end of block bitmap is not set".'
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53317.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53317.json
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.0305'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.03052'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05164'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05085'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08145'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0808'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08136'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08117'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08148'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08235'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08288'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08304'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08283'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08106'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07772'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07843'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0783'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0801'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08001'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08009'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09362'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09308'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09293'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09402'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0934'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09352'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09363'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09383'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09511'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09468'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: 7
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53317.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53317
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-53317
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2395887
    reference_type:
    reference_id: 2395887
  - url: https://access.redhat.com/errata/RHSA-2024:2394
    reference_type:
    reference_id: RHSA-2024:2394
