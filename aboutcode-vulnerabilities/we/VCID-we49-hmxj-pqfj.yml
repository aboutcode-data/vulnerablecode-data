vulnerability_id: VCID-we49-hmxj-pqfj
aliases:
  - CVE-2025-32971
  - GHSA-987p-r3jc-8c8v
summary: "Solr script service doesn't take dropped programming right into account\n### Impact\n\
  The Solr script service that is accessible in XWiki's scripting API normally requires programming\
  \ right to be called. Due to using the wrong API for checking rights, it doesn't take the\
  \ fact into account that programming rights might have been dropped by calling `$xcontext.dropPermissions()`.\
  \ If some code relies on this for the safety of executing Velocity code with the wrong author\
  \ context, this could allow a user with script right to either cause a high load by indexing\
  \ documents or to temporarily remove documents from the search index. We're not aware that\
  \ this is exploitable in XWiki itself.\n\nTo reproduce, a user with programming right can\
  \ add the following XWiki syntax to a page:\n```\n{{velocity}}\n$xcontext.dropPermissions()\n\
  $services.solr.index('document:xwiki:Main.WebHome')\n{{/velocity}} \n```\n\nThis should trigger\
  \ an error in XWiki's log, otherwise the installation is vulnerable.\n\n### Patches\nThis\
  \ has been patched in XWiki 15.10.13, 16.8.0RC1, and 16.4.4.\n\n### Workarounds\nWe're not\
  \ aware of any workarounds apart from being careful whom you grant script right."
severities:
  - score: '3.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: '3.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/6570f40f976aec82baf388b5239d1412cab238c9
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/6570f40f976aec82baf388b5239d1412cab238c9
  - score: '3.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-987p-r3jc-8c8v
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-987p-r3jc-8c8v
  - score: '3.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-22474
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-22474
weaknesses:
  - CWE-863
references:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/6570f40f976aec82baf388b5239d1412cab238c9
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-987p-r3jc-8c8v
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-22474
    reference_type:
    reference_id:
