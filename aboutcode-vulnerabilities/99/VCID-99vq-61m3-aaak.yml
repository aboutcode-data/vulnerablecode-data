vulnerability_id: VCID-99vq-61m3-aaak
aliases:
  - BIT-2021-29530
  - BIT-tensorflow-2021-29530
  - CVE-2021-29530
  - GHSA-xcwj-wfcm-m23c
  - PYSEC-2021-167
  - PYSEC-2021-458
  - PYSEC-2021-656
summary: TensorFlow is an end-to-end open source platform for machine learning. An attacker
  can trigger a null pointer dereference by providing an invalid `permutation` to `tf.raw_ops.SparseMatrixSparseCholesky`.
  This is because the implementation(https://github.com/tensorflow/tensorflow/blob/080f1d9e257589f78b3ffb75debf584168aa6062/tensorflow/core/kernels/sparse/sparse_cholesky_op.cc#L85-L86)
  fails to properly validate the input arguments. Although `ValidateInputs` is called and there
  are checks in the body of this function, the code proceeds to the next line in `ValidateInputs`
  since `OP_REQUIRES`(https://github.com/tensorflow/tensorflow/blob/080f1d9e257589f78b3ffb75debf584168aa6062/tensorflow/core/framework/op_requires.h#L41-L48)
  is a macro that only exits the current function. Thus, the first validation condition that
  fails in `ValidateInputs` will cause an early return from that function. However, the caller
  will continue execution from the next line. The fix is to either explicitly check `context->status()`
  or to convert `ValidateInputs` to return a `Status`. The fix will be included in TensorFlow
  2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow
  2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.
severities:
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01975'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01942'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01924'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01885'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01884'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01871'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01872'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01857'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01866'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01877'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03893'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03881'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03903'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03877'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03115'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03122'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.0313'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03835'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03828'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03841'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03853'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03842'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03839'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03826'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03825'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03874'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03878'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.04596'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.38031'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.38038'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.38003'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.38326'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42548'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42271'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42249'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42238'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42241'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42151'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42126'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42039'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.41772'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42291'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42458'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.42490'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xcwj-wfcm-m23c
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-458.yaml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-458.yaml
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-656.yaml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-656.yaml
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-167.yaml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-167.yaml
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/e6a7c7cc18c3aaad1ae0872cb0a959f5c923d2bd
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/e6a7c7cc18c3aaad1ae0872cb0a959f5c923d2bd
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-xcwj-wfcm-m23c
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-xcwj-wfcm-m23c
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-xcwj-wfcm-m23c
  - score: '4.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29530
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29530
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29530
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29530
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29530
  - score: Critical
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-1962
weaknesses:
  - CWE-476
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-29530
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-458.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-656.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-167.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/e6a7c7cc18c3aaad1ae0872cb0a959f5c923d2bd
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/AVG-1962
    reference_type:
    reference_id: AVG-1962
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29530
    reference_type:
    reference_id: CVE-2021-29530
  - url: https://github.com/advisories/GHSA-xcwj-wfcm-m23c
    reference_type:
    reference_id: GHSA-xcwj-wfcm-m23c
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-xcwj-wfcm-m23c
    reference_type:
    reference_id: GHSA-xcwj-wfcm-m23c
