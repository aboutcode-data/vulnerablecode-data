vulnerability_id: VCID-38rq-d4wx-aaaj
aliases:
  - CVE-2019-5477
  - GHSA-cr5j-953j-xw5p
summary: A command injection vulnerability in Nokogiri v1.10.3 and earlier allows commands to
  be executed in a subprocess via Ruby's `Kernel.open` method. Processes are vulnerable only
  if the undocumented method `Nokogiri::CSS::Tokenizer#load_file` is being called with unsafe
  user input as the filename. This vulnerability appears in code generated by the Rexical gem
  versions v1.0.6 and earlier. Rexical is used by Nokogiri to generate lexical scanner code
  for parsing CSS queries. The underlying vulnerability was addressed in Rexical v1.0.7 and
  Nokogiri upgraded to this version of Rexical in Nokogiri v1.10.4.
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2019/CVE-2019-5477.html
  - score: '0.01346'
    scoring_system: epss
    scoring_elements: '0.78368'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01346'
    scoring_system: epss
    scoring_elements: '0.78419'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01346'
    scoring_system: epss
    scoring_elements: '0.79002'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.79133'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.79139'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.79147'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.79159'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.79142'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.79123'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.791'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78576'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78577'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78584'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78573'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78568'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.7855'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78543'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78548'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78515'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78511'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78444'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.78437'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.79141'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.79151'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.01368'
    scoring_system: epss
    scoring_elements: '0.7915'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02018'
    scoring_system: epss
    scoring_elements: '0.88597'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02018'
    scoring_system: epss
    scoring_elements: '0.88584'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02018'
    scoring_system: epss
    scoring_elements: '0.88589'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90345'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90364'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90261'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90352'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90312'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90325'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90337'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90338'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90340'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02421'
    scoring_system: epss
    scoring_elements: '0.90348'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.02454'
    scoring_system: epss
    scoring_elements: '0.89765'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: '0.05058'
    scoring_system: epss
    scoring_elements: '0.82585'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5477
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-cr5j-953j-xw5p
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-cr5j-953j-xw5p
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/sparklemotion/nokogiri
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/sparklemotion/nokogiri
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/sparklemotion/nokogiri/commit/5d30128343573a9428c86efc758ba2c66e9f12dc
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/sparklemotion/nokogiri/commit/5d30128343573a9428c86efc758ba2c66e9f12dc
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://github.com/sparklemotion/nokogiri/issues/1915
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/sparklemotion/nokogiri/issues/1915
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/sparklemotion/nokogiri/issues/1915
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tenderlove/rexical/blob/master/CHANGELOG.rdoc
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tenderlove/rexical/blob/master/CHANGELOG.rdoc
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://github.com/tenderlove/rexical/commit/a652474dbc66be350055db3e8f9b3a7b3fd75926
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tenderlove/rexical/commit/a652474dbc66be350055db3e8f9b3a7b3fd75926
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tenderlove/rexical/commit/a652474dbc66be350055db3e8f9b3a7b3fd75926
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://hackerone.com/reports/650835
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://hackerone.com/reports/650835
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2019/09/msg00027.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2019/09/msg00027.html
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2022/10/msg00018.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2022/10/msg00018.html
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2022/10/msg00019.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2022/10/msg00019.html
  - score: '7.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-5477
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-5477
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-5477
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://security.gentoo.org/glsa/202006-05
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.gentoo.org/glsa/202006-05
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-4175-1
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://usn.ubuntu.com/4175-1
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://usn.ubuntu.com/4175-1
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://usn.ubuntu.com/usn/usn-4175-1
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2019/CVE-2019-5477.html
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2019-5477
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5477
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/commit/5d30128343573a9428c86efc758ba2c66e9f12dc
    reference_type:
    reference_id:
  - url: https://github.com/sparklemotion/nokogiri/issues/1915
    reference_type:
    reference_id:
  - url: https://github.com/tenderlove/rexical/blob/master/CHANGELOG.rdoc
    reference_type:
    reference_id:
  - url: https://github.com/tenderlove/rexical/commit/a652474dbc66be350055db3e8f9b3a7b3fd75926
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/650835
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2019/09/msg00027.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/10/msg00018.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/10/msg00019.html
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202006-05
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4175-1
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4175-1
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4175-1/
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/usn/usn-4175-1
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=934802
    reference_type:
    reference_id: 934802
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nokogiri:nokogiri:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:nokogiri:nokogiri:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:19.04:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:19.04:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:19.10:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:19.10:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-5477
    reference_type:
    reference_id: CVE-2019-5477
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/CVE-2019-5477.yml
    reference_type:
    reference_id: CVE-2019-5477.YML
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rexical/CVE-2019-5477.yml
    reference_type:
    reference_id: CVE-2019-5477.YML
  - url: https://github.com/advisories/GHSA-cr5j-953j-xw5p
    reference_type:
    reference_id: GHSA-cr5j-953j-xw5p
