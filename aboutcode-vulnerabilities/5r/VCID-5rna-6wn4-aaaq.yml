vulnerability_id: VCID-5rna-6wn4-aaaq
aliases:
  - CVE-2024-42467
  - GHSA-v7gr-mqpj-wwh3
summary: |
  CometVisu Backend for openHAB affected by SSRF/XSS
  The [proxy endpoint](https://github.com/openhab/openhab-webui/blob/1c03c60f84388b9d7da0231df2d4ebb1e17d3fcf/bundles/org.openhab.ui.cometvisu/src/main/java/org/openhab/ui/cometvisu/internal/backend/rest/ProxyResource.java#L83) of openHAB's CometVisu add-on can be accessed without authentication. This proxy-feature can be exploited as Server-Side Request Forgery (SSRF) to induce GET HTTP requests to internal-only servers, in case openHAB is exposed in a non-private network.

  Furthermore, this proxy-feature can also be exploited as a Cross-Site Scripting (XSS) vulnerability, as an attacker is able to re-route a request to their server and return a page with malicious JavaScript code. Since the browser receives this data directly from the openHAB CometVisu UI, this JavaScript code will be executed with the origin of the CometVisu UI. This allows an attacker to exploit call endpoints on an openHAB server even if the openHAB server is located in a private network. (e.g. by sending an openHAB admin a link that proxies malicious JavaScript.)

  This vulnerability was discovered with the help of CodeQL's [Server-side request forgery](https://codeql.github.com/codeql-query-help/java/java-ssrf/) query.

  ## Impact

  This issue may lead up to Remote Code Execution (RCE) when chained with other vulnerabilities (see: GHSL-2024-007).
severities:
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28947'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29751'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29351'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29377'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29378'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29373'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29300'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29241'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29015'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28965'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28949'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28532'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28792'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28870'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28901'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28953'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74275'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74229'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74257'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74286'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74301'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74306'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74281'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74272'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74276'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74278'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.00891'
    scoring_system: epss
    scoring_elements: '0.74285'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83832'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83827'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83839'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83828'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83733'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.8373'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83779'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83776'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83799'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83804'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83797'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83798'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83803'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02436'
    scoring_system: epss
    scoring_elements: '0.83815'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.02873'
    scoring_system: epss
    scoring_elements: '0.85119'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: '0.17439'
    scoring_system: epss
    scoring_elements: '0.91841'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-v7gr-mqpj-wwh3
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/openhab/openhab-webui
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/openhab/openhab-webui
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/openhab/openhab-webui/blob/1c03c60f84388b9d7da0231df2d4ebb1e17d3fcf/bundles/org.openhab.ui.cometvisu/src/main/java/org/openhab/ui/cometvisu/internal/backend/rest/ProxyResource.java#L83
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/openhab/openhab-webui/blob/1c03c60f84388b9d7da0231df2d4ebb1e17d3fcf/bundles/org.openhab.ui.cometvisu/src/main/java/org/openhab/ui/cometvisu/internal/backend/rest/ProxyResource.java#L83
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/openhab/openhab-webui/commit/630e8525835c698cf58856aa43782d92b18087f2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/openhab/openhab-webui/commit/630e8525835c698cf58856aa43782d92b18087f2
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/openhab/openhab-webui/security/advisories/GHSA-v7gr-mqpj-wwh3
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/openhab/openhab-webui/security/advisories/GHSA-v7gr-mqpj-wwh3
  - score: '10.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42467
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42467
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42467
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42467
weaknesses:
  - CWE-918
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-42467
    reference_type:
    reference_id:
  - url: https://github.com/openhab/openhab-webui
    reference_type:
    reference_id:
  - url: https://github.com/openhab/openhab-webui/blob/1c03c60f84388b9d7da0231df2d4ebb1e17d3fcf/bundles/org.openhab.ui.cometvisu/src/main/java/org/openhab/ui/cometvisu/internal/backend/rest/ProxyResource.java#L83
    reference_type:
    reference_id:
  - url: https://github.com/openhab/openhab-webui/commit/630e8525835c698cf58856aa43782d92b18087f2
    reference_type:
    reference_id:
  - url: https://github.com/openhab/openhab-webui/security/advisories/GHSA-v7gr-mqpj-wwh3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42467
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openhab:openhab_web_interface:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:openhab:openhab_web_interface:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-v7gr-mqpj-wwh3
    reference_type:
    reference_id: GHSA-v7gr-mqpj-wwh3
