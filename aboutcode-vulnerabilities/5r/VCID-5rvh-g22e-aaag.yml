vulnerability_id: VCID-5rvh-g22e-aaag
aliases:
  - GHSA-4v48-4q5m-8vx4
summary: |
  Prometheus vulnerable to basic authentication bypass
  ### Impact

  Prometheus can be secured by a web.yml file that specifies usernames and hashed passwords for basic authentication.

  Passwords are hashed with bcrypt, which means that even if you have access to the hash, it is very hard to find the original password back.

  However, a flaw in the way this mechanism was implemented in the [exporter toolkit](https://github.com/prometheus/exporter-toolkit) makes it possible with people who know the hashed password to authenticate against Prometheus.

  A request can be forged by an attacker to poison the internal cache used to cache the computation of hashes and make subsequent requests successful. This cache is used in both happy and unhappy scenarios in order to limit side channel attacks that could tell an attacker if a user is present in the file or not.

  ### Patches

  Prometheus 2.37.4 ([LTS](https://prometheus.io/docs/introduction/release-cycle/)) and 2.40.4 have been released to address this issue.

  ### Workarounds

  There is no workaround but attacker must have access to the hashed password, stored in disk, to bypass the authentication.
severities:
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/prometheus/prometheus/commit/31a2db3ae9c0f4b486b6895973beabc1d1beac93
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/prometheus/prometheus/commit/31a2db3ae9c0f4b486b6895973beabc1d1beac93
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/prometheus/prometheus/releases/tag/v2.37.4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/prometheus/prometheus/releases/tag/v2.37.4
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/prometheus/prometheus/releases/tag/v2.40.4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/prometheus/prometheus/releases/tag/v2.40.4
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/prometheus/prometheus/security/advisories/GHSA-4v48-4q5m-8vx4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/prometheus/prometheus/security/advisories/GHSA-4v48-4q5m-8vx4
weaknesses:
  - CWE-303
references:
  - url: https://github.com/prometheus/prometheus/commit/31a2db3ae9c0f4b486b6895973beabc1d1beac93
    reference_type:
    reference_id:
  - url: https://github.com/prometheus/prometheus/releases/tag/v2.37.4
    reference_type:
    reference_id:
  - url: https://github.com/prometheus/prometheus/releases/tag/v2.40.4
    reference_type:
    reference_id:
  - url: https://github.com/prometheus/prometheus/security/advisories/GHSA-4v48-4q5m-8vx4
    reference_type:
    reference_id:
