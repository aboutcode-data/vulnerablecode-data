vulnerability_id: VCID-5rcv-uyjb-zfd8
aliases:
  - CVE-2024-47725
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dm-verity: restart or panic on an I/O error

  Maxim Suhanov reported that dm-verity doesn't crash if an I/O error
  happens. In theory, this could be used to subvert security, because an
  attacker can create sectors that return error with the Write Uncorrectable
  command. Some programs may misbehave if they have to deal with EIO.

  This commit fixes dm-verity, so that if "panic_on_corruption" or
  "restart_on_corruption" was specified and an I/O error happens, the
  machine will panic or restart.

  This commit also changes kernel_restart to emergency_restart -
  kernel_restart calls reboot notifiers and these reboot notifiers may wait
  for the bio that failed. emergency_restart doesn't call the notifiers.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47725.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:01:23Z/
    published_at: None
    url: https://git.kernel.org/stable/c/338b32a232bbee39e52dd1486cbc0c9f458d4d69
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:01:23Z/
    published_at: None
    url: https://git.kernel.org/stable/c/b332bcca59143cfdd000957f8b78c28dd2ac1da4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:01:23Z/
    published_at: None
    url: https://git.kernel.org/stable/c/cada2646b7483cce370eb3b046659df31d9d34d1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:01:23Z/
    published_at: None
    url: https://git.kernel.org/stable/c/e6a3531dd542cb127c8de32ab1e54a48ae19962b
weaknesses:
  - CWE-754
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47725.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47725
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47725
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2320198
    reference_type:
    reference_id: 2320198
  - url: https://git.kernel.org/stable/c/338b32a232bbee39e52dd1486cbc0c9f458d4d69
    reference_type:
    reference_id: 338b32a232bbee39e52dd1486cbc0c9f458d4d69
  - url: https://git.kernel.org/stable/c/b332bcca59143cfdd000957f8b78c28dd2ac1da4
    reference_type:
    reference_id: b332bcca59143cfdd000957f8b78c28dd2ac1da4
  - url: https://git.kernel.org/stable/c/cada2646b7483cce370eb3b046659df31d9d34d1
    reference_type:
    reference_id: cada2646b7483cce370eb3b046659df31d9d34d1
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47725
    reference_type:
    reference_id: CVE-2024-47725
  - url: https://git.kernel.org/stable/c/e6a3531dd542cb127c8de32ab1e54a48ae19962b
    reference_type:
    reference_id: e6a3531dd542cb127c8de32ab1e54a48ae19962b
