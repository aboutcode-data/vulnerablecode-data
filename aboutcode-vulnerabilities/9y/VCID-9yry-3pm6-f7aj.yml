vulnerability_id: VCID-9yry-3pm6-f7aj
aliases:
  - CVE-2025-22092
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  PCI: Fix NULL dereference in SR-IOV VF creation error path

  Clean up when virtfn setup fails to prevent NULL pointer dereference
  during device removal. The kernel oops below occurred due to incorrect
  error handling flow when pci_setup_device() fails.

  Add pci_iov_scan_device(), which handles virtfn allocation and setup and
  cleans up if pci_setup_device() fails, so pci_iov_add_virtfn() doesn't need
  to call pci_stop_and_remove_bus_device().  This prevents accessing
  partially initialized virtfn devices during removal.

    BUG: kernel NULL pointer dereference, address: 00000000000000d0
    RIP: 0010:device_del+0x3d/0x3d0
    Call Trace:
     pci_remove_bus_device+0x7c/0x100
     pci_iov_add_virtfn+0xfa/0x200
     sriov_enable+0x208/0x420
     mlx5_core_sriov_configure+0x6a/0x160 [mlx5_core]
     sriov_numvfs_store+0xae/0x1a0

  [bhelgaas: commit log, return ERR_PTR(-ENOMEM) directly]
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22092.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02531'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02537'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.0253'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02545'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04294'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04283'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04247'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04275'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04273'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04281'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04282'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22092.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-22092
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/04d50d953ab46d96b0b32d5ad955fceaa28622db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c67a233834b778b8c78f8b62c072ccf87a9eb6d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ef421b4d206f0d3681804b8f94f06a8458a53aaf
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2360206
    reference_type:
    reference_id: 2360206
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22092
    reference_type:
    reference_id: CVE-2025-22092
