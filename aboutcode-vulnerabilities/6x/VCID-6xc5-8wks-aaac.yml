vulnerability_id: VCID-6xc5-8wks-aaac
aliases:
  - CVE-2021-21310
  - GHSA-pg53-56cg-4m8q
summary: |
  Authentication Bypass by Spoofing
  In next-auth there is a token verification vulnerability. Implementations using the Prisma database adapter in conjunction with the Email provider are impacted. Implementations using the Email provider with the default database adapter are not impacted. Implementations using the Prisma database adapter but not using the Email provider are not impacted. The Prisma database adapter was checking the verification token, but was not verifying the email address associated with that token. This made it possible to use a valid token to sign in as another user when using the Prima adapter in conjunction with the Email provider.
severities:
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68902'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.69039'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.69008'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68988'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68920'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68914'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68792'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68835'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68850'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68899'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00276'
    scoring_system: epss
    scoring_elements: '0.68896'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52645'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52625'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52682'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.5271'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52716'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52634'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52648'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52656'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52664'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.5267'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52693'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.5268'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52668'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50279'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50264'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50371'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50377'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50399'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50415'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50384'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50362'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50406'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50427'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50439'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50432'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50411'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.50392'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.003'
    scoring_system: epss
    scoring_elements: '0.52581'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00509'
    scoring_system: epss
    scoring_elements: '0.76379'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00509'
    scoring_system: epss
    scoring_elements: '0.76561'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00509'
    scoring_system: epss
    scoring_elements: '0.76415'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00509'
    scoring_system: epss
    scoring_elements: '0.76398'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: '0.00582'
    scoring_system: epss
    scoring_elements: '0.52286'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-pg53-56cg-4m8q
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/releases/tag/v3.3.0
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-pg53-56cg-4m8q
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21310
  - score: '5.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21310
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21310
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.npmjs.com/package/next-auth
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-290
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-21310
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/releases/tag/v3.3.0
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-pg53-56cg-4m8q
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/next-auth
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21310
    reference_type:
    reference_id: CVE-2021-21310
  - url: https://github.com/advisories/GHSA-pg53-56cg-4m8q
    reference_type:
    reference_id: GHSA-pg53-56cg-4m8q
