vulnerability_id: VCID-vx3k-33qa-ubh3
aliases:
  - CVE-2025-53539
  - GHSA-j47q-rc62-w448
summary: |
  fastapi-guard is vulnerable to ReDoS through inefficient regex
  ### Summary

  fastapi-guard detects penetration attempts by using regex patterns to scan incoming requests. However, some of the regex patterns used in detection are extremely inefficient and can cause polynomial complexity backtracks when handling specially crafted inputs.

  It is not as severe as _exponential_ complexity ReDoS, but still downgrades performance and allows DoS exploits. An attacker can trigger high cpu usage and make a service unresponsive for hours by sending a single request in size of KBs.

  ### PoC

  e.g. https://github.com/rennf93/fastapi-guard/blob/1e6c2873bfc7866adcbe5fc4da72f2d79ea552e7/guard/handlers/suspatterns_handler.py#L31C79-L32C7

  ```python
  payload = lambda n: '<'*n+ ' '*n+ 'style=' + '"'*n + ' '*n+ 'url('*n # complexity: O(n^5)

  print(requests.post("http://172.24.1.3:8000/", data=payload(50)).elapsed) # 0:00:03.771120
  print(requests.post("http://172.24.1.3:8000/", data=payload(100)).elapsed) # 0:01:17.952637
  print(requests.post("http://172.24.1.3:8000/", data=payload(200)).elapsed) # timeout (>15min)
  ```

  Single-threaded uvicorn workers can not handle any other concurrent requests during the elapsed time.

  ### Impact

  Penetration detection is enabled by default. Services that use fastapi-guard middleware without explicitly setting `enable_penetration_detection=False` are vulnerable to DoS.
severities:
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12228'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.1222'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12257'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.17371'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.17374'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.17325'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.17383'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.17368'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.17385'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18953'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18916'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19101'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19054'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19052'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.1896'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18972'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.1893'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18967'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18974'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.199'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19926'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19886'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.1984'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19918'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19919'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19871'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19833'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19787'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19868'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19848'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19854'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19831'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19839'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19838'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19879'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19824'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19973'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19943'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20019'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20051'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20081'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.19978'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20053'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20045'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20084'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20003'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20073'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20029'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.20047'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00091'
    scoring_system: epss
    scoring_elements: '0.26233'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: '0.00091'
    scoring_system: epss
    scoring_elements: '0.26168'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-j47q-rc62-w448
  - score: '0.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://github.com/rennf93/fastapi-guard
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rennf93/fastapi-guard
  - score: '0.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://github.com/rennf93/fastapi-guard/commit/d9d50e8130b7b434cdc1b001b8cfd03a06729f7f
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/rennf93/fastapi-guard/commit/d9d50e8130b7b434cdc1b001b8cfd03a06729f7f
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rennf93/fastapi-guard/commit/d9d50e8130b7b434cdc1b001b8cfd03a06729f7f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-07-07T20:51:32Z/
    published_at: None
    url: https://github.com/rennf93/fastapi-guard/commit/d9d50e8130b7b434cdc1b001b8cfd03a06729f7f
  - score: '0.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://github.com/rennf93/fastapi-guard/security/advisories/GHSA-j47q-rc62-w448
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/rennf93/fastapi-guard/security/advisories/GHSA-j47q-rc62-w448
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/rennf93/fastapi-guard/security/advisories/GHSA-j47q-rc62-w448
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rennf93/fastapi-guard/security/advisories/GHSA-j47q-rc62-w448
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-07-07T20:51:32Z/
    published_at: None
    url: https://github.com/rennf93/fastapi-guard/security/advisories/GHSA-j47q-rc62-w448
  - score: '0.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-53539
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-53539
weaknesses:
  - CWE-1333
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-53539
    reference_type:
    reference_id:
  - url: https://github.com/rennf93/fastapi-guard
    reference_type:
    reference_id:
  - url: https://github.com/rennf93/fastapi-guard/commit/d9d50e8130b7b434cdc1b001b8cfd03a06729f7f
    reference_type:
    reference_id:
  - url: https://github.com/rennf93/fastapi-guard/security/advisories/GHSA-j47q-rc62-w448
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-53539
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-j47q-rc62-w448
    reference_type:
    reference_id: GHSA-j47q-rc62-w448
