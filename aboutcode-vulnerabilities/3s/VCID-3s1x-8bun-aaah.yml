vulnerability_id: VCID-3s1x-8bun-aaah
aliases:
  - CVE-2021-47393
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  hwmon: (mlxreg-fan) Return non-zero value when fan current state is enforced from sysfs

  Fan speed minimum can be enforced from sysfs. For example, setting
  current fan speed to 20 is used to enforce fan speed to be at 100%
  speed, 19 - to be not below 90% speed, etcetera. This feature provides
  ability to limit fan speed according to some system wise
  considerations, like absence of some replaceable units or high system
  ambient temperature.

  Request for changing fan minimum speed is configuration request and can
  be set only through 'sysfs' write procedure. In this situation value of
  argument 'state' is above nominal fan speed maximum.

  Return non-zero code in this case to avoid
  thermal_cooling_device_stats_update() call, because in this case
  statistics update violates thermal statistics table range.
  The issues is observed in case kernel is configured with option
  CONFIG_THERMAL_STATISTICS.

  Here is the trace from KASAN:
  [  159.506659] BUG: KASAN: slab-out-of-bounds in thermal_cooling_device_stats_update+0x7d/0xb0
  [  159.516016] Read of size 4 at addr ffff888116163840 by task hw-management.s/7444
  [  159.545625] Call Trace:
  [  159.548366]  dump_stack+0x92/0xc1
  [  159.552084]  ? thermal_cooling_device_stats_update+0x7d/0xb0
  [  159.635869]  thermal_zone_device_update+0x345/0x780
  [  159.688711]  thermal_zone_device_set_mode+0x7d/0xc0
  [  159.694174]  mlxsw_thermal_modules_init+0x48f/0x590 [mlxsw_core]
  [  159.700972]  ? mlxsw_thermal_set_cur_state+0x5a0/0x5a0 [mlxsw_core]
  [  159.731827]  mlxsw_thermal_init+0x763/0x880 [mlxsw_core]
  [  160.070233] RIP: 0033:0x7fd995909970
  [  160.074239] Code: 73 01 c3 48 8b 0d 28 d5 2b 00 f7 d8 64 89 01 48 83 c8 ff c3 66 0f 1f 44 00 00 83 3d 99 2d 2c 00 00 75 10 b8 01 00 00 00 0f 05 <48> 3d 01 f0 ff ..
  [  160.095242] RSP: 002b:00007fff54f5d938 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
  [  160.103722] RAX: ffffffffffffffda RBX: 0000000000000013 RCX: 00007fd995909970
  [  160.111710] RDX: 0000000000000013 RSI: 0000000001906008 RDI: 0000000000000001
  [  160.119699] RBP: 0000000001906008 R08: 00007fd995bc9760 R09: 00007fd996210700
  [  160.127687] R10: 0000000000000073 R11: 0000000000000246 R12: 0000000000000013
  [  160.135673] R13: 0000000000000001 R14: 00007fd995bc8600 R15: 0000000000000013
  [  160.143671]
  [  160.145338] Allocated by task 2924:
  [  160.149242]  kasan_save_stack+0x19/0x40
  [  160.153541]  __kasan_kmalloc+0x7f/0xa0
  [  160.157743]  __kmalloc+0x1a2/0x2b0
  [  160.161552]  thermal_cooling_device_setup_sysfs+0xf9/0x1a0
  [  160.167687]  __thermal_cooling_device_register+0x1b5/0x500
  [  160.173833]  devm_thermal_of_cooling_device_register+0x60/0xa0
  [  160.180356]  mlxreg_fan_probe+0x474/0x5e0 [mlxreg_fan]
  [  160.248140]
  [  160.249807] The buggy address belongs to the object at ffff888116163400
  [  160.249807]  which belongs to the cache kmalloc-1k of size 1024
  [  160.263814] The buggy address is located 64 bytes to the right of
  [  160.263814]  1024-byte region [ffff888116163400, ffff888116163800)
  [  160.277536] The buggy address belongs to the page:
  [  160.282898] page:0000000012275840 refcount:1 mapcount:0 mapping:0000000000000000 index:0xffff888116167000 pfn:0x116160
  [  160.294872] head:0000000012275840 order:3 compound_mapcount:0 compound_pincount:0
  [  160.303251] flags: 0x200000000010200(slab|head|node=0|zone=2)
  [  160.309694] raw: 0200000000010200 ffffea00046f7208 ffffea0004928208 ffff88810004dbc0
  [  160.318367] raw: ffff888116167000 00000000000a0006 00000001ffffffff 0000000000000000
  [  160.327033] page dumped because: kasan: bad access detected
  [  160.333270]
  [  160.334937] Memory state around the buggy address:
  [  160.356469] >ffff888116163800: fc ..
severities:
  - score: '4.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47393.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.2944'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25298'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29471'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29489'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25252'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25399'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25421'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.2543'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.2544'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25394'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25368'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25379'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25409'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25441'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25428'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25384'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25361'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29407'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.2947'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29537'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29584'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29521'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29501'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29465'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29464'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '0.00434'
    scoring_system: epss
    scoring_elements: '0.45699'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-754
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47393.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47393
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47393
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5c6e0bce647d9cb32a17d58ffa669b3421fcc6ca
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/76bbb482d33bfcd7e9070ecf594c9ec73e01c930
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a6c42ae1530f94724d3c42cf91fe3d3c5e394f8a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa85fb7bde558bb2e364e85976b14b259c8b6fe8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e6fab7af6ba1bc77c78713a83876f60ca7a4a064
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2282345
    reference_type:
    reference_id: 2282345
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47393
    reference_type:
    reference_id: CVE-2021-47393
  - url: https://access.redhat.com/errata/RHSA-2023:2458
    reference_type:
    reference_id: RHSA-2023:2458
  - url: https://access.redhat.com/errata/RHSA-2024:10262
    reference_type:
    reference_id: RHSA-2024:10262
  - url: https://access.redhat.com/errata/RHSA-2024:5065
    reference_type:
    reference_id: RHSA-2024:5065
  - url: https://access.redhat.com/errata/RHSA-2024:6990
    reference_type:
    reference_id: RHSA-2024:6990
  - url: https://access.redhat.com/errata/RHSA-2024:6991
    reference_type:
    reference_id: RHSA-2024:6991
  - url: https://access.redhat.com/errata/RHSA-2024:7000
    reference_type:
    reference_id: RHSA-2024:7000
  - url: https://access.redhat.com/errata/RHSA-2024:7001
    reference_type:
    reference_id: RHSA-2024:7001
