vulnerability_id: VCID-jma9-uewy-afdn
aliases:
  - CVE-2025-22013
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  KVM: arm64: Unconditionally save+flush host FPSIMD/SVE/SME state

  There are several problems with the way hyp code lazily saves the host's
  FPSIMD/SVE state, including:

  * Host SVE being discarded unexpectedly due to inconsistent
    configuration of TIF_SVE and CPACR_ELx.ZEN. This has been seen to
    result in QEMU crashes where SVE is used by memmove(), as reported by
    Eric Auger:

    https://issues.redhat.com/browse/RHEL-68997

  * Host SVE state is discarded *after* modification by ptrace, which was an
    unintentional ptrace ABI change introduced with lazy discarding of SVE state.

  * The host FPMR value can be discarded when running a non-protected VM,
    where FPMR support is not exposed to a VM, and that VM uses
    FPSIMD/SVE. In these cases the hyp code does not save the host's FPMR
    before unbinding the host's FPSIMD/SVE/SME state, leaving a stale
    value in memory.

  Avoid these by eagerly saving and "flushing" the host's FPSIMD/SVE/SME
  state when loading a vCPU such that KVM does not need to save any of the
  host's FPSIMD/SVE/SME state. For clarity, fpsimd_kvm_prepare() is
  removed and the necessary call to fpsimd_save_and_flush_cpu_state() is
  placed in kvm_arch_vcpu_load_fp(). As 'fpsimd_state' and 'fpmr_ptr'
  should not be used, they are set to NULL; all uses of these will be
  removed in subsequent patches.

  Historical problems go back at least as far as v5.17, e.g. erroneous
  assumptions about TIF_SVE being clear in commit:

    8383741ab2e773a9 ("KVM: arm64: Get rid of host SVE tracking/saving")

  ... and so this eager save+flush probably needs to be backported to ALL
  stable trees.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22013.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0241'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02407'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02391'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02348'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0235'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02394'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04679'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04671'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04634'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04636'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04629'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03685'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04658'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04685'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04717'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04699'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04698'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04716'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04751'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04764'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04755'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22013.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-22013
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/04c50cc23a492c4d43fdaefc7c1ecc0ff6f7b82e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/79e140bba70bcacc5fe15bf8c0b958793fd7d56f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/806d5c1e1d2e5502175a24bf70f251648d99c36a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/900b444be493b7f404898c785d6605b177a093d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fbc7e61195e23f744814e78524b73b59faa54ab4
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2358222
    reference_type:
    reference_id: 2358222
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22013
    reference_type:
    reference_id: CVE-2025-22013
