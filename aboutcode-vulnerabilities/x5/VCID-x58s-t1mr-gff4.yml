vulnerability_id: VCID-x58s-t1mr-gff4
aliases:
  - CVE-2022-50332
summary: 'In the Linux kernel, the following vulnerability has been resolved:  video/aperture:
  Call sysfb_disable() before removing PCI devices  Call sysfb_disable() from aperture_remove_conflicting_pci_devices()
  before removing PCI devices. Without, simpledrm can still bind to simple-framebuffer devices
  after the hardware driver has taken over the hardware. Both drivers interfere with each other
  and results are undefined.  Reported modesetting errors [1] are shown below.  ---- snap ----
  rcu: INFO: rcu_sched detected expedited stalls on CPUs/tasks: { 13-.... } 7 jiffies s: 165
  root: 0x2000/. rcu: blocking rcu_node structures (internal RCU debug): Task dump for CPU 13:
  task:X               state:R  running task     stack:    0 pid: 4242 ppid:  4228 flags:0x00000008
  Call Trace:  <TASK>  ? commit_tail+0xd7/0x130  ? drm_atomic_helper_commit+0x126/0x150  ? drm_atomic_commit+0xa4/0xe0  ?
  drm_plane_get_damage_clips.cold+0x1c/0x1c  ? drm_atomic_helper_dirtyfb+0x19e/0x280  ? drm_mode_dirtyfb_ioctl+0x10f/0x1e0  ?
  drm_mode_getfb2_ioctl+0x2d0/0x2d0  ? drm_ioctl_kernel+0xc4/0x150  ? drm_ioctl+0x246/0x3f0  ?
  drm_mode_getfb2_ioctl+0x2d0/0x2d0  ? __x64_sys_ioctl+0x91/0xd0  ? do_syscall_64+0x60/0xd0  ?
  entry_SYSCALL_64_after_hwframe+0x4b/0xb5  </TASK> ... rcu: INFO: rcu_sched detected expedited
  stalls on CPUs/tasks: { 13-.... } 30 jiffies s: 169 root: 0x2000/. rcu: blocking rcu_node
  structures (internal RCU debug): Task dump for CPU 13: task:X               state:R  running
  task     stack:    0 pid: 4242 ppid:  4228 flags:0x0000400e Call Trace:  <TASK>  ? memcpy_toio+0x76/0xc0  ?
  memcpy_toio+0x1b/0xc0  ? drm_fb_memcpy_toio+0x76/0xb0  ? drm_fb_blit_toio+0x75/0x2b0  ? simpledrm_simple_display_pipe_update+0x132/0x150  ?
  drm_atomic_helper_commit_planes+0xb6/0x230  ? drm_atomic_helper_commit_tail+0x44/0x80  ? commit_tail+0xd7/0x130  ?
  drm_atomic_helper_commit+0x126/0x150  ? drm_atomic_commit+0xa4/0xe0  ? drm_plane_get_damage_clips.cold+0x1c/0x1c  ?
  drm_atomic_helper_dirtyfb+0x19e/0x280  ? drm_mode_dirtyfb_ioctl+0x10f/0x1e0  ? drm_mode_getfb2_ioctl+0x2d0/0x2d0  ?
  drm_ioctl_kernel+0xc4/0x150  ? drm_ioctl+0x246/0x3f0  ? drm_mode_getfb2_ioctl+0x2d0/0x2d0  ?
  __x64_sys_ioctl+0x91/0xd0  ? do_syscall_64+0x60/0xd0  ? entry_SYSCALL_64_after_hwframe+0x4b/0xb5  </TASK>  The
  problem was added by commit 5e0137612430 ("video/aperture: Disable and unregister sysfb devices
  via aperture helpers") to v6.0.3 and does not exist in the mainline branch.  The mainline
  commit 5e0137612430 ("video/aperture: Disable and unregister sysfb devices via aperture helpers")
  has been backported from v6.0-rc1 to stable v6.0.3 from a larger patch series [2] that reworks
  fbdev framebuffer ownership. The backport misses a change to aperture_remove_conflicting_pci_devices().
  Mainline itself is fine, because the function does not exist there as a result of the patch
  series.  Instead of backporting the whole series, fix the additional function.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50332.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03261'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03304'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03233'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04309'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04319'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05107'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05268'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05271'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05307'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05221'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05206'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05277'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05283'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05297'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05228'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04968'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04977'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04965'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05098'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05978'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05958'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05946'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05952'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05934'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0593'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05912'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0604'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06016'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05996'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50332.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50332
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2395324
    reference_type:
    reference_id: 2395324
