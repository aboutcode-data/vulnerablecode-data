vulnerability_id: VCID-gkwr-sqh9-mbcy
aliases:
  - CVE-2025-38464
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  tipc: Fix use-after-free in tipc_conn_close().

  syzbot reported a null-ptr-deref in tipc_conn_close() during netns
  dismantle. [0]

  tipc_topsrv_stop() iterates tipc_net(net)->topsrv->conn_idr and calls
  tipc_conn_close() for each tipc_conn.

  The problem is that tipc_conn_close() is called after releasing the
  IDR lock.

  At the same time, there might be tipc_conn_recv_work() running and it
  could call tipc_conn_close() for the same tipc_conn and release its
  last ->kref.

  Once we release the IDR lock in tipc_topsrv_stop(), there is no
  guarantee that the tipc_conn is alive.

  Let's hold the ref before releasing the lock and put the ref after
  tipc_conn_close() in tipc_topsrv_stop().

  [0]:
  BUG: KASAN: use-after-free in tipc_conn_close+0x122/0x140 net/tipc/topsrv.c:165
  Read of size 8 at addr ffff888099305a08 by task kworker/u4:3/435

  CPU: 0 PID: 435 Comm: kworker/u4:3 Not tainted 4.19.204-syzkaller #0
  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
  Workqueue: netns cleanup_net
  Call Trace:
   __dump_stack lib/dump_stack.c:77 [inline]
   dump_stack+0x1fc/0x2ef lib/dump_stack.c:118
   print_address_description.cold+0x54/0x219 mm/kasan/report.c:256
   kasan_report_error.cold+0x8a/0x1b9 mm/kasan/report.c:354
   kasan_report mm/kasan/report.c:412 [inline]
   __asan_report_load8_noabort+0x88/0x90 mm/kasan/report.c:433
   tipc_conn_close+0x122/0x140 net/tipc/topsrv.c:165
   tipc_topsrv_stop net/tipc/topsrv.c:701 [inline]
   tipc_topsrv_exit_net+0x27b/0x5c0 net/tipc/topsrv.c:722
   ops_exit_list+0xa5/0x150 net/core/net_namespace.c:153
   cleanup_net+0x3b4/0x8b0 net/core/net_namespace.c:553
   process_one_work+0x864/0x1570 kernel/workqueue.c:2153
   worker_thread+0x64c/0x1130 kernel/workqueue.c:2296
   kthread+0x33f/0x460 kernel/kthread.c:259
   ret_from_fork+0x24/0x30 arch/x86/entry/entry_64.S:415

  Allocated by task 23:
   kmem_cache_alloc_trace+0x12f/0x380 mm/slab.c:3625
   kmalloc include/linux/slab.h:515 [inline]
   kzalloc include/linux/slab.h:709 [inline]
   tipc_conn_alloc+0x43/0x4f0 net/tipc/topsrv.c:192
   tipc_topsrv_accept+0x1b5/0x280 net/tipc/topsrv.c:470
   process_one_work+0x864/0x1570 kernel/workqueue.c:2153
   worker_thread+0x64c/0x1130 kernel/workqueue.c:2296
   kthread+0x33f/0x460 kernel/kthread.c:259
   ret_from_fork+0x24/0x30 arch/x86/entry/entry_64.S:415

  Freed by task 23:
   __cache_free mm/slab.c:3503 [inline]
   kfree+0xcc/0x210 mm/slab.c:3822
   tipc_conn_kref_release net/tipc/topsrv.c:150 [inline]
   kref_put include/linux/kref.h:70 [inline]
   conn_put+0x2cd/0x3a0 net/tipc/topsrv.c:155
   process_one_work+0x864/0x1570 kernel/workqueue.c:2153
   worker_thread+0x64c/0x1130 kernel/workqueue.c:2296
   kthread+0x33f/0x460 kernel/kthread.c:259
   ret_from_fork+0x24/0x30 arch/x86/entry/entry_64.S:415

  The buggy address belongs to the object at ffff888099305a00
   which belongs to the cache kmalloc-512 of size 512
  The buggy address is located 8 bytes inside of
   512-byte region [ffff888099305a00, ffff888099305c00)
  The buggy address belongs to the page:
  page:ffffea000264c140 count:1 mapcount:0 mapping:ffff88813bff0940 index:0x0
  flags: 0xfff00000000100(slab)
  raw: 00fff00000000100 ffffea00028b6b88 ffffea0002cd2b08 ffff88813bff0940
  raw: 0000000000000000 ffff888099305000 0000000100000006 0000000000000000
  page dumped because: kasan: bad access detected

  Memory state around the buggy address:
   ffff888099305900: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
   ffff888099305980: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
  >ffff888099305a00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                        ^
   ffff888099305a80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
   ffff888099305b00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
severities:
  - score: '7.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38464.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03352'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.0335'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07277'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07331'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07239'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07204'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07359'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07276'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0726'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08906'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09076'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09057'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0906'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08595'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08575'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08587'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08678'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08661'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08751'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08812'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08865'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08816'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08928'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10279'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10267'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10299'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10271'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10242'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10287'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10284'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1032'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10333'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1031'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10276'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10233'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10204'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10282'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10231'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10228'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10222'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10211'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10281'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38464.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38464
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38464
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/03dcdd2558e1e55bf843822fe4363dcb48743f2b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/15a6f4971e2f157d57e09ea748d1fbc714277aa4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1dbf7cd2454a28b1da700085b99346b5445aeabb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3b89e17b2fd64012682bed158d9eb3d2e96dec42
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/50aa2d121bc2cfe2d825f8a331ea75dfaaab6a50
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/667eeab4999e981c96b447a4df5f20bdf5c26f13
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/be4b8392da7978294f2f368799d29dd509fb6c4d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dab8ded2e5ff41012a6ff400b44dbe76ccf3592a
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2383509
    reference_type:
    reference_id: 2383509
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38464
    reference_type:
    reference_id: CVE-2025-38464
  - url: https://access.redhat.com/errata/RHSA-2025:14985
    reference_type:
    reference_id: RHSA-2025:14985
  - url: https://access.redhat.com/errata/RHSA-2025:15005
    reference_type:
    reference_id: RHSA-2025:15005
  - url: https://access.redhat.com/errata/RHSA-2025:15008
    reference_type:
    reference_id: RHSA-2025:15008
  - url: https://access.redhat.com/errata/RHSA-2025:15009
    reference_type:
    reference_id: RHSA-2025:15009
  - url: https://access.redhat.com/errata/RHSA-2025:15011
    reference_type:
    reference_id: RHSA-2025:15011
  - url: https://access.redhat.com/errata/RHSA-2025:15224
    reference_type:
    reference_id: RHSA-2025:15224
  - url: https://access.redhat.com/errata/RHSA-2025:15227
    reference_type:
    reference_id: RHSA-2025:15227
  - url: https://access.redhat.com/errata/RHSA-2025:15647
    reference_type:
    reference_id: RHSA-2025:15647
  - url: https://access.redhat.com/errata/RHSA-2025:15656
    reference_type:
    reference_id: RHSA-2025:15656
  - url: https://access.redhat.com/errata/RHSA-2025:15658
    reference_type:
    reference_id: RHSA-2025:15658
  - url: https://access.redhat.com/errata/RHSA-2025:15660
    reference_type:
    reference_id: RHSA-2025:15660
  - url: https://access.redhat.com/errata/RHSA-2025:15668
    reference_type:
    reference_id: RHSA-2025:15668
  - url: https://access.redhat.com/errata/RHSA-2025:15670
    reference_type:
    reference_id: RHSA-2025:15670
  - url: https://usn.ubuntu.com/7774-1/
    reference_type:
    reference_id: USN-7774-1
  - url: https://usn.ubuntu.com/7774-2/
    reference_type:
    reference_id: USN-7774-2
  - url: https://usn.ubuntu.com/7774-3/
    reference_type:
    reference_id: USN-7774-3
  - url: https://usn.ubuntu.com/7774-4/
    reference_type:
    reference_id: USN-7774-4
  - url: https://usn.ubuntu.com/7774-5/
    reference_type:
    reference_id: USN-7774-5
  - url: https://usn.ubuntu.com/7775-1/
    reference_type:
    reference_id: USN-7775-1
  - url: https://usn.ubuntu.com/7775-2/
    reference_type:
    reference_id: USN-7775-2
  - url: https://usn.ubuntu.com/7775-3/
    reference_type:
    reference_id: USN-7775-3
  - url: https://usn.ubuntu.com/7776-1/
    reference_type:
    reference_id: USN-7776-1
  - url: https://usn.ubuntu.com/7879-1/
    reference_type:
    reference_id: USN-7879-1
  - url: https://usn.ubuntu.com/7879-2/
    reference_type:
    reference_id: USN-7879-2
  - url: https://usn.ubuntu.com/7879-3/
    reference_type:
    reference_id: USN-7879-3
  - url: https://usn.ubuntu.com/7879-4/
    reference_type:
    reference_id: USN-7879-4
  - url: https://usn.ubuntu.com/7880-1/
    reference_type:
    reference_id: USN-7880-1
  - url: https://usn.ubuntu.com/7934-1/
    reference_type:
    reference_id: USN-7934-1
