vulnerability_id: VCID-am9p-3a87-7fgw
aliases:
  - CVE-2025-49128
  - GHSA-wf8f-6423-gfxg
summary: |
  Jackson-core Vulnerable to Memory Disclosure via Source Snippet in JsonLocation
  ### Overview

  A flaw in Jackson-core's `JsonLocation._appendSourceDesc` method allows up to 500 bytes of unintended memory content to be included in exception messages. When parsing JSON from a byte array with an offset and length, the exception message incorrectly reads from the beginning of the array instead of the logical payload start. This results in possible **information disclosure** in systems using **pooled or reused buffers**, like Netty or Vert.x.

  ### Details

  The vulnerability affects the creation of exception messages like:

  ```
  JsonParseException: Unexpected character ... at [Source: (byte[])...]
  ```

  When `JsonFactory.createParser(byte[] data, int offset, int len)` is used, and an error occurs while parsing, the exception message should include a snippet from the specified logical payload. However, the method `_appendSourceDesc` ignores the `offset`, and always starts reading from index `0`.

  If the buffer contains residual sensitive data from a previous request, such as credentials or document contents, that data may be exposed if the exception is propagated to the client.

  The issue particularly impacts server applications using:

  * Pooled byte buffers (e.g., Netty)
  * Frameworks that surface parse errors in HTTP responses
  * Default Jackson settings (i.e., `INCLUDE_SOURCE_IN_LOCATION` is enabled)

  A documented real-world example is [CVE-2021-22145](https://nvd.nist.gov/vuln/detail/CVE-2021-22145) in Elasticsearch, which stemmed from the same root cause.

  ### Attack Scenario

  An attacker sends malformed JSON to a service using Jackson and pooled byte buffers (e.g., Netty-based HTTP servers). If the server reuses a buffer and includes the parser’s exception in its HTTP 400 response, the attacker may receive residual data from previous requests.

  ### Proof of Concept

  ```java
  byte[] buffer = new byte[1000];
  System.arraycopy("SECRET".getBytes(), 0, buffer, 0, 6);
  System.arraycopy("{ \"bad\": }".getBytes(), 0, buffer, 700, 10);

  JsonFactory factory = new JsonFactory();
  JsonParser parser = factory.createParser(buffer, 700, 20);
  parser.nextToken(); // throws exception

  // Exception message will include "SECRET"
  ```

  ### Patches
  This issue was silently fixed in jackson-core version 2.13.0, released on September 30, 2021, via [PR #652](https://github.com/FasterXML/jackson-core/pull/652).

  All users should upgrade to version 2.13.0 or later.

  ### Workarounds
  If upgrading is not immediately possible, applications can mitigate the issue by:

  1. **Disabling exception message exposure to clients** — avoid returning parsing exception messages in HTTP responses.
  2. **Disabling source inclusion in exceptions** by setting:

     ```java
     jsonFactory.disable(JsonFactory.Feature.INCLUDE_SOURCE_IN_LOCATION);
     ```

      This prevents Jackson from embedding any source content in exception messages, avoiding leakage.


  ### References
  * [Pull Request #652 (Fix implementation)](https://github.com/FasterXML/jackson-core/pull/652)
  * [CVE-2021-22145 (Elasticsearch exposure of this flaw)](https://nvd.nist.gov/vuln/detail/CVE-2021-22145)
severities:
  - score: '4.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-49128.json
  - score: 4e-05
    scoring_system: epss
    scoring_elements: '0.0014'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 4e-05
    scoring_system: epss
    scoring_elements: '0.00139'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 4e-05
    scoring_system: epss
    scoring_elements: '0.00149'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 4e-05
    scoring_system: epss
    scoring_elements: '0.00156'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00225'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.0021'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00209'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00208'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00207'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00223'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.0029'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00236'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00238'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00272'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00261'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00259'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00258'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00257'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00255'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00256'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.0026'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00287'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00288'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00286'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-wf8f-6423-gfxg
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/FasterXML/jackson-core
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FasterXML/jackson-core
  - score: 4
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/FasterXML/jackson-core/commit/a6c297682737dde13337cb7c3020f299518609a8
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/FasterXML/jackson-core/commit/a6c297682737dde13337cb7c3020f299518609a8
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FasterXML/jackson-core/commit/a6c297682737dde13337cb7c3020f299518609a8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-09T15:13:56Z/
    published_at: None
    url: https://github.com/FasterXML/jackson-core/commit/a6c297682737dde13337cb7c3020f299518609a8
  - score: 4
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/FasterXML/jackson-core/pull/652
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/FasterXML/jackson-core/pull/652
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FasterXML/jackson-core/pull/652
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-09T15:13:56Z/
    published_at: None
    url: https://github.com/FasterXML/jackson-core/pull/652
  - score: 4
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/FasterXML/jackson-core/security/advisories/GHSA-wf8f-6423-gfxg
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/FasterXML/jackson-core/security/advisories/GHSA-wf8f-6423-gfxg
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/FasterXML/jackson-core/security/advisories/GHSA-wf8f-6423-gfxg
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FasterXML/jackson-core/security/advisories/GHSA-wf8f-6423-gfxg
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-09T15:13:56Z/
    published_at: None
    url: https://github.com/FasterXML/jackson-core/security/advisories/GHSA-wf8f-6423-gfxg
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-22145
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-22145
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-49128
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-49128
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-209
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-49128.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-49128
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-49128
    reference_type:
    reference_id:
  - url: https://github.com/FasterXML/jackson-core
    reference_type:
    reference_id:
  - url: https://github.com/FasterXML/jackson-core/commit/a6c297682737dde13337cb7c3020f299518609a8
    reference_type:
    reference_id:
  - url: https://github.com/FasterXML/jackson-core/pull/652
    reference_type:
    reference_id:
  - url: https://github.com/FasterXML/jackson-core/security/advisories/GHSA-wf8f-6423-gfxg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49128
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2370891
    reference_type:
    reference_id: 2370891
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-22145
    reference_type:
    reference_id: CVE-2021-22145
  - url: https://github.com/advisories/GHSA-wf8f-6423-gfxg
    reference_type:
    reference_id: GHSA-wf8f-6423-gfxg
