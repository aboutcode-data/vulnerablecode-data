vulnerability_id: VCID-b71c-g7ce-g7eq
aliases:
  - CVE-2025-4754
  - GHSA-f7gq-h8jv-h3cq
summary: "ash_authentication_phoenix has Insufficient Session Expiration\n### Impact\n\nSession\
  \ tokens remain valid on the server after user logout, creating a security gap where:\n\n\
  - Compromised tokens (via XSS, network interception, or device theft) continue to work even\
  \ after the user logs out\n  - The sessions stored in the database still expire, limiting\
  \ the duration during which this could be exploited\n- Users cannot fully invalidate their\
  \ sessions when logging out from shared or potentially compromised devices \n  - by default,\
  \ changing one's password *does* invalidate all other sessions, so changing your password\
  \ as a security measure would have been effective\n- May cause compliance issues with security\
  \ frameworks requiring complete session \n### Patches\nUpgrade to version 2.10.0. After upgrading,\
  \ users must update their AuthController implementation to use the new `clear_session/2` function\
  \ with their OTP app name. You will be prompted to do so with a compile-time error.\n\nIf\
  \ you do not have the setting `require_token_presence_for_authentication?` set to `true` in\
  \ the `tokens` section, you will see a separate error:\n\n```\n** (Spark.Error.DslError) authentication\
  \ -> session_identifier:\nMust set `authentication.session_identifier` to either `:jti` or\
  \ `:unsafe`.\n\n...\n```\n\nIn order to revoke sessions on log out when not storing tokens\
  \ directly in the session, we must have some unique identifier with which to do so. You should\
  \ prefer to enable `require_token_presence_for_authentication?` if possible, instead of setting\
  \ this to `:jti`. Note that whatever you do here, if you did not previously have `require_token_presence_for_authentication?`\
  \ set to `true`, setting it to `true` *or* setting `authentication.session_identifier` to\
  \ `:jti` will log out all of your currently authenticated users.\n\n### Workarounds\nYou can\
  \ manually revoke tokens in your `logout/2` handler in your auth controller."
severities:
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.25209'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.25147'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28453'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28378'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28392'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.30061'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.30983'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.30934'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.30903'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.30942'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31005'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.30947'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.31446'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32053'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.3201'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32009'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32001'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32038'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32034'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32016'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32077'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32114'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32133'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32132'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32115'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32158'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32141'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32123'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.3222'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32215'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32233'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32079'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32067'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32052'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32118'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32127'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.3522'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35198'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35141'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35034'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35113'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35107'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35083'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35045'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35116'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35123'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.36904'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.3693'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00192'
    scoring_system: epss
    scoring_elements: '0.41483'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00192'
    scoring_system: epss
    scoring_elements: '0.41569'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00192'
    scoring_system: epss
    scoring_elements: '0.41517'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00192'
    scoring_system: epss
    scoring_elements: '0.415'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00192'
    scoring_system: epss
    scoring_elements: '0.41489'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43469'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43491'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix/commit/a3253fb4fc7145aeb403537af1c24d3a8d51ffb1
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix/commit/a3253fb4fc7145aeb403537af1c24d3a8d51ffb1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-17T14:40:37Z/
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix/commit/a3253fb4fc7145aeb403537af1c24d3a8d51ffb1
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix/pull/634
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix/pull/634
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-17T14:40:37Z/
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix/pull/634
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix/security/advisories/GHSA-f7gq-h8jv-h3cq
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix/security/advisories/GHSA-f7gq-h8jv-h3cq
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-17T14:40:37Z/
    published_at: None
    url: https://github.com/team-alembic/ash_authentication_phoenix/security/advisories/GHSA-f7gq-h8jv-h3cq
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-4754
weaknesses:
  - CWE-613
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-4754
    reference_type:
    reference_id:
  - url: https://github.com/team-alembic/ash_authentication_phoenix
    reference_type:
    reference_id:
  - url: https://github.com/team-alembic/ash_authentication_phoenix/commit/a3253fb4fc7145aeb403537af1c24d3a8d51ffb1
    reference_type:
    reference_id:
  - url: https://github.com/team-alembic/ash_authentication_phoenix/pull/634
    reference_type:
    reference_id:
  - url: https://github.com/team-alembic/ash_authentication_phoenix/security/advisories/GHSA-f7gq-h8jv-h3cq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-4754
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:team-alembic:ash_authentication_phoenix:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:team-alembic:ash_authentication_phoenix:*:*:*:*:*:*:*:*
