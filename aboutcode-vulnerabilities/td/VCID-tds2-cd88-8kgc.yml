vulnerability_id: VCID-tds2-cd88-8kgc
aliases:
  - CVE-2025-39936
summary: "In the Linux kernel, the following vulnerability has been resolved:  crypto: ccp -\
  \ Always pass in an error pointer to __sev_platform_shutdown_locked()  When    9770b428b1a2\
  \ (\"crypto: ccp - Move dev_info/err messages for SEV/SNP init and shutdown\")  moved the\
  \ error messages dumping so that they don't need to be issued by the callers, it missed the\
  \ case where __sev_firmware_shutdown() calls __sev_platform_shutdown_locked() with a NULL\
  \ argument which leads to a NULL ptr deref on the shutdown path, during suspend to disk: \
  \   #PF: supervisor read access in kernel mode   #PF: error_code(0x0000) - not-present page\
  \   PGD 0 P4D 0   Oops: Oops: 0000 [#1] SMP NOPTI   CPU: 0 UID: 0 PID: 983 Comm: hib.sh Not\
  \ tainted 6.17.0-rc4+ #1 PREEMPT(voluntary)   Hardware name: Supermicro Super Server/H12SSL-i,\
  \ BIOS 2.5 09/08/2022   RIP: 0010:__sev_platform_shutdown_locked.cold+0x0/0x21 [ccp]  That\
  \ rIP is:    00000000000006fd <__sev_platform_shutdown_locked.cold>:    6fd:   8b 13     \
  \              mov    (%rbx),%edx    6ff:   48 8b 7d 00             mov    0x0(%rbp),%rdi\
  \    703:   89 c1                   mov    %eax,%ecx    Code: 74 05 31 ff 41 89 3f 49 8b 3e\
  \ 89 ea 48 c7 c6 a0 8e 54 a0 41 bf 92 ff ff ff e8 e5 2e 09 e1 c6 05 2a d4 38 00 01 e9 26 af\
  \ ff ff <8b> 13 48 8b 7d 00 89 c1 48 c7 c6 18 90 54 a0 89 44 24 04 e8 c1 2e   RSP: 0018:ffffc90005467d00\
  \ EFLAGS: 00010282   RAX: 00000000ffffff92 RBX: 0000000000000000 RCX: 0000000000000000   \t\
  \t\t     ^^^^^^^^^^^^^^^^ and %rbx is nice and clean.    Call Trace:    <TASK>    __sev_firmware_shutdown.isra.0\
  \    sev_dev_destroy    psp_dev_destroy    sp_destroy    pci_device_shutdown    device_shutdown\
  \    kernel_power_off    hibernate.cold    state_store    kernfs_fop_write_iter    vfs_write\
  \    ksys_write    do_syscall_64    entry_SYSCALL_64_after_hwframe  Pass in a pointer to the\
  \ function-local error var in the caller.  With that addressed, suspending the ccp shows the\
  \ error properly at least:    ccp 0000:47:00.1: sev command 0x2 timed out, disabling PSP \
  \  ccp 0000:47:00.1: SEV: failed to SHUTDOWN error 0x0, rc -110   SEV-SNP: Leaking PFN range\
  \ 0x146800-0x146a00   SEV-SNP: PFN 0x146800 unassigned, dumping non-zero entries in 2M PFN\
  \ region: [0x146800 - 0x146a00]   ...   ccp 0000:47:00.1: SEV-SNP firmware shutdown failed,\
  \ rc -16, error 0x0   ACPI: PM: Preparing to enter system sleep state S5   kvm: exiting hardware\
  \ virtualization   reboot: Power down  Btw, this driver is crying to be cleaned up to pass\
  \ in a proper I/O struct which can be used to store information between the different functions,\
  \ otherwise stuff like that will happen in the future again."
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39936.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03382'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03419'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0342'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05275'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05267'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0525'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05222'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05235'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05214'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05197'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05186'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05196'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05212'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05292'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0531'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05277'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05283'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05297'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.07233'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.07203'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39936.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-39936
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2401426
    reference_type:
    reference_id: 2401426
