vulnerability_id: VCID-5bwh-ayht-aaab
aliases:
  - CVE-2024-26893
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  firmware: arm_scmi: Fix double free in SMC transport cleanup path

  When the generic SCMI code tears down a channel, it calls the chan_free
  callback function, defined by each transport. Since multiple protocols
  might share the same transport_info member, chan_free() might want to
  clean up the same member multiple times within the given SCMI transport
  implementation. In this case, it is SMC transport. This will lead to a NULL
  pointer dereference at the second time:

      | scmi_protocol scmi_dev.1: Enabled polling mode TX channel - prot_id:16
      | arm-scmi firmware:scmi: SCMI Notifications - Core Enabled.
      | arm-scmi firmware:scmi: unable to communicate with SCMI
      | Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000
      | Mem abort info:
      |   ESR = 0x0000000096000004
      |   EC = 0x25: DABT (current EL), IL = 32 bits
      |   SET = 0, FnV = 0
      |   EA = 0, S1PTW = 0
      |   FSC = 0x04: level 0 translation fault
      | Data abort info:
      |   ISV = 0, ISS = 0x00000004, ISS2 = 0x00000000
      |   CM = 0, WnR = 0, TnD = 0, TagAccess = 0
      |   GCS = 0, Overlay = 0, DirtyBit = 0, Xs = 0
      | user pgtable: 4k pages, 48-bit VAs, pgdp=0000000881ef8000
      | [0000000000000000] pgd=0000000000000000, p4d=0000000000000000
      | Internal error: Oops: 0000000096000004 [#1] PREEMPT SMP
      | Modules linked in:
      | CPU: 4 PID: 1 Comm: swapper/0 Not tainted 6.7.0-rc2-00124-g455ef3d016c9-dirty #793
      | Hardware name: FVP Base RevC (DT)
      | pstate: 61400009 (nZCv daif +PAN -UAO -TCO +DIT -SSBS BTYPE=--)
      | pc : smc_chan_free+0x3c/0x6c
      | lr : smc_chan_free+0x3c/0x6c
      | Call trace:
      |  smc_chan_free+0x3c/0x6c
      |  idr_for_each+0x68/0xf8
      |  scmi_cleanup_channels.isra.0+0x2c/0x58
      |  scmi_probe+0x434/0x734
      |  platform_probe+0x68/0xd8
      |  really_probe+0x110/0x27c
      |  __driver_probe_device+0x78/0x12c
      |  driver_probe_device+0x3c/0x118
      |  __driver_attach+0x74/0x128
      |  bus_for_each_dev+0x78/0xe0
      |  driver_attach+0x24/0x30
      |  bus_add_driver+0xe4/0x1e8
      |  driver_register+0x60/0x128
      |  __platform_driver_register+0x28/0x34
      |  scmi_driver_init+0x84/0xc0
      |  do_one_initcall+0x78/0x33c
      |  kernel_init_freeable+0x2b8/0x51c
      |  kernel_init+0x24/0x130
      |  ret_from_fork+0x10/0x20
      | Code: f0004701 910a0021 aa1403e5 97b91c70 (b9400280)
      | ---[ end trace 0000000000000000 ]---

  Simply check for the struct pointer being NULL before trying to access
  its members, to avoid this situation.

  This was found when a transport doesn't really work (for instance no SMC
  service), the probe routines then tries to clean up, and triggers a crash.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26893.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15143'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14968'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15029'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15124'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15199'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15204'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15176'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15149'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15138'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.1514'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15147'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15169'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15171'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.1516'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23582'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23533'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23515'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23491'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23522'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23549'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23573'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23475'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.2341'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23559'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23579'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23584'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23588'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23538'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.23507'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.43039'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26893
weaknesses:
  - CWE-415
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26893.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-26893
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26893
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0d276d9f335f41d6524258d58c0c0241ef9a83a4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/857f56db8c3a71f9871922b6984ff74ad588cb2c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ffaa17ccb1eb1b65cf85db63225a3581c303773
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ead445dd3d681020af333649a27306160eee761d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f1d71576d2c9ec8fdb822173fa7f3de79475e9bd
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2275664
    reference_type:
    reference_id: 2275664
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26893
    reference_type:
    reference_id: CVE-2024-26893
  - url: https://usn.ubuntu.com/6816-1/
    reference_type:
    reference_id: USN-6816-1
  - url: https://usn.ubuntu.com/6817-1/
    reference_type:
    reference_id: USN-6817-1
  - url: https://usn.ubuntu.com/6817-2/
    reference_type:
    reference_id: USN-6817-2
  - url: https://usn.ubuntu.com/6817-3/
    reference_type:
    reference_id: USN-6817-3
  - url: https://usn.ubuntu.com/6878-1/
    reference_type:
    reference_id: USN-6878-1
  - url: https://usn.ubuntu.com/7100-1/
    reference_type:
    reference_id: USN-7100-1
  - url: https://usn.ubuntu.com/7100-2/
    reference_type:
    reference_id: USN-7100-2
  - url: https://usn.ubuntu.com/7123-1/
    reference_type:
    reference_id: USN-7123-1
  - url: https://usn.ubuntu.com/7144-1/
    reference_type:
    reference_id: USN-7144-1
  - url: https://usn.ubuntu.com/7194-1/
    reference_type:
    reference_id: USN-7194-1
