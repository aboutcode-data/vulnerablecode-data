vulnerability_id: VCID-pfqz-3pgs-qkbz
aliases:
  - CVE-2024-53989
  - GHSA-rxv5-gxqc-xx8g
summary: |
  rails-html-sanitizer has XSS vulnerability with certain configurations
  ## Summary

  There is a possible XSS vulnerability with certain configurations of
  Rails::HTML::Sanitizer 1.6.0 when used with Rails >= 7.1.0.

  * Versions affected: 1.6.0
  * Not affected: < 1.6.0
  * Fixed versions: 1.6.1

  ## Impact

  A possible XSS vulnerability with certain configurations of
  Rails::HTML::Sanitizer may allow an attacker to inject content if
  HTML5 sanitization is enabled and the application developer has
  overridden the sanitizer's allowed tags in the following way:

  - the "noscript" element is explicitly allowed

  Code is only impacted if Rails is configured to use HTML5 sanitization,
  please see documentation for [`config.action_view.sanitizer_vendor`](https://guides.rubyonrails.org/configuring.html#config-action-view-sanitizer-vendor)
  and [`config.action_text.sanitizer_vendor`](https://guides.rubyonrails.org/configuring.html#config-action-text-sanitizer-vendor)
  for more information on these configuration options.

  The default configuration is to disallow all of these elements. Code
  is only impacted if allowed tags are being overridden. Applications
  may be doing this in a few different ways:

  1. using application configuration to configure Action View sanitizers'
     allowed tags:

    ```ruby
    # In config/application.rb
    config.action_view.sanitized_allowed_tags = ["noscript"]
    ```

    see https://guides.rubyonrails.org/configuring.html#configuring-action-view

  2. using a `:tags` option to the Action View helper `sanitize`:

    ```
    <= sanitize @comment.body, tags: ["noscript"] >
    ```

    see https://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-sanitize

  3. setting Rails::HTML5::SafeListSanitizer class attribute `allowed_tags`:

    ```ruby
    # class-level option
    Rails::HTML5::SafeListSanitizer.allowed_tags = ["noscript"]
    ```

    (note that this class may also be referenced as
    `Rails::Html::SafeListSanitizer`)

  4. using a `:tags` options to the Rails::HTML5::SafeListSanitizer instance method `sanitize`:

    ```ruby
    # instance-level option
    Rails::HTML5::SafeListSanitizer.new.sanitize(@article.body, tags: ["noscript"])
    ```

    (note that this class may also be referenced as
    `Rails::Html::SafeListSanitizer`)

  5. setting ActionText::ContentHelper module attribute `allowed_tags`:

    ```ruby
    ActionText::ContentHelper.allowed_tags = ["noscript"]
    ```

  All users overriding the allowed tags by any of the above
  mechanisms to include "noscript" should either upgrade or use
  one of the workarounds.

  ## Workarounds

  Any one of the following actions will work around this issue:

  - Remove "noscript" from the overridden allowed tags,
  - Or, downgrade sanitization to HTML4 (see documentation for
    [`config.action_view.sanitizer_vendor`](https://guides.rubyonrails.org/configuring.html#config-action-view-sanitizer-vendor)
    and [`config.action_text.sanitizer_vendor`](https://guides.rubyonrails.org/configuring.html#config-action-text-sanitizer-vendor)
    for more information).

  ## References

  - [CWE - CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') (4.9)](https://cwe.mitre.org/data/definitions/79.html)
  - Original report: https://hackerone.com/reports/2509647

  ## Credit

  This vulnerability was responsibly reported by HackerOne user
  [@taise](https://hackerone.com/taise?type=user).
severities:
  - score: '3.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53989.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.21299'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.2134'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.21192'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.21241'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.21315'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31218'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31221'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31284'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31332'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31339'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.3127'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31252'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31254'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31246'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31251'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31268'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.3126'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31233'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.27019'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.27028'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.27032'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.26992'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.26959'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.26999'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.27036'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.27034'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.27003'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.26985'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.31155'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.22839'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-rxv5-gxqc-xx8g
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rails/rails-html-sanitizer
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/rails/rails-html-sanitizer/commit/16251735e36ebdc302e2f90f2a39cad56879414f
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rails/rails-html-sanitizer/commit/16251735e36ebdc302e2f90f2a39cad56879414f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-03T14:35:22Z/
    published_at: None
    url: https://github.com/rails/rails-html-sanitizer/commit/16251735e36ebdc302e2f90f2a39cad56879414f
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/rails/rails-html-sanitizer/security/advisories/GHSA-rxv5-gxqc-xx8g
  - score: '2.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/rails/rails-html-sanitizer/security/advisories/GHSA-rxv5-gxqc-xx8g
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rails/rails-html-sanitizer/security/advisories/GHSA-rxv5-gxqc-xx8g
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-03T14:35:22Z/
    published_at: None
    url: https://github.com/rails/rails-html-sanitizer/security/advisories/GHSA-rxv5-gxqc-xx8g
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rails-html-sanitizer/CVE-2024-53989.yml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-53989
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53989.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-53989
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails-html-sanitizer
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails-html-sanitizer/security/advisories/GHSA-rxv5-gxqc-xx8g
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails-html-sanitizer/commit/16251735e36ebdc302e2f90f2a39cad56879414f
    reference_type:
    reference_id: 16251735e36ebdc302e2f90f2a39cad56879414f
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2330055
    reference_type:
    reference_id: 2330055
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-53989
    reference_type:
    reference_id: CVE-2024-53989
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rails-html-sanitizer/CVE-2024-53989.yml
    reference_type:
    reference_id: CVE-2024-53989.YML
  - url: https://github.com/advisories/GHSA-rxv5-gxqc-xx8g
    reference_type:
    reference_id: GHSA-rxv5-gxqc-xx8g
