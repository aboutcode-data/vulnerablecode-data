vulnerability_id: VCID-wsnj-4xg3-3bcm
aliases:
  - CVE-2022-50231
summary: 'In the Linux kernel, the following vulnerability has been resolved:  crypto: arm64/poly1305
  - fix a read out-of-bound  A kasan error was reported during fuzzing:  BUG: KASAN: slab-out-of-bounds
  in neon_poly1305_blocks.constprop.0+0x1b4/0x250 [poly1305_neon] Read of size 4 at addr ffff0010e293f010
  by task syz-executor.5/1646715 CPU: 4 PID: 1646715 Comm: syz-executor.5 Kdump: loaded Not
  tainted 5.10.0.aarch64 #1 Hardware name: Huawei TaiShan 2280 /BC11SPCD, BIOS 1.59 01/31/2019
  Call trace:  dump_backtrace+0x0/0x394  show_stack+0x34/0x4c arch/arm64/kernel/stacktrace.c:196  __dump_stack
  lib/dump_stack.c:77 [inline]  dump_stack+0x158/0x1e4 lib/dump_stack.c:118  print_address_description.constprop.0+0x68/0x204
  mm/kasan/report.c:387  __kasan_report+0xe0/0x140 mm/kasan/report.c:547  kasan_report+0x44/0xe0
  mm/kasan/report.c:564  check_memory_region_inline mm/kasan/generic.c:187 [inline]  __asan_load4+0x94/0xd0
  mm/kasan/generic.c:252  neon_poly1305_blocks.constprop.0+0x1b4/0x250 [poly1305_neon]  neon_poly1305_do_update+0x6c/0x15c
  [poly1305_neon]  neon_poly1305_update+0x9c/0x1c4 [poly1305_neon]  crypto_shash_update crypto/shash.c:131
  [inline]  shash_finup_unaligned+0x84/0x15c crypto/shash.c:179  crypto_shash_finup+0x8c/0x140
  crypto/shash.c:193  shash_digest_unaligned+0xb8/0xe4 crypto/shash.c:201  crypto_shash_digest+0xa4/0xfc
  crypto/shash.c:217  crypto_shash_tfm_digest+0xb4/0x150 crypto/shash.c:229  essiv_skcipher_setkey+0x164/0x200
  [essiv]  crypto_skcipher_setkey+0xb0/0x160 crypto/skcipher.c:612  skcipher_setkey+0x3c/0x50
  crypto/algif_skcipher.c:305  alg_setkey+0x114/0x2a0 crypto/af_alg.c:220  alg_setsockopt+0x19c/0x210
  crypto/af_alg.c:253  __sys_setsockopt+0x190/0x2e0 net/socket.c:2123  __do_sys_setsockopt net/socket.c:2134
  [inline]  __se_sys_setsockopt net/socket.c:2131 [inline]  __arm64_sys_setsockopt+0x78/0x94
  net/socket.c:2131  __invoke_syscall arch/arm64/kernel/syscall.c:36 [inline]  invoke_syscall+0x64/0x100
  arch/arm64/kernel/syscall.c:48  el0_svc_common.constprop.0+0x220/0x230 arch/arm64/kernel/syscall.c:155  do_el0_svc+0xb4/0xd4
  arch/arm64/kernel/syscall.c:217  el0_svc+0x24/0x3c arch/arm64/kernel/entry-common.c:353  el0_sync_handler+0x160/0x164
  arch/arm64/kernel/entry-common.c:369  el0_sync+0x160/0x180 arch/arm64/kernel/entry.S:683  This
  error can be reproduced by the following code compiled as ko on a system with kasan enabled:  #include
  <linux/module.h> #include <linux/crypto.h> #include <crypto/hash.h> #include <crypto/poly1305.h>  char
  test_data[] = "\x00\x01\x02\x03\x04\x05\x06\x07"                    "\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f"                    "\x10\x11\x12\x13\x14\x15\x16\x17"                    "\x18\x19\x1a\x1b\x1c\x1d\x1e";  int
  init(void) {         struct crypto_shash *tfm = NULL;         char *data = NULL, *out = NULL;          tfm
  = crypto_alloc_shash("poly1305", 0, 0);         data = kmalloc(POLY1305_KEY_SIZE - 1, GFP_KERNEL);         out
  = kmalloc(POLY1305_DIGEST_SIZE, GFP_KERNEL);         memcpy(data, test_data, POLY1305_KEY_SIZE
  - 1);         crypto_shash_tfm_digest(tfm, data, POLY1305_KEY_SIZE - 1, out);          kfree(data);         kfree(out);         return
  0; }  void deinit(void) { }  module_init(init) module_exit(deinit) MODULE_LICENSE("GPL");  The
  root cause of the bug sits in neon_poly1305_blocks. The logic neon_poly1305_blocks() performed
  is that if it was called with both s[] and r[] uninitialized, it will first try to initialize
  them with the data from the first "block" that it believed to be 32 bytes in length. First
  16 bytes are used as the key and the next 16 bytes for s[]. This would lead to the aforementioned
  read out-of-bound. However, after calling poly1305_init_arch(), only 16 bytes were deducted
  from the input and s[] is initialized yet again with the following 16 bytes. The second initialization
  of s[] is certainly redundent which indicates that the first initialization should be for
  r[] only.  This patch fixes the issue by calling poly1305_init_arm64() instead o ---truncated---'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50231.json
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50231.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02953'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02926'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03729'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03732'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04719'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04688'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04685'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04692'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04713'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04699'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04774'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04698'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04726'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05309'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05279'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05325'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05366'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.053'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05297'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0527'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05307'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05305'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0625'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05897'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05843'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05857'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05885'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05864'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05962'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05983'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0602'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05916'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05919'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05884'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05987'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05986'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05991'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06141'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06126'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06164'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06129'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06111'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06146'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06211'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06245'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06261'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09168'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09283'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09221'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0923'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09234'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0925'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09271'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09385'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09342'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09192'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09245'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-125
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50231.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50231
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-50231
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c77292d52b341831cb09c24ca4112a1e4f9e91f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3d4c28475ee352c440b83484b72b1320ff76364a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7ae19d422c7da84b5f13bc08b98bd737a08d3a53
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8d25a08599df7ca3093eb7ca731c7cd41cbfbb51
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d069dcffef849b8fd10030fd73007a79612803e6
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2373412
    reference_type:
    reference_id: 2373412
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50231
    reference_type:
    reference_id: CVE-2022-50231
