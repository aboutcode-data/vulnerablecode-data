vulnerability_id: VCID-gutu-2p41-h7hg
aliases:
  - CVE-2024-50336
  - GHSA-xvg8-m4x3-w6xr
summary: |
  matrix-js-sdk has insufficient MXC URI validation which allows client-side path traversal
  ### Summary

  matrix-js-sdk before 34.11.0 is vulnerable to client-side path traversal via crafted MXC URIs. A malicious room member can trigger clients based on the matrix-js-sdk to issue arbitrary authenticated GET requests to the client's homeserver.

  ### Details

  The Matrix specification demands homeservers to [perform validation](https://spec.matrix.org/v1.12/client-server-api/#security-considerations-5) of the `server-name` and `media-id` components of MXC URIs with the intent to prevent path traversal. However, it is not mentioned that a similar check must also be performed on the client to prevent *client-side* path traversal. matrix-js-sdk fails to perform this validation.

  ### Patches

  Fixed in matrix-js-sdk 34.11.1.

  ### Workarounds

  None.

  ### References

  - https://spec.matrix.org/v1.12/client-server-api/#security-considerations-5
  - https://blog.doyensec.com/2024/07/02/cspt2csrf.html
severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11931'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11942'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11999'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12052'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12350'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12135'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12407'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12500'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12085'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12070'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11755'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12472'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11846'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11869'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11936'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28525'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28565'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28536'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28501'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28496'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28534'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28575'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28544'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28539'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28429'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28394'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30449'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30517'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30491'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.30474'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35578'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35489'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35553'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35621'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35664'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35669'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.35583'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37746'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37753'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37676'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37704'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37734'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37742'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37727'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.32278'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xvg8-m4x3-w6xr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-xvg8-m4x3-w6xr
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:L/VA:N/SC:N/SI:L/SA:N
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-xvg8-m4x3-w6xr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-xvg8-m4x3-w6xr
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-11-12T17:11:23Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-xvg8-m4x3-w6xr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50336
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:L/VA:N/SC:N/SI:L/SA:N
    published_at: None
    url: https://spec.matrix.org/v1.12/client-server-api/#security-considerations-5
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://spec.matrix.org/v1.12/client-server-api/#security-considerations-5
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-11-12T17:11:23Z/
    published_at: None
    url: https://spec.matrix.org/v1.12/client-server-api/#security-considerations-5
  - score: none
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.mozilla.org/en-US/security/advisories/mfsa2024-69
  - score: high
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.mozilla.org/en-US/security/advisories/mfsa2025-04
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-50336
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50336
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-js-sdk
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-xvg8-m4x3-w6xr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50336
    reference_type:
    reference_id:
  - url: https://spec.matrix.org/v1.12/client-server-api/#security-considerations-5
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-xvg8-m4x3-w6xr
    reference_type:
    reference_id: GHSA-xvg8-m4x3-w6xr
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2024-69
    reference_type:
    reference_id: mfsa2024-69
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2025-04
    reference_type:
    reference_id: mfsa2025-04
