vulnerability_id: VCID-7f36-tecm-uqf2
aliases:
  - CVE-2025-24371
  - GHSA-22qq-3xwm-r5x4
summary: CometBFT is a distributed, Byzantine fault-tolerant, deterministic state machine replication
  engine. In the `blocksync` protocol peers send their `base` and `latest` heights when they
  connect to a new node (`A`), which is syncing to the tip of a network. `base` acts as a lower
  ground and informs `A` that the peer only has blocks starting from height `base`. `latest`
  height informs `A` about the latest block in a network. Normally, nodes would only report
  increasing heights. If `B` fails to provide the latest block, `B` is removed and the `latest`
  height (target height) is recalculated based on other nodes `latest` heights. The existing
  code however doesn't check for the case where `B` first reports `latest` height `X` and immediately
  after height `Y`, where `X > Y`. `A` will be trying to catch up to 2000 indefinitely. This
  condition requires the introduction of malicious code in the full node first reporting some
  non-existing `latest` height, then reporting lower `latest` height and nodes which are syncing
  using `blocksync` protocol. This issue has been patched in versions 1.0.1 and 0.38.17 and
  all users are advised to upgrade. Operators may attempt to ban malicious peers from the network
  as a workaround.
severities:
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.07394'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14487'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14703'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.147'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14661'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.1464'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14629'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.1444'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14604'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14611'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14647'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14631'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14666'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20754'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17355'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20584'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20649'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20705'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20765'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20758'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20743'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20724'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20721'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20731'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20735'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20753'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20757'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20759'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.1741'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17385'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft/commit/0ee80cd609c7ae9fe856bdd1c6d38553fdae90ce
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft/commit/2cebfde06ae5073c0b296a9d2ca6ab4b95397ea5
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/cometbft/cometbft/releases/tag/v0.38.17
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft/releases/tag/v0.38.17
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-04T19:15:05Z/
    published_at: None
    url: https://github.com/cometbft/cometbft/releases/tag/v0.38.17
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/cometbft/cometbft/releases/tag/v1.0.1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft/releases/tag/v1.0.1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-04T19:15:05Z/
    published_at: None
    url: https://github.com/cometbft/cometbft/releases/tag/v1.0.1
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/cometbft/cometbft/security/advisories/GHSA-22qq-3xwm-r5x4
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft/security/advisories/GHSA-22qq-3xwm-r5x4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-04T19:15:05Z/
    published_at: None
    url: https://github.com/cometbft/cometbft/security/advisories/GHSA-22qq-3xwm-r5x4
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-24371
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3442
weaknesses:
  - CWE-703
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-24371
    reference_type:
    reference_id:
  - url: https://github.com/cometbft/cometbft
    reference_type:
    reference_id:
  - url: https://github.com/cometbft/cometbft/commit/0ee80cd609c7ae9fe856bdd1c6d38553fdae90ce
    reference_type:
    reference_id:
  - url: https://github.com/cometbft/cometbft/commit/2cebfde06ae5073c0b296a9d2ca6ab4b95397ea5
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3442
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-24371
    reference_type:
    reference_id: CVE-2025-24371
  - url: https://github.com/cometbft/cometbft/security/advisories/GHSA-22qq-3xwm-r5x4
    reference_type:
    reference_id: GHSA-22qq-3xwm-r5x4
  - url: https://github.com/cometbft/cometbft/releases/tag/v0.38.17
    reference_type:
    reference_id: v0.38.17
  - url: https://github.com/cometbft/cometbft/releases/tag/v1.0.1
    reference_type:
    reference_id: v1.0.1
