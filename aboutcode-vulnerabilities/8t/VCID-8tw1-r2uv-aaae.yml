vulnerability_id: VCID-8tw1-r2uv-aaae
aliases:
  - GHSA-qp29-wcc2-vmpc
summary: |
  Silverstripe HtmlEditor embed url sanitisation
  "Add from URL" doesn't clearly sanitise URL server side

  HtmlEditorField_Toolbar has an action HtmlEditorField_Toolbar#viewfile, which gets called by the CMS when adding a media "from a URL" (i.e. via oembed).

  This action gets the URL to add in the GET parameter FileURL. However it doesn't do any URL sanitising server side. The current logic will pass this through to Oembed, which will probably reject most dangerous URLs, but it's possible future changes would break this.
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-qp29-wcc2-vmpc
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2015-027-1.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2015-027-1.yaml
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/silverstripe/silverstripe-framework
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/silverstripe/silverstripe-framework
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://www.silverstripe.org/download/security-releases/ss-2015-027
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.silverstripe.org/download/security-releases/ss-2015-027
weaknesses:
  - CWE-937
  - CWE-1035
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2015-027-1.yaml
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework
    reference_type:
    reference_id:
  - url: https://www.silverstripe.org/download/security-releases/ss-2015-027
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-qp29-wcc2-vmpc
    reference_type:
    reference_id: GHSA-qp29-wcc2-vmpc
