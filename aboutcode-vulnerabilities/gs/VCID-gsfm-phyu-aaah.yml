vulnerability_id: VCID-gsfm-phyu-aaah
aliases:
  - GHSA-x883-2vmg-xwf7
summary: |
  Authelia's Group Changes may not have the expected results (YAML file backend)
  ### Impact

  Under very specific conditions changes to a users groups may not have the expected results.

  The specific conditions are:

  * The file authentication backend is being used.
  * The [watch](https://www.authelia.com/configuration/first-factor/file/#watch) option is set to true.
  * The [refresh_interval](https://www.authelia.com/configuration/first-factor/introduction/#refresh_interval) is configured to a non-disabled value.
  * The users groups are adjusted by an administrator.
  * The user attempts to access a resource that their groups previously had access to but their new groups do not have access to.

  When these conditions are met administrators may find the changes are not taken into account by access control for longer than expected periods. While this may not necessarily be a security vulnerability it's security-adjacent and because of the unexpected nature of it and our dedication to a security-first culture we feel it's important to make users aware of this behaviour utilizing a security advisory and the existence of a fix.

  This:

  * Can not have an Impact for Unauthenticated Users.
  * Can not have an Impact for Configurations utilizing the LDAP Backend.
  * Can not be directly or indirectly caused by a users or third parties actions.

  ### Patches

  This behaviour was identified **_after_** it was inadvertently fixed in the `master` branch during the multi-cookie domain rework (i.e. between feature releases). A patch for prior versions can be provided upon request. The fix was to ensure the details are updated regardless of backend, it was a small oversight in previous functionality which made refreshing ineffectual prior to v4.37.0.

  ### Workarounds

  Ensure you restart between user database changes.

  ### References

  * https://github.com/authelia/authelia/blob/v4.37.5/internal/handlers/handler_verify.go#L376-L394
severities:
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/authelia/authelia
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authelia/authelia
  - score: '1.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:P/AC:H/PR:H/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/authelia/authelia/blob/v4.37.5/internal/handlers/handler_verify.go#L376-L394
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authelia/authelia/blob/v4.37.5/internal/handlers/handler_verify.go#L376-L394
  - score: '1.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:P/AC:H/PR:H/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/authelia/authelia/security/advisories/GHSA-x883-2vmg-xwf7
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authelia/authelia/security/advisories/GHSA-x883-2vmg-xwf7
weaknesses:
  - CWE-281
references:
  - url: https://github.com/authelia/authelia
    reference_type:
    reference_id:
  - url: https://github.com/authelia/authelia/blob/v4.37.5/internal/handlers/handler_verify.go#L376-L394
    reference_type:
    reference_id:
  - url: https://github.com/authelia/authelia/security/advisories/GHSA-x883-2vmg-xwf7
    reference_type:
    reference_id:
