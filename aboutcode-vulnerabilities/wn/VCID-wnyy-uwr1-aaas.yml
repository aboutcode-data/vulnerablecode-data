vulnerability_id: VCID-wnyy-uwr1-aaas
aliases:
  - GHSA-h8g9-6gvh-5mrc
summary: "etcd vulnerable to TOCTOU of gateway endpoint authentication\n### Vulnerability type\n\
  Authentication\n\n### Workarounds\nRefer to the [gateway documentation](https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/gateway.md).\
  \ The vulnerability was spotted due to unclear documentation of how the gateway handles endpoints\
  \ validation. \n\n### Detail\nThe gateway only authenticates endpoints detected from DNS SRV\
  \ records, and it only authenticates the detected endpoints once. Therefore, if an endpoint\
  \ changes its authentication settings, the gateway will continue to assume the endpoint is\
  \ still authenticated. The auditors has noted that appropriate documentation of this validation\
  \ functionality plus deprecation of this misleading functionality is an acceptable path forward.\n\
  \n### References\nFind out more on this vulnerability in the [security audit report](https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf)\n\
  \n### For more information\nIf you have any questions or comments about this advisory:\n*\
  \ Contact the [etcd security committee](https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md#product-security-committee-psc)"
severities:
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/etcd-io/etcd
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/etcd-io/etcd
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/etcd-io/etcd/security/advisories/GHSA-h8g9-6gvh-5mrc
weaknesses:
  - CWE-367
references:
  - url: https://github.com/etcd-io/etcd
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/security/advisories/GHSA-h8g9-6gvh-5mrc
    reference_type:
    reference_id:
