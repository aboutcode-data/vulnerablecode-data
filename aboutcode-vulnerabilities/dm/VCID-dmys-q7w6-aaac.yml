vulnerability_id: VCID-dmys-q7w6-aaac
aliases:
  - CVE-2022-39263
  - GHSA-4rxr-27mm-mxq9
summary: |
  Improper Authentication
  `@next-auth/upstash-redis-adapter` is the Upstash Redis adapter for NextAuth.js, which provides authentication for Next.js. Applications that use `next-auth` Email Provider and `@next-auth/upstash-redis-adapter` before v3.0.2 are affected by this vulnerability. The Upstash Redis adapter implementation does not check for both the identifier (email) and the token, but only checking for the identifier when verifying the token in the email callback flow. An attacker who knows about the victim's email could easily sign in as the victim, given the attacker also knows about the verification token's expired duration. The vulnerability is patched in v3.0.2. A workaround is available. Using Advanced Initialization, developers can check the requests and compare the query's token and identifier before proceeding.
severities:
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28159'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24127'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.2407'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24219'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24245'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24248'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24254'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24205'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24172'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.2419'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24251'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24242'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24204'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24187'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.24158'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28017'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28077'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28119'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28163'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28108'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28093'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28076'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28079'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28068'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28082'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28065'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28044'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28037'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00197'
    scoring_system: epss
    scoring_elements: '0.57349'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00197'
    scoring_system: epss
    scoring_elements: '0.57322'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00197'
    scoring_system: epss
    scoring_elements: '0.57615'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00197'
    scoring_system: epss
    scoring_elements: '0.57341'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.59289'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.59322'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.58744'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.58965'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.59029'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.59044'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.59102'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.59090'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.59115'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.59141'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.59255'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.37404'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-4rxr-27mm-mxq9
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/nextauthjs/next-auth
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/d16e04848ee703cf797724194d4ad2907fe125a9
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/d16e04848ee703cf797724194d4ad2907fe125a9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:44Z/
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/d16e04848ee703cf797724194d4ad2907fe125a9
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-4rxr-27mm-mxq9
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-4rxr-27mm-mxq9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:44Z/
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-4rxr-27mm-mxq9
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39263
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39263
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-287
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-39263
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/commit/d16e04848ee703cf797724194d4ad2907fe125a9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:next-auth:nextauth:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:next-auth:nextauth:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39263
    reference_type:
    reference_id: CVE-2022-39263
  - url: https://github.com/advisories/GHSA-4rxr-27mm-mxq9
    reference_type:
    reference_id: GHSA-4rxr-27mm-mxq9
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-4rxr-27mm-mxq9
    reference_type:
    reference_id: GHSA-4rxr-27mm-mxq9
