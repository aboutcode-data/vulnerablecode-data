vulnerability_id: VCID-5kre-tqw8-aaaa
aliases:
  - CVE-2022-45786
  - GHSA-6p5q-h963-pwwf
summary: 'There are issues with the AGE drivers for Golang and Python that enable SQL injections
  to occur. This impacts AGE for PostgreSQL 11 & AGE for PostgreSQL 12, all versions up-to-and-including
  1.1.0, when using those drivers. The fix is to update to the latest Golang and Python drivers
  in addition to the latest version of AGE that is used for PostgreSQL 11 or PostgreSQL 12.
  The update of AGE will add a new function to enable parameterization of the cypher() function,
  which, in conjunction with the driver updates, will resolve this issue. Background (for those
  who want more information): After thoroughly researching this issue, we found that due to
  the nature of the cypher() function, it was not easy to parameterize the values passed into
  it. This enabled SQL injections, if the developer of the driver wasn''t careful. The developer
  of the Golang and Pyton drivers didn''t fully utilize parameterization, likely because of
  this, thus enabling SQL injections. The obvious fix to this issue is to use parameterization
  in the drivers for all PG SQL queries. However, parameterizing all PG queries is complicated
  by the fact that the cypher() function call itself cannot be parameterized directly, as it
  isn''t a real function. At least, not the parameters that would take the graph name and cypher
  query. The reason the cypher() function cannot have those values parameterized is because
  the function is a placeholder and never actually runs. The cypher() function node, created
  by PG in the query tree, is transformed and replaced with a query tree for the actual cypher
  query during the analyze phase. The problem is that parameters - that would be passed in and
  that the cypher() function transform needs to be resolved - are only resolved in the execution
  phase, which is much later. Since the transform of the cypher() function needs to know the
  graph name and cypher query prior to execution, they can''t be passed as parameters. The fix
  that we are testing right now, and are proposing to use, is to create a function that will
  be called prior to the execution of the cypher() function transform. This new function will
  allow values to be passed as parameters for the graph name and cypher query. As this command
  will be executed prior to the cypher() function transform, its values will be resolved. These
  values can then be cached for the immediately following cypher() function transform to use.
  As added features, the cached values will store the calling session''s pid, for validation.
  And, the cypher() function transform will clear this cached information after function invocation,
  regardless of whether it was used. This method will allow the parameterizing of the cypher()
  function indirectly and provide a way to lock out SQL injection attacks.'
severities:
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16354'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1336'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13397'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13437'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13412'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13396'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13413'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13431'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13458'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13446'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13417'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13401'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13342'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16127'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16199'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16299'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16374'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16377'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16353'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16329'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16323'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16326'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16345'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16371'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16378'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16364'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13222'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13187'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13346'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.45912'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.46197'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.46122'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.46099'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.45934'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.45457'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.45708'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.45794'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.45813'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.45894'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.45888'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00112'
    scoring_system: epss
    scoring_elements: '0.45893'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.28312'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.67540'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.67762'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.67565'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.67559'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-6p5q-h963-pwwf
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/age
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/age
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.apache.org/thread/of8x0gt5d2vfrm5ksxw55bwn2849ck1w
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/of8x0gt5d2vfrm5ksxw55bwn2849ck1w
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-26T13:57:26Z/
    published_at: None
    url: https://lists.apache.org/thread/of8x0gt5d2vfrm5ksxw55bwn2849ck1w
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-45786
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-45786
weaknesses:
  - CWE-89
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-45786
    reference_type:
    reference_id:
  - url: https://github.com/apache/age
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/of8x0gt5d2vfrm5ksxw55bwn2849ck1w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:age:*:*:*:*:*:postgresql:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:age:*:*:*:*:*:postgresql:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-45786
    reference_type:
    reference_id: CVE-2022-45786
  - url: https://github.com/advisories/GHSA-6p5q-h963-pwwf
    reference_type:
    reference_id: GHSA-6p5q-h963-pwwf
