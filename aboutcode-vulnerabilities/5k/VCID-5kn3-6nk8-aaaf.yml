vulnerability_id: VCID-5kn3-6nk8-aaaf
aliases:
  - GHSA-xpww-g9jx-hp8r
summary: |
  Miscomputed sha2 results when using AVX2 backend
  The v0.9.7 release of the `sha2` crate introduced a new AVX2-accelerated
  backend which was automatically enabled for all x86/x86_64 CPUs where AVX2
  support was autodetected at runtime.

  This backend was buggy and would miscompute results for long messages
  (i.e. messages spanning multiple SHA blocks).

  The crate has since been yanked, but any users who upgraded to v0.9.7 should
  immediately upgrade to v0.9.8 and recompute any hashes which were previously
  computed by v0.9.7.
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xpww-g9jx-hp8r
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/RustCrypto/hashes
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/RustCrypto/hashes
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/RustCrypto/hashes/pull/314
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/RustCrypto/hashes/pull/314
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2021-0100.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2021-0100.html
weaknesses: []
references:
  - url: https://github.com/RustCrypto/hashes
    reference_type:
    reference_id:
  - url: https://github.com/RustCrypto/hashes/pull/314
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0100.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-xpww-g9jx-hp8r
    reference_type:
    reference_id: GHSA-xpww-g9jx-hp8r
