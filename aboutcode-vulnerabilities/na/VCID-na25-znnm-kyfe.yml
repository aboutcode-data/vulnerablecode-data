vulnerability_id: VCID-na25-znnm-kyfe
aliases:
  - CVE-2023-52977
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: openvswitch:
  fix flow memory leak in ovs_flow_cmd_new  Syzkaller reports a memory leak of new_flow in ovs_flow_cmd_new()
  as it is not freed when an allocation of a key fails.  BUG: memory leak unreferenced object
  0xffff888116668000 (size 632):   comm "syz-executor231", pid 1090, jiffies 4294844701 (age
  18.871s)   hex dump (first 32 bytes):     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................     00
  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................   backtrace:     [<00000000defa3494>]
  kmem_cache_zalloc include/linux/slab.h:654 [inline]     [<00000000defa3494>] ovs_flow_alloc+0x19/0x180
  net/openvswitch/flow_table.c:77     [<00000000c67d8873>] ovs_flow_cmd_new+0x1de/0xd40 net/openvswitch/datapath.c:957     [<0000000010a539a8>]
  genl_family_rcv_msg_doit+0x22d/0x330 net/netlink/genetlink.c:739     [<00000000dff3302d>]
  genl_family_rcv_msg net/netlink/genetlink.c:783 [inline]     [<00000000dff3302d>] genl_rcv_msg+0x328/0x590
  net/netlink/genetlink.c:800     [<000000000286dd87>] netlink_rcv_skb+0x153/0x430 net/netlink/af_netlink.c:2515     [<0000000061fed410>]
  genl_rcv+0x24/0x40 net/netlink/genetlink.c:811     [<000000009dc0f111>] netlink_unicast_kernel
  net/netlink/af_netlink.c:1313 [inline]     [<000000009dc0f111>] netlink_unicast+0x545/0x7f0
  net/netlink/af_netlink.c:1339     [<000000004a5ee816>] netlink_sendmsg+0x8e7/0xde0 net/netlink/af_netlink.c:1934     [<00000000482b476f>]
  sock_sendmsg_nosec net/socket.c:651 [inline]     [<00000000482b476f>] sock_sendmsg+0x152/0x190
  net/socket.c:671     [<00000000698574ba>] ____sys_sendmsg+0x70a/0x870 net/socket.c:2356     [<00000000d28d9e11>]
  ___sys_sendmsg+0xf3/0x170 net/socket.c:2410     [<0000000083ba9120>] __sys_sendmsg+0xe5/0x1b0
  net/socket.c:2439     [<00000000c00628f8>] do_syscall_64+0x30/0x40 arch/x86/entry/common.c:46     [<000000004abfdcf4>]
  entry_SYSCALL_64_after_hwframe+0x61/0xc6  To fix this the patch rearranges the goto labels
  to reflect the order of object allocations and adds appropriate goto statements on the error
  paths.  Found by Linux Verification Center (linuxtesting.org) with Syzkaller.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52977.json
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52977.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01049'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01045'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01042'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01046'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01034'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01031'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01025'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0104'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01036'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01023'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01041'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01409'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03671'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03676'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.03931'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05475'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05476'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05487'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05506'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0549'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05498'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05494'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.055'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05509'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05497'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05436'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07114'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52977
weaknesses:
  - CWE-401
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52977.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52977
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52977
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0c598aed445eb45b0ee7ba405f7ece99ee349c30
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1ac653cf886cdfc082708c82dc6ac6115cebd2ee
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/70154489f531587996f3e9d7cceeee65cff0001d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/70d40674a549d498bd63d5432acf46205da1534b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/af4e720bc00a2653f7b9df21755b9978b3d7f386
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ed6c5e8caf55778500202775167e8ccdb1a030cb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f423c2efd51d7eb1d143c2be7eea233241d9bbbf
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355538
    reference_type:
    reference_id: 2355538
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52977
    reference_type:
    reference_id: CVE-2023-52977
  - url: https://access.redhat.com/errata/RHSA-2023:7077
    reference_type:
    reference_id: RHSA-2023:7077
