vulnerability_id: VCID-qvvy-m7us-aaaf
aliases:
  - CVE-2023-30624
  - GHSA-ch89-5g45-qwc7
summary: |
  Wasmtime is a standalone runtime for WebAssembly. Prior to versions 6.0.2, 7.0.1, and 8.0.1, Wasmtime's implementation of managing per-instance state, such as tables and memories, contains LLVM-level undefined behavior. This undefined behavior was found to cause runtime-level issues when compiled with LLVM 16 which causes some writes, which are critical for correctness, to be optimized away. Vulnerable versions of Wasmtime compiled with Rust 1.70, which is currently in beta, or later are known to have incorrectly compiled functions. Versions of Wasmtime compiled with the current Rust stable release, 1.69, and prior are not known at this time to have any issues, but can theoretically exhibit potential issues.

  The underlying problem is that Wasmtime's runtime state for an instance involves a Rust-defined structure called `Instance` which has a trailing `VMContext` structure after it. This `VMContext` structure has a runtime-defined layout that is unique per-module. This representation cannot be expressed with safe code in Rust so `unsafe` code is required to maintain this state. The code doing this, however, has methods which take `&self` as an argument but modify data in the `VMContext` part of the allocation. This means that pointers derived from `&self` are mutated. This is typically not allowed, except in the presence of `UnsafeCell`, in Rust. When compiled to LLVM these functions have `noalias readonly` parameters which means it's UB to write through the pointers.

  Wasmtime's internal representation and management of `VMContext` has been updated to use `&mut self` methods where appropriate. Additionally verification tools for `unsafe` code in Rust, such as `cargo miri`, are planned to be executed on the `main` branch soon to fix any Rust-level issues that may be exploited in future compiler versions.

  Precomplied binaries available for Wasmtime from GitHub releases have been compiled with at most LLVM 15 so are not known to be vulnerable. As mentioned above, however, it's still recommended to update.

  Wasmtime version 6.0.2, 7.0.1, and 8.0.1 have been issued which contain the patch necessary to work correctly on LLVM 16 and have no known UB on LLVM 15 and earlier. If Wasmtime is compiled with Rust 1.69 and prior, which use LLVM 15, then there are no known issues. There is a theoretical possibility for undefined behavior to exploited, however, so it's recommended that users upgrade to a patched version of Wasmtime. Users using beta Rust (1.70 at this time) or nightly Rust (1.71 at this time) must update to a patched version to work correctly.
severities:
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26643'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26632'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.2665'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26666'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26648'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26579'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26649'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26652'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26669'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.2669'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26734'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26623'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26732'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26687'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.50152'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52776'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52781'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52798'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52826'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52974'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.53001'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.53053'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52080'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52107'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52113'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52399'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52631'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52696'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52782'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52713'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.5163'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51482'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51472'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51575'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.5158'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51605'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51598'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51578'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51597'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51616'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51637'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.51647'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00314'
    scoring_system: epss
    scoring_elements: '0.5164'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: '0.00471'
    scoring_system: epss
    scoring_elements: '0.47554'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-ch89-5g45-qwc7
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime
  - score: '3.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/commit/0977952dcd9d482bff7c288868ccb52769b3a92e
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/commit/0977952dcd9d482bff7c288868ccb52769b3a92e
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-30T19:33:26Z/
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/commit/0977952dcd9d482bff7c288868ccb52769b3a92e
  - score: '3.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-ch89-5g45-qwc7
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-ch89-5g45-qwc7
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-30T19:33:26Z/
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-ch89-5g45-qwc7
  - score: '3.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://groups.google.com/a/bytecodealliance.org/g/sec-announce/c/ecK-6G2yi90
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://groups.google.com/a/bytecodealliance.org/g/sec-announce/c/ecK-6G2yi90
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-30624
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-30624
weaknesses:
  - CWE-758
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-30624
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime/commit/0977952dcd9d482bff7c288868ccb52769b3a92e
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-ch89-5g45-qwc7
    reference_type:
    reference_id:
  - url: https://groups.google.com/a/bytecodealliance.org/g/sec-announce/c/ecK-6G2yi90
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:bytecodealliance:wasmtime:7.0.0:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:bytecodealliance:wasmtime:7.0.0:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:bytecodealliance:wasmtime:8.0.0:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:bytecodealliance:wasmtime:8.0.0:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:bytecodealliance:wasmtime:*:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:bytecodealliance:wasmtime:*:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-30624
    reference_type:
    reference_id: CVE-2023-30624
  - url: https://github.com/advisories/GHSA-ch89-5g45-qwc7
    reference_type:
    reference_id: GHSA-ch89-5g45-qwc7
