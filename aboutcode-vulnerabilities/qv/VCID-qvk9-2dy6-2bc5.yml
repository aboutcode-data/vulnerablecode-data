vulnerability_id: VCID-qvk9-2dy6-2bc5
aliases:
  - CVE-2025-59343
  - GHSA-vj76-c3g6-qr5v
summary: |
  tar-fs has a symlink validation bypass if destination directory is predictable with a specific tarball
  ### Impact
   v3.1.0, v2.1.3, v1.16.5 and below

  ### Patches
  Has been patched in 3.1.1, 2.1.4, and 1.16.6

  ### Workarounds
  You can use the ignore option to ignore non files/directories.

  ```js
    ignore (_, header) {
      // pass files & directories, ignore e.g. symlinks
      return header.type !== 'file' && header.type !== 'directory'
    }
  ```

  ### Credit
  Reported by: Mapta / BugBunny_ai
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-59343.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04455'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04448'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04469'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04477'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04502'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04488'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04496'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05198'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05076'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05061'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05654'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0567'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05053'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05174'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15424'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15438'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15402'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20721'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20928'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20898'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20888'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20762'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20739'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20677'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20748'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20751'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-vj76-c3g6-qr5v
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mafintosh/tar-fs
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/mafintosh/tar-fs/commit/0bd54cdf06da2b7b5b95cd4b062c9f4e0a8c4e09
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mafintosh/tar-fs/commit/0bd54cdf06da2b7b5b95cd4b062c9f4e0a8c4e09
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-03T14:49:04Z/
    published_at: None
    url: https://github.com/mafintosh/tar-fs/commit/0bd54cdf06da2b7b5b95cd4b062c9f4e0a8c4e09
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/mafintosh/tar-fs/security/advisories/GHSA-vj76-c3g6-qr5v
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/mafintosh/tar-fs/security/advisories/GHSA-vj76-c3g6-qr5v
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mafintosh/tar-fs/security/advisories/GHSA-vj76-c3g6-qr5v
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-03T14:49:04Z/
    published_at: None
    url: https://github.com/mafintosh/tar-fs/security/advisories/GHSA-vj76-c3g6-qr5v
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2025/09/msg00028.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59343
weaknesses:
  - CWE-22
  - CWE-1035
  - CWE-937
  - CWE-61
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-59343.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-59343
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-59343
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/mafintosh/tar-fs
    reference_type:
    reference_id:
  - url: https://github.com/mafintosh/tar-fs/commit/0bd54cdf06da2b7b5b95cd4b062c9f4e0a8c4e09
    reference_type:
    reference_id:
  - url: https://github.com/mafintosh/tar-fs/security/advisories/GHSA-vj76-c3g6-qr5v
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/09/msg00028.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59343
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1116338
    reference_type:
    reference_id: 1116338
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2397901
    reference_type:
    reference_id: 2397901
  - url: https://github.com/advisories/GHSA-vj76-c3g6-qr5v
    reference_type:
    reference_id: GHSA-vj76-c3g6-qr5v
  - url: https://access.redhat.com/errata/RHSA-2025:17376
    reference_type:
    reference_id: RHSA-2025:17376
  - url: https://access.redhat.com/errata/RHSA-2025:18979
    reference_type:
    reference_id: RHSA-2025:18979
  - url: https://access.redhat.com/errata/RHSA-2025:19094
    reference_type:
    reference_id: RHSA-2025:19094
  - url: https://access.redhat.com/errata/RHSA-2025:19201
    reference_type:
    reference_id: RHSA-2025:19201
  - url: https://access.redhat.com/errata/RHSA-2025:19221
    reference_type:
    reference_id: RHSA-2025:19221
  - url: https://access.redhat.com/errata/RHSA-2025:19529
    reference_type:
    reference_id: RHSA-2025:19529
