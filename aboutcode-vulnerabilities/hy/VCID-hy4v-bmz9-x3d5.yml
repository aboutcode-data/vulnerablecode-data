vulnerability_id: VCID-hy4v-bmz9-x3d5
aliases:
  - CVE-2022-48941
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ice: fix concurrent reset and removal of VFs

  Commit c503e63200c6 ("ice: Stop processing VF messages during teardown")
  introduced a driver state flag, ICE_VF_DEINIT_IN_PROGRESS, which is
  intended to prevent some issues with concurrently handling messages from
  VFs while tearing down the VFs.

  This change was motivated by crashes caused while tearing down and
  bringing up VFs in rapid succession.

  It turns out that the fix actually introduces issues with the VF driver
  caused because the PF no longer responds to any messages sent by the VF
  during its .remove routine. This results in the VF potentially removing
  its DMA memory before the PF has shut down the device queues.

  Additionally, the fix doesn't actually resolve concurrency issues within
  the ice driver. It is possible for a VF to initiate a reset just prior
  to the ice driver removing VFs. This can result in the remove task
  concurrently operating while the VF is being reset. This results in
  similar memory corruption and panics purportedly fixed by that commit.

  Fix this concurrency at its root by protecting both the reset and
  removal flows using the existing VF cfg_lock. This ensures that we
  cannot remove the VF while any outstanding critical tasks such as a
  virtchnl message or a reset are occurring.

  This locking change also fixes the root cause originally fixed by commit
  c503e63200c6 ("ice: Stop processing VF messages during teardown"), so we
  can simply revert it.

  Note that I kept these two changes together because simply reverting the
  original commit alone would leave the driver vulnerable to worse race
  conditions.
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48941.json
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06006'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04566'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04565'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04572'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04569'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04593'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04621'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04611'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04604'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0457'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05944'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05967'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06056'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06008'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0599'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05974'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05934'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0593'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0594'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05941'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05959'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04627'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04571'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04556'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04559'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04561'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06097'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06066'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.18716'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '4.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48941
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48941
weaknesses:
  - CWE-362
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48941.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-48941
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/05ae1f0fe9c6c5ead08b306e665763a352d20716
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2a3e61de89bab6696aa28b70030eb119968c5586
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c805fce07c9dbc47d8a9129c7c5458025951957
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fadead80fe4c033b5e514fcbadd20b55c4494112
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2307197
    reference_type:
    reference_id: 2307197
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48941
    reference_type:
    reference_id: CVE-2022-48941
