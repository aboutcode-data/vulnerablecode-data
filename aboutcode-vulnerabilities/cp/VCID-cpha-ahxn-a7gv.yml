vulnerability_id: VCID-cpha-ahxn-a7gv
aliases:
  - CVE-2024-45388
  - GHSA-6xx4-x46f-f897
summary: Hoverfly is a lightweight service virtualization/ API simulation / API mocking tool
  for developers and testers. The `/api/v2/simulation` POST handler allows users to create new
  simulation views from the contents of a user-specified file. This feature can be abused by
  an attacker to read arbitrary files from the Hoverfly server. Note that, although the code
  prevents absolute paths from being specified, an attacker can escape out of the `hf.Cfg.ResponsesBodyFilesPath`
  base path by using `../` segments and reach any arbitrary files. This issue was found using
  the Uncontrolled data used in path expression CodeQL query for python. Users are advised to
  make sure the final path (`filepath.Join(hf.Cfg.ResponsesBodyFilesPath, filePath)`) is contained
  within the expected base path (`filepath.Join(hf.Cfg.ResponsesBodyFilesPath, "/")`). This
  issue is also tracked as GHSL-2023-274.
severities:
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79470'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.78855'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.78685'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.78695'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.78677'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79573'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79548'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79536'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79485'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79481'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79265'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79468'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79393'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79429'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79440'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.00620'
    scoring_system: epss
    scoring_elements: '0.79471'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.82056'
    scoring_system: epss
    scoring_elements: '0.99165'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.82056'
    scoring_system: epss
    scoring_elements: '0.99161'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.82056'
    scoring_system: epss
    scoring_elements: '0.99168'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.82056'
    scoring_system: epss
    scoring_elements: '0.9917'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.82056'
    scoring_system: epss
    scoring_elements: '0.99172'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.82056'
    scoring_system: epss
    scoring_elements: '0.99173'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.82056'
    scoring_system: epss
    scoring_elements: '0.99171'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.82056'
    scoring_system: epss
    scoring_elements: '0.99175'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.90698'
    scoring_system: epss
    scoring_elements: '0.99557'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.91503'
    scoring_system: epss
    scoring_elements: '0.9963'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.91503'
    scoring_system: epss
    scoring_elements: '0.99633'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.91503'
    scoring_system: epss
    scoring_elements: '0.99631'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '0.91503'
    scoring_system: epss
    scoring_elements: '0.99632'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://codeql.github.com/codeql-query-help/go/go-path-injection
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://codeql.github.com/codeql-query-help/go/go-path-injection
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/SpectoLabs/hoverfly
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SpectoLabs/hoverfly
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/SpectoLabs/hoverfly/releases/tag/v1.10.3
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SpectoLabs/hoverfly/releases/tag/v1.10.3
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-6xx4-x46f-f897
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-6xx4-x46f-f897
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-45388
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-45388
weaknesses:
  - CWE-22
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-45388
    reference_type:
    reference_id:
  - url: https://codeql.github.com/codeql-query-help/go/go-path-injection
    reference_type:
    reference_id:
  - url: https://github.com/SpectoLabs/hoverfly
    reference_type:
    reference_id:
  - url: https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87
    reference_type:
    reference_id:
  - url: https://github.com/SpectoLabs/hoverfly/releases/tag/v1.10.3
    reference_type:
    reference_id:
  - url: https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-6xx4-x46f-f897
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:hoverfly:hoverfly:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:hoverfly:hoverfly:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45388
    reference_type:
    reference_id: CVE-2024-45388
