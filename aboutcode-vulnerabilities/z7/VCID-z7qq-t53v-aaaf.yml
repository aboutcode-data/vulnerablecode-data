vulnerability_id: VCID-z7qq-t53v-aaaf
aliases:
  - GHSA-hg58-rf2h-6rr7
summary: |
  CometBFT is unstability during blocksync when syncing from malicious peer
  **Name**: ASA-2024-008: Instability during blocksync when syncing from malicious peer
  **Component**: CometBFT
  **Criticality**: Medium ([ACMv1](https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md): I:Moderate; L: Possible)
  **Affected versions**: < v0.38.7

  # Summary

  An issue was identified for nodes syncing on an existing network during blocksync in which a malicious peer could cause the syncing peer to panic, enter into a catastrophic invalid syncing state or get stuck in blocksync mode, never switching to consensus. It is recommended for all clients to adopt this patch so that blocksync functions as expected and is tolerant of malicious peers presenting invalid data in this situation. Nodes that are vulnerable to this state may experience a Denial of Service condition in which syncing will not work as expected when joining a network as a client.

  # Recognition

  This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 5/01/24 by unknown_feature. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see https://hackerone.com/cosmos.

  If you have questions about Interchain security efforts, please reach out to our official communication channel at [security@interchain.io](mailto:security@interchain.io).

  For more information about CometBFT, please see https://docs.cometbft.com/.

  For more information about the Interchain Foundationâ€™s engagement with Amulet, please see https://github.com/interchainio/security.
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/cometbft/cometbft
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft/commit/07866e11139127e415bd0339ac377b6e6a845533
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft/commit/8ba2e4f52d5e626e019501ba6420cc86d5de7857
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cometbft/cometbft/security/advisories/GHSA-hg58-rf2h-6rr7
weaknesses:
  - CWE-610
references:
  - url: https://github.com/cometbft/cometbft
    reference_type:
    reference_id:
  - url: https://github.com/cometbft/cometbft/commit/07866e11139127e415bd0339ac377b6e6a845533
    reference_type:
    reference_id:
  - url: https://github.com/cometbft/cometbft/commit/8ba2e4f52d5e626e019501ba6420cc86d5de7857
    reference_type:
    reference_id:
  - url: https://github.com/cometbft/cometbft/security/advisories/GHSA-hg58-rf2h-6rr7
    reference_type:
    reference_id:
