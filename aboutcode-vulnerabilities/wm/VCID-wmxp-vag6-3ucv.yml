vulnerability_id: VCID-wmxp-vag6-3ucv
aliases:
  - CVE-2025-62378
  - GHSA-fhwm-pc6r-4h2f
summary: |
  CommandKit has incorrect command name exposure in context object for message command aliases
  ### Impact
  A logic flaw exists in the message command handler of CommandKit that affects how the `commandName` property is exposed to both middleware functions and command execution contexts when handling command aliases. When a message command is invoked using an alias, the `ctx.commandName` value reflects the alias rather than the canonical command name. This occurs in both middleware functions and within the commandâ€™s own run function.

  Developers who rely on `ctx.commandName` for logic that assumes it represents the canonical command identifier may introduce unintended behavior. In security-sensitive cases, such as middleware used for permission checks, rate limiting, or audit logging, this behavior could allow unauthorized command execution or inaccurate access control decisions. Slash commands and context menu commands are not affected.

  ### Patches
  Fixed in v1.2.0-rc.12.
  `ctx.commandName` now consistently returns the actual command name, regardless of the alias used to invoke it.

  ### Workaround

  If upgrading isn't immediately possible:
  - Use `ctx.command.data.command.name` for permission validations, or
  - Include all command aliases in your permission logic.

  ### References
  - [CommandKit repository](https://github.com/underctrl-io/commandkit)
severities:
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0141'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01439'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00535'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00532'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00531'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00689'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00688'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.0069'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00687'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00684'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00685'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-fhwm-pc6r-4h2f
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://github.com/underctrl-io/commandkit
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/underctrl-io/commandkit
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://github.com/underctrl-io/commandkit/commit/440385a3e5de3fa3d2a76d23a807995cb29602fd
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/underctrl-io/commandkit/commit/440385a3e5de3fa3d2a76d23a807995cb29602fd
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://github.com/underctrl-io/commandkit/security/advisories/GHSA-fhwm-pc6r-4h2f
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/underctrl-io/commandkit/security/advisories/GHSA-fhwm-pc6r-4h2f
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/underctrl-io/commandkit/security/advisories/GHSA-fhwm-pc6r-4h2f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-15T17:13:11Z/
    published_at: None
    url: https://github.com/underctrl-io/commandkit/security/advisories/GHSA-fhwm-pc6r-4h2f
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-62378
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-62378
weaknesses:
  - CWE-706
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-62378
    reference_type:
    reference_id:
  - url: https://github.com/underctrl-io/commandkit
    reference_type:
    reference_id:
  - url: https://github.com/underctrl-io/commandkit/commit/440385a3e5de3fa3d2a76d23a807995cb29602fd
    reference_type:
    reference_id:
  - url: https://github.com/underctrl-io/commandkit/security/advisories/GHSA-fhwm-pc6r-4h2f
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-62378
    reference_type:
    reference_id: CVE-2025-62378
  - url: https://github.com/advisories/GHSA-fhwm-pc6r-4h2f
    reference_type:
    reference_id: GHSA-fhwm-pc6r-4h2f
