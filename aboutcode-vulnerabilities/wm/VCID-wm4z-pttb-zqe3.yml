vulnerability_id: VCID-wm4z-pttb-zqe3
aliases:
  - CVE-2023-53105
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/mlx5e: Fix cleanup null-ptr deref on encap lock

  During module is unloaded while a peer tc flow is still offloaded,
  first the peer uplink rep profile is changed to a nic profile, and so
  neigh encap lock is destroyed. Next during unload, the VF reps netdevs
  are unregistered which causes the original non-peer tc flow to be deleted,
  which deletes the peer flow. The peer flow deletion detaches the encap
  entry and try to take the already destroyed encap lock, causing the
  below trace.

  Fix this by clearing peer flows during tc eswitch cleanup
  (mlx5e_tc_esw_cleanup()).

  Relevant trace:
  [ 4316.837128] BUG: kernel NULL pointer dereference, address: 00000000000001d8
  [ 4316.842239] RIP: 0010:__mutex_lock+0xb5/0xc40
  [ 4316.851897] Call Trace:
  [ 4316.852481]  <TASK>
  [ 4316.857214]  mlx5e_rep_neigh_entry_release+0x93/0x790 [mlx5_core]
  [ 4316.858258]  mlx5e_rep_encap_entry_detach+0xa7/0xf0 [mlx5_core]
  [ 4316.859134]  mlx5e_encap_dealloc+0xa3/0xf0 [mlx5_core]
  [ 4316.859867]  clean_encap_dests.part.0+0x5c/0xe0 [mlx5_core]
  [ 4316.860605]  mlx5e_tc_del_fdb_flow+0x32a/0x810 [mlx5_core]
  [ 4316.862609]  __mlx5e_tc_del_fdb_peer_flow+0x1a2/0x250 [mlx5_core]
  [ 4316.863394]  mlx5e_tc_del_flow+0x(/0x630 [mlx5_core]
  [ 4316.864090]  mlx5e_flow_put+0x5f/0x100 [mlx5_core]
  [ 4316.864771]  mlx5e_delete_flower+0x4de/0xa40 [mlx5_core]
  [ 4316.865486]  tc_setup_cb_reoffload+0x20/0x80
  [ 4316.865905]  fl_reoffload+0x47c/0x510 [cls_flower]
  [ 4316.869181]  tcf_block_playback_offloads+0x91/0x1d0
  [ 4316.869649]  tcf_block_unbind+0xe7/0x1b0
  [ 4316.870049]  tcf_block_offload_cmd.isra.0+0x1ee/0x270
  [ 4316.879266]  tcf_block_offload_unbind+0x61/0xa0
  [ 4316.879711]  __tcf_block_put+0xa4/0x310
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53105.json
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01763'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01741'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02508'
    published_at: '2025-05-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02633'
    published_at: '2025-05-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02559'
    published_at: '2025-05-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02526'
    published_at: '2025-05-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02513'
    published_at: '2025-05-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03917'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03882'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03918'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.04022'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0399'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03987'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0381'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.04005'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04296'
    published_at: '2025-05-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04298'
    published_at: '2025-05-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04277'
    published_at: '2025-05-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04289'
    published_at: '2025-05-31 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04384'
    published_at: '2025-06-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04366'
    published_at: '2025-06-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04292'
    published_at: '2025-05-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04324'
    published_at: '2025-05-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04315'
    published_at: '2025-05-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04301'
    published_at: '2025-05-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.043'
    published_at: '2025-05-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04317'
    published_at: '2025-05-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04329'
    published_at: '2025-05-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04375'
    published_at: '2025-05-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0437'
    published_at: '2025-05-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04421'
    published_at: '2025-05-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04387'
    published_at: '2025-05-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04341'
    published_at: '2025-05-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04349'
    published_at: '2025-05-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04327'
    published_at: '2025-05-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04304'
    published_at: '2025-05-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04297'
    published_at: '2025-05-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0503'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05017'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05054'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05071'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05081'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04778'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04818'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04806'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04735'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04761'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04803'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04792'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04787'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05098'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05111'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04855'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0486'
    published_at: '2025-06-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05122'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05018'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05003'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0499'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04999'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05012'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0498'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05129'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05158'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05154'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05116'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05112'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05117'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05036'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0503'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04939'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04977'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04989'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04988'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05024'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08052'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0788'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07893'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07824'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07862'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07822'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07784'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07673'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07698'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07595'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0757'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07588'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53105.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53105
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-53105
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/01fdaea410787fe372daeaeda93a29ed0606d334
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b7350f8dbe0c2a1d4d3ad7c35b610abd3cb91750
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c9668f0b1d28570327dbba189f2c61f6f9e43ae7
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2363776
    reference_type:
    reference_id: 2363776
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53105
    reference_type:
    reference_id: CVE-2023-53105
  - url: https://access.redhat.com/errata/RHSA-2023:7077
    reference_type:
    reference_id: RHSA-2023:7077
