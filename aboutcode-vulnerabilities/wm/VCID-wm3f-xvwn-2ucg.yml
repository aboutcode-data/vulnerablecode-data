vulnerability_id: VCID-wm3f-xvwn-2ucg
aliases:
  - CVE-2023-53989
summary: "In the Linux kernel, the following vulnerability has been resolved:  arm64: mm: fix\
  \ VA-range sanity check  Both create_mapping_noalloc() and update_mapping_prot() sanity-check\
  \ their 'virt' parameter, but the check itself doesn't make much sense. The condition used\
  \ today appears to be a historical accident.  The sanity-check condition:  \tif ((virt >=\
  \ PAGE_END) && (virt < VMALLOC_START)) { \t\t[ ... warning here ... ] \t\treturn; \t}  ...\
  \ can only be true for the KASAN shadow region or the module region, and there's no reason\
  \ to exclude these specifically for creating and updateing mappings.  When arm64 support was\
  \ first upstreamed in commit:    c1cc1552616d0f35 (\"arm64: MMU initialisation\")  ... the\
  \ condition was:  \tif (virt < VMALLOC_START) { \t\t[ ... warning here ... ] \t\treturn; \t\
  }  At the time, VMALLOC_START was the lowest kernel address, and this was checking whether\
  \ 'virt' would be translated via TTBR1.  Subsequently in commit:    14c127c957c1c607 (\"arm64:\
  \ mm: Flip kernel VA space\")  ... the condition was changed to:  \tif ((virt >= VA_START)\
  \ && (virt < VMALLOC_START)) { \t\t[ ... warning here ... ] \t\treturn; \t}  This appear to\
  \ have been a thinko. The commit moved the linear map to the bottom of the kernel address\
  \ space, with VMALLOC_START being at the halfway point. The old condition would warn for changes\
  \ to the linear map below this, and at the time VA_START was the end of the linear map.  Subsequently\
  \ we cleaned up the naming of VA_START in commit:    77ad4ce69321abbe (\"arm64: memory: rename\
  \ VA_START to PAGE_END\")  ... keeping the erroneous condition as:  \tif ((virt >= PAGE_END)\
  \ && (virt < VMALLOC_START)) { \t\t[ ... warning here ... ] \t\treturn; \t}  Correct the condition\
  \ to check against the start of the TTBR1 address space, which is currently PAGE_OFFSET. This\
  \ simplifies the logic, and more clearly matches the \"outside kernel range\" message in the\
  \ warning."
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53989.json
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05723'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53989
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05699'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53989
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53989.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53989
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-53989
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2424933
    reference_type:
    reference_id: 2424933
