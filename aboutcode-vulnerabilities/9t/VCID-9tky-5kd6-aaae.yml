vulnerability_id: VCID-9tky-5kd6-aaae
aliases:
  - CVE-2024-4030
summary: |
  On Windows a directory returned by tempfile.mkdtemp() would not always have permissions set to restrict reading and writing to the temporary directory by other users, instead usually inheriting the correct permissions from the default location. Alternate configurations or users without a profile directory may not have the intended permissions.

  If you’re not using Windows or haven’t changed the temporary directory location then you aren’t affected by this vulnerability. On other platforms the returned directory is consistently readable and writable only by the current user.

  This issue was caused by Python not supporting Unix permissions on Windows. The fix adds support for Unix “700” for the mkdir function on Windows which is used by mkdtemp() to ensure the newly created directory has the proper permissions.
severities:
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0145'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01467'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01472'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01478'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01461'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0146'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0147'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01477'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01487'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0148'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01484'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01495'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01476'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18893'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18895'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19177'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19059'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18414'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18512'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18548'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18637'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18630'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18648'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18686'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18749'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18115'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19133'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19237'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18916'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12308'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12287'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12265'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12205'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12321'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12291'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12279'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12273'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12276'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.123'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12263'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.1223'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12226'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.1206'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12098'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.19446'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-276
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-4030
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/35c799d79177b962ddace2fa068101465570a29a
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/5130731c9e779b97d00a24f54cdce73ce9975dfd
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/66f8bb76a15e64a1bb7688b177ed29e26230fdee
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/6d0850c4c8188035643586ab4d8ec2468abd699e
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/81939dad77001556c527485d31a2d0f4a759033e
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/8ed546679524140d8282175411fd141fe7df070d
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/91e3669e01245185569d09e9e6e11641282971ee
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/94591dca510c796c7d40e9b4167ea56f2fdf28ca
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/c8f868dc52f98011d0f9b459b6487920bfb0ac4d
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/d86b49411753bf2c83291e3a14ae43fefded2f84
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/e1dfa978b1ad210d551385ad8073ec6154f53763
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/commit/eb29e2f5905da93333d1ce78bc98b151e763ff46
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/issues/118486
    reference_type:
    reference_id:
  - url: https://mail.python.org/archives/list/security-announce@python.org/thread/PRGS5OR3N3PNPT4BMV2VAGN5GMUI5636/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240705-0005/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-4030
    reference_type:
    reference_id: CVE-2024-4030
