vulnerability_id: VCID-kf84-g3t6-ckhq
aliases:
  - CVE-2023-53070
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ACPI: PPTT: Fix to avoid sleep in the atomic context when PPTT is absent

  Commit 0c80f9e165f8 ("ACPI: PPTT: Leave the table mapped for the runtime usage")
  enabled to map PPTT once on the first invocation of acpi_get_pptt() and
  never unmapped the same allowing it to be used at runtime with out the
  hassle of mapping and unmapping the table. This was needed to fetch LLC
  information from the PPTT in the cpuhotplug path which is executed in
  the atomic context as the acpi_get_table() might sleep waiting for a
  mutex.

  However it missed to handle the case when there is no PPTT on the system
  which results in acpi_get_pptt() being called from all the secondary
  CPUs attempting to fetch the LLC information in the atomic context
  without knowing the absence of PPTT resulting in the splat like below:

   | BUG: sleeping function called from invalid context at kernel/locking/semaphore.c:164
   | in_atomic(): 1, irqs_disabled(): 1, non_block: 0, pid: 0, name: swapper/1
   | preempt_count: 1, expected: 0
   | RCU nest depth: 0, expected: 0
   | no locks held by swapper/1/0.
   | irq event stamp: 0
   | hardirqs last  enabled at (0): 0x0
   | hardirqs last disabled at (0): copy_process+0x61c/0x1b40
   | softirqs last  enabled at (0): copy_process+0x61c/0x1b40
   | softirqs last disabled at (0): 0x0
   | CPU: 1 PID: 0 Comm: swapper/1 Not tainted 6.3.0-rc1 #1
   | Call trace:
   |  dump_backtrace+0xac/0x138
   |  show_stack+0x30/0x48
   |  dump_stack_lvl+0x60/0xb0
   |  dump_stack+0x18/0x28
   |  __might_resched+0x160/0x270
   |  __might_sleep+0x58/0xb0
   |  down_timeout+0x34/0x98
   |  acpi_os_wait_semaphore+0x7c/0xc0
   |  acpi_ut_acquire_mutex+0x58/0x108
   |  acpi_get_table+0x40/0xe8
   |  acpi_get_pptt+0x48/0xa0
   |  acpi_get_cache_info+0x38/0x140
   |  init_cache_level+0xf4/0x118
   |  detect_cache_attributes+0x2e4/0x640
   |  update_siblings_masks+0x3c/0x330
   |  store_cpu_topology+0x88/0xf0
   |  secondary_start_kernel+0xd0/0x168
   |  __secondary_switched+0xb8/0xc0

  Update acpi_get_pptt() to consider the fact that PPTT is once checked and
  is not available on the system and return NULL avoiding any attempts to
  fetch PPTT and thereby avoiding any possible sleep waiting for a mutex
  in the atomic context.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53070.json
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01763'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01741'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02508'
    published_at: '2025-05-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02633'
    published_at: '2025-05-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02559'
    published_at: '2025-05-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02526'
    published_at: '2025-05-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02513'
    published_at: '2025-05-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03917'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03882'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03918'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.04022'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0399'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03987'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0381'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.04005'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04296'
    published_at: '2025-05-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04298'
    published_at: '2025-05-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04277'
    published_at: '2025-05-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04289'
    published_at: '2025-05-31 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04384'
    published_at: '2025-06-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04366'
    published_at: '2025-06-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04292'
    published_at: '2025-05-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04324'
    published_at: '2025-05-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04315'
    published_at: '2025-05-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04301'
    published_at: '2025-05-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.043'
    published_at: '2025-05-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04317'
    published_at: '2025-05-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04329'
    published_at: '2025-05-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04375'
    published_at: '2025-05-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0437'
    published_at: '2025-05-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04421'
    published_at: '2025-05-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04387'
    published_at: '2025-05-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04341'
    published_at: '2025-05-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04349'
    published_at: '2025-05-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04327'
    published_at: '2025-05-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04304'
    published_at: '2025-05-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04297'
    published_at: '2025-05-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0503'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05017'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05054'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05071'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05081'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04778'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04818'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04806'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04735'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04761'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04803'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04792'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04787'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05098'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05111'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04855'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0486'
    published_at: '2025-06-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05122'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05018'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05003'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0499'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04999'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05012'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0498'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05129'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05158'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05154'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05116'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05112'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05117'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05036'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0503'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04939'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04977'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04989'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04988'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05024'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08052'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0788'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07893'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07824'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07862'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07822'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07784'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07673'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07698'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07595'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0757'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07588'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-252
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53070.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53070
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1318a07706bb2f8c65f88f39a16c2b5260bcdcd4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/91d7b60a65d9f71230ea09b86d2058a884a3c2af
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e0c1106d51b9abc8eae03c5522b20649b6a55f6e
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2363685
    reference_type:
    reference_id: 2363685
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53070
    reference_type:
    reference_id: CVE-2023-53070
  - url: https://access.redhat.com/errata/RHSA-2024:3138
    reference_type:
    reference_id: RHSA-2024:3138
