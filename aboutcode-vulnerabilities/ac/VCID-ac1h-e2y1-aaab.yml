vulnerability_id: VCID-ac1h-e2y1-aaab
aliases:
  - CVE-2024-36950
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  firewire: ohci: mask bus reset interrupts between ISR and bottom half

  In the FireWire OHCI interrupt handler, if a bus reset interrupt has
  occurred, mask bus reset interrupts until bus_reset_work has serviced and
  cleared the interrupt.

  Normally, we always leave bus reset interrupts masked. We infer the bus
  reset from the self-ID interrupt that happens shortly thereafter. A
  scenario where we unmask bus reset interrupts was introduced in 2008 in
  a007bb857e0b26f5d8b73c2ff90782d9c0972620: If
  OHCI_PARAM_DEBUG_BUSRESETS (8) is set in the debug parameter bitmask, we
  will unmask bus reset interrupts so we can log them.

  irq_handler logs the bus reset interrupt. However, we can't clear the bus
  reset event flag in irq_handler, because we won't service the event until
  later. irq_handler exits with the event flag still set. If the
  corresponding interrupt is still unmasked, the first bus reset will
  usually freeze the system due to irq_handler being called again each
  time it exits. This freeze can be reproduced by loading firewire_ohci
  with "modprobe firewire_ohci debug=-1" (to enable all debugging output).
  Apparently there are also some cases where bus_reset_work will get called
  soon enough to clear the event, and operation will continue normally.

  This freeze was first reported a few months after a007bb85 was committed,
  but until now it was never fixed. The debug level could safely be set
  to -1 through sysfs after the module was loaded, but this would be
  ineffectual in logging bus reset interrupts since they were only
  unmasked during initialization.

  irq_handler will now leave the event flag set but mask bus reset
  interrupts, so irq_handler won't be called again and there will be no
  freeze. If OHCI_PARAM_DEBUG_BUSRESETS is enabled, bus_reset_work will
  unmask the interrupt after servicing the event, so future interrupts
  will be caught as desired.

  As a side effect to this change, OHCI_PARAM_DEBUG_BUSRESETS can now be
  enabled through sysfs in addition to during initial module loading.
  However, when enabled through sysfs, logging of bus reset interrupts will
  be effective only starting with the second bus reset, after
  bus_reset_work has executed.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-36950.json
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14083'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14371'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15080'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14767'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14726'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14714'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15128'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15033'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14976'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14691'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14461'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14482'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14548'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14541'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14611'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14556'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.56028'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.55941'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.55882'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.55983'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.55987'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.5601'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.55995'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.56012'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.56033'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.5605'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.56057'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.56041'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.56027'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.0037'
    scoring_system: epss
    scoring_elements: '0.56015'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58972'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.5894'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58941'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58943'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58958'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58956'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58949'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58953'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58864'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58902'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58946'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.00389'
    scoring_system: epss
    scoring_elements: '0.58987'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '0.01141'
    scoring_system: epss
    scoring_elements: '0.65416'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-04T15:34:28Z/
    published_at: None
    url: https://git.kernel.org/stable/c/31279bbca40d2f40cb3bbb6d538ec9620a645dec
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-04T15:34:28Z/
    published_at: None
    url: https://git.kernel.org/stable/c/4f9cc355c328fc4f41cbd9c4cd58b235184fa420
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-04T15:34:28Z/
    published_at: None
    url: https://git.kernel.org/stable/c/5982887de60c1b84f9c0ca07c835814d07fd1da0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-04T15:34:28Z/
    published_at: None
    url: https://git.kernel.org/stable/c/6fafe3661712b143d9c69a7322294bd53f559d5d
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-04T15:34:28Z/
    published_at: None
    url: https://git.kernel.org/stable/c/752e3c53de0fa3b7d817a83050b6699b8e9c6ec9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-04T15:34:28Z/
    published_at: None
    url: https://git.kernel.org/stable/c/8643332aac0576581cfdf01798ea3e4e0d624b61
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-04T15:34:28Z/
    published_at: None
    url: https://git.kernel.org/stable/c/b3948c69d60279fce5b2eeda92a07d66296c8130
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-06-04T15:34:28Z/
    published_at: None
    url: https://git.kernel.org/stable/c/fa273f312334246c909475c5868e6daab889cc8c
weaknesses:
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-36950.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-36950
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48655
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52585
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52882
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26900
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27398
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27399
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27401
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-35848
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-35947
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36017
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36031
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36883
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36886
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36889
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36902
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36904
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36905
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36916
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36919
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36929
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36933
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36934
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36939
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36940
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36941
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36946
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36950
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36953
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36954
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36957
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36959
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/31279bbca40d2f40cb3bbb6d538ec9620a645dec
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4f9cc355c328fc4f41cbd9c4cd58b235184fa420
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5982887de60c1b84f9c0ca07c835814d07fd1da0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6fafe3661712b143d9c69a7322294bd53f559d5d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/752e3c53de0fa3b7d817a83050b6699b8e9c6ec9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8643332aac0576581cfdf01798ea3e4e0d624b61
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b3948c69d60279fce5b2eeda92a07d66296c8130
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fa273f312334246c909475c5868e6daab889cc8c
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00019.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2284625
    reference_type:
    reference_id: 2284625
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-36950
    reference_type:
    reference_id: CVE-2024-36950
  - url: https://access.redhat.com/errata/RHSA-2024:5101
    reference_type:
    reference_id: RHSA-2024:5101
  - url: https://access.redhat.com/errata/RHSA-2024:5102
    reference_type:
    reference_id: RHSA-2024:5102
  - url: https://usn.ubuntu.com/6949-1/
    reference_type:
    reference_id: USN-6949-1
  - url: https://usn.ubuntu.com/6949-2/
    reference_type:
    reference_id: USN-6949-2
  - url: https://usn.ubuntu.com/6950-1/
    reference_type:
    reference_id: USN-6950-1
  - url: https://usn.ubuntu.com/6950-2/
    reference_type:
    reference_id: USN-6950-2
  - url: https://usn.ubuntu.com/6950-3/
    reference_type:
    reference_id: USN-6950-3
  - url: https://usn.ubuntu.com/6950-4/
    reference_type:
    reference_id: USN-6950-4
  - url: https://usn.ubuntu.com/6951-1/
    reference_type:
    reference_id: USN-6951-1
  - url: https://usn.ubuntu.com/6951-2/
    reference_type:
    reference_id: USN-6951-2
  - url: https://usn.ubuntu.com/6951-3/
    reference_type:
    reference_id: USN-6951-3
  - url: https://usn.ubuntu.com/6951-4/
    reference_type:
    reference_id: USN-6951-4
  - url: https://usn.ubuntu.com/6952-1/
    reference_type:
    reference_id: USN-6952-1
  - url: https://usn.ubuntu.com/6952-2/
    reference_type:
    reference_id: USN-6952-2
  - url: https://usn.ubuntu.com/6953-1/
    reference_type:
    reference_id: USN-6953-1
  - url: https://usn.ubuntu.com/6955-1/
    reference_type:
    reference_id: USN-6955-1
  - url: https://usn.ubuntu.com/6956-1/
    reference_type:
    reference_id: USN-6956-1
  - url: https://usn.ubuntu.com/6957-1/
    reference_type:
    reference_id: USN-6957-1
  - url: https://usn.ubuntu.com/6979-1/
    reference_type:
    reference_id: USN-6979-1
  - url: https://usn.ubuntu.com/7019-1/
    reference_type:
    reference_id: USN-7019-1
