vulnerability_id: VCID-mm7v-zmwc-aaar
aliases:
  - CVE-2023-31038
summary: "SQL injection in Log4cxx when using the ODBC appender to send log messages to a database. \
  \ No fields sent to the database were properly escaped for SQL injection.  This has been the\
  \ case since at least version 0.9.0(released 2003-08-06)\n\n\n\n\nNote that Log4cxx is a C++\
  \ framework, so only C++ applications are affected.\n\nBefore version 1.1.0, the ODBC appender\
  \ was automatically part of Log4cxx if the library was found when compiling the library. \
  \ As of version 1.1.0, this must be both explicitly enabled in order to be compiled in.\n\n\
  \n\n\nThree preconditions must be met for this vulnerability to be possible:\n\n1. Log4cxx\
  \ compiled with ODBC support(before version 1.1.0, this was auto-detected at compile time)\n\
  \n2. ODBCAppender enabled for logging messages to, generally done via a config file\n\n3.\
  \ User input is logged at some point. If your application does not have user input, it is\
  \ unlikely to be affected.\n\n\n\n\n\nUsers are recommended to upgrade to version 1.1.0 which\
  \ properly binds the parameters to the SQL statement, or migrate to the new DBAppender class\
  \ which supports an ODBC connection in addition to other databases. \nNote that this fix does\
  \ require a configuration file update, as the old configuration files will not configure properly. \
  \ An example is shown below, and more information may be found in the Log4cxx documentation\
  \ on the ODBCAppender.\n\n\n\n\n\nExample of old configuration snippet:\n\n<appender name=\"\
  SqlODBCAppender\" class=\"ODBCAppender\">\n\n    <param name=\"sql\" value=\"INSERT INTO logs\
  \ (message) VALUES ('%m')\" />\n\n    ... other params here ...\n\n</appender>\n\n\n\n\nThe\
  \ migrated configuration snippet with new ColumnMapping parameters:\n\n\n<appender name=\"\
  SqlODBCAppender\" class=\"ODBCAppender\">\n\n\n\n\n    <param name=\"sql\" value=\"INSERT\
  \ INTO logs (message) VALUES (?)\" />\n\n    <param name=\"ColumnMapping\" value=\"message\"\
  />\n    ... other params here ...\n\n\n</appender>\n\n\n\n\n\n"
severities:
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-31038.json
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.49054'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.49330'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.49404'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.49426'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.49500'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.49486'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.49493'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.54026'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53832'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53858'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53999'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.54075'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00254'
    scoring_system: epss
    scoring_elements: '0.64425'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00254'
    scoring_system: epss
    scoring_elements: '0.64401'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00254'
    scoring_system: epss
    scoring_elements: '0.64419'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00254'
    scoring_system: epss
    scoring_elements: '0.64648'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64528'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64454'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64488'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64522'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64548'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64554'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64518'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64525'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64527'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64536'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.00498'
    scoring_system: epss
    scoring_elements: '0.64546'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83315'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83331'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83341'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83349'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83339'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83344'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83336'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.8332'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83312'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83318'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83246'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83241'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83289'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83291'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.02289'
    scoring_system: epss
    scoring_elements: '0.83313'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '0.07277'
    scoring_system: epss
    scoring_elements: '0.85775'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31038
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31038
weaknesses:
  - CWE-89
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-31038.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-31038
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31038
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/vgjlpdf353vv91gryspwxrzj6p0fbjd9
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2196727
    reference_type:
    reference_id: 2196727
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:log4cxx:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:log4cxx:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-31038
    reference_type:
    reference_id: CVE-2023-31038
