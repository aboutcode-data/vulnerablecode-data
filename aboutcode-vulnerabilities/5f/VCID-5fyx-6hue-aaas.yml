vulnerability_id: VCID-5fyx-6hue-aaas
aliases:
  - GHSA-5h5v-m596-r6rf
summary: |
  TYPO3 Possible Insecure Deserialization in Extbase Request Handling
  It has been discovered that request handling in Extbase can be vulnerable to insecure deserialization. User submitted payload has to be signed with a corresponding HMAC-SHA1 using the sensitive TYPO3 encryptionKey as secret - invalid or unsigned payload is not deserialized.

  However, since sensitive information could have been leaked by accident (e.g. in repositories or in commonly known and unprotected backup files), there is the possibility that attackers know the private encryptionKey and are able to calculate the required HMAC-SHA1 to allow a malicious payload to be deserialized.

  Requirements for successfully exploiting this vulnerability (all of the following):

  - rendering at least one Extbase plugin in the frontend
  - encryptionKey has been leaked (from LocalConfiguration.php or corresponding .env file)
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5h5v-m596-r6rf
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms-core/2019-12-17-7.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms-core/2019-12-17-7.yaml
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/TYPO3-CMS/core
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/TYPO3-CMS/core
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://typo3.org/security/advisory/typo3-psa-2019-011
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://typo3.org/security/advisory/typo3-psa-2019-011
weaknesses:
  - CWE-502
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms-core/2019-12-17-7.yaml
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3-CMS/core
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-psa-2019-011
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5h5v-m596-r6rf
    reference_type:
    reference_id: GHSA-5h5v-m596-r6rf
