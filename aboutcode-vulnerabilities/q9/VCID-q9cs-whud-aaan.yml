vulnerability_id: VCID-q9cs-whud-aaan
aliases:
  - GHSA-47xh-qxqv-mgvg
summary: |
  kube-httpcache is vulnerable to Cross-Site Request Forgery (CSRF)
  ### Impact

  > A request forgery attack can be performed on Varnish Cache servers that have the HTTP/2 protocol turned on. An attacker may introduce characters through the HTTP/2 pseudo-headers that are invalid in the context of an HTTP/1 request line, causing the Varnish server to produce invalid HTTP/1 requests to the backend. This may in turn be used to successfully exploit vulnerabilities in a server behind the Varnish server.
  > -- https://varnish-cache.org/security/VSV00011.html#vsv00011

  ### Patches

  This is fixed in Varnish 6.0.11; Varnish 6.0.11 is available in `kube-httpcache` versions v0.7.1 and later.

  ### Workarounds

  See [upstream mitigation hints](https://varnish-cache.org/security/VSV00011.html#mitigation).

  ### References

  - https://varnish-cache.org/security/VSV00011.html#vsv00011
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mittwald/kube-httpcache
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mittwald/kube-httpcache/security/advisories/GHSA-47xh-qxqv-mgvg
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://varnish-cache.org/security/VSV00011.html#vsv00011
weaknesses:
  - CWE-352
references:
  - url: https://github.com/mittwald/kube-httpcache
    reference_type:
    reference_id:
  - url: https://github.com/mittwald/kube-httpcache/security/advisories/GHSA-47xh-qxqv-mgvg
    reference_type:
    reference_id:
  - url: https://varnish-cache.org/security/VSV00011.html#vsv00011
    reference_type:
    reference_id:
