vulnerability_id: VCID-r1k3-z7et-aaam
aliases:
  - CVE-2023-40177
  - GHSA-5mf8-v43w-mfxp
summary: XWiki Platform is a generic wiki platform offering runtime services for applications
  built on top of it. Any registered user can use the content field of their user profile page
  to execute arbitrary scripts with programming rights, thus effectively performing rights escalation.
  This issue is present since version 4.3M2 when AppWithinMinutes Application added support
  for the Content field, allowing any wiki page (including the user profile page) to use its
  content as an AWM Content field, which has a custom displayer that executes the content with
  the rights of the ``AppWithinMinutes.Content`` author, rather than the rights of the content
  author. The vulnerability has been fixed in XWiki 14.10.5 and 15.1RC1. The fix is in the content
  of the AppWithinMinutes.Content page that defines the custom displayer. By using the ``display``
  script service to render the content we make sure that the proper author is used for access
  rights checks.
severities:
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.44062'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.44397'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.44067'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.44089'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.45335'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.45412'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.44660'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.44901'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.44987'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.45006'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.45085'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.45088'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.45077'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.45103'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.45130'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.45307'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.83093'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.83138'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.83139'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.83135'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.83142'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.83141'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.8315'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.8314'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.83131'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.83106'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.02113'
    scoring_system: epss
    scoring_elements: '0.83127'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.26328'
    scoring_system: epss
    scoring_elements: '0.94054'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.97418'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.9741'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.97415'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.97419'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.97424'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.97421'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.97425'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.97428'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.9743'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.97431'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: '0.46523'
    scoring_system: epss
    scoring_elements: '0.97434'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5mf8-v43w-mfxp
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/dfb1cde173e363ca5c12eb3654869f9719820262
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/dfb1cde173e363ca5c12eb3654869f9719820262
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5mf8-v43w-mfxp
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5mf8-v43w-mfxp
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5mf8-v43w-mfxp
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-7369
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-7369
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40177
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40177
weaknesses:
  - CWE-94
  - CWE-937
  - CWE-1035
  - CWE-95
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-40177
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/dfb1cde173e363ca5c12eb3654869f9719820262
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5mf8-v43w-mfxp
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-7369
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:15.0:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:15.0:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:15.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:15.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:4.3:milestone2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:4.3:milestone2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-40177
    reference_type:
    reference_id: CVE-2023-40177
  - url: https://github.com/advisories/GHSA-5mf8-v43w-mfxp
    reference_type:
    reference_id: GHSA-5mf8-v43w-mfxp
