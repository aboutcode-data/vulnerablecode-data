vulnerability_id: VCID-a3mf-18bc-4uh4
aliases:
  - CVE-2024-49758
  - GHSA-c86q-rj37-8f85
summary: |
  LibreNMS has a stored XSS in ExamplePlugin with Device's Notes
  ### Summary

  The application fail to sanitising inputs properly and rendering the code from user input to browser which allow an attacker to execute malicious javascript code.

  ### Details

  User with Admin role can add Notes to a device, the application did not properly sanitize the user input, when the ExamplePlugin enable, if java script code is inside the device's Notes, its will be trigger.

  ### PoC

  1. As an admin user, enable the ExamplePlugin.

  ![image](https://github.com/user-attachments/assets/409f3a0c-7fac-46e3-8140-84749a120dd9)

  2. Add the payload `<img src="x" onerror="alert(document.cookie)">` into the device Notes

  ![image](https://github.com/user-attachments/assets/c2a57dbd-ea07-4166-8b29-61be6ad6c2b6)

  3. Once visit the Overview of the Device, a pop-up will show up.

  ![image](https://github.com/user-attachments/assets/3c9b87c3-d010-49e7-bd13-4a715db4e0c3)

  ### Impact

  It could allow authenticated users to execute arbitrary JavaScript code in the context of other users' sessions.
  Impacted users could have their accounts compromised, enabling the attacker to perform unauthorized actions on their behalf.
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15638'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15610'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16010'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15917'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15865'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15605'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15531'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15487'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15477'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15486'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15421'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15934'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: 1e-05
    scoring_system: epss
    scoring_elements: 4e-05
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: 1e-05
    scoring_system: epss
    scoring_elements: 2e-05
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: 2e-05
    scoring_system: epss
    scoring_elements: '0.00052'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: 2e-05
    scoring_system: epss
    scoring_elements: '0.00051'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: 2e-05
    scoring_system: epss
    scoring_elements: '0.00034'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: 3e-05
    scoring_system: epss
    scoring_elements: '0.00065'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-c86q-rj37-8f85
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/librenms/librenms
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms/commit/24b142d753898e273ec20b542a27dd6eb530c7d8
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/librenms/librenms/commit/24b142d753898e273ec20b542a27dd6eb530c7d8
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/commit/24b142d753898e273ec20b542a27dd6eb530c7d8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-11-15T18:51:55Z/
    published_at: None
    url: https://github.com/librenms/librenms/commit/24b142d753898e273ec20b542a27dd6eb530c7d8
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-c86q-rj37-8f85
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-c86q-rj37-8f85
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-c86q-rj37-8f85
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-c86q-rj37-8f85
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-11-15T18:51:55Z/
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-c86q-rj37-8f85
  - score: '4.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49758
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49758
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49758
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49758
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-49758
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/24b142d753898e273ec20b542a27dd6eb530c7d8
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-c86q-rj37-8f85
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49758
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-c86q-rj37-8f85
    reference_type:
    reference_id: GHSA-c86q-rj37-8f85
