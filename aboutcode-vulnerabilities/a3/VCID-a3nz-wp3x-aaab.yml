vulnerability_id: VCID-a3nz-wp3x-aaab
aliases:
  - CVE-2023-40570
  - GHSA-7ch3-7pp7-7cpq
  - PYSEC-0000-CVE-2023-40570
  - PYSEC-2023-154
summary: Datasette is an open source multi-tool for exploring and publishing data. This bug
  affects Datasette instances running a Datasette 1.0 alpha - 1.0a0, 1.0a1, 1.0a2 or 1.0a3 -
  in an online accessible location but with authentication enabled using a plugin such as datasette-auth-passwords.
  The `/-/api` API explorer endpoint could reveal the names of both databases and tables - but
  not their contents - to an unauthenticated user. Datasette 1.0a4 has a fix for this issue.
  This will block access to the API explorer but will still allow access to the Datasette read
  or write JSON APIs, as those use different URL patterns within the Datasette `/database` hierarchy.
  This issue is patched in version 1.0a4.
severities:
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33938'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33962'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33980'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34207'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34262'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34324'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33805'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33831'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33933'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33934'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33390'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33719'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42833'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42855'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42839'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43180'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54582'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54538'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54645'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54657'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54667'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54649'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54643'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54641'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.5463'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54599'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54681'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54668'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.5464'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54622'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66566'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66462'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66444'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66541'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66543'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66559'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66577'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66562'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66571'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66586'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66598'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66612'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66607'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.66599'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.00583'
    scoring_system: epss
    scoring_elements: '0.6658'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: '0.01212'
    scoring_system: epss
    scoring_elements: '0.66383'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-7ch3-7pp7-7cpq
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-7ch3-7pp7-7cpq
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/datasette/PYSEC-2023-154.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/datasette/PYSEC-2023-154.yaml
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/simonw/datasette
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/simonw/datasette
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/simonw/datasette/commit/01e0558825b8f7ec17d3b691aa072daf122fcc74
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/simonw/datasette/commit/01e0558825b8f7ec17d3b691aa072daf122fcc74
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/simonw/datasette/security/advisories/GHSA-7ch3-7pp7-7cpq
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/simonw/datasette/security/advisories/GHSA-7ch3-7pp7-7cpq
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/simonw/datasette/security/advisories/GHSA-7ch3-7pp7-7cpq
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/simonw/datasette/security/advisories/GHSA-7ch3-7pp7-7cpq
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40570
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40570
weaknesses:
  - CWE-213
  - CWE-937
  - CWE-1035
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-40570
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/datasette/PYSEC-2023-154.yaml
    reference_type:
    reference_id:
  - url: https://github.com/simonw/datasette
    reference_type:
    reference_id:
  - url: https://github.com/simonw/datasette/commit/01e0558825b8f7ec17d3b691aa072daf122fcc74
    reference_type:
    reference_id:
  - url: https://github.com/simonw/datasette/security/advisories/GHSA-7ch3-7pp7-7cpq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:datasette:datasette:1.0:alpha0:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:datasette:datasette:1.0:alpha0:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:datasette:datasette:1.0:alpha1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:datasette:datasette:1.0:alpha1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:datasette:datasette:1.0:alpha2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:datasette:datasette:1.0:alpha2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:datasette:datasette:1.0:alpha3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:datasette:datasette:1.0:alpha3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-40570
    reference_type:
    reference_id: CVE-2023-40570
  - url: https://github.com/advisories/GHSA-7ch3-7pp7-7cpq
    reference_type:
    reference_id: GHSA-7ch3-7pp7-7cpq
