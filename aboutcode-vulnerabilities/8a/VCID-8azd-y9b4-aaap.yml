vulnerability_id: VCID-8azd-y9b4-aaap
aliases:
  - CVE-2022-39389
  - GHSA-hc82-w9v8-83pr
summary: Lightning Network Daemon (lnd) is an implementation of a lightning bitcoin overlay
  network node. All lnd nodes before version `v0.15.4` are vulnerable to a block parsing bug
  that can cause a node to enter a degraded state once encountered. In this degraded state,
  nodes can continue to make payments and forward HTLCs, and close out channels. Opening channels
  is prohibited, and also on chain transaction events will be undetected. This can cause loss
  of funds if a CSV expiry is researched during a breach attempt or a CLTV delta expires forgetting
  the funds in the HTLC. A patch is available in `lnd` version 0.15.4. Users are advised to
  upgrade. Users unable to upgrade may use the `lncli updatechanpolicy` RPC call to increase
  their CLTV value to a very high amount or increase their fee policies. This will prevent nodes
  from routing through your node, meaning that no pending HTLCs can be present.
severities:
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24128'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20364'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20316'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20473'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.2049'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20507'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20508'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20465'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20437'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20455'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20471'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20514'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.2047'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20462'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.20434'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24015'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24073'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24173'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24146'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24134'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24122'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24123'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24135'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24155'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24148'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24139'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.24137'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41331'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41059'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41840'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41765'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41725'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41551'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41542'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41525'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41532'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41441'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.41414'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.21337'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00196'
    scoring_system: epss
    scoring_elements: '0.57559'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00196'
    scoring_system: epss
    scoring_elements: '0.57264'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00196'
    scoring_system: epss
    scoring_elements: '0.57292'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '0.00196'
    scoring_system: epss
    scoring_elements: '0.57285'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/lightningnetwork/lnd
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lightningnetwork/lnd
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/lightningnetwork/lnd/issues/7096
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lightningnetwork/lnd/issues/7096
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:39:14Z/
    published_at: None
    url: https://github.com/lightningnetwork/lnd/issues/7096
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/lightningnetwork/lnd/pull/7098
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lightningnetwork/lnd/pull/7098
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:39:14Z/
    published_at: None
    url: https://github.com/lightningnetwork/lnd/pull/7098
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:39:14Z/
    published_at: None
    url: https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:39:14Z/
    published_at: None
    url: https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39389
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39389
weaknesses:
  - CWE-20
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-39389
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/issues/7096
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/pull/7098
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/releases/tag/v0.15.4-beta
    reference_type:
    reference_id:
  - url: https://github.com/lightningnetwork/lnd/security/advisories/GHSA-hc82-w9v8-83pr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:btcd_project:btcd:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:btcd_project:btcd:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:lightning_network_daemon_project:lightning_network_daemon:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39389
    reference_type:
    reference_id: CVE-2022-39389
