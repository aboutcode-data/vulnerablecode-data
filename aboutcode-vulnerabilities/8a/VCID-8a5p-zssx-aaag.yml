vulnerability_id: VCID-8a5p-zssx-aaag
aliases:
  - CVE-2024-32003
  - GHSA-chcp-g9j5-3xxx
summary: 'wn-dusk-plugin (Dusk plugin) is a plugin which integrates Laravel Dusk browser testing
  into Winter CMS. The Dusk plugin provides some special routes as part of its testing framework
  to allow a browser environment (such as headless Chrome) to act as a user in the Backend or
  User plugin without having to go through authentication. This route is `[[URL]]/_dusk/login/[[USER
  ID]]/[[MANAGER]]` - where `[[URL]]` is the base URL of the site, `[[USER ID]]` is the ID of
  the user account and `[[MANAGER]]` is the authentication manager (either `backend` for Backend,
  or `user` for the User plugin). If a configuration of a site using the Dusk plugin is set
  up in such a way that the Dusk plugin is available publicly and the test cases in Dusk are
  run with live data, this route may potentially be used to gain access to any user account
  in either the Backend or User plugin without authentication. As indicated in the `README`,
  this plugin should only be used in development and should *NOT* be used in a production instance.
  It is specifically recommended that the plugin be installed as a development dependency only
  in Composer. In order to remediate this issue, the special routes used above will now no longer
  be registered unless the `APP_ENV` environment variable is specifically set to `dusk`. Since
  Winter by default does not use this environment variable and it is not populated by default,
  it will only exist if Dusk''s automatic configuration is used (which won''t exhibit this vulnerability)
  or if a developer manually specifies it in their configuration. The automatic configuration
  performed by the Dusk plugin has also been hardened by default to use sane defaults and not
  allow external environment variables to leak into this configuration. This will only affect
  users in which the Winter CMS installation meets ALL the following criteria: 1. The Dusk plugin
  is installed in the Winter CMS instance. 2. The application is in production mode (ie. the
  `debug` config value is set to `true` in `config/app.php`). 3. The Dusk plugin''s automatic
  configuration has been overridden, either by providing a custom `.env.dusk` file or by providing
  custom configuration in the `config/dusk` folder, or by providing configuration environment
  variables externally. 4. The environment has been configured to use production data in the
  database for testing, and not the temporary SQLite database that Dusk uses by default. 5.
  The application is connectable via the web. This issue has been fixed in version 2.1.0. Users
  are advised to upgrade.'
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17752'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14691'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14647'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17546'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17618'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17711'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17788'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17783'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17764'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17725'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17718'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.1773'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.1774'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17762'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17763'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17757'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14677'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14688'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14707'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14745'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14746'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14716'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.0033'
    scoring_system: epss
    scoring_elements: '0.52922'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.0033'
    scoring_system: epss
    scoring_elements: '0.53042'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.0033'
    scoring_system: epss
    scoring_elements: '0.5307'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.0033'
    scoring_system: epss
    scoring_elements: '0.53046'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.0033'
    scoring_system: epss
    scoring_elements: '0.53024'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.0033'
    scoring_system: epss
    scoring_elements: '0.53017'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.0033'
    scoring_system: epss
    scoring_elements: '0.52937'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: '0.00641'
    scoring_system: epss
    scoring_elements: '0.54375'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-chcp-g9j5-3xxx
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/wintercms/wn-dusk-plugin
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wintercms/wn-dusk-plugin
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/wintercms/wn-dusk-plugin/blob/main/README.md
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wintercms/wn-dusk-plugin/blob/main/README.md
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/wintercms/wn-dusk-plugin/security/advisories/GHSA-chcp-g9j5-3xxx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wintercms/wn-dusk-plugin/security/advisories/GHSA-chcp-g9j5-3xxx
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-863
  - CWE-269
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-32003
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/wn-dusk-plugin
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/wn-dusk-plugin/blob/main/README.md
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/wn-dusk-plugin/security/advisories/GHSA-chcp-g9j5-3xxx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32003
    reference_type:
    reference_id: CVE-2024-32003
  - url: https://github.com/advisories/GHSA-chcp-g9j5-3xxx
    reference_type:
    reference_id: GHSA-chcp-g9j5-3xxx
