vulnerability_id: VCID-uddt-fn57-aaac
aliases:
  - CVE-2022-35924
  - GHSA-xv97-c62v-4587
summary: 'NextAuth.js is a complete open source authentication solution for Next.js applications.
  `next-auth` users who are using the `EmailProvider` either in versions before `4.10.3` or
  `3.29.10` are affected. If an attacker could forge a request that sent a comma-separated list
  of emails (eg.: `attacker@attacker.com,victim@victim.com`) to the sign-in endpoint, NextAuth.js
  would send emails to both the attacker and the victim''s e-mail addresses. The attacker could
  then login as a newly created user with the email being `attacker@attacker.com,victim@victim.com`.
  This means that basic authorization like `email.endsWith("@victim.com")` in the `signIn` callback
  would fail to communicate a threat to the developer and would let the attacker bypass authorization,
  even with an `@attacker.com` address. This vulnerability has been patched in `v4.10.3` and
  `v3.29.10` by normalizing the email value that is sent to the sign-in endpoint before accessing
  it anywhere else. We also added a `normalizeIdentifier` callback on the `EmailProvider` configuration,
  where you can further tweak your requirements for what your system considers a valid e-mail
  address. (E.g.: strict RFC2821 compliance). Users are advised to upgrade. There are no known
  workarounds for this vulnerability. If for some reason you cannot upgrade, you can normalize
  the incoming request using Advanced Initialization.'
severities:
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19037'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22701'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22709'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22681'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22674'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22661'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22672'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.2268'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22703'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.2271'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22658'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22607'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22544'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19108'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.1914'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19166'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19201'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.1921'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19176'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19155'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19141'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19151'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19189'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19183'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19169'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19152'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.18995'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00079'
    scoring_system: epss
    scoring_elements: '0.24443'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00079'
    scoring_system: epss
    scoring_elements: '0.24446'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00163'
    scoring_system: epss
    scoring_elements: '0.2429'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00300'
    scoring_system: epss
    scoring_elements: '0.69161'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00300'
    scoring_system: epss
    scoring_elements: '0.69367'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00300'
    scoring_system: epss
    scoring_elements: '0.69180'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00300'
    scoring_system: epss
    scoring_elements: '0.69176'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.72165'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.72120'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.72110'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.72073'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.72260'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.71926'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.72290'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.72243'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.72172'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '0.00340'
    scoring_system: epss
    scoring_elements: '0.72167'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://en.wikipedia.org/wiki/Email_address#Local-part
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://en.wikipedia.org/wiki/Email_address#Local-part
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:47Z/
    published_at: None
    url: https://en.wikipedia.org/wiki/Email_address#Local-part
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xv97-c62v-4587
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/nextauthjs/next-auth
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:47Z/
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-xv97-c62v-4587
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-xv97-c62v-4587
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:47Z/
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-xv97-c62v-4587
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://next-auth.js.org/configuration/callbacks#sign-in-callback
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://next-auth.js.org/configuration/callbacks#sign-in-callback
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:47Z/
    published_at: None
    url: https://next-auth.js.org/configuration/callbacks#sign-in-callback
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://next-auth.js.org/configuration/initialization#advanced-initialization
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://next-auth.js.org/configuration/initialization#advanced-initialization
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://next-auth.js.org/configuration/initialization#advanced-initialization
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:47Z/
    published_at: None
    url: https://next-auth.js.org/configuration/initialization#advanced-initialization
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://next-auth.js.org/providers/email
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://next-auth.js.org/providers/email
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:47Z/
    published_at: None
    url: https://next-auth.js.org/providers/email
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://next-auth.js.org/providers/email#normalizing-the-e-mail-address
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://next-auth.js.org/providers/email#normalizing-the-e-mail-address
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:47Z/
    published_at: None
    url: https://next-auth.js.org/providers/email#normalizing-the-e-mail-address
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://next-auth.js.org/providers/email#normalizing-the-email-address
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://next-auth.js.org/providers/email#normalizing-the-email-address
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nodemailer.com/message/addresses
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nodemailer.com/message/addresses
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:48:47Z/
    published_at: None
    url: https://nodemailer.com/message/addresses
  - score: '9.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-35924
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-35924
weaknesses:
  - CWE-20
  - CWE-937
  - CWE-1035
  - CWE-863
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-35924
    reference_type:
    reference_id:
  - url: https://en.wikipedia.org/wiki/Email_address#Local-part
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/callbacks#sign-in-callback
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/initialization#advanced-initialization
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/providers/email
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/providers/email#normalizing-the-e-mail-address
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/providers/email#normalizing-the-email-address
    reference_type:
    reference_id:
  - url: https://nodemailer.com/message/addresses
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-35924
    reference_type:
    reference_id: CVE-2022-35924
  - url: https://github.com/advisories/GHSA-xv97-c62v-4587
    reference_type:
    reference_id: GHSA-xv97-c62v-4587
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-xv97-c62v-4587
    reference_type:
    reference_id: GHSA-xv97-c62v-4587
