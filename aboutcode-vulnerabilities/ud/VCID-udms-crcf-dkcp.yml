vulnerability_id: VCID-udms-crcf-dkcp
aliases:
  - CVE-2025-64186
  - GHSA-88h9-77c7-p6w4
summary: "Evervault Go SDK: Incomplete PCR Validation in Enclave Attestation for non-Evervault\
  \ hosted Enclaves\n### Summary\n\nA vulnerability was identified in the `evervault-go` SDKâ€™s\
  \ attestation verification logic that may allow incomplete documents to pass validation. This\
  \ may cause the client to trust an enclave operator that does not meet expected integrity\
  \ guarantees.\n\nThe exploitability of this issue is limited in Evervault-hosted environments\
  \ as an attacker would require the pre-requisite ability to serve requests from specific evervault\
  \ domain names, following from our ACME challenge based TLS certificate acquisition pipeline.\
  \ \n\nThe vulnerability primarily affects applications which only check PCR8. Though the efficacy\
  \ is also reduced for applications that check all PCR values, the impact is largely remediated\
  \ by checking PCR 0, 1 and 2.\n \n\n### Patches\nThe identified issue has been addressed in\
  \ version [1.3.2](https://github.com/evervault/evervault-go/pull/48) by validating attestation\
  \ documents before storing in the cache, and replacing the naive equality checks with a new\
  \ SatisfiedBy check.\n\n### Workarounds\nIf you are using evervault-go to attest Enclaves\
  \ that are hosted outside of Evervault environments and cannot upgrade:\n\n1) Modify your\
  \ application logic to fail verification if PCR8 is not explicitly present and non-empty\n\
  2) Add custom pre-validation to reject documents that omit any required PCRs.\n\n### POC\n\
  ```\npackage evervault\nimport (\n        \"testing\"\n\n        \"github.com/evervault/evervault-go/attestation\"\
  \n        \"github.com/stretchr/testify/assert\"\n        \"github.com/hf/nitrite\"\n)\n\n\
  \nfunc TestVulnerableCompare(t *testing.T) {\n          assert := assert.New(t)\n        \
  \  // arrange\n          expectedPCRs := []attestation.PCRs{\n                attestation.PCRs{\n\
  \                      PCR0:\n\"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001\"\
  ,\n                      PCR1:\n\"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002\"\
  ,\n                      PCR2:\n\"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003\"\
  ,\n                      PCR8:\n\"000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004\"\
  ,\n                     },\n           }\n            actualDocument := nitrite.Document {}\n\
  \            actualDocument.PCRs = map[uint][]byte{\n                    10: make([]byte,\
  \ 32),\n            }\n            // act\n            v := verifyPCRs(expectedPCRs, actualDocument)\n\
  \            \n            // assert\n            // Verify should not pass but it does\n\
  \            \n            assert.Equal(true, v)\n}\n```"
severities:
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00705'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64186
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00696'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64186
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/evervault/evervault-go
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/evervault/evervault-go
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/evervault/evervault-go/commit/7c824d289bba11ec0bea46a338023f5b128bbb28
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/evervault/evervault-go/commit/7c824d289bba11ec0bea46a338023f5b128bbb28
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-11-14T17:40:02Z/
    published_at: None
    url: https://github.com/evervault/evervault-go/commit/7c824d289bba11ec0bea46a338023f5b128bbb28
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/evervault/evervault-go/pull/48
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/evervault/evervault-go/pull/48
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-11-14T17:40:02Z/
    published_at: None
    url: https://github.com/evervault/evervault-go/pull/48
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/evervault/evervault-go/security/advisories/GHSA-88h9-77c7-p6w4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/evervault/evervault-go/security/advisories/GHSA-88h9-77c7-p6w4
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-11-14T17:40:02Z/
    published_at: None
    url: https://github.com/evervault/evervault-go/security/advisories/GHSA-88h9-77c7-p6w4
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-64186
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-64186
weaknesses:
  - CWE-347
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-64186
    reference_type:
    reference_id:
  - url: https://github.com/evervault/evervault-go
    reference_type:
    reference_id:
  - url: https://github.com/evervault/evervault-go/commit/7c824d289bba11ec0bea46a338023f5b128bbb28
    reference_type:
    reference_id:
  - url: https://github.com/evervault/evervault-go/pull/48
    reference_type:
    reference_id:
  - url: https://github.com/evervault/evervault-go/security/advisories/GHSA-88h9-77c7-p6w4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64186
    reference_type:
    reference_id:
