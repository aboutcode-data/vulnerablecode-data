vulnerability_id: VCID-3zz8-y4pv-aaah
aliases:
  - CVE-2017-7692
summary: SquirrelMail 1.4.22 (and other versions before 20170427_0200-SVN) allows post-authentication
  remote code execution via a sendmail.cf file that is mishandled in a popen call. It's possible
  to exploit this vulnerability to execute arbitrary shell commands on the remote server. The
  problem is in the Deliver_SendMail.class.php with the initStream function that uses escapeshellcmd()
  to sanitize the sendmail command before executing it. The use of escapeshellcmd() is not correct
  in this case since it doesn't escape whitespaces, allowing the injection of arbitrary command
  parameters. The problem is in -f$envelopefrom within the sendmail command line. Hence, if
  the target server uses sendmail and SquirrelMail is configured to use it as a command-line
  program, it's possible to trick sendmail into using an attacker-provided configuration file
  that triggers the execution of an arbitrary command. For exploitation, the attacker must upload
  a sendmail.cf file as an email attachment, and inject the sendmail.cf filename with the -C
  option within the "Options > Personal Informations > Email Address" setting.
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-7692.html
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2017-7692.json
  - score: '0.06234'
    scoring_system: epss
    scoring_elements: '0.93518'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.06234'
    scoring_system: epss
    scoring_elements: '0.93514'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.06234'
    scoring_system: epss
    scoring_elements: '0.93542'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.06234'
    scoring_system: epss
    scoring_elements: '0.93515'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94282'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94284'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94297'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94313'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94321'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94316'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94219'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94255'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94266'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94270'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.07268'
    scoring_system: epss
    scoring_elements: '0.94279'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93642'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93641'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.9364'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93637'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93636'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93635'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93634'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93448'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93444'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93461'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93459'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93466'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93467'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93462'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93464'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93472'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93475'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93471'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93619'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.9363'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93639'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.12983'
    scoring_system: epss
    scoring_elements: '0.93638'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: '0.245'
    scoring_system: epss
    scoring_elements: '0.93721'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1445165
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7692
  - score: '9.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-7692
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-7692
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2017/04/19/6
weaknesses:
  - CWE-20
references:
  - url: http://openwall.com/lists/oss-security/2017/04/19/6
    reference_type:
    reference_id:
  - url: http://openwall.com/lists/oss-security/2017/04/27/1
    reference_type:
    reference_id:
  - url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-7692.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2017-7692.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2017-7692
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7692
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/201709-13
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/41910/
    reference_type:
    reference_id:
  - url: http://www.debian.org/security/2017/dsa-3852
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2017/04/19/6
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/98067
    reference_type:
    reference_id:
  - url: http://www.securitytracker.com/id/1038312
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1445165
    reference_type:
    reference_id: 1445165
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:squirrelmail:squirrelmail:1.4.22:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:squirrelmail:squirrelmail:1.4.22:*:*:*:*:*:*:*
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/linux/remote/41910.sh
    reference_type: exploit
    reference_id: CVE-2017-7692
  - url: https://legalhackers.com/advisories/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html
    reference_type: exploit
    reference_id: CVE-2017-7692
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-7692
    reference_type:
    reference_id: CVE-2017-7692
