vulnerability_id: VCID-vtke-vn9n-s3hh
aliases:
  - CVE-2024-43802
summary: Vim is an improved version of the unix vi text editor. When flushing the typeahead
  buffer, Vim moves the current position in the typeahead buffer but does not check whether
  there is enough space left in the buffer to handle the next characters.  So this may lead
  to the tb_off position within the typebuf variable to point outside of the valid buffer size,
  which can then later lead to a heap-buffer overflow in e.g. ins_typebuf(). Therefore, when
  flushing the typeahead buffer, check if there is enough space left before advancing the off
  position. If not, fall back to flush current typebuf contents. It's not quite clear yet, what
  can lead to this situation. It seems to happen when error messages occur (which will cause
  Vim to flush the typeahead buffer) in comnination with several long mappgins and so it may
  eventually move the off position out of a valid buffer size. Impact is low since it is not
  easily reproducible and requires to have several mappings active and run into some error condition.
  But when this happens, this will cause a crash. The issue has been fixed as of Vim patch v9.1.0697.
  Users are advised to upgrade. There are no known workarounds for this issue.
severities:
  - score: '4.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-43802.json
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10139'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.08'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.08012'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.08022'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.0801'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07983'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.0797'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07928'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10105'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10156'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10265'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10332'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10319'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10301'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10246'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10226'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10217'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10214'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10216'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10221'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.102'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07926'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07945'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07957'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07992'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07991'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07995'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11759'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11722'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.10363'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
  - score: '4.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-122
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-43802.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-43802
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-43802
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vim/vim/commit/322ba9108612bead5eb
    reference_type:
    reference_id:
  - url: https://github.com/vim/vim/security/advisories/GHSA-4ghr-c62x-cqfh
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20241004-0008/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2307995
    reference_type:
    reference_id: 2307995
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43802
    reference_type:
    reference_id: CVE-2024-43802
  - url: https://usn.ubuntu.com/7048-1/
    reference_type:
    reference_id: USN-7048-1
  - url: https://usn.ubuntu.com/7048-2/
    reference_type:
    reference_id: USN-7048-2
