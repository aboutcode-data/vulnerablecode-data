vulnerability_id: VCID-sp9a-dp2y-aaaa
aliases:
  - GHSA-5wvv-q5fv-2388
summary: |
  hyper-staticfile's location header incorporates user input, allowing open redirect
  When `hyper-staticfile` performs a redirect for a directory request (e.g. a request for `/dir` that redirects to `/dir/`), the `Location` header value was derived from user input (the request path), simply appending a slash. The intent was to perform an origin-relative redirect, but specific inputs allowed performing a scheme-relative redirect instead.

  An attacker could craft a special URL that would appear to be for the correct domain, but immediately redirects to a malicious domain. Such a URL can benefit phishing attacks, for example an innocent looking link in an email.
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5wvv-q5fv-2388
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/stephank/hyper-staticfile
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/stephank/hyper-staticfile/commit/4db4afb811c553bc3d54a01a9985b9e6dfc5a115
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/stephank/hyper-staticfile/commit/f12cadc6666c6f555d29725f5bc45da2103f24ea
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2022-0072.html
weaknesses:
  - CWE-601
references:
  - url: https://github.com/stephank/hyper-staticfile
    reference_type:
    reference_id:
  - url: https://github.com/stephank/hyper-staticfile/commit/4db4afb811c553bc3d54a01a9985b9e6dfc5a115
    reference_type:
    reference_id:
  - url: https://github.com/stephank/hyper-staticfile/commit/f12cadc6666c6f555d29725f5bc45da2103f24ea
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2022-0072.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5wvv-q5fv-2388
    reference_type:
    reference_id: GHSA-5wvv-q5fv-2388
