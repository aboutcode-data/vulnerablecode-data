vulnerability_id: VCID-8nng-ystb-5kc8
aliases:
  - CVE-2025-39791
summary: 'In the Linux kernel, the following vulnerability has been resolved:  dm: dm-crypt:
  Do not partially accept write BIOs with zoned targets  Read and write operations issued to
  a dm-crypt target may be split according to the dm-crypt internal limits defined by the max_read_size
  and max_write_size module parameters (default is 128 KB). The intent is to improve processing
  time of large BIOs by splitting them into smaller operations that can be parallelized on different
  CPUs.  For zoned dm-crypt targets, this BIO splitting is still done but without the parallel
  execution to ensure that the issuing order of write operations to the underlying devices remains
  sequential. However, the splitting itself causes other problems:  1) Since dm-crypt relies
  on the block layer zone write plugging to    handle zone append emulation using regular write
  operations, the    reminder of a split write BIO will always be plugged into the target    zone
  write plugged. Once the on-going write BIO finishes, this    reminder BIO is unplugged and
  issued from the zone write plug work.    If this reminder BIO itself needs to be split, the
  reminder will be    re-issued and plugged again, but that causes a call to a    blk_queue_enter(),
  which may block if a queue freeze operation was    initiated. This results in a deadlock as
  DM submission still holds    BIOs that the queue freeze side is waiting for.  2) dm-crypt
  relies on the emulation done by the block layer using    regular write operations for processing
  zone append operations. This    still requires to properly return the written sector as the
  BIO    sector of the original BIO. However, this can be done correctly only    and only if
  there is a single clone BIO used for processing the    original zone append operation issued
  by the user. If the size of a    zone append operation is larger than dm-crypt max_write_size,
  then    the orginal BIO will be split and processed as a chain of regular    write operations.
  Such chaining result in an incorrect written sector    being returned to the zone append issuer
  using the original BIO    sector.  This in turn results in file system data corruptions using    xfs
  or btrfs.  Fix this by modifying get_max_request_size() to always return the size of the BIO
  to avoid it being split with dm_accpet_partial_bio() in crypt_map(). get_max_request_size()
  is renamed to get_max_request_sectors() to clarify the unit of the value returned and its
  interface is changed to take a struct dm_target pointer and a pointer to the struct bio being
  processed. In addition to this change, to ensure that crypt_alloc_buffer() works correctly,
  set the dm-crypt device max_hw_sectors limit to be at most BIO_MAX_VECS << PAGE_SECTORS_SHIFT
  (1 MB with a 4KB page architecture). This forces DM core to split write BIOs before passing
  them to crypt_map(), and thus guaranteeing that dm-crypt can always accept an entire write
  BIO without needing to split it.  This change does not have any effect on the read path of
  dm-crypt. Read operations can still be split and the BIO fragments processed in parallel.
  There is also no impact on the performance of the write path given that all zone write BIOs
  were already processed inline instead of in parallel.  This change also does not affect in
  any way regular dm-crypt block devices.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39791.json
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01851'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02702'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02712'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0364'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04337'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04312'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04427'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0445'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04452'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0462'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04624'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04659'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04551'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04521'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0455'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04315'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04349'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04399'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04338'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0529'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05303'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05282'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05274'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05257'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05229'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05242'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05222'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05205'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05193'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05203'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0522'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05317'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05299'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05284'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39791.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-39791
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2394613
    reference_type:
    reference_id: 2394613
