vulnerability_id: VCID-8nsc-518n-aaaq
aliases:
  - CVE-2022-29256
  - GHSA-gp95-ppv5-3jc5
summary: sharp is an application for Node.js image processing. Prior to version 0.30.5, there
  is a possible vulnerability in logic that is run only at `npm install` time when installing
  versions of `sharp` prior to the latest v0.30.5. If an attacker has the ability to set the
  value of the `PKG_CONFIG_PATH` environment variable in a build environment then they might
  be able to use this to inject an arbitrary command at `npm install` time. This is not part
  of any runtime code, does not affect Windows users at all, and is unlikely to affect anyone
  that already cares about the security of their build environment. This problem is fixed in
  version 0.30.5.
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://advisory.dw1.io/54
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://advisory.dw1.io/54
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10793'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08441'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08459'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08438'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05222'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05226'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05214'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05211'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05197'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05205'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05165'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05172'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05180'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05238'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05230'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27274'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27258'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27225'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27625'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26459'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26466'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26451'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.2654'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26499'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26478'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26462'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.2646'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26444'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22457'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22389'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22532'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22552'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22553'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22545'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22458'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22473'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22529'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22471'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.22429'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.2639'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26453'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26481'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.30988'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-gp95-ppv5-3jc5
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/lovell/sharp
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lovell/sharp
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/lovell/sharp/commit/a6aeef612be50f5868a77481848b1de674216f0c
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lovell/sharp/commit/a6aeef612be50f5868a77481848b1de674216f0c
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/lovell/sharp/security/advisories/GHSA-gp95-ppv5-3jc5
  - score: '4.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29256
  - score: '6.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29256
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29256
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-77
  - CWE-78
references:
  - url: https://advisory.dw1.io/54
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-29256
    reference_type:
    reference_id:
  - url: https://github.com/lovell/sharp
    reference_type:
    reference_id:
  - url: https://github.com/lovell/sharp/commit/a6aeef612be50f5868a77481848b1de674216f0c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sharp_project:sharp:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:sharp_project:sharp:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29256
    reference_type:
    reference_id: CVE-2022-29256
  - url: https://github.com/advisories/GHSA-gp95-ppv5-3jc5
    reference_type:
    reference_id: GHSA-gp95-ppv5-3jc5
  - url: https://github.com/lovell/sharp/security/advisories/GHSA-gp95-ppv5-3jc5
    reference_type:
    reference_id: GHSA-gp95-ppv5-3jc5
