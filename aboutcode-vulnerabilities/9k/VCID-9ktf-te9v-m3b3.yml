vulnerability_id: VCID-9ktf-te9v-m3b3
aliases:
  - CVE-2024-47701
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: avoid OOB when system.data xattr changes underneath the filesystem

  When looking up for an entry in an inlined directory, if e_value_offs is
  changed underneath the filesystem by some change in the block device, it
  will lead to an out-of-bounds access that KASAN detects as an UAF.

  EXT4-fs (loop0): mounted filesystem 00000000-0000-0000-0000-000000000000 r/w without journal. Quota mode: none.
  loop0: detected capacity change from 2048 to 2047
  ==================================================================
  BUG: KASAN: use-after-free in ext4_search_dir+0xf2/0x1c0 fs/ext4/namei.c:1500
  Read of size 1 at addr ffff88803e91130f by task syz-executor269/5103

  CPU: 0 UID: 0 PID: 5103 Comm: syz-executor269 Not tainted 6.11.0-rc4-syzkaller #0
  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014
  Call Trace:
   <TASK>
   __dump_stack lib/dump_stack.c:93 [inline]
   dump_stack_lvl+0x241/0x360 lib/dump_stack.c:119
   print_address_description mm/kasan/report.c:377 [inline]
   print_report+0x169/0x550 mm/kasan/report.c:488
   kasan_report+0x143/0x180 mm/kasan/report.c:601
   ext4_search_dir+0xf2/0x1c0 fs/ext4/namei.c:1500
   ext4_find_inline_entry+0x4be/0x5e0 fs/ext4/inline.c:1697
   __ext4_find_entry+0x2b4/0x1b30 fs/ext4/namei.c:1573
   ext4_lookup_entry fs/ext4/namei.c:1727 [inline]
   ext4_lookup+0x15f/0x750 fs/ext4/namei.c:1795
   lookup_one_qstr_excl+0x11f/0x260 fs/namei.c:1633
   filename_create+0x297/0x540 fs/namei.c:3980
   do_symlinkat+0xf9/0x3a0 fs/namei.c:4587
   __do_sys_symlinkat fs/namei.c:4610 [inline]
   __se_sys_symlinkat fs/namei.c:4607 [inline]
   __x64_sys_symlinkat+0x95/0xb0 fs/namei.c:4607
   do_syscall_x64 arch/x86/entry/common.c:52 [inline]
   do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
   entry_SYSCALL_64_after_hwframe+0x77/0x7f
  RIP: 0033:0x7f3e73ced469
  Code: 28 00 00 00 75 05 48 83 c4 28 c3 e8 21 18 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
  RSP: 002b:00007fff4d40c258 EFLAGS: 00000246 ORIG_RAX: 000000000000010a
  RAX: ffffffffffffffda RBX: 0032656c69662f2e RCX: 00007f3e73ced469
  RDX: 0000000020000200 RSI: 00000000ffffff9c RDI: 00000000200001c0
  RBP: 0000000000000000 R08: 00007fff4d40c290 R09: 00007fff4d40c290
  R10: 0023706f6f6c2f76 R11: 0000000000000246 R12: 00007fff4d40c27c
  R13: 0000000000000003 R14: 431bde82d7b634db R15: 00007fff4d40c2b0
   </TASK>

  Calling ext4_xattr_ibody_find right after reading the inode with
  ext4_get_inode_loc will lead to a check of the validity of the xattrs,
  avoiding this problem.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47701.json
  - score: '6.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47701.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47701.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03466'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03473'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.02583'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07412'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05721'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05719'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05728'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05746'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05733'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05732'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05726'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05735'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05744'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05734'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05714'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05673'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07447'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0748'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07573'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07581'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07568'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07545'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07512'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07495'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07477'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07474'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0747'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07483'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07476'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:04:32Z/
    published_at: None
    url: https://git.kernel.org/stable/c/2a6579ef5f2576a940125729f7409cc182f1c8df
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:04:32Z/
    published_at: None
    url: https://git.kernel.org/stable/c/371d0bacecd529f887ea2547333d9173e7bcdc0a
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:04:32Z/
    published_at: None
    url: https://git.kernel.org/stable/c/5b076d37e8d99918e9294bd6b35a8bbb436819b0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:04:32Z/
    published_at: None
    url: https://git.kernel.org/stable/c/7fc22c3b3ffc0e952f5e0062dd11aa6ae76affba
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:04:32Z/
    published_at: None
    url: https://git.kernel.org/stable/c/8adf0eb4e361a9e060d54f4bd0ac9c5d85277d20
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:04:32Z/
    published_at: None
    url: https://git.kernel.org/stable/c/be2e9b111e2790962cc66a177869b4e9717b4e29
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:04:32Z/
    published_at: None
    url: https://git.kernel.org/stable/c/c6b72f5d82b1017bad80f9ebf502832fc321d796
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:04:32Z/
    published_at: None
    url: https://git.kernel.org/stable/c/ccb8c18076e2e630fea23fbec583cdad61787fc5
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:04:32Z/
    published_at: None
    url: https://git.kernel.org/stable/c/ea32883e4a03ed575a2eb7a66542022312bde477
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47701
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47701
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47701.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47701
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47701
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2320180
    reference_type:
    reference_id: 2320180
  - url: https://git.kernel.org/stable/c/2a6579ef5f2576a940125729f7409cc182f1c8df
    reference_type:
    reference_id: 2a6579ef5f2576a940125729f7409cc182f1c8df
  - url: https://git.kernel.org/stable/c/371d0bacecd529f887ea2547333d9173e7bcdc0a
    reference_type:
    reference_id: 371d0bacecd529f887ea2547333d9173e7bcdc0a
  - url: https://git.kernel.org/stable/c/5b076d37e8d99918e9294bd6b35a8bbb436819b0
    reference_type:
    reference_id: 5b076d37e8d99918e9294bd6b35a8bbb436819b0
  - url: https://git.kernel.org/stable/c/7fc22c3b3ffc0e952f5e0062dd11aa6ae76affba
    reference_type:
    reference_id: 7fc22c3b3ffc0e952f5e0062dd11aa6ae76affba
  - url: https://git.kernel.org/stable/c/8adf0eb4e361a9e060d54f4bd0ac9c5d85277d20
    reference_type:
    reference_id: 8adf0eb4e361a9e060d54f4bd0ac9c5d85277d20
  - url: https://git.kernel.org/stable/c/be2e9b111e2790962cc66a177869b4e9717b4e29
    reference_type:
    reference_id: be2e9b111e2790962cc66a177869b4e9717b4e29
  - url: https://git.kernel.org/stable/c/c6b72f5d82b1017bad80f9ebf502832fc321d796
    reference_type:
    reference_id: c6b72f5d82b1017bad80f9ebf502832fc321d796
  - url: https://git.kernel.org/stable/c/ccb8c18076e2e630fea23fbec583cdad61787fc5
    reference_type:
    reference_id: ccb8c18076e2e630fea23fbec583cdad61787fc5
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47701
    reference_type:
    reference_id: CVE-2024-47701
  - url: https://git.kernel.org/stable/c/ea32883e4a03ed575a2eb7a66542022312bde477
    reference_type:
    reference_id: ea32883e4a03ed575a2eb7a66542022312bde477
  - url: https://usn.ubuntu.com/7166-1/
    reference_type:
    reference_id: USN-7166-1
  - url: https://usn.ubuntu.com/7166-2/
    reference_type:
    reference_id: USN-7166-2
  - url: https://usn.ubuntu.com/7166-3/
    reference_type:
    reference_id: USN-7166-3
  - url: https://usn.ubuntu.com/7166-4/
    reference_type:
    reference_id: USN-7166-4
  - url: https://usn.ubuntu.com/7186-1/
    reference_type:
    reference_id: USN-7186-1
  - url: https://usn.ubuntu.com/7186-2/
    reference_type:
    reference_id: USN-7186-2
  - url: https://usn.ubuntu.com/7194-1/
    reference_type:
    reference_id: USN-7194-1
  - url: https://usn.ubuntu.com/7276-1/
    reference_type:
    reference_id: USN-7276-1
  - url: https://usn.ubuntu.com/7277-1/
    reference_type:
    reference_id: USN-7277-1
  - url: https://usn.ubuntu.com/7293-1/
    reference_type:
    reference_id: USN-7293-1
  - url: https://usn.ubuntu.com/7294-1/
    reference_type:
    reference_id: USN-7294-1
  - url: https://usn.ubuntu.com/7294-2/
    reference_type:
    reference_id: USN-7294-2
  - url: https://usn.ubuntu.com/7294-3/
    reference_type:
    reference_id: USN-7294-3
  - url: https://usn.ubuntu.com/7294-4/
    reference_type:
    reference_id: USN-7294-4
  - url: https://usn.ubuntu.com/7295-1/
    reference_type:
    reference_id: USN-7295-1
  - url: https://usn.ubuntu.com/7301-1/
    reference_type:
    reference_id: USN-7301-1
  - url: https://usn.ubuntu.com/7303-1/
    reference_type:
    reference_id: USN-7303-1
  - url: https://usn.ubuntu.com/7303-2/
    reference_type:
    reference_id: USN-7303-2
  - url: https://usn.ubuntu.com/7303-3/
    reference_type:
    reference_id: USN-7303-3
  - url: https://usn.ubuntu.com/7304-1/
    reference_type:
    reference_id: USN-7304-1
  - url: https://usn.ubuntu.com/7310-1/
    reference_type:
    reference_id: USN-7310-1
  - url: https://usn.ubuntu.com/7311-1/
    reference_type:
    reference_id: USN-7311-1
  - url: https://usn.ubuntu.com/7384-1/
    reference_type:
    reference_id: USN-7384-1
  - url: https://usn.ubuntu.com/7384-2/
    reference_type:
    reference_id: USN-7384-2
  - url: https://usn.ubuntu.com/7385-1/
    reference_type:
    reference_id: USN-7385-1
  - url: https://usn.ubuntu.com/7386-1/
    reference_type:
    reference_id: USN-7386-1
  - url: https://usn.ubuntu.com/7393-1/
    reference_type:
    reference_id: USN-7393-1
  - url: https://usn.ubuntu.com/7401-1/
    reference_type:
    reference_id: USN-7401-1
  - url: https://usn.ubuntu.com/7403-1/
    reference_type:
    reference_id: USN-7403-1
  - url: https://usn.ubuntu.com/7413-1/
    reference_type:
    reference_id: USN-7413-1
  - url: https://usn.ubuntu.com/7468-1/
    reference_type:
    reference_id: USN-7468-1
