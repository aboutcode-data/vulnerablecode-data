vulnerability_id: VCID-p6cr-2axj-xbf7
aliases:
  - CVE-2025-38234
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sched/rt: Fix race in push_rt_task

  Overview
  ========
  When a CPU chooses to call push_rt_task and picks a task to push to
  another CPU's runqueue then it will call find_lock_lowest_rq method
  which would take a double lock on both CPUs' runqueues. If one of the
  locks aren't readily available, it may lead to dropping the current
  runqueue lock and reacquiring both the locks at once. During this window
  it is possible that the task is already migrated and is running on some
  other CPU. These cases are already handled. However, if the task is
  migrated and has already been executed and another CPU is now trying to
  wake it up (ttwu) such that it is queued again on the runqeue
  (on_rq is 1) and also if the task was run by the same CPU, then the
  current checks will pass even though the task was migrated out and is no
  longer in the pushable tasks list.

  Crashes
  =======
  This bug resulted in quite a few flavors of crashes triggering kernel
  panics with various crash signatures such as assert failures, page
  faults, null pointer dereferences, and queue corruption errors all
  coming from scheduler itself.

  Some of the crashes:
  -> kernel BUG at kernel/sched/rt.c:1616! BUG_ON(idx >= MAX_RT_PRIO)
     Call Trace:
     ? __die_body+0x1a/0x60
     ? die+0x2a/0x50
     ? do_trap+0x85/0x100
     ? pick_next_task_rt+0x6e/0x1d0
     ? do_error_trap+0x64/0xa0
     ? pick_next_task_rt+0x6e/0x1d0
     ? exc_invalid_op+0x4c/0x60
     ? pick_next_task_rt+0x6e/0x1d0
     ? asm_exc_invalid_op+0x12/0x20
     ? pick_next_task_rt+0x6e/0x1d0
     __schedule+0x5cb/0x790
     ? update_ts_time_stats+0x55/0x70
     schedule_idle+0x1e/0x40
     do_idle+0x15e/0x200
     cpu_startup_entry+0x19/0x20
     start_secondary+0x117/0x160
     secondary_startup_64_no_verify+0xb0/0xbb

  -> BUG: kernel NULL pointer dereference, address: 00000000000000c0
     Call Trace:
     ? __die_body+0x1a/0x60
     ? no_context+0x183/0x350
     ? __warn+0x8a/0xe0
     ? exc_page_fault+0x3d6/0x520
     ? asm_exc_page_fault+0x1e/0x30
     ? pick_next_task_rt+0xb5/0x1d0
     ? pick_next_task_rt+0x8c/0x1d0
     __schedule+0x583/0x7e0
     ? update_ts_time_stats+0x55/0x70
     schedule_idle+0x1e/0x40
     do_idle+0x15e/0x200
     cpu_startup_entry+0x19/0x20
     start_secondary+0x117/0x160
     secondary_startup_64_no_verify+0xb0/0xbb

  -> BUG: unable to handle page fault for address: ffff9464daea5900
     kernel BUG at kernel/sched/rt.c:1861! BUG_ON(rq->cpu != task_cpu(p))

  -> kernel BUG at kernel/sched/rt.c:1055! BUG_ON(!rq->nr_running)
     Call Trace:
     ? __die_body+0x1a/0x60
     ? die+0x2a/0x50
     ? do_trap+0x85/0x100
     ? dequeue_top_rt_rq+0xa2/0xb0
     ? do_error_trap+0x64/0xa0
     ? dequeue_top_rt_rq+0xa2/0xb0
     ? exc_invalid_op+0x4c/0x60
     ? dequeue_top_rt_rq+0xa2/0xb0
     ? asm_exc_invalid_op+0x12/0x20
     ? dequeue_top_rt_rq+0xa2/0xb0
     dequeue_rt_entity+0x1f/0x70
     dequeue_task_rt+0x2d/0x70
     __schedule+0x1a8/0x7e0
     ? blk_finish_plug+0x25/0x40
     schedule+0x3c/0xb0
     futex_wait_queue_me+0xb6/0x120
     futex_wait+0xd9/0x240
     do_futex+0x344/0xa90
     ? get_mm_exe_file+0x30/0x60
     ? audit_exe_compare+0x58/0x70
     ? audit_filter_rules.constprop.26+0x65e/0x1220
     __x64_sys_futex+0x148/0x1f0
     do_syscall_64+0x30/0x80
     entry_SYSCALL_64_after_hwframe+0x62/0xc7

  -> BUG: unable to handle page fault for address: ffff8cf3608bc2c0
     Call Trace:
     ? __die_body+0x1a/0x60
     ? no_context+0x183/0x350
     ? spurious_kernel_fault+0x171/0x1c0
     ? exc_page_fault+0x3b6/0x520
     ? plist_check_list+0x15/0x40
     ? plist_check_list+0x2e/0x40
     ? asm_exc_page_fault+0x1e/0x30
     ? _cond_resched+0x15/0x30
     ? futex_wait_queue_me+0xc8/0x120
     ? futex_wait+0xd9/0x240
     ? try_to_wake_up+0x1b8/0x490
     ? futex_wake+0x78/0x160
     ? do_futex+0xcd/0xa90
     ? plist_check_list+0x15/0x40
     ? plist_check_list+0x2e/0x40
     ? plist_del+0x6a/0xd0
     ? plist_check_list+0x15/0x40
     ? plist_check_list+0x2e/0x40
     ? dequeue_pushable_task+0x20/0x70
     ? __schedule+0x382/0x7e0
     ? asm_sysvec_reschedule_i
  ---truncated---
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38234.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03031'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04888'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0489'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04893'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04815'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04812'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04908'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04883'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04916'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05484'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0553'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05562'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05682'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05625'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0551'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05472'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05506'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06435'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06469'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06486'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06481'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06414'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06051'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06068'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06048'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06162'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06184'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06218'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06113'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0612'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06087'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06199'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06198'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0636'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06342'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06379'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06345'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06328'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06366'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06372'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06374'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06383'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06485'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06396'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0639'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06407'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06389'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06384'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0968'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00711'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00721'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38234.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38234
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38234
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/07ecabfbca64f4f0b6071cf96e49d162fa9d138d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/690e47d1403e90b7f2366f03b52ed3304194c793
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2376375
    reference_type:
    reference_id: 2376375
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38234
    reference_type:
    reference_id: CVE-2025-38234
  - url: https://access.redhat.com/errata/RHSA-2025:8246
    reference_type:
    reference_id: RHSA-2025:8246
  - url: https://access.redhat.com/errata/RHSA-2025:8247
    reference_type:
    reference_id: RHSA-2025:8247
  - url: https://access.redhat.com/errata/RHSA-2025:9348
    reference_type:
    reference_id: RHSA-2025:9348
  - url: https://access.redhat.com/errata/RHSA-2025:9584
    reference_type:
    reference_id: RHSA-2025:9584
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
