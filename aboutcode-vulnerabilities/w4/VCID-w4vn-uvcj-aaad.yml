vulnerability_id: VCID-w4vn-uvcj-aaad
aliases:
  - CVE-2024-37901
  - GHSA-h63h-5c77-77p5
summary: |
  XWiki Platform vulnerable to remote code execution from account via SearchSuggestConfigSheet
  ### Impact
  Any user with edit right on any page can perform arbitrary remote code execution by adding instances of `XWiki.SearchSuggestConfig` and `XWiki.SearchSuggestSourceClass` to their user profile or any other page. This compromises the confidentiality, integrity and availability of the whole XWiki installation.

  To reproduce on an instance, as a user without script nor programming rights, add an object of type `XWiki.SearchSuggestConfig` to your profile page, and an object of type `XWiki.SearchSuggestSourceClass` as well. On this last object, set both `name` and `icon` properties to `$services.logging.getLogger("attacker").error("I got programming: $services.security.authorization.hasAccess('programming')")` and `limit` and `engine` to `{{/html}}{{async}}{{velocity}}$services.logging.getLogger("attacker").error("I got programming: $services.security.authorization.hasAccess('programming')"){{/velocity}}{{/async}}`. Save and display the page. If the logs contain any message `ERROR attacker - I got programming: true` then the instance is vulnerable.

  ### Patches
  This vulnerability has been patched in XWiki 14.10.21, 15.5.5 and 15.10.2.

  ### Workarounds
  We're not aware of any workaround except upgrading.

  ### References
  - https://jira.xwiki.org/browse/XWIKI-21473
  - https://github.com/xwiki/xwiki-platform/commit/742cd4591642be4cdcaf68325f17540e0934e64e
severities:
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42996'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42303'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42561'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42647'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42671'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42761'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42757'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42964'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42767'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42783'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42802'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42598'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42241'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42255'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.42232'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.00100'
    scoring_system: epss
    scoring_elements: '0.43057'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.8925'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89251'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89255'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89258'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89264'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89266'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89273'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89268'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89257'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89245'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.05129'
    scoring_system: epss
    scoring_elements: '0.89233'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38189'
    scoring_system: epss
    scoring_elements: '0.96933'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38189'
    scoring_system: epss
    scoring_elements: '0.96934'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38189'
    scoring_system: epss
    scoring_elements: '0.96937'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38189'
    scoring_system: epss
    scoring_elements: '0.96941'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38189'
    scoring_system: epss
    scoring_elements: '0.96943'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38189'
    scoring_system: epss
    scoring_elements: '0.96942'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38189'
    scoring_system: epss
    scoring_elements: '0.9693'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38189'
    scoring_system: epss
    scoring_elements: '0.96928'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38189'
    scoring_system: epss
    scoring_elements: '0.96931'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38393'
    scoring_system: epss
    scoring_elements: '0.96935'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38393'
    scoring_system: epss
    scoring_elements: '0.96931'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38393'
    scoring_system: epss
    scoring_elements: '0.96945'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38393'
    scoring_system: epss
    scoring_elements: '0.96942'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.38393'
    scoring_system: epss
    scoring_elements: '0.96947'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: '0.54276'
    scoring_system: epss
    scoring_elements: '0.97123'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-h63h-5c77-77p5
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/0b135760514fef73db748986a3311f3edd4a553b
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/0b135760514fef73db748986a3311f3edd4a553b
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/742cd4591642be4cdcaf68325f17540e0934e64e
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/742cd4591642be4cdcaf68325f17540e0934e64e
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/9ce3e0319869b6d8131fc4e0909736f7041566a4
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/9ce3e0319869b6d8131fc4e0909736f7041566a4
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/bbde8a4f564e3c28839440076334a9093e2b4834
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/bbde8a4f564e3c28839440076334a9093e2b4834
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h63h-5c77-77p5
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h63h-5c77-77p5
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-21473
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-21473
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37901
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37901
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37901
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37901
weaknesses:
  - CWE-94
  - CWE-937
  - CWE-1035
  - CWE-862
  - CWE-95
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-37901
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/0b135760514fef73db748986a3311f3edd4a553b
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/742cd4591642be4cdcaf68325f17540e0934e64e
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/9ce3e0319869b6d8131fc4e0909736f7041566a4
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/bbde8a4f564e3c28839440076334a9093e2b4834
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h63h-5c77-77p5
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-21473
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37901
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-h63h-5c77-77p5
    reference_type:
    reference_id: GHSA-h63h-5c77-77p5
