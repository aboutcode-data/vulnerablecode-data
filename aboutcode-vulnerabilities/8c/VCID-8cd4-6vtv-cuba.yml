vulnerability_id: VCID-8cd4-6vtv-cuba
aliases:
  - CVE-2023-54069
summary: "In the Linux kernel, the following vulnerability has been resolved:  ext4: fix BUG\
  \ in ext4_mb_new_inode_pa() due to overflow  When we calculate the end position of ext4_free_extent,\
  \ this position may be exactly where ext4_lblk_t (i.e. uint) overflows. For example, if ac_g_ex.fe_logical\
  \ is 4294965248 and ac_orig_goal_len is 2048, then the computed end is 0x100000000, which\
  \ is 0. If ac->ac_o_ex.fe_logical is not the first case of adjusting the best extent, that\
  \ is, new_bex_end > 0, the following BUG_ON will be triggered:  =========================================================\
  \ kernel BUG at fs/ext4/mballoc.c:5116! invalid opcode: 0000 [#1] PREEMPT SMP PTI CPU: 3 PID:\
  \ 673 Comm: xfs_io Tainted: G E 6.5.0-rc1+ #279 RIP: 0010:ext4_mb_new_inode_pa+0xc5/0x430\
  \ Call Trace:  <TASK>  ext4_mb_use_best_found+0x203/0x2f0  ext4_mb_try_best_found+0x163/0x240\
  \  ext4_mb_regular_allocator+0x158/0x1550  ext4_mb_new_blocks+0x86a/0xe10  ext4_ext_map_blocks+0xb0c/0x13a0\
  \  ext4_map_blocks+0x2cd/0x8f0  ext4_iomap_begin+0x27b/0x400  iomap_iter+0x222/0x3d0  __iomap_dio_rw+0x243/0xcb0\
  \  iomap_dio_rw+0x16/0x80 =========================================================  A simple\
  \ reproducer demonstrating the problem:  \tmkfs.ext4 -F /dev/sda -b 4096 100M \tmount /dev/sda\
  \ /tmp/test \tfallocate -l1M /tmp/test/tmp \tfallocate -l10M /tmp/test/file \tfallocate -i\
  \ -o 1M -l16777203M /tmp/test/file \tfsstress -d /tmp/test -l 0 -n 100000 -p 8 & \tsleep 10\
  \ && killall -9 fsstress \trm -f /tmp/test/tmp \txfs_io -c \"open -ad /tmp/test/file\" -c\
  \ \"pwrite -S 0xff 0 8192\"  We simply refactor the logic for adjusting the best extent by\
  \ adding a temporary ext4_free_extent ex and use extent_logical_end() to avoid overflow, which\
  \ also simplifies the code."
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54069.json
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0895'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54069
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08909'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54069
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54069.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-54069
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-54069
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2425063
    reference_type:
    reference_id: 2425063
