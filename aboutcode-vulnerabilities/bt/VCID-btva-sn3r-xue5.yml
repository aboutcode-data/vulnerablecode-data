vulnerability_id: VCID-btva-sn3r-xue5
aliases:
  - CVE-2025-38349
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\neventpoll:\
  \ don't decrement ep refcount while still holding the ep mutex\n\nJann Horn points out that\
  \ epoll is decrementing the ep refcount and then\ndoing a\n\n    mutex_unlock(&ep->mtx);\n\
  \nafterwards. That's very wrong, because it can lead to a use-after-free.\n\nThat pattern\
  \ is actually fine for the very last reference, because the\ncode in question will delay the\
  \ actual call to \"ep_free(ep)\" until after\nit has unlocked the mutex.\n\nBut it's wrong\
  \ for the much subtler \"next to last\" case when somebody\n*else* may also be dropping their\
  \ reference and free the ep while we're\nstill using the mutex.\n\nNote that this is true\
  \ even if that other user is also using the same ep\nmutex: mutexes, unlike spinlocks, can\
  \ not be used for object ownership,\neven if they guarantee mutual exclusion.\n\nA mutex \"\
  unlock\" operation is not atomic, and as one user is still\naccessing the mutex as part of\
  \ unlocking it, another user can come in\nand get the now released mutex and free the data\
  \ structure while the\nfirst user is still cleaning up.\n\nSee our mutex documentation in\
  \ Documentation/locking/mutex-design.rst,\nin particular the section [1] about semantics:\n\
  \n\t\"mutex_unlock() may access the mutex structure even after it has\n\t internally released\
  \ the lock already - so it's not safe for\n\t another context to acquire the mutex and assume\
  \ that the\n\t mutex_unlock() context is not using the structure anymore\"\n\nSo if we drop\
  \ our ep ref before the mutex unlock, but we weren't the\nlast one, we may then unlock the\
  \ mutex, another user comes in, drops\n_their_ reference and releases the 'ep' as it now has\
  \ no users - all\nwhile the mutex_unlock() is still accessing it.\n\nFix this by simply moving\
  \ the ep refcount dropping to outside the mutex:\nthe refcount itself is atomic, and doesn't\
  \ need mutex protection (that's\nthe whole _point_ of refcounts: unlike mutexes, they are\
  \ inherently\nabout object lifetimes)."
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38349.json
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02269'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02276'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02741'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02737'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02754'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04398'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04381'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04352'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04389'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10077'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10335'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10235'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10307'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10256'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10107'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10189'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11289'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11341'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11304'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11291'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11275'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11373'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11331'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1097'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11139'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11138'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11298'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11288'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11321'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11265'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11249'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11295'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11353'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11405'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11414'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11395'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11364'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1132'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1127'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12819'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12983'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12995'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13021'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12754'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12807'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-366
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38349.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38349
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/521e9ff0b67c66a17d6f9593dfccafaa984aae4c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/605c18698ecfa99165f36b7f59d3ed503e169814
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6dee745bd0aec9d399df674256e7b1ecdb615444
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8c2e52ebbe885c7eeaabd3b7ddcdc1246fc400d2
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2381870
    reference_type:
    reference_id: 2381870
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38349
    reference_type:
    reference_id: CVE-2025-38349
  - url: https://usn.ubuntu.com/7879-1/
    reference_type:
    reference_id: USN-7879-1
  - url: https://usn.ubuntu.com/7879-2/
    reference_type:
    reference_id: USN-7879-2
  - url: https://usn.ubuntu.com/7879-3/
    reference_type:
    reference_id: USN-7879-3
  - url: https://usn.ubuntu.com/7879-4/
    reference_type:
    reference_id: USN-7879-4
  - url: https://usn.ubuntu.com/7880-1/
    reference_type:
    reference_id: USN-7880-1
  - url: https://usn.ubuntu.com/7934-1/
    reference_type:
    reference_id: USN-7934-1
