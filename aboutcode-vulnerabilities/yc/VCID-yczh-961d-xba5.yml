vulnerability_id: VCID-yczh-961d-xba5
aliases:
  - CVE-2025-38359
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/mm: Fix in_atomic() handling in do_secure_storage_access()

  Kernel user spaces accesses to not exported pages in atomic context
  incorrectly try to resolve the page fault.
  With debug options enabled call traces like this can be seen:

  BUG: sleeping function called from invalid context at kernel/locking/rwsem.c:1523
  in_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 419074, name: qemu-system-s39
  preempt_count: 1, expected: 0
  RCU nest depth: 0, expected: 0
  INFO: lockdep is turned off.
  Preemption disabled at:
  [<00000383ea47cfa2>] copy_page_from_iter_atomic+0xa2/0x8a0
  CPU: 12 UID: 0 PID: 419074 Comm: qemu-system-s39
  Tainted: G        W           6.16.0-20250531.rc0.git0.69b3a602feac.63.fc42.s390x+debug #1 PREEMPT
  Tainted: [W]=WARN
  Hardware name: IBM 3931 A01 703 (LPAR)
  Call Trace:
   [<00000383e990d282>] dump_stack_lvl+0xa2/0xe8
   [<00000383e99bf152>] __might_resched+0x292/0x2d0
   [<00000383eaa7c374>] down_read+0x34/0x2d0
   [<00000383e99432f8>] do_secure_storage_access+0x108/0x360
   [<00000383eaa724b0>] __do_pgm_check+0x130/0x220
   [<00000383eaa842e4>] pgm_check_handler+0x114/0x160
   [<00000383ea47d028>] copy_page_from_iter_atomic+0x128/0x8a0
  ([<00000383ea47d016>] copy_page_from_iter_atomic+0x116/0x8a0)
   [<00000383e9c45eae>] generic_perform_write+0x16e/0x310
   [<00000383e9eb87f4>] ext4_buffered_write_iter+0x84/0x160
   [<00000383e9da0de4>] vfs_write+0x1c4/0x460
   [<00000383e9da123c>] ksys_write+0x7c/0x100
   [<00000383eaa7284e>] __do_syscall+0x15e/0x280
   [<00000383eaa8417e>] system_call+0x6e/0x90
  INFO: lockdep is turned off.

  It is not allowed to take the mmap_lock while in atomic context. Therefore
  handle such a secure storage access fault as if the accessed page is not
  mapped: the uaccess function will return -EFAULT, and the caller has to
  deal with this. Usually this means that the access is retried in process
  context, which allows to resolve the page fault (or in this case export the
  page).
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38359.json
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01701'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01721'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04718'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04724'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04754'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04788'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04671'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04701'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04708'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05661'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05642'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05733'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05755'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05798'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05687'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05632'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0565'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05748'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0575'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05625'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05752'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05682'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06374'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0636'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06342'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06379'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06345'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06328'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06366'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06435'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06469'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06486'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06481'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06414'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06396'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0639'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06407'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06389'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06384'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06372'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06383'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06485'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06458'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-366
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38359.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38359
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38359
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/11709abccf93b08adde95ef313c300b0d4bc28f1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d2e317dfd2d1fe416c77315d17c5d57dbe374915
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2383387
    reference_type:
    reference_id: 2383387
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38359
    reference_type:
    reference_id: CVE-2025-38359
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
