vulnerability_id: VCID-ycv4-8ewf-xuep
aliases:
  - CVE-2025-32782
  - GHSA-3988-q8q7-p787
summary: "ash_authentication has email link auto-click account confirmation vulnerability\n\
  ### Impact\n\nThe confirmation flow for account creation currently uses a GET request triggered\
  \ by clicking a link sent via email. Some email clients and security tools (e.g., Outlook,\
  \ virus scanners, and email previewers) may automatically follow these links, unintentionally\
  \ confirming the account. This allows an attacker to register an account using another user’s\
  \ email and potentially have it auto-confirmed by the victim’s email client.\n\nThis does\
  \ not allow attackers to take over or access existing accounts or private data. It is limited\
  \ to account confirmation of new accounts only.\n\n### Patches\nA mitigation has been released\
  \ in version `4.7.0`. You will also need to upgrade to `2.6.0` or later of `ash_authentication_phoenix`\
  \ to take advantage of the autogenerated views for confirmation. The fix updates the confirmation\
  \ flow to require explicit user interaction (such as clicking a button on the confirmation\
  \ page) rather than performing the confirmation via a GET request. This ensures that automatic\
  \ link prefetching or scanning by email clients does not unintentionally confirm accounts.\n\
  \nIn order to use this new confirmation flow, you will need to add this to your router to\
  \ get the desired behavior. It will add a new route to the new confirmation page LiveView.\
  \ Note the `path` and `token_as_route_param?` options, required for keeping backwards compatibility\
  \ with current defaults. You may need to adjust if you have changed those routes in some way.\n\
  \n```elixir\nconfirm_route(\n  MyApp.Accounts.User,\n  <confirmation_strategy_name>,\n  auth_routes_prefix:\
  \ \"/auth\",\n  overrides: [MyAppWeb.AuthOverrides, AshAuthentication.Phoenix.Overrides.Default],\n\
  \  # use these options to keep your currently issued confirmation emails compatible\n  # without\
  \ the options below, the route will default to `/<the_strategy_name>/:token`\n  path: \"/auth/user/<confirmation_strategy_name>\"\
  ,\n  token_as_route_param?: false\n)\n```\n\nUsers should upgrade to version `4.7.0` as soon\
  \ as possible, and set `require_interaction?` to `true` in their confirmation strategy. This\
  \ will change the `GET` request generated for confirming to a `POST` request. \n\nIf you upgrade\
  \ to this version and do not set `require_interaction?` to `true`, compilation will be fail\
  \ with a message linking to this advisory. This error can be bypassed if, for example, you\
  \ are confident that you are not affected.\n\n### Workarounds\n_Is there a way for users to\
  \ fix or remediate the vulnerability without upgrading?_\nYou can disable the confirmation\
  \ routes and create your own live view. We highly advised that you upgrade and take advantage\
  \ of the builtin views if possible. If you are not using the provided views, you will need\
  \ to *add* a confirmation LiveView, that does a `POST` to the old confirmation url instead\
  \ of a `GET`. You would do this by taking the token a parameter out of the link, and adding\
  \ it as a hidden field to a form. That form would have no inputs, only a button that posts\
  \ to the confirmation URL. If you are using Liveview, this would be done with `phx-trigger-action`\
  \ and `phx-action`."
severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12969'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13115'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13145'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13144'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13069'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16428'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16405'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.164'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16422'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16447'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16453'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16441'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/team-alembic/ash_authentication
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/team-alembic/ash_authentication
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/team-alembic/ash_authentication/commit/99ea38977fd4f421d2aaae0c2fb29f8e5f8f707d
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/team-alembic/ash_authentication/commit/99ea38977fd4f421d2aaae0c2fb29f8e5f8f707d
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-16T14:07:20Z/
    published_at: None
    url: https://github.com/team-alembic/ash_authentication/commit/99ea38977fd4f421d2aaae0c2fb29f8e5f8f707d
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/team-alembic/ash_authentication/security/advisories/GHSA-3988-q8q7-p787
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/team-alembic/ash_authentication/security/advisories/GHSA-3988-q8q7-p787
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-16T14:07:20Z/
    published_at: None
    url: https://github.com/team-alembic/ash_authentication/security/advisories/GHSA-3988-q8q7-p787
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-32782
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-32782
weaknesses:
  - CWE-306
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-32782
    reference_type:
    reference_id:
  - url: https://github.com/team-alembic/ash_authentication
    reference_type:
    reference_id:
  - url: https://github.com/team-alembic/ash_authentication/commit/99ea38977fd4f421d2aaae0c2fb29f8e5f8f707d
    reference_type:
    reference_id:
  - url: https://github.com/team-alembic/ash_authentication/security/advisories/GHSA-3988-q8q7-p787
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32782
    reference_type:
    reference_id:
