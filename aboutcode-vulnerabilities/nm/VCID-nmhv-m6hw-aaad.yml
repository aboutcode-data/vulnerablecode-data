vulnerability_id: VCID-nmhv-m6hw-aaad
aliases:
  - CVE-2022-31093
  - GHSA-g5fm-jp9v-2432
  - GMS-2022-2609
summary: NextAuth.js is a complete open source authentication solution for Next.js applications.
  In affected versions an attacker can send a request to an app using NextAuth.js with an invalid
  `callbackUrl` query parameter, which internally is converted to a `URL` object. The URL instantiation
  would fail due to a malformed URL being passed into the constructor, causing it to throw an
  unhandled error which led to the **API route handler timing out and logging in to fail**.
  This has been remedied in versions 3.29.5 and 4.5.0. If for some reason you cannot upgrade,
  the workaround requires you to rely on Advanced Initialization. Please see the documentation
  for more.
severities:
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54820'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54890'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.53885'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.53909'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.53923'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54192'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54845'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54484'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54546'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54566'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54634'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54629'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54638'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54653'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00168'
    scoring_system: epss
    scoring_elements: '0.54684'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00195'
    scoring_system: epss
    scoring_elements: '0.57500'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48371'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48372'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48395'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48406'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48375'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48388'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48349'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.50777'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.50765'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.50753'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.50833'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.50828'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.50808'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.5075'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.50704'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48366'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48379'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48399'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48418'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48269'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.4841'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00278'
    scoring_system: epss
    scoring_elements: '0.48246'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00296'
    scoring_system: epss
    scoring_elements: '0.52342'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00296'
    scoring_system: epss
    scoring_elements: '0.52367'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00296'
    scoring_system: epss
    scoring_elements: '0.52371'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00296'
    scoring_system: epss
    scoring_elements: '0.52395'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00296'
    scoring_system: epss
    scoring_elements: '0.52381'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00296'
    scoring_system: epss
    scoring_elements: '0.52368'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: '0.00361'
    scoring_system: epss
    scoring_elements: '0.41279'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-g5fm-jp9v-2432
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/nextauthjs/next-auth
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/25517b73153332d948114bacdff3b5908de91d85
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/25517b73153332d948114bacdff3b5908de91d85
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:53:50Z/
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/25517b73153332d948114bacdff3b5908de91d85
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/e498483b23273d1bfc81be68339607f88d411bd6
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/e498483b23273d1bfc81be68339607f88d411bd6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:53:50Z/
    published_at: None
    url: https://github.com/nextauthjs/next-auth/commit/e498483b23273d1bfc81be68339607f88d411bd6
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-g5fm-jp9v-2432
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-g5fm-jp9v-2432
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:53:50Z/
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-g5fm-jp9v-2432
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://next-auth.js.org/configuration/initialization#advanced-initialization
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://next-auth.js.org/configuration/initialization#advanced-initialization
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://next-auth.js.org/configuration/initialization#advanced-initialization
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:53:50Z/
    published_at: None
    url: https://next-auth.js.org/configuration/initialization#advanced-initialization
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31093
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31093
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31093
weaknesses:
  - CWE-754
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-31093
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/commit/25517b73153332d948114bacdff3b5908de91d85
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth/commit/e498483b23273d1bfc81be68339607f88d411bd6
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/initialization#advanced-initialization
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:nextauth.js:next-auth:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31093
    reference_type:
    reference_id: CVE-2022-31093
  - url: https://github.com/advisories/GHSA-g5fm-jp9v-2432
    reference_type:
    reference_id: GHSA-g5fm-jp9v-2432
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-g5fm-jp9v-2432
    reference_type:
    reference_id: GHSA-g5fm-jp9v-2432
