vulnerability_id: VCID-2ctn-ysec-aaar
aliases:
  - CVE-2024-32874
  - GHSA-w4h6-9wrp-v5jq
summary: "Malicious Long Unicode filenames may cause a Multiple Application-level Denial of\
  \ Service\n**Important: Exploiting this vulnerability requires the attacker to have access\
  \ to your Frigate instance, which means they could also just delete all of your recordings\
  \ or perform any other action. If you have configured authentication in front of Frigate via\
  \ a reverse proxy, then this vulnerability is not exploitable without first getting around\
  \ your authentication method. For many obvious reasons in addition to this one, please don't\
  \ expose your Frigate instance publicly without any kind of authentication.**\n\n## Summary\n\
  \nWhen uploading a file or retrieving the filename, a user may intentionally use a large Unicode\
  \ filename which would lead to a application-level denial of service. This is due to no limitation\
  \ set on the length of the filename and the costy use of the Unicode normalization with the\
  \ form NFKD under the hood of `secure_filename()`.\n\nI idenfied multiple vulnerable paths\
  \ on [blakeblackshear/frigate](https://www.github.com/blakeblackshear/frigate/) repository.\
  \ In all of those paths, it was possible for a malicious user to send a filename equals to\
  \ the output of : `python3 -c \"print('â„€' * 1_000_000)\"` which would reach the werkzeug `secure_filename()`\
  \ call , which in turn under the hood uses a compatibility Unicode normalization with NFKC/NFKD\
  \ form. In sum, the latter call would be costly in matter of CPU resource and may lead to\
  \ the application-level denial of service. \n\n## Vulnerable Paths\n\n<details>\n<summary>Path\
  \ with 2 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L379C20-L379C31)\n\
  \   <pre><code class=\"python\">@MediaBp.route(\"/&lt;camera_name&gt;/start/&lt;int:start_ts&gt;/end/&lt;int:end_ts&gt;/clip.mp4\"\
  )\n   @MediaBp.route(\"/&lt;camera_name&gt;/start/&lt;float:start_ts&gt;/end/&lt;float:end_ts&gt;/clip.mp4\"\
  )\n   def recording_clip(<strong>camera_name</strong>, start_ts, end_ts):\n       download\
  \ = request.args.get(\"download\", type=bool)\n\n   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78)\n\
  \   <pre><code class=\"python\">            playlist_lines.append(f\"outpoint {int(end_ts\
  \ - clip.start_time)}\")\n\n       file_name = secure_filename(<strong>f\"clip_{camera_name}_{start_ts}-{end_ts}.mp4\"\
  </strong>)\n       path = os.path.join(CACHE_DIR, file_name)\n\n   </code></pre>\n\n</details>\n\
  \n----------------------------------------\n\n[frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78)\n\
  \n<pre><code class=\"python\">            playlist_lines.append(f\"outpoint {int(end_ts -\
  \ clip.start_time)}\")\n\n    file_name = secure_filename(<strong>f\"clip_{camera_name}_{start_ts}-{end_ts}.mp4\"\
  </strong>)\n    path = os.path.join(CACHE_DIR, file_name)\n\n</code></pre>\n\n*This [user-provided\
  \ value](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L379C33-L379C41)\
  \ can reach a [costly Unicode normalization operation](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78).*\n\
  \n#### Paths\n\n<details>\n<summary>Path with 2 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L379C33-L379C41)\n\
  \   <pre><code class=\"python\">@MediaBp.route(\"/&lt;camera_name&gt;/start/&lt;int:start_ts&gt;/end/&lt;int:end_ts&gt;/clip.mp4\"\
  )\n   @MediaBp.route(\"/&lt;camera_name&gt;/start/&lt;float:start_ts&gt;/end/&lt;float:end_ts&gt;/clip.mp4\"\
  )\n   def recording_clip(camera_name, <strong>start_ts</strong>, end_ts):\n       download\
  \ = request.args.get(\"download\", type=bool)\n\n   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78)\n\
  \   <pre><code class=\"python\">            playlist_lines.append(f\"outpoint {int(end_ts\
  \ - clip.start_time)}\")\n\n       file_name = secure_filename(<strong>f\"clip_{camera_name}_{start_ts}-{end_ts}.mp4\"\
  </strong>)\n       path = os.path.join(CACHE_DIR, file_name)\n\n   </code></pre>\n\n</details>\n\
  \n----------------------------------------\n\n[frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78)\n\
  \n<pre><code class=\"python\">            playlist_lines.append(f\"outpoint {int(end_ts -\
  \ clip.start_time)}\")\n\n    file_name = secure_filename(<strong>f\"clip_{camera_name}_{start_ts}-{end_ts}.mp4\"\
  </strong>)\n    path = os.path.join(CACHE_DIR, file_name)\n\n</code></pre>\n\n*This [user-provided\
  \ value](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L379C43-L379C49)\
  \ can reach a [costly Unicode normalization operation](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78).*\n\
  \n#### Paths\n\n<details>\n<summary>Path with 2 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L379C43-L379C49)\n\
  \   <pre><code class=\"python\">@MediaBp.route(\"/&lt;camera_name&gt;/start/&lt;int:start_ts&gt;/end/&lt;int:end_ts&gt;/clip.mp4\"\
  )\n   @MediaBp.route(\"/&lt;camera_name&gt;/start/&lt;float:start_ts&gt;/end/&lt;float:end_ts&gt;/clip.mp4\"\
  )\n   def recording_clip(camera_name, start_ts, <strong>end_ts</strong>):\n       download\
  \ = request.args.get(\"download\", type=bool)\n\n   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78)\n\
  \   <pre><code class=\"python\">            playlist_lines.append(f\"outpoint {int(end_ts\
  \ - clip.start_time)}\")\n\n       file_name = secure_filename(<strong>f\"clip_{camera_name}_{start_ts}-{end_ts}.mp4\"\
  </strong>)\n       path = os.path.join(CACHE_DIR, file_name)\n\n   </code></pre>\n\n</details>\n\
  \n----------------------------------------\n\n[frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L646C25-L646C47)\n\
  \n<pre><code class=\"python\">        current_app.frigate_config,\n        camera_name,\n\
  \        secure_filename(<strong>name.replace(\" \", \"_\")</strong>) if name else None,\n\
  \        int(start_time),\n        int(end_time),\n</code></pre>\n\n*This [user-provided value](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L23C5-L23C12)\
  \ can reach a [costly Unicode normalization operation](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L646C25-L646C47).*\n\
  \n#### Paths\n\n<details>\n<summary>Path with 8 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L23C5-L23C12)\n\
  \   <pre><code class=\"python\">    jsonify,\n       make_response,\n       <strong>request</strong>,\n\
  \   )\n   from peewee import DoesNotExist, fn\n   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L23C5-L23C12)\n\
  \   <pre><code class=\"python\">    jsonify,\n       make_response,\n       <strong>request</strong>,\n\
  \   )\n   from peewee import DoesNotExist, fn\n   </code></pre>\n\n3. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L620C28-L620C35)\n\
  \   <pre><code class=\"python\">        )\n\n       json: dict[str, any] = <strong>request</strong>.get_json(silent=True)\
  \ or {}\n       playback_factor = json.get(\"playback\", \"realtime\")\n       name: Optional[str]\
  \ = json.get(\"name\")\n   </code></pre>\n\n4. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L620C5-L620C9)\n\
  \   <pre><code class=\"python\">        )\n\n       <strong>json</strong>: dict[str, any]\
  \ = request.get_json(silent=True) or {}\n       playback_factor = json.get(\"playback\", \"\
  realtime\")\n       name: Optional[str] = json.get(\"name\")\n   </code></pre>\n\n5. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L622C27-L622C31)\n\
  \   <pre><code class=\"python\">    json: dict[str, any] = request.get_json(silent=True) or\
  \ {}\n       playback_factor = json.get(\"playback\", \"realtime\")\n       name: Optional[str]\
  \ = <strong>json</strong>.get(\"name\")\n\n       recordings_count = (\n   </code></pre>\n\
  \n6. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L622C27-L622C43)\n\
  \   <pre><code class=\"python\">    json: dict[str, any] = request.get_json(silent=True) or\
  \ {}\n       playback_factor = json.get(\"playback\", \"realtime\")\n       name: Optional[str]\
  \ = <strong>json.get(\"name\")</strong>\n\n       recordings_count = (\n   </code></pre>\n\
  \n7. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L622C5-L622C9)\n\
  \   <pre><code class=\"python\">    json: dict[str, any] = request.get_json(silent=True) or\
  \ {}\n       playback_factor = json.get(\"playback\", \"realtime\")\n       <strong>name</strong>:\
  \ Optional[str] = json.get(\"name\")\n\n       recordings_count = (\n   </code></pre>\n\n\
  8. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L646C25-L646C47)\n\
  \   <pre><code class=\"python\">        current_app.frigate_config,\n           camera_name,\n\
  \           secure_filename(<strong>name.replace(\" \", \"_\")</strong>) if name else None,\n\
  \           int(start_time),\n           int(end_time),\n   </code></pre>\n\n</details>\n\n\
  ----------------------------------------\n\n[frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C9-L684C59)\n\
  \n<pre><code class=\"python\">def export_rename(file_name_current, file_name_new: str):\n\
  \    safe_file_name_current = secure_filename(\n        <strong>export_filename_check_extension(file_name_current)</strong>\n\
  \    )\n    file_current = os.path.join(EXPORT_DIR, safe_file_name_current)\n</code></pre>\n\
  \n*This [user-provided value](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L682C19-L682C36)\
  \ can reach a [costly Unicode normalization operation](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C9-L684C59).*\n\
  \n#### Paths\n\n<details>\n<summary>Path with 5 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L682C19-L682C36)\n\
  \   <pre><code class=\"python\">\n   @MediaBp.route(\"/export/&lt;file_name_current&gt;/&lt;file_name_new&gt;\"\
  , methods=[\"PATCH\"])\n   def export_rename(<strong>file_name_current</strong>, file_name_new:\
  \ str):\n       safe_file_name_current = secure_filename(\n           export_filename_check_extension(file_name_current)\n\
  \   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C41-L684C58)\n\
  \   <pre><code class=\"python\">def export_rename(file_name_current, file_name_new: str):\n\
  \       safe_file_name_current = secure_filename(\n           export_filename_check_extension(<strong>file_name_current</strong>)\n\
  \       )\n       file_current = os.path.join(EXPORT_DIR, safe_file_name_current)\n   </code></pre>\n\
  \n3. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L667C37-L667C45)\n\
  \   <pre><code class=\"python\">\n\n   def export_filename_check_extension(<strong>filename</strong>:\
  \ str):\n       if filename.endswith(\".mp4\"):\n           return filename\n   </code></pre>\n\
  \n4. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L669C16-L669C24)\n\
  \   <pre><code class=\"python\">def export_filename_check_extension(filename: str):\n    \
  \   if filename.endswith(\".mp4\"):\n           return <strong>filename</strong>\n       else:\n\
  \           return filename + \".mp4\"\n   </code></pre>\n\n5. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C9-L684C59)\n\
  \   <pre><code class=\"python\">def export_rename(file_name_current, file_name_new: str):\n\
  \       safe_file_name_current = secure_filename(\n           <strong>export_filename_check_extension(file_name_current)</strong>\n\
  \       )\n       file_current = os.path.join(EXPORT_DIR, safe_file_name_current)\n   </code></pre>\n\
  \n</details>\n\n<details>\n<summary>Path with 5 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L682C19-L682C36)\n\
  \   <pre><code class=\"python\">\n   @MediaBp.route(\"/export/&lt;file_name_current&gt;/&lt;file_name_new&gt;\"\
  , methods=[\"PATCH\"])\n   def export_rename(<strong>file_name_current</strong>, file_name_new:\
  \ str):\n       safe_file_name_current = secure_filename(\n           export_filename_check_extension(file_name_current)\n\
  \   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C41-L684C58)\n\
  \   <pre><code class=\"python\">def export_rename(file_name_current, file_name_new: str):\n\
  \       safe_file_name_current = secure_filename(\n           export_filename_check_extension(<strong>file_name_current</strong>)\n\
  \       )\n       file_current = os.path.join(EXPORT_DIR, safe_file_name_current)\n   </code></pre>\n\
  \n3. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L667C37-L667C45)\n\
  \   <pre><code class=\"python\">\n\n   def export_filename_check_extension(<strong>filename</strong>:\
  \ str):\n       if filename.endswith(\".mp4\"):\n           return filename\n   </code></pre>\n\
  \n4. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L671C16-L671C33)\n\
  \   <pre><code class=\"python\">        return filename\n       else:\n           return <strong>filename\
  \ + \".mp4\"</strong>\n\n\n   </code></pre>\n\n5. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C9-L684C59)\n\
  \   <pre><code class=\"python\">def export_rename(file_name_current, file_name_new: str):\n\
  \       safe_file_name_current = secure_filename(\n           <strong>export_filename_check_extension(file_name_current)</strong>\n\
  \       )\n       file_current = os.path.join(EXPORT_DIR, safe_file_name_current)\n   </code></pre>\n\
  \n</details>\n\n----------------------------------------\n\n[frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C42-L705C88)\n\
  \n<pre><code class=\"python\">        )\n\n    safe_file_name_new = secure_filename(<strong>export_filename_check_extension(file_name_new)</strong>)\n\
  \    file_new = os.path.join(EXPORT_DIR, safe_file_name_new)\n\n</code></pre>\n\n*This [user-provided\
  \ value](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L682C38-L682C51)\
  \ can reach a [costly Unicode normalization operation](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C42-L705C88).*\n\
  \n#### Paths\n\n<details>\n<summary>Path with 5 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L682C38-L682C51)\n\
  \   <pre><code class=\"python\">\n   @MediaBp.route(\"/export/&lt;file_name_current&gt;/&lt;file_name_new&gt;\"\
  , methods=[\"PATCH\"])\n   def export_rename(file_name_current, <strong>file_name_new</strong>:\
  \ str):\n       safe_file_name_current = secure_filename(\n           export_filename_check_extension(file_name_current)\n\
  \   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C74-L705C87)\n\
  \   <pre><code class=\"python\">        )\n\n       safe_file_name_new = secure_filename(export_filename_check_extension(<strong>file_name_new</strong>))\n\
  \       file_new = os.path.join(EXPORT_DIR, safe_file_name_new)\n\n   </code></pre>\n\n3.\
  \ [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L667C37-L667C45)\n\
  \   <pre><code class=\"python\">\n\n   def export_filename_check_extension(<strong>filename</strong>:\
  \ str):\n       if filename.endswith(\".mp4\"):\n           return filename\n   </code></pre>\n\
  \n4. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L669C16-L669C24)\n\
  \   <pre><code class=\"python\">def export_filename_check_extension(filename: str):\n    \
  \   if filename.endswith(\".mp4\"):\n           return <strong>filename</strong>\n       else:\n\
  \           return filename + \".mp4\"\n   </code></pre>\n\n5. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C42-L705C88)\n\
  \   <pre><code class=\"python\">        )\n\n       safe_file_name_new = secure_filename(<strong>export_filename_check_extension(file_name_new)</strong>)\n\
  \       file_new = os.path.join(EXPORT_DIR, safe_file_name_new)\n\n   </code></pre>\n\n</details>\n\
  \n<details>\n<summary>Path with 5 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L682C38-L682C51)\n\
  \   <pre><code class=\"python\">\n   @MediaBp.route(\"/export/&lt;file_name_current&gt;/&lt;file_name_new&gt;\"\
  , methods=[\"PATCH\"])\n   def export_rename(file_name_current, <strong>file_name_new</strong>:\
  \ str):\n       safe_file_name_current = secure_filename(\n           export_filename_check_extension(file_name_current)\n\
  \   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C74-L705C87)\n\
  \   <pre><code class=\"python\">        )\n\n       safe_file_name_new = secure_filename(export_filename_check_extension(<strong>file_name_new</strong>))\n\
  \       file_new = os.path.join(EXPORT_DIR, safe_file_name_new)\n\n   </code></pre>\n\n3.\
  \ [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L667C37-L667C45)\n\
  \   <pre><code class=\"python\">\n\n   def export_filename_check_extension(<strong>filename</strong>:\
  \ str):\n       if filename.endswith(\".mp4\"):\n           return filename\n   </code></pre>\n\
  \n4. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L671C16-L671C33)\n\
  \   <pre><code class=\"python\">        return filename\n       else:\n           return <strong>filename\
  \ + \".mp4\"</strong>\n\n\n   </code></pre>\n\n5. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C42-L705C88)\n\
  \   <pre><code class=\"python\">        )\n\n       safe_file_name_new = secure_filename(<strong>export_filename_check_extension(file_name_new)</strong>)\n\
  \       file_new = os.path.join(EXPORT_DIR, safe_file_name_new)\n\n   </code></pre>\n\n</details>\n\
  \n----------------------------------------\n\n[frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C38-L728C80)\n\
  \n<pre><code class=\"python\">@MediaBp.route(\"/export/&lt;file_name&gt;\", methods=[\"DELETE\"\
  ])\ndef export_delete(file_name: str):\n    safe_file_name = secure_filename(<strong>export_filename_check_extension(file_name)</strong>)\n\
  \    file = os.path.join(EXPORT_DIR, safe_file_name)\n\n</code></pre>\n\n*This [user-provided\
  \ value](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L727C19-L727C28)\
  \ can reach a [costly Unicode normalization operation](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C38-L728C80).*\n\
  \n#### Paths\n\n<details>\n<summary>Path with 5 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L727C19-L727C28)\n\
  \   <pre><code class=\"python\">\n   @MediaBp.route(\"/export/&lt;file_name&gt;\", methods=[\"\
  DELETE\"])\n   def export_delete(<strong>file_name</strong>: str):\n       safe_file_name\
  \ = secure_filename(export_filename_check_extension(file_name))\n       file = os.path.join(EXPORT_DIR,\
  \ safe_file_name)\n   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C70-L728C79)\n\
  \   <pre><code class=\"python\">@MediaBp.route(\"/export/&lt;file_name&gt;\", methods=[\"\
  DELETE\"])\n   def export_delete(file_name: str):\n       safe_file_name = secure_filename(export_filename_check_extension(<strong>file_name</strong>))\n\
  \       file = os.path.join(EXPORT_DIR, safe_file_name)\n\n   </code></pre>\n\n3. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L667C37-L667C45)\n\
  \   <pre><code class=\"python\">\n\n   def export_filename_check_extension(<strong>filename</strong>:\
  \ str):\n       if filename.endswith(\".mp4\"):\n           return filename\n   </code></pre>\n\
  \n4. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L669C16-L669C24)\n\
  \   <pre><code class=\"python\">def export_filename_check_extension(filename: str):\n    \
  \   if filename.endswith(\".mp4\"):\n           return <strong>filename</strong>\n       else:\n\
  \           return filename + \".mp4\"\n   </code></pre>\n\n5. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C38-L728C80)\n\
  \   <pre><code class=\"python\">@MediaBp.route(\"/export/&lt;file_name&gt;\", methods=[\"\
  DELETE\"])\n   def export_delete(file_name: str):\n       safe_file_name = secure_filename(<strong>export_filename_check_extension(file_name)</strong>)\n\
  \       file = os.path.join(EXPORT_DIR, safe_file_name)\n\n   </code></pre>\n\n</details>\n\
  \n<details>\n<summary>Path with 5 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L727C19-L727C28)\n\
  \   <pre><code class=\"python\">\n   @MediaBp.route(\"/export/&lt;file_name&gt;\", methods=[\"\
  DELETE\"])\n   def export_delete(<strong>file_name</strong>: str):\n       safe_file_name\
  \ = secure_filename(export_filename_check_extension(file_name))\n       file = os.path.join(EXPORT_DIR,\
  \ safe_file_name)\n   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C70-L728C79)\n\
  \   <pre><code class=\"python\">@MediaBp.route(\"/export/&lt;file_name&gt;\", methods=[\"\
  DELETE\"])\n   def export_delete(file_name: str):\n       safe_file_name = secure_filename(export_filename_check_extension(<strong>file_name</strong>))\n\
  \       file = os.path.join(EXPORT_DIR, safe_file_name)\n\n   </code></pre>\n\n3. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L667C37-L667C45)\n\
  \   <pre><code class=\"python\">\n\n   def export_filename_check_extension(<strong>filename</strong>:\
  \ str):\n       if filename.endswith(\".mp4\"):\n           return filename\n   </code></pre>\n\
  \n4. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L671C16-L671C33)\n\
  \   <pre><code class=\"python\">        return filename\n       else:\n           return <strong>filename\
  \ + \".mp4\"</strong>\n\n\n   </code></pre>\n\n5. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C38-L728C80)\n\
  \   <pre><code class=\"python\">@MediaBp.route(\"/export/&lt;file_name&gt;\", methods=[\"\
  DELETE\"])\n   def export_delete(file_name: str):\n       safe_file_name = secure_filename(<strong>export_filename_check_extension(file_name)</strong>)\n\
  \       file = os.path.join(EXPORT_DIR, safe_file_name)\n\n   </code></pre>\n\n</details>\n\
  \n----------------------------------------\n\n[frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1346C46-L1346C55)\n\
  \n<pre><code class=\"python\">def preview_thumbnail(file_name: str):\n    \"\"\"Get a thumbnail\
  \ from the cached preview frames.\"\"\"\n    safe_file_name_current = secure_filename(<strong>file_name</strong>)\n\
  \    preview_dir = os.path.join(CACHE_DIR, \"preview_frames\")\n\n</code></pre>\n\n*This [user-provided\
  \ value](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1344C23-L1344C32)\
  \ can reach a [costly Unicode normalization operation](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1346C46-L1346C55).*\n\
  \n#### Paths\n\n<details>\n<summary>Path with 2 steps</summary>\n\n1. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1344C23-L1344C32)\n\
  \   <pre><code class=\"python\">@MediaBp.route(\"/preview/&lt;file_name&gt;/thumbnail.jpg\"\
  )\n   @MediaBp.route(\"/preview/&lt;file_name&gt;/thumbnail.webp\")\n   def preview_thumbnail(<strong>file_name</strong>:\
  \ str):\n       \"\"\"Get a thumbnail from the cached preview frames.\"\"\"\n       safe_file_name_current\
  \ = secure_filename(file_name)\n   </code></pre>\n\n2. [frigate/api/media.py](https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1346C46-L1346C55)\n\
  \   <pre><code class=\"python\">def preview_thumbnail(file_name: str):\n       \"\"\"Get a\
  \ thumbnail from the cached preview frames.\"\"\"\n       safe_file_name_current = secure_filename(<strong>file_name</strong>)\n\
  \       preview_dir = os.path.join(CACHE_DIR, \"preview_frames\")\n\n   </code></pre>\n\n\
  </details>\n\n\n\n## Impact\n\n* Application-level Denial of Service, the web app would hung\
  \ undefinetly and not process any further request due to the use of the malicious payload.\n\
  \  \n\n## Mitigation\n\n* Limiting the length of the incoming filename, similar to this commit\
  \ [fix](https://github.com/django/django/commit/048a9ebb6ea468426cb4e57c71572cbbd975517f).\n\
  \  \n\n## References\n\n* Similar to [CVE-2023-46695](https://github.com/advisories/GHSA-qmf9-6jqf-j8fq\
  \ \"CVE-2023-46695\")"
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44758'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44756'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44814'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44874'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44901'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44898'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44797'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44792'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44802'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44816'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.4482'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44833'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0022'
    scoring_system: epss
    scoring_elements: '0.44794'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48627'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.4862'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48639'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48659'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48666'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48648'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48609'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48523'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48501'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48617'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48618'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48644'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48654'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48624'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.0028'
    scoring_system: epss
    scoring_elements: '0.48598'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: '0.00318'
    scoring_system: epss
    scoring_elements: '0.38428'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-w4h6-9wrp-v5jq
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url: https://github.com/blakeblackshear/frigate
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/blakeblackshear/frigate
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1346C46-L1346C55
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1346C46-L1346C55
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L646C25-L646C47
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L646C25-L646C47
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C9-L684C59
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C9-L684C59
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C42-L705C88
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C42-L705C88
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C38-L728C80
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C38-L728C80
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url: https://github.com/blakeblackshear/frigate/commit/cc851555e4029647986dccc8b8ecf54afee31442
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/blakeblackshear/frigate/commit/cc851555e4029647986dccc8b8ecf54afee31442
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:H
    published_at: None
    url: https://github.com/blakeblackshear/frigate/security/advisories/GHSA-w4h6-9wrp-v5jq
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/blakeblackshear/frigate/security/advisories/GHSA-w4h6-9wrp-v5jq
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-770
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-32874
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L1346C46-L1346C55
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L408C33-L408C78
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L646C25-L646C47
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L684C9-L684C59
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L705C42-L705C88
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/blob/d7ae0eedf89e14f297093ac5c8042862034cbaeb/frigate/api/media.py#L728C38-L728C80
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/commit/cc851555e4029647986dccc8b8ecf54afee31442
    reference_type:
    reference_id:
  - url: https://github.com/blakeblackshear/frigate/security/advisories/GHSA-w4h6-9wrp-v5jq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32874
    reference_type:
    reference_id: CVE-2024-32874
  - url: https://github.com/advisories/GHSA-w4h6-9wrp-v5jq
    reference_type:
    reference_id: GHSA-w4h6-9wrp-v5jq
