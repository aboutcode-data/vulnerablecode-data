vulnerability_id: VCID-2c6j-yb46-hbbp
aliases:
  - CVE-2025-37753
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\ns390/cpumf:\
  \ Fix double free on error in cpumf_pmu_event_init()\n\nIn PMU event initialization functions\n\
  \ - cpumsf_pmu_event_init()\n - cpumf_pmu_event_init()\n - cfdiag_event_init()\nthe partially\
  \ created event had to be removed when an error was detected.\nThe event::event_init() member\
  \ function had to release all resources\nit allocated in case of error. event::destroy() had\
  \ to be called\non freeing an event after it was successfully created and\nevent::event_init()\
  \ returned success.\n\nWith\n\ncommit c70ca298036c (\"perf/core: Simplify the perf_event_alloc()\
  \ error path\")\n\nthis is not necessary anymore. The performance subsystem common\ncode now\
  \ always calls event::destroy() to clean up the allocated\nresources created during event\
  \ initialization.\n\nRemove the event::destroy() invocation in PMU event initialization\n\
  or that function is called twice for each event that runs into an\nerror condition in event\
  \ creation.\n\nThis is the kernel log entry which shows up without the fix:\n\n------------[\
  \ cut here ]------------\nrefcount_t: underflow; use-after-free.\nWARNING: CPU: 0 PID: 43388\
  \ at lib/refcount.c:87\trefcount_dec_not_one+0x74/0x90\nCPU: 0 UID: 0 PID: 43388 Comm: perf\
  \ Not tainted 6.15.0-20250407.rc1.git0.300.fc41.s390x+git #1 NONE\nHardware name: IBM 3931\
  \ A01 704 (LPAR)\nKrnl PSW : 0704c00180000000 00000209cb2c1b88 (refcount_dec_not_one+0x78/0x90)\n\
  \           R:0 T:1 IO:1 EX:1 Key:0 M:1 W:0 P:0 AS:3 CC:0 PM:0 RI:0 EA:3\nKrnl GPRS: 0000020900000027\
  \ 0000020900000023 0000000000000026 0000018900000000\n           00000004a2200a00 0000000000000000\
  \ 0000000000000057 ffffffffffffffea\n           00000002b386c600 00000002b3f5b3e0 00000209cc51f140\
  \ 00000209cc7fc550\n           0000000001449d38 ffffffffffffffff 00000209cb2c1b84 00000189d67dfb80\n\
  Krnl Code: 00000209cb2c1b78: c02000506727\tlarl\t%r2,00000209cbcce9c6\n           00000209cb2c1b7e:\
  \ c0e5ffbd4431\tbrasl\t%r14,00000209caa6a3e0\n          #00000209cb2c1b84: af000000\t\tmc\t\
  0,0\n          >00000209cb2c1b88: a7480001\t\tlhi\t%r4,1\n           00000209cb2c1b8c: ebeff0a00004\t\
  lmg\t%r14,%r15,160(%r15)\n           00000209cb2c1b92: ec243fbf0055\trisbg\t%r2,%r4,63,191,0\n\
  \           00000209cb2c1b98: 07fe\t\tbcr\t15,%r14\n           00000209cb2c1b9a: 47000700\t\
  \tbc\t0,1792\nCall Trace:\n [<00000209cb2c1b88>] refcount_dec_not_one+0x78/0x90\n [<00000209cb2c1dc4>]\
  \ refcount_dec_and_mutex_lock+0x24/0x90\n [<00000209caa3c29e>] hw_perf_event_destroy+0x2e/0x80\n\
  \ [<00000209cacaf8b4>] __free_event+0x74/0x270\n [<00000209cacb47c4>] perf_event_alloc.part.0+0x4a4/0x730\n\
  \ [<00000209cacbf3e8>] __do_sys_perf_event_open+0x248/0xc20\n [<00000209cacc14a4>] __s390x_sys_perf_event_open+0x44/0x50\n\
  \ [<00000209cb8114de>] __do_syscall+0x12e/0x260\n [<00000209cb81ce34>] system_call+0x74/0x98\n\
  Last Breaking-Event-Address:\n [<00000209caa6a4d2>] __warn_printk+0xf2/0x100\n---[ end trace\
  \ 0000000000000000 ]---"
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-37753.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02902'
    published_at: '2025-05-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02897'
    published_at: '2025-05-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03079'
    published_at: '2025-05-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03096'
    published_at: '2025-05-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02974'
    published_at: '2025-05-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04659'
    published_at: '2025-05-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0467'
    published_at: '2025-05-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04668'
    published_at: '2025-05-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04633'
    published_at: '2025-05-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04698'
    published_at: '2025-05-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04662'
    published_at: '2025-05-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04649'
    published_at: '2025-05-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04648'
    published_at: '2025-05-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0466'
    published_at: '2025-05-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04675'
    published_at: '2025-05-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04729'
    published_at: '2025-05-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04778'
    published_at: '2025-05-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04746'
    published_at: '2025-05-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04691'
    published_at: '2025-05-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04696'
    published_at: '2025-05-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04678'
    published_at: '2025-05-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04663'
    published_at: '2025-05-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
  - score: '0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-37753.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-37753
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3a3faf873db5dcd5d2622d8e2accb90af0a86c2d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa1ac98268cd1f380c713f07e39b1fa1d5c7650c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bdbecb2bf531fadbbc9347a79009f7a58ea7eb03
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ddf60c1491102dab04491481bc3376d3e9cd139d
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2363352
    reference_type:
    reference_id: 2363352
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-37753
    reference_type:
    reference_id: CVE-2025-37753
