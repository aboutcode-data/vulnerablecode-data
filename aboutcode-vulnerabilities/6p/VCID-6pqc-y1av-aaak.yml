vulnerability_id: VCID-6pqc-y1av-aaak
aliases:
  - GHSA-w5w5-8vfh-xcjq
summary: |
  whoami stack buffer overflow on several Unix platforms
  With versions of the whoami crate >= 0.5.3 and < 1.5.0, calling any of these functions leads to an immediate stack buffer overflow on illumos and Solaris:

  - `whoami::username`
  - `whoami::realname`
  - `whoami::username_os`
  - `whoami::realname_os`

  With versions of the whoami crate >= 0.5.3 and < 1.0.1, calling any of the above functions also leads to a stack buffer overflow on these platforms:

  - Bitrig
  - DragonFlyBSD
  - FreeBSD
  - NetBSD
  - OpenBSD

  This occurs because of an incorrect definition of the `passwd` struct on those platforms.

  As a result of this issue, denial of service and data corruption have both been observed in the wild. The issue is possibly exploitable as well.

  This vulnerability also affects other Unix platforms that aren't Linux or macOS.

  This issue has been addressed in whoami 1.5.0.

  For more information, see [this GitHub issue](https://github.com/ardaku/whoami/issues/91).
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-w5w5-8vfh-xcjq
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/ardaku/whoami
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ardaku/whoami
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/ardaku/whoami/commit/d6ee13ed9e818aa51b8d86d95e8009a376289a40
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ardaku/whoami/commit/d6ee13ed9e818aa51b8d86d95e8009a376289a40
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/ardaku/whoami/issues/91
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ardaku/whoami/issues/91
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2024-0020.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2024-0020.html
weaknesses:
  - CWE-121
references:
  - url: https://github.com/ardaku/whoami
    reference_type:
    reference_id:
  - url: https://github.com/ardaku/whoami/commit/d6ee13ed9e818aa51b8d86d95e8009a376289a40
    reference_type:
    reference_id:
  - url: https://github.com/ardaku/whoami/issues/91
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2024-0020.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-w5w5-8vfh-xcjq
    reference_type:
    reference_id: GHSA-w5w5-8vfh-xcjq
