vulnerability_id: VCID-cyq7-16v4-aaah
aliases:
  - GHSA-5fm9-h728-fwpj
summary: |
  trust-dns vulnerable to Remote Attackers causing Denial-of-Service (packet loops) with crafted DNS packets
  trust-dns and trust-dns-server are vulnerable to remotely triggered denial-of-service attacks, consuming both network and CPU resources.
  DNS messages with the QR=1 bit set are responded to with a `FormErr` response.
  This allows creating a traffic loop, in which these `FormErr` responses are sent nonstop between vulnerable servers.

  There are two scenarios how this can be exploited: 1) Create a loop between two instances of trust-dns, consuming network resources, or 2) consuming the CPU of a single instance.

  With two instances *A* and *B* an attacker sends a DNS query with a spoofed source IP address to *A*.
  *A* replies with a `FormErr` to *B*.
  Now both servers with ping-pong the message back and forth until by chance the packet is dropped in the network.
  Multiple spoofed packets can be sent by the attacker, increasing resource consumption.

  A single server can get locked up replying to itself.
  Same setup as above, but now *A* sends the reply to itself.
  The packet is sent out as fast as the CPU and network stack manage.
  This locks up a CPU core.
  Multiple packets from the attacker consume multiple CPU cores.
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5fm9-h728-fwpj
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/bluejekyll/trust-dns
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bluejekyll/trust-dns
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bluejekyll/trust-dns/pull/1952
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2023-0041.html
weaknesses: []
references:
  - url: https://github.com/bluejekyll/trust-dns
    reference_type:
    reference_id:
  - url: https://github.com/bluejekyll/trust-dns/pull/1952
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2023-0041.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5fm9-h728-fwpj
    reference_type:
    reference_id: GHSA-5fm9-h728-fwpj
