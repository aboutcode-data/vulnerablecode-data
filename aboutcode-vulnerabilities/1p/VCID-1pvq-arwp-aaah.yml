vulnerability_id: VCID-1pvq-arwp-aaah
aliases:
  - CVE-2023-51747
  - GHSA-p5q9-86w4-2xr5
summary: |
  Apache James prior to versions 3.8.1 and 3.7.5 is vulnerable to SMTP smuggling.

  A lenient behaviour in line delimiter handling might create a difference of interpretation between the sender and the receiver which can be exploited by an attacker to forge an SMTP envelop, allowing for instance to bypass SPF checks.

  The patch implies enforcement of CRLF as a line delimiter as part of the DATA transaction.

  We recommend James users to upgrade to non vulnerable versions.
severities:
  - score: '7.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-51747.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21918'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21759'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21824'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21869'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21926'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21916'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21899'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21892'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21887'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21901'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21911'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21934'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21928'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21925'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38095'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.37965'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38003'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38038'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38073'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38108'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38134'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38137'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38105'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38082'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38068'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38124'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.38098'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: '0.0051'
    scoring_system: epss
    scoring_elements: '0.49247'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p5q9-86w4-2xr5
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p5q9-86w4-2xr5
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://github.com/apache/james-project
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/james-project
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/james-project
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://github.com/apache/james-project/commit/d1ef102540e504c067b6c1721a6f1e7eee9c6fc6
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/james-project/commit/d1ef102540e504c067b6c1721a6f1e7eee9c6fc6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/james-project/commit/d1ef102540e504c067b6c1721a6f1e7eee9c6fc6
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://github.com/apache/james-project/commit/d5cd8bb098aa78d8d62c9645f3c532689ef1cb03
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/james-project/commit/d5cd8bb098aa78d8d62c9645f3c532689ef1cb03
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/james-project/commit/d5cd8bb098aa78d8d62c9645f3c532689ef1cb03
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://lists.apache.org/thread/rxkwbkh9vgbl9rzx1fkllyk3krhgydko
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/rxkwbkh9vgbl9rzx1fkllyk3krhgydko
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/rxkwbkh9vgbl9rzx1fkllyk3krhgydko
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-15T20:37:43Z/
    published_at: None
    url: https://lists.apache.org/thread/rxkwbkh9vgbl9rzx1fkllyk3krhgydko
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-51747
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-51747
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://postfix.org/smtp-smuggling.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://postfix.org/smtp-smuggling.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://postfix.org/smtp-smuggling.html
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-15T20:37:43Z/
    published_at: None
    url: https://postfix.org/smtp-smuggling.html
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-15T20:37:43Z/
    published_at: None
    url: https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/02/27/4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/02/27/4
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/02/27/4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-03-15T20:37:43Z/
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/02/27/4
weaknesses:
  - CWE-20
  - CWE-937
  - CWE-1035
  - CWE-290
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-51747.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-51747
    reference_type:
    reference_id:
  - url: https://github.com/apache/james-project
    reference_type:
    reference_id:
  - url: https://github.com/apache/james-project/commit/d1ef102540e504c067b6c1721a6f1e7eee9c6fc6
    reference_type:
    reference_id:
  - url: https://github.com/apache/james-project/commit/d5cd8bb098aa78d8d62c9645f3c532689ef1cb03
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/rxkwbkh9vgbl9rzx1fkllyk3krhgydko
    reference_type:
    reference_id:
  - url: https://postfix.org/smtp-smuggling.html
    reference_type:
    reference_id:
  - url: https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide
    reference_type:
    reference_id:
  - url: https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/02/27/4
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2267363
    reference_type:
    reference_id: 2267363
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-51747
    reference_type:
    reference_id: CVE-2023-51747
  - url: https://github.com/advisories/GHSA-p5q9-86w4-2xr5
    reference_type:
    reference_id: GHSA-p5q9-86w4-2xr5
