vulnerability_id: VCID-h8zw-5hqr-ukf6
aliases:
  - CVE-2022-50248
summary: 'In the Linux kernel, the following vulnerability has been resolved:  wifi: iwlwifi:
  mvm: fix double free on tx path.  We see kernel crashes and lockups and KASAN errors related
  to ax210 firmware crashes.  One of the KASAN dumps pointed at the tx path, and it appears
  there is indeed a way to double-free an skb.  If iwl_mvm_tx_skb_sta returns non-zero, then
  the ''skb'' sent into the method will be freed.  But, in case where we build TSO skb buffer,
  the skb may also be freed in error case.  So, return 0 in that particular error case and do
  cleanup manually.  BUG: KASAN: use-after-free in __list_del_entry_valid+0x12/0x90 iwlwifi
  0000:06:00.0: 0x00000000 | tsf hi Read of size 8 at addr ffff88813cfa4ba0 by task btserver/9650  CPU:
  4 PID: 9650 Comm: btserver Tainted: G        W         5.19.8+ #5 iwlwifi 0000:06:00.0: 0x00000000
  | time gp1 Hardware name: Default string Default string/SKYBAY, BIOS 5.12 02/19/2019 Call
  Trace:  <TASK>  dump_stack_lvl+0x55/0x6d  print_report.cold.12+0xf2/0x684 iwlwifi 0000:06:00.0:
  0x1D0915A8 | time gp2  ? __list_del_entry_valid+0x12/0x90  kasan_report+0x8b/0x180 iwlwifi
  0000:06:00.0: 0x00000001 | uCode revision type  ? __list_del_entry_valid+0x12/0x90  __list_del_entry_valid+0x12/0x90
  iwlwifi 0000:06:00.0: 0x00000048 | uCode version major  tcp_update_skb_after_send+0x5d/0x170  __tcp_transmit_skb+0xb61/0x15c0
  iwlwifi 0000:06:00.0: 0xDAA05125 | uCode version minor  ? __tcp_select_window+0x490/0x490
  iwlwifi 0000:06:00.0: 0x00000420 | hw version  ? trace_kmalloc_node+0x29/0xd0  ? __kmalloc_node_track_caller+0x12a/0x260  ?
  memset+0x1f/0x40  ? __build_skb_around+0x125/0x150  ? __alloc_skb+0x1d4/0x220  ? skb_zerocopy_clone+0x55/0x230
  iwlwifi 0000:06:00.0: 0x00489002 | board version  ? kmalloc_reserve+0x80/0x80  ? rcu_read_lock_bh_held+0x60/0xb0  tcp_write_xmit+0x3f1/0x24d0
  iwlwifi 0000:06:00.0: 0x034E001C | hcmd  ? __check_object_size+0x180/0x350 iwlwifi 0000:06:00.0:
  0x24020000 | isr0  tcp_sendmsg_locked+0x8a9/0x1520 iwlwifi 0000:06:00.0: 0x01400000 | isr1  ?
  tcp_sendpage+0x50/0x50 iwlwifi 0000:06:00.0: 0x48F0000A | isr2  ? lock_release+0xb9/0x400  ?
  tcp_sendmsg+0x14/0x40 iwlwifi 0000:06:00.0: 0x00C3080C | isr3  ? lock_downgrade+0x390/0x390  ?
  do_raw_spin_lock+0x114/0x1d0 iwlwifi 0000:06:00.0: 0x00200000 | isr4  ? rwlock_bug.part.2+0x50/0x50
  iwlwifi 0000:06:00.0: 0x034A001C | last cmd Id  ? rwlock_bug.part.2+0x50/0x50  ? lockdep_hardirqs_on_prepare+0xe/0x200
  iwlwifi 0000:06:00.0: 0x0000C2F0 | wait_event  ? __local_bh_enable_ip+0x87/0xe0  ? inet_send_prepare+0x220/0x220
  iwlwifi 0000:06:00.0: 0x000000C4 | l2p_control  tcp_sendmsg+0x22/0x40  sock_sendmsg+0x5f/0x70
  iwlwifi 0000:06:00.0: 0x00010034 | l2p_duration  __sys_sendto+0x19d/0x250 iwlwifi 0000:06:00.0:
  0x00000007 | l2p_mhvalid  ? __ia32_sys_getpeername+0x40/0x40 iwlwifi 0000:06:00.0: 0x00000000
  | l2p_addr_match  ? rcu_read_lock_held_common+0x12/0x50  ? rcu_read_lock_sched_held+0x5a/0xd0  ?
  rcu_read_lock_bh_held+0xb0/0xb0  ? rcu_read_lock_sched_held+0x5a/0xd0  ? rcu_read_lock_sched_held+0x5a/0xd0  ?
  lock_release+0xb9/0x400  ? lock_downgrade+0x390/0x390  ? ktime_get+0x64/0x130  ? ktime_get+0x8d/0x130  ?
  rcu_read_lock_held_common+0x12/0x50  ? rcu_read_lock_sched_held+0x5a/0xd0  ? rcu_read_lock_held_common+0x12/0x50  ?
  rcu_read_lock_sched_held+0x5a/0xd0  ? rcu_read_lock_bh_held+0xb0/0xb0  ? rcu_read_lock_bh_held+0xb0/0xb0  __x64_sys_sendto+0x6f/0x80  do_syscall_64+0x34/0xb0  entry_SYSCALL_64_after_hwframe+0x46/0xb0
  RIP: 0033:0x7f1d126e4531 Code: 00 00 00 00 0f 1f 44 00 00 f3 0f 1e fa 48 8d 05 35 80 0c 00
  41 89 ca 8b 00 85 c0 75 1c 45 31 c9 45 31 c0 b8 2c 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 67
  c3 66 0f 1f 44 00 00 55 48 83 ec 20 48 89 RSP: 002b:00007ffe21a679d8 EFLAGS: 00000246 ORIG_RAX:
  000000000000002c RAX: ffffffffffffffda RBX: 000000000000ffdc RCX: 00007f1d126e4531 RDX: 0000000000010000
  RSI: 000000000374acf0 RDI: 0000000000000014 RBP: 00007ffe21a67ac0 R08: 0000000000000000 R09:
  0000000000000000 R10: 0000000000000000 R11: 0000000000000246 R ---truncated---'
severities:
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50248.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50248.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03739'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0374'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05085'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05164'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08145'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0808'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08136'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08117'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08106'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08235'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08288'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08304'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08148'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07772'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07843'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0783'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0801'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08001'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08009'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09362'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09308'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09293'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09402'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0934'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09352'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09363'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09383'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09511'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09468'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09374'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
  - score: 7
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-415
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50248.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50248
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-50248
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2395252
    reference_type:
    reference_id: 2395252
