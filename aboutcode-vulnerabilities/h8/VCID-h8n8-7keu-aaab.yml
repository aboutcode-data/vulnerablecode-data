vulnerability_id: VCID-h8n8-7keu-aaab
aliases:
  - CVE-2024-38594
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: stmmac: move the EST lock to struct stmmac_priv

  Reinitialize the whole EST structure would also reset the mutex
  lock which is embedded in the EST structure, and then trigger
  the following warning. To address this, move the lock to struct
  stmmac_priv. We also need to reacquire the mutex lock when doing
  this initialization.

  DEBUG_LOCKS_WARN_ON(lock->magic != lock)
  WARNING: CPU: 3 PID: 505 at kernel/locking/mutex.c:587 __mutex_lock+0xd84/0x1068
   Modules linked in:
   CPU: 3 PID: 505 Comm: tc Not tainted 6.9.0-rc6-00053-g0106679839f7-dirty #29
   Hardware name: NXP i.MX8MPlus EVK board (DT)
   pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
   pc : __mutex_lock+0xd84/0x1068
   lr : __mutex_lock+0xd84/0x1068
   sp : ffffffc0864e3570
   x29: ffffffc0864e3570 x28: ffffffc0817bdc78 x27: 0000000000000003
   x26: ffffff80c54f1808 x25: ffffff80c9164080 x24: ffffffc080d723ac
   x23: 0000000000000000 x22: 0000000000000002 x21: 0000000000000000
   x20: 0000000000000000 x19: ffffffc083bc3000 x18: ffffffffffffffff
   x17: ffffffc08117b080 x16: 0000000000000002 x15: ffffff80d2d40000
   x14: 00000000000002da x13: ffffff80d2d404b8 x12: ffffffc082b5a5c8
   x11: ffffffc082bca680 x10: ffffffc082bb2640 x9 : ffffffc082bb2698
   x8 : 0000000000017fe8 x7 : c0000000ffffefff x6 : 0000000000000001
   x5 : ffffff8178fe0d48 x4 : 0000000000000000 x3 : 0000000000000027
   x2 : ffffff8178fe0d50 x1 : 0000000000000000 x0 : 0000000000000000
   Call trace:
    __mutex_lock+0xd84/0x1068
    mutex_lock_nested+0x28/0x34
    tc_setup_taprio+0x118/0x68c
    stmmac_setup_tc+0x50/0xf0
    taprio_change+0x868/0xc9c
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-38594.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34037'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.33998'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34065'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34131'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.3417'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34175'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34091'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34076'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34078'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.3408'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34097'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34089'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.34062'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.35349'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.35231'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.35331'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.35198'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.35347'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35393'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35437'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35405'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35363'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35346'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.3536'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35432'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35415'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35382'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '0.00723'
    scoring_system: epss
    scoring_elements: '0.57053'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:13:43Z/
    published_at: None
    url: https://git.kernel.org/stable/c/b538fefeb1026aad9dcdcbb410c42b56dff8aae9
weaknesses:
  - CWE-413
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-38594.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-38594
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-38594
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/36ac9e7f2e5786bd37c5cd91132e1f39c29b8197
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/487f9030b1ef34bab123f2df2a4ccbe01ba84416
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6f476aff2d8da1a189621c4c16a76a6c534e4312
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2293376
    reference_type:
    reference_id: 2293376
  - url: https://git.kernel.org/stable/c/b538fefeb1026aad9dcdcbb410c42b56dff8aae9
    reference_type:
    reference_id: b538fefeb1026aad9dcdcbb410c42b56dff8aae9
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-38594
    reference_type:
    reference_id: CVE-2024-38594
  - url: https://usn.ubuntu.com/6949-1/
    reference_type:
    reference_id: USN-6949-1
  - url: https://usn.ubuntu.com/6949-2/
    reference_type:
    reference_id: USN-6949-2
  - url: https://usn.ubuntu.com/6952-1/
    reference_type:
    reference_id: USN-6952-1
  - url: https://usn.ubuntu.com/6952-2/
    reference_type:
    reference_id: USN-6952-2
  - url: https://usn.ubuntu.com/6955-1/
    reference_type:
    reference_id: USN-6955-1
