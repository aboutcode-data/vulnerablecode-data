vulnerability_id: VCID-nyvw-5zuu-aaak
aliases:
  - CVE-2022-39218
  - GHSA-cmr8-5w4c-44v8
summary: |
  Incorrect Usage of Seeds in Pseudo-Random Number Generator (PRNG)
  The JS Compute Runtime for Fastly's Compute@Edge platform provides the environment JavaScript is executed in when using the Compute@Edge JavaScript SDK. In versions prior to 0.5.3, the `Math.random` and `crypto.getRandomValues` methods fail to use sufficiently random values. The initial value to seed the PRNG (pseudorandom number generator) is baked-in to the final WebAssembly module, making the sequence of random values for that specific WebAssembly module predictable. An attacker can use the fixed seed to predict random numbers generated by these functions and bypass cryptographic security controls, for example to disclose sensitive data encrypted by functions that use these generators. The problem has been patched in version 0.5.3. No known workarounds exist.
severities:
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30475'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26111'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26064'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26216'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26236'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26245'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26244'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26201'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26172'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26183'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26253'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26249'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26214'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26205'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.2618'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30301'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30365'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30428'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30474'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.3041'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30396'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30388'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.3038'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30389'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30409'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30387'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30357'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30349'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.21458'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.58163'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.57912'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.57913'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.57883'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61786'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61770'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61778'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61796'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61810'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61929'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61986'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61964'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61478'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61645'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61701'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.61717'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-cmr8-5w4c-44v8
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:H
    published_at: None
    url: https://github.com/fastly/js-compute-runtime
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fastly/js-compute-runtime
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastly/js-compute-runtime/commit/65524ffc962644e9fc39f4b368a326b6253912a9
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fastly/js-compute-runtime/commit/65524ffc962644e9fc39f4b368a326b6253912a9
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastly/js-compute-runtime/security/advisories/GHSA-cmr8-5w4c-44v8
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/fastly/js-compute-runtime/security/advisories/GHSA-cmr8-5w4c-44v8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:51:22Z/
    published_at: None
    url: https://github.com/fastly/js-compute-runtime/security/advisories/GHSA-cmr8-5w4c-44v8
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39218
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39218
weaknesses:
  - CWE-335
  - CWE-330
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-39218
    reference_type:
    reference_id:
  - url: https://github.com/fastly/js-compute-runtime
    reference_type:
    reference_id:
  - url: https://github.com/fastly/js-compute-runtime/commit/65524ffc962644e9fc39f4b368a326b6253912a9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fastly:js-compute:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:fastly:js-compute:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39218
    reference_type:
    reference_id: CVE-2022-39218
  - url: https://github.com/advisories/GHSA-cmr8-5w4c-44v8
    reference_type:
    reference_id: GHSA-cmr8-5w4c-44v8
  - url: https://github.com/fastly/js-compute-runtime/security/advisories/GHSA-cmr8-5w4c-44v8
    reference_type:
    reference_id: GHSA-cmr8-5w4c-44v8
