vulnerability_id: VCID-ny69-bjxn-m7cj
aliases:
  - CVE-2025-69255
  - GHSA-gw2x-q739-qhcr
summary: |
  RustFS gRPC GetMetrics deserialization panic enables remote DoS
  ### Summary
  A malformed gRPC `GetMetrics` request causes `get_metrics` to `unwrap()` failed deserialization of `metric_type`/`opts`, panicking the handler thread and enabling remote denial of service of the metrics endpoint.

  ### Details
  - Vulnerable code: `rustfs/src/storage/tonic_service.rs:1775-1782`:
    - `MetricType` and `CollectMetricsOpts` are deserialized with `Deserialize::deserialize(...).unwrap()` from client-supplied bytes.
    - Malformed `metric_type`/`opts` (e.g., empty or truncated rmp-serde payloads) trigger `InvalidMarkerRead` and panic.
  - Reachability: same TCP listener as S3 (default `:9000`); only a static interceptor token `authorization: rustfs rpc` is checked in `server/http.rs:677`.
  - Impact scope: panic terminates the worker handling the request, causing metrics service interruption and potential process instability.

  ### PoC

  [rustfs-grpc-metrics-invalid-metric-type-panic-poc.tar.gz](https://github.com/user-attachments/files/24038341/rustfs-grpc-metrics-invalid-metric-type-panic-poc.tar.gz)


  1) Start RustFS (example local dev):
  ```bash
  mkdir -p /tmp/rustfs-data1 /tmp/rustfs-data2
  RUSTFS_ACCESS_KEY=devadmin RUSTFS_SECRET_KEY=devadmin \
    cargo run --bin rustfs -- --address 0.0.0.0:9000 \
    /tmp/rustfs-data1 /tmp/rustfs-data2
  ```
  2) From `rustfs-grpc-metrics-invalid-metric-type-panic-poc/`, run:
  ```bash
  ENDPOINT=127.0.0.1:9000 make run
  # or: grpcurl -plaintext \
  #   -H 'authorization: rustfs rpc' \
  #   -import-path ../crates/protos/src -proto node.proto \
  #   -d '{"metric_type":"","opts":""}' \
  #   127.0.0.1:9000 node_service.NodeService/GetMetrics
  ```
  3) Observe panic in server logs at `tonic_service.rs:get_metrics` with `InvalidMarkerRead` and worker crash; client output saved to `poc-response.txt`/`poc-grpcurl.log`.

  ### Impact
  - Vulnerability type: remote unauthenticated (static token) denial of service via panic in gRPC handler.
  - Who is impacted: any deployment exposing the gRPC endpoint where an attacker can reach port 9000 and supply the known `authorization: rustfs rpc` header; metrics service is disrupted and may affect overall stability depending on runtime crash handling.
severities:
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.33514'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-69255
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.3349'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-69255
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-gw2x-q739-qhcr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rustfs/rustfs
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/rustfs/rustfs/commit/eb33e82b56ed11fd12bb39416359d8d60737dc7a
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rustfs/rustfs/commit/eb33e82b56ed11fd12bb39416359d8d60737dc7a
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-07T21:04:45Z/
    published_at: None
    url: https://github.com/rustfs/rustfs/commit/eb33e82b56ed11fd12bb39416359d8d60737dc7a
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/rustfs/rustfs/security/advisories/GHSA-gw2x-q739-qhcr
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/rustfs/rustfs/security/advisories/GHSA-gw2x-q739-qhcr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rustfs/rustfs/security/advisories/GHSA-gw2x-q739-qhcr
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-07T21:04:45Z/
    published_at: None
    url: https://github.com/rustfs/rustfs/security/advisories/GHSA-gw2x-q739-qhcr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-69255
weaknesses:
  - CWE-755
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-69255
    reference_type:
    reference_id:
  - url: https://github.com/rustfs/rustfs
    reference_type:
    reference_id:
  - url: https://github.com/rustfs/rustfs/commit/eb33e82b56ed11fd12bb39416359d8d60737dc7a
    reference_type:
    reference_id:
  - url: https://github.com/rustfs/rustfs/security/advisories/GHSA-gw2x-q739-qhcr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-69255
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-gw2x-q739-qhcr
    reference_type:
    reference_id: GHSA-gw2x-q739-qhcr
