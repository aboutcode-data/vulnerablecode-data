vulnerability_id: VCID-ncez-meqg-9ydq
aliases:
  - GHSA-4rmq-mc2c-r495
summary: |
  Babylon Incorrect FP inactive accounting in costaking creates “phantom stake” that earns rewards after BTC unbond
  ### Summary

  A state consistency bug in `x/costaking` can leave a BTC delegator with non-zero `ActiveSatoshis` (Phatom Stake) even after they have fully unbonded their BTC delegation, if their Finality Provider (FP) drops out of the active set in the exact same babylon block height. This creates a “phantom stake”: the delegator’s BTC capital is withdrawn, the FP is inactive, but costaking continues to treat the delegation as active BTC stake allowing ongoing rewards accrual without backing BTC.

  ### Impact

  An address can keep earning costaking rewards with zero BTC staked.

  Reported by @BottyBott.
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/babylonlabs-io/babylon
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/babylonlabs-io/babylon/commit/e65c3a55a398a403103f1b089cf76f0d4befc7a0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/babylonlabs-io/babylon/security/advisories/GHSA-4rmq-mc2c-r495
weaknesses:
  - CWE-459
references:
  - url: https://github.com/babylonlabs-io/babylon
    reference_type:
    reference_id:
  - url: https://github.com/babylonlabs-io/babylon/commit/e65c3a55a398a403103f1b089cf76f0d4befc7a0
    reference_type:
    reference_id:
  - url: https://github.com/babylonlabs-io/babylon/security/advisories/GHSA-4rmq-mc2c-r495
    reference_type:
    reference_id:
