vulnerability_id: VCID-3nqn-16a8-aaah
aliases:
  - CVE-2023-52527
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ipv4, ipv6: Fix handling of transhdrlen in __ip{,6}_append_data()

  Including the transhdrlen in length is a problem when the packet is
  partially filled (e.g. something like send(MSG_MORE) happened previously)
  when appending to an IPv4 or IPv6 packet as we don't want to repeat the
  transport header or account for it twice.  This can happen under some
  circumstances, such as splicing into an L2TP socket.

  The symptom observed is a warning in __ip6_append_data():

      WARNING: CPU: 1 PID: 5042 at net/ipv6/ip6_output.c:1800 __ip6_append_data.isra.0+0x1be8/0x47f0 net/ipv6/ip6_output.c:1800

  that occurs when MSG_SPLICE_PAGES is used to append more data to an already
  partially occupied skbuff.  The warning occurs when 'copy' is larger than
  the amount of data in the message iterator.  This is because the requested
  length includes the transport header length when it shouldn't.  This can be
  triggered by, for example:

          sfd = socket(AF_INET6, SOCK_DGRAM, IPPROTO_L2TP);
          bind(sfd, ...); // ::1
          connect(sfd, ...); // ::1 port 7
          send(sfd, buffer, 4100, MSG_MORE);
          sendfile(sfd, dfd, NULL, 1024);

  Fix this by only adding transhdrlen into the length if the write queue is
  empty in l2tp_ip6_sendmsg(), analogously to how UDP does things.

  l2tp_ip_sendmsg() looks like it won't suffer from this problem as it builds
  the UDP packet itself.
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52527.json
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14371'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14461'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14482'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14548'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14541'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14556'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14611'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14691'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14976'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15033'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15128'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14714'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14726'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14767'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14083'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23142'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23104'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23034'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.2318'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23199'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23203'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23193'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23109'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23124'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23147'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23166'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23108'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23084'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '0.00382'
    scoring_system: epss
    scoring_elements: '0.426'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00353'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00355'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00356'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00354'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00352'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00358'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00359'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.0036'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00357'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52527
weaknesses:
  - CWE-20
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52527.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52527
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52527
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1fc793d68d50dee4782ef2e808913d5dd880bcc6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/559d697c5d072593d22b3e0bd8b8081108aeaf59
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7626b9fed53092aa2147978070e610ecb61af844
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/96b2e1090397217839fcd6c9b6d8f5d439e705ed
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9d4c75800f61e5d75c1659ba201b6c0c7ead3070
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cd1189956393bf850b2e275e37411855d3bd86bb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6a7182179c0ed788e3755ee2ed18c888ddcc33f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe80658c08e3001c80c5533cd41abfbb0e0e28fd
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2267790
    reference_type:
    reference_id: 2267790
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.6:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.6:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.6:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.6:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.6:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.6:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.6:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.6:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52527
    reference_type:
    reference_id: CVE-2023-52527
  - url: https://usn.ubuntu.com/7028-1/
    reference_type:
    reference_id: USN-7028-1
  - url: https://usn.ubuntu.com/7028-2/
    reference_type:
    reference_id: USN-7028-2
  - url: https://usn.ubuntu.com/7039-1/
    reference_type:
    reference_id: USN-7039-1
