vulnerability_id: VCID-3nzm-w2sq-aaak
aliases:
  - CVE-2021-43781
  - GHSA-xr38-w74q-r8jv
  - PYSEC-2021-836
  - PYSEC-2021-837
  - PYSEC-2021-838
summary: Invenio-Drafts-Resources is a submission/deposit module for Invenio, a software framework
  for research data management. Invenio-Drafts-Resources prior to versions 0.13.7 and 0.14.6
  does not properly check permissions when a record is published. The vulnerability is exploitable
  in a default installation of InvenioRDM. An authenticated a user is able via REST API calls
  to publish draft records of other users if they know the record identifier and the draft validates
  (e.g. all require fields filled out). An attacker is not able to modify the data in the record,
  and thus e.g. *cannot* change a record from restricted to public. The problem is patched in
  Invenio-Drafts-Resources v0.13.7 and 0.14.6, which is part of InvenioRDM v6.0.1 and InvenioRDM
  v7.0 respectively.
severities:
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.22969'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.22880'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.22908'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.22975'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.22963'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.22988'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.22478'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.23441'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.23343'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.23274'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.23020'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.22789'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24799'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24403'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24411'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24432'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.16699'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31438'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31378'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31443'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31505'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31554'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.3156'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31489'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31471'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31472'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31488'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31481'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.31454'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27099'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27049'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.272'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27219'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27228'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27237'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27199'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27163'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27202'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27236'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27239'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27209'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.27208'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.2719'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xr38-w74q-r8jv
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/inveniosoftware/invenio-drafts-resources/commit/039b0cff1ad4b952000f4d8c3a93f347108b6626
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/inveniosoftware/invenio-drafts-resources/commit/039b0cff1ad4b952000f4d8c3a93f347108b6626
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/inveniosoftware/invenio-drafts-resources/security/advisories/GHSA-xr38-w74q-r8jv
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/invenio-app-rdm/PYSEC-2021-837.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/invenio-app-rdm/PYSEC-2021-837.yaml
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/invenio-drafts-resources/PYSEC-2021-836.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/invenio-drafts-resources/PYSEC-2021-836.yaml
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43781
  - score: '4.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43781
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43781
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-863
  - CWE-862
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-43781
    reference_type:
    reference_id:
  - url: https://github.com/inveniosoftware/invenio-drafts-resources/commit/039b0cff1ad4b952000f4d8c3a93f347108b6626
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/invenio-app-rdm/PYSEC-2021-837.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/invenio-drafts-resources/PYSEC-2021-836.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:inveniosoftware:invenio-drafts-resources:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:inveniosoftware:invenio-drafts-resources:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43781
    reference_type:
    reference_id: CVE-2021-43781
  - url: https://github.com/advisories/GHSA-xr38-w74q-r8jv
    reference_type:
    reference_id: GHSA-xr38-w74q-r8jv
  - url: https://github.com/inveniosoftware/invenio-drafts-resources/security/advisories/GHSA-xr38-w74q-r8jv
    reference_type:
    reference_id: GHSA-xr38-w74q-r8jv
