vulnerability_id: VCID-vu7m-19m3-aaap
aliases:
  - CVE-2023-22462
  - GHSA-7rqg-hjwc-6mjf
summary: Grafana is an open-source platform for monitoring and observability. On 2023-01-01
  during an internal audit of Grafana, a member of the security team found a stored XSS vulnerability
  affecting the core plugin "Text". The stored XSS vulnerability requires several user interactions
  in order to be fully exploited. The vulnerability was possible due to React's render cycle
  that will pass though the unsanitized HTML code, but in the next cycle the HTML is cleaned
  up and saved in Grafana's database. An attacker needs to have the Editor role in order to
  change a Text panel to include JavaScript. Another user needs to edit the same Text panel,
  and click on "Markdown" or "HTML" for the code to be executed. This means that vertical privilege
  escalation is possible, where a user with Editor role can change to a known password for a
  user having Admin role if the user with Admin role executes malicious JavaScript viewing a
  dashboard. This issue has been patched in versions 9.2.10 and 9.3.4.
severities:
  - score: '6.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-22462.json
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.46929'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.46903'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47216'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.46931'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55215'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55211'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55485'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55440'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55402'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55263'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55236'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.54788'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55221'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55066'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55129'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.55150'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.05314'
    scoring_system: epss
    scoring_elements: '0.83035'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91117'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90848'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90834'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91106'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91119'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91127'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91129'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91135'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91132'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91123'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91122'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91124'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.9112'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.91121'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.908'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90788'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90823'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90817'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90829'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90836'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90827'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.9083'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90835'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '0.07273'
    scoring_system: epss
    scoring_elements: '0.90844'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/grafana/grafana
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/grafana
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/grafana/grafana/commit/db83d5f398caffe35c5846cfa7727d1a2a414165
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/grafana/commit/db83d5f398caffe35c5846cfa7727d1a2a414165
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/grafana/grafana/security/advisories/GHSA-7rqg-hjwc-6mjf
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/grafana/security/advisories/GHSA-7rqg-hjwc-6mjf
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://grafana.com/blog/2023/02/28/grafana-security-release-new-versions-with-security-fixes-for-cve-2023-0594-cve-2023-0507-and-cve-2023-22462
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://grafana.com/blog/2023/02/28/grafana-security-release-new-versions-with-security-fixes-for-cve-2023-0594-cve-2023-0507-and-cve-2023-22462
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-22462
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-22462
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20230413-0004
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20230413-0004
weaknesses:
  - CWE-79
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-22462.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-22462
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/commit/db83d5f398caffe35c5846cfa7727d1a2a414165
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/security/advisories/GHSA-7rqg-hjwc-6mjf
    reference_type:
    reference_id:
  - url: https://grafana.com/blog/2023/02/28/grafana-security-release-new-versions-with-security-fixes-for-cve-2023-0594-cve-2023-0507-and-cve-2023-22462
    reference_type:
    reference_id:
  - url: https://grafana.com/blog/2023/02/28/grafana-security-release-new-versions-with-security-fixes-for-cve-2023-0594-cve-2023-0507-and-cve-2023-22462/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230413-0004
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230413-0004/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2164936
    reference_type:
    reference_id: 2164936
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22462
    reference_type:
    reference_id: CVE-2023-22462
  - url: https://access.redhat.com/errata/RHSA-2024:0746
    reference_type:
    reference_id: RHSA-2024:0746
