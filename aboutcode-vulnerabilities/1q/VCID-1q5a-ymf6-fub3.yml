vulnerability_id: VCID-1q5a-ymf6-fub3
aliases:
  - GHSA-hqf9-8xv5-x8xw
summary: "ERC7984ERC20Wrapper: once a wrapper is filled, subsequent wrap requests do not revert\
  \ and result in loss of funds.\n### Impact\nThe `ERC7984` contract tracks total supply using\
  \ a confidential `euint64` value. If a call to the internal `_mint` function would result\
  \ in the total supply overflowing, the call fails silently. The `wrap` and `onTransferReceived`\
  \ functions in `ERC7984ERC20Wrapper` assume that `_mint` won't fail silently and do not check\
  \ the return value. If the mint function fails silently, users do not receive the confidential\
  \ wrapped token but still send the underlying token, resulting in a loss of funds.\n\nBy default\
  \ (without overriding `rate()`, the wrapper fills up after wrapping ~18.4 trillion tokens.\
  \ There are very few tokens of value with sufficient total supply to result in the filling\
  \ of the wrapper. That said, we recommend upgrading to `0.3.1` to remove this issue. \n\n\
  ### Patches\nThis issue has been patched in the `0.3.1` release."
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-hqf9-8xv5-x8xw
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/OpenZeppelin/openzeppelin-confidential-contracts
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/OpenZeppelin/openzeppelin-confidential-contracts/security/advisories/GHSA-hqf9-8xv5-x8xw
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/OpenZeppelin/openzeppelin-confidential-contracts/security/advisories/GHSA-hqf9-8xv5-x8xw
weaknesses:
  - CWE-190
references:
  - url: https://github.com/OpenZeppelin/openzeppelin-confidential-contracts
    reference_type:
    reference_id:
  - url: https://github.com/OpenZeppelin/openzeppelin-confidential-contracts/security/advisories/GHSA-hqf9-8xv5-x8xw
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-hqf9-8xv5-x8xw
    reference_type:
    reference_id: GHSA-hqf9-8xv5-x8xw
