vulnerability_id: VCID-1qad-hmu4-aaac
aliases:
  - GHSA-5j8w-r7g8-5472
summary: |
  Arrow2 allows double free in `safe` code
  The struct `Ffi_ArrowArray` implements `#derive(Clone)` that is inconsistent with
  its custom implementation of `Drop`, resulting in a double free when cloned.

  Cloning this struct in `safe` results in a segmentation fault, which is unsound.

  This derive was removed from this struct. All users are advised to either:
  * bump the patch version of this crate (for versions `v0.7,v0.8,v0.9`), or
  * migrate to a more recent version of  the crate (when using `<0.7`).

  Doing so elimitates this vulnerability (code no longer compiles).
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5j8w-r7g8-5472
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jorgecarleitao/arrow2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jorgecarleitao/arrow2/issues/880
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2022-0012.html
weaknesses:
  - CWE-415
references:
  - url: https://github.com/jorgecarleitao/arrow2
    reference_type:
    reference_id:
  - url: https://github.com/jorgecarleitao/arrow2/issues/880
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2022-0012.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5j8w-r7g8-5472
    reference_type:
    reference_id: GHSA-5j8w-r7g8-5472
