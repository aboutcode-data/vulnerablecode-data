vulnerability_id: VCID-nrk4-x4rc-aaap
aliases:
  - CVE-2024-31999
  - GHSA-9wwp-q7wq-jx35
summary: '@festify/secure-session creates a secure stateless cookie session for Fastify. At
  the end of the request handling, it will encrypt all data in the session with a secret key
  and attach the ciphertext as a cookie value with the defined cookie name. After that, the
  session on the server side is destroyed. When an encrypted cookie with matching session name
  is provided with subsequent requests, it will decrypt the ciphertext to get the data. The
  plugin then creates a new session with the data in the ciphertext. Thus theoretically the
  web instance is still accessing the data from a server-side session, but technically that
  session is generated solely from a user provided cookie (which is assumed to be non-craftable
  because it is encrypted with a secret key not known to the user). The issue exists in the
  session removal process. In the delete function of the code, when the session is deleted,
  it is marked for deletion. However, if an attacker could gain access to the cookie, they could
  keep using it forever. Version 7.3.0 contains a patch for the issue. As a workaround, one
  may include a "last update" field in the session, and treat "old sessions" as expired.'
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32902'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32936'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32873'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32954'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32941'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32944'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32946'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32945'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32968'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33045'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.3304'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32996'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32924'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.39534'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.39535'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.39562'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40056'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40161'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40186'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40185'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40156'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.4013'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40112'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40122'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.4014'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40137'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40131'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40023'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: '0.00402'
    scoring_system: epss
    scoring_elements: '0.44007'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-9wwp-q7wq-jx35
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastify/fastify-secure-session
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fastify/fastify-secure-session
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastify/fastify-secure-session/commit/56d66642ecc633cff0606927601e81cdac361370
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fastify/fastify-secure-session/commit/56d66642ecc633cff0606927601e81cdac361370
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastify/fastify-secure-session/security/advisories/GHSA-9wwp-q7wq-jx35
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fastify/fastify-secure-session/security/advisories/GHSA-9wwp-q7wq-jx35
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-613
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-31999
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-secure-session
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-secure-session/commit/56d66642ecc633cff0606927601e81cdac361370
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-secure-session/security/advisories/GHSA-9wwp-q7wq-jx35
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-31999
    reference_type:
    reference_id: CVE-2024-31999
  - url: https://github.com/advisories/GHSA-9wwp-q7wq-jx35
    reference_type:
    reference_id: GHSA-9wwp-q7wq-jx35
