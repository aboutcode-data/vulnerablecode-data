vulnerability_id: VCID-hr16-38yn-aaas
aliases:
  - CVE-2021-46743
  - GHSA-8xf4-w7qw-pjjw
summary: |
  Access of Resource Using Incompatible Type ('Type Confusion')
  In Firebase PHP-JWT before 6.0.0, an algorithm-confusion issue (e.g., RS256 / HS256) exists via the kid (aka Key ID) header, when multiple types of keys are loaded in a key ring. This allows an attacker to forge tokens that validate under the incorrect key. NOTE: this provides a straightforward way to use the PHP-JWT library unsafely, but might not be considered a vulnerability in the library itself.
severities:
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46733'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.51012'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.51064'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51503'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51477'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51460'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51462'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51305'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51398'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51377'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51469'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51647'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.32823'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.32988'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.32971'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.33961'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.33937'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.55365'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.55377'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.55661'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.55342'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.39461'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.4943'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49426'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49441'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49461'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49406'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.6858'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.68626'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.68615'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.68601'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.69559'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.69587'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.69614'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.69635'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.69637'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.69616'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.69609'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.00652'
    scoring_system: epss
    scoring_elements: '0.69615'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.01017'
    scoring_system: epss
    scoring_elements: '0.75961'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.01017'
    scoring_system: epss
    scoring_elements: '0.7596'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.01017'
    scoring_system: epss
    scoring_elements: '0.75942'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.01017'
    scoring_system: epss
    scoring_elements: '0.75953'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: '0.12142'
    scoring_system: epss
    scoring_elements: '0.89672'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-8xf4-w7qw-pjjw
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/firebase/php-jwt
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/firebase/php-jwt
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/firebase/php-jwt/issues/351
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/firebase/php-jwt/issues/351
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/firebase/php-jwt/releases/tag/v6.0.0
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/firebase/php-jwt/releases/tag/v6.0.0
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46743
  - score: '9.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46743
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46743
weaknesses:
  - CWE-843
  - CWE-937
  - CWE-1035
  - CWE-347
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-46743
    reference_type:
    reference_id:
  - url: https://github.com/firebase/php-jwt
    reference_type:
    reference_id:
  - url: https://github.com/firebase/php-jwt/issues/351
    reference_type:
    reference_id:
  - url: https://github.com/firebase/php-jwt/releases/tag/v6.0.0
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:firebase_php-jwt:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:firebase_php-jwt:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-46743
    reference_type:
    reference_id: CVE-2021-46743
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/firebase/php-jwt/CVE-2021-46743.yaml
    reference_type:
    reference_id: CVE-2021-46743.YAML
  - url: https://github.com/advisories/GHSA-8xf4-w7qw-pjjw
    reference_type:
    reference_id: GHSA-8xf4-w7qw-pjjw
