vulnerability_id: VCID-t7eh-c667-aaam
aliases:
  - CVE-2018-12904
summary: In arch/x86/kvm/vmx.c in the Linux kernel before 4.17.2, when nested virtualization
  is used, local attackers could cause L1 KVM guests to VMEXIT, potentially allowing privilege
  escalations and denial of service attacks due to lack of checking of CPL.
severities:
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=727ba748e110b4de50d142edca9d6a9b7e6111d8
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12904.html
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2018-12904.json
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31936'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31543'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31785'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31524'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31523'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31527'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31564'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31018'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31311'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31387'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31413'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00094'
    scoring_system: epss
    scoring_elements: '0.41015'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00094'
    scoring_system: epss
    scoring_elements: '0.41022'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00094'
    scoring_system: epss
    scoring_elements: '0.41003'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00094'
    scoring_system: epss
    scoring_elements: '0.41366'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34277'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34321'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34254'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34245'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34278'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34313'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34289'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34141'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34295'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.34183'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00167'
    scoring_system: epss
    scoring_elements: '0.24766'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.37476'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41388'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41573'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41574'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41467'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.4145'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41459'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41453'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41464'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41427'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.3798'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.37943'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.37908'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.4141'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41472'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.41539'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1595143
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12904
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '4.4'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-12904
  - score: '4.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-12904
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-3752-1
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-3752-2
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-3752-3
weaknesses:
  - CWE-284
references:
  - url: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=727ba748e110b4de50d142edca9d6a9b7e6111d8
    reference_type:
    reference_id:
  - url: http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12904.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2018-12904.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2018-12904
    reference_type:
    reference_id:
  - url: https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.17.2
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12904
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/torvalds/linux/commit/727ba748e110b4de50d142edca9d6a9b7e6111d8
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3752-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3752-2
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3752-3
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3752-1/
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3752-2/
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3752-3/
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/44944/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1595143
    reference_type:
    reference_id: 1595143
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://bugs.chromium.org/p/project-zero/issues/detail?id=1589
    reference_type: exploit
    reference_id: CVE-2018-12904
  - url: https://gitlab.com/exploit-database/exploitdb/-/blob/main/exploits/linux/dos/44944.txt
    reference_type: exploit
    reference_id: CVE-2018-12904
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-12904
    reference_type:
    reference_id: CVE-2018-12904
