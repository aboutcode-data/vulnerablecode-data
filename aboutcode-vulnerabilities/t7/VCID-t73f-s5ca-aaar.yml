vulnerability_id: VCID-t73f-s5ca-aaar
aliases:
  - CVE-2024-42073
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mlxsw: spectrum_buffers: Fix memory corruptions on Spectrum-4 systems

  The following two shared buffer operations make use of the Shared Buffer
  Status Register (SBSR):

   # devlink sb occupancy snapshot pci/0000:01:00.0
   # devlink sb occupancy clearmax pci/0000:01:00.0

  The register has two masks of 256 bits to denote on which ingress /
  egress ports the register should operate on. Spectrum-4 has more than
  256 ports, so the register was extended by cited commit with a new
  'port_page' field.

  However, when filling the register's payload, the driver specifies the
  ports as absolute numbers and not relative to the first port of the port
  page, resulting in memory corruptions [1].

  Fix by specifying the ports relative to the first port of the port page.

  [1]
  BUG: KASAN: slab-use-after-free in mlxsw_sp_sb_occ_snapshot+0xb6d/0xbc0
  Read of size 1 at addr ffff8881068cb00f by task devlink/1566
  [...]
  Call Trace:
   <TASK>
   dump_stack_lvl+0xc6/0x120
   print_report+0xce/0x670
   kasan_report+0xd7/0x110
   mlxsw_sp_sb_occ_snapshot+0xb6d/0xbc0
   mlxsw_devlink_sb_occ_snapshot+0x75/0xb0
   devlink_nl_sb_occ_snapshot_doit+0x1f9/0x2a0
   genl_family_rcv_msg_doit+0x20c/0x300
   genl_rcv_msg+0x567/0x800
   netlink_rcv_skb+0x170/0x450
   genl_rcv+0x2d/0x40
   netlink_unicast+0x547/0x830
   netlink_sendmsg+0x8d4/0xdb0
   __sys_sendto+0x49b/0x510
   __x64_sys_sendto+0xe5/0x1c0
   do_syscall_64+0xc1/0x1d0
   entry_SYSCALL_64_after_hwframe+0x77/0x7f
  [...]
  Allocated by task 1:
   kasan_save_stack+0x33/0x60
   kasan_save_track+0x14/0x30
   __kasan_kmalloc+0x8f/0xa0
   copy_verifier_state+0xbc2/0xfb0
   do_check_common+0x2c51/0xc7e0
   bpf_check+0x5107/0x9960
   bpf_prog_load+0xf0e/0x2690
   __sys_bpf+0x1a61/0x49d0
   __x64_sys_bpf+0x7d/0xc0
   do_syscall_64+0xc1/0x1d0
   entry_SYSCALL_64_after_hwframe+0x77/0x7f

  Freed by task 1:
   kasan_save_stack+0x33/0x60
   kasan_save_track+0x14/0x30
   kasan_save_free_info+0x3b/0x60
   poison_slab_object+0x109/0x170
   __kasan_slab_free+0x14/0x30
   kfree+0xca/0x2b0
   free_verifier_state+0xce/0x270
   do_check_common+0x4828/0xc7e0
   bpf_check+0x5107/0x9960
   bpf_prog_load+0xf0e/0x2690
   __sys_bpf+0x1a61/0x49d0
   __x64_sys_bpf+0x7d/0xc0
   do_syscall_64+0xc1/0x1d0
   entry_SYSCALL_64_after_hwframe+0x77/0x7f
severities:
  - score: '5.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-42073.json
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10731'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10708'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10763'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10781'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10773'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10703'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10598'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10718'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10553'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12434'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12452'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12453'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12447'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12438'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17475'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17567'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17421'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17909'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17938'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17907'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17967'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17966'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17941'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17954'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17925'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17912'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17916'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17934'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18946'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '0.00279'
    scoring_system: epss
    scoring_elements: '0.35137'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42073
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42073
weaknesses:
  - CWE-476
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-42073.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-42073
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-42073
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/942901e0fc74ad4b7992ef7ca9336e68d5fd6d36
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bf8781ede7bd9a37c0fcabca78976e61300b5a1a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bfa86a96912faa0b6142a918db88cc0c738a769e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c28947de2bed40217cf256c5d0d16880054fcf13
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2300511
    reference_type:
    reference_id: 2300511
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42073
    reference_type:
    reference_id: CVE-2024-42073
  - url: https://usn.ubuntu.com/7089-1/
    reference_type:
    reference_id: USN-7089-1
  - url: https://usn.ubuntu.com/7089-2/
    reference_type:
    reference_id: USN-7089-2
  - url: https://usn.ubuntu.com/7089-3/
    reference_type:
    reference_id: USN-7089-3
  - url: https://usn.ubuntu.com/7089-4/
    reference_type:
    reference_id: USN-7089-4
  - url: https://usn.ubuntu.com/7089-5/
    reference_type:
    reference_id: USN-7089-5
  - url: https://usn.ubuntu.com/7089-6/
    reference_type:
    reference_id: USN-7089-6
  - url: https://usn.ubuntu.com/7089-7/
    reference_type:
    reference_id: USN-7089-7
  - url: https://usn.ubuntu.com/7090-1/
    reference_type:
    reference_id: USN-7090-1
  - url: https://usn.ubuntu.com/7095-1/
    reference_type:
    reference_id: USN-7095-1
  - url: https://usn.ubuntu.com/7156-1/
    reference_type:
    reference_id: USN-7156-1
