vulnerability_id: VCID-zv5q-su32-aaak
aliases:
  - CVE-2022-31008
summary: 'RabbitMQ is a multi-protocol messaging and streaming broker. In affected versions
  the shovel and federation plugins perform URI obfuscation in their worker (link) state. The
  encryption key used to encrypt the URI was seeded with a predictable secret. This means that
  in case of certain exceptions related to Shovel and Federation plugins, reasonably easily
  deobfuscatable data could appear in the node log. Patched versions correctly use a cluster-wide
  secret for that purpose. This issue has been addressed and Patched versions: `3.10.2`, `3.9.18`,
  `3.8.32` are available. Users unable to upgrade should disable the Shovel and Federation plugins.'
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-31008.json
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13126'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13104'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13093'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13118'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13128'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13162'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13192'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13117'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13017'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12959'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10409'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10468'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10493'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10524'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10556'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10535'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10523'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.1051'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10495'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10503'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10427'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10463'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13628'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13653'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13642'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12947'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12816'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12784'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.15'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.45714'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.45429'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.45406'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46498'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46422'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46399'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46240'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46223'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46198'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46204'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46118'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46100'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46014'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.45766'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.45414'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/rabbitmq/rabbitmq-server/pull/4841
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T13:56:54Z/
    published_at: None
    url: https://github.com/rabbitmq/rabbitmq-server/pull/4841
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-v9gv-xp36-jgj8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T13:56:54Z/
    published_at: None
    url: https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-v9gv-xp36-jgj8
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31008
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31008
weaknesses:
  - CWE-337
  - CWE-335
  - CWE-330
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-31008.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-31008
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31008
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/rabbitmq/rabbitmq-server/pull/4841
    reference_type:
    reference_id:
  - url: https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-v9gv-xp36-jgj8
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2141397
    reference_type:
    reference_id: 2141397
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:broadcom:rabbitmq_server:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:broadcom:rabbitmq_server:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vmware:rabbitmq:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:vmware:rabbitmq:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31008
    reference_type:
    reference_id: CVE-2022-31008
