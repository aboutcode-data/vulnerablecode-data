vulnerability_id: VCID-cnnj-tv6e-aaab
aliases:
  - CVE-2024-22205
  - GHSA-3q6g-qmpx-rqw4
  - PYSEC-2024-18
summary: Whoogle Search is a self-hosted metasearch engine. In versions 0.8.3 and prior, the
  `window` endpoint does not sanitize user-supplied input from the `location` variable and passes
  it to the `send` method which sends a `GET` request on lines 339-343 in `request.py,` which
  leads to a server-side request forgery. This issue allows for crafting GET requests to internal
  and external resources on behalf of the server. For example, this issue would allow for accessing
  resources on the internal network that the server has access to, even though these resources
  may not be accessible on the internet. This issue is fixed in version 0.8.4.
severities:
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.40709'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.41106'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.40925'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.40920'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.40911'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.40900'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.40906'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.40815'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.40416'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.40787'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.41233'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.41161'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42660'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42637'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47061'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.46772'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00167'
    scoring_system: epss
    scoring_elements: '0.38751'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00167'
    scoring_system: epss
    scoring_elements: '0.3881'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00167'
    scoring_system: epss
    scoring_elements: '0.38782'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00167'
    scoring_system: epss
    scoring_elements: '0.38819'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00167'
    scoring_system: epss
    scoring_elements: '0.38804'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00199'
    scoring_system: epss
    scoring_elements: '0.42626'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00199'
    scoring_system: epss
    scoring_elements: '0.42478'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00199'
    scoring_system: epss
    scoring_elements: '0.4254'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00199'
    scoring_system: epss
    scoring_elements: '0.42599'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00199'
    scoring_system: epss
    scoring_elements: '0.42631'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00199'
    scoring_system: epss
    scoring_elements: '0.42536'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00199'
    scoring_system: epss
    scoring_elements: '0.42532'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00219'
    scoring_system: epss
    scoring_elements: '0.44688'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62451'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62447'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62448'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62426'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62441'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62462'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62459'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62436'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62354'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62328'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62427'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62429'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62453'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00481'
    scoring_system: epss
    scoring_elements: '0.62471'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: '0.00946'
    scoring_system: epss
    scoring_elements: '0.62202'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-3q6g-qmpx-rqw4
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/benbusby/whoogle-search
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/benbusby/whoogle-search
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/request.py#L339-L343
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/request.py#L339-L343
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L479
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L479
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L496-L557
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L496-L557
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L497
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L497
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/benbusby/whoogle-search/commit/3a2e0b262e4a076a20416b45e6b6f23fd265aeda
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/benbusby/whoogle-search/commit/3a2e0b262e4a076a20416b45e6b6f23fd265aeda
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/whoogle-search/PYSEC-2024-18.yaml
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/whoogle-search/PYSEC-2024-18.yaml
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-22205
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-22205
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://securitylab.github.com/advisories/GHSL-2023-186_GHSL-2023-189_benbusby_whoogle-search
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://securitylab.github.com/advisories/GHSL-2023-186_GHSL-2023-189_benbusby_whoogle-search
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://securitylab.github.com/advisories/GHSL-2023-186_GHSL-2023-189_benbusby_whoogle-search/
weaknesses:
  - CWE-918
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-22205
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/request.py#L339-L343
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L479
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L496-L557
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L497
    reference_type:
    reference_id:
  - url: https://github.com/benbusby/whoogle-search/commit/3a2e0b262e4a076a20416b45e6b6f23fd265aeda
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/whoogle-search/PYSEC-2024-18.yaml
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2023-186_GHSL-2023-189_benbusby_whoogle-search
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2023-186_GHSL-2023-189_benbusby_whoogle-search/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:benbusby:whoogle_search:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:benbusby:whoogle_search:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22205
    reference_type:
    reference_id: CVE-2024-22205
  - url: https://github.com/advisories/GHSA-3q6g-qmpx-rqw4
    reference_type:
    reference_id: GHSA-3q6g-qmpx-rqw4
