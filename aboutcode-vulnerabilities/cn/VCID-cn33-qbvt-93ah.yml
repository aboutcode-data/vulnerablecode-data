vulnerability_id: VCID-cn33-qbvt-93ah
aliases:
  - CVE-2024-34711
  - GHSA-mc43-4fqr-c965
summary: "GeoServer has improper ENTITY_RESOLUTION_ALLOWLIST URI validation in XML Processing\
  \ (SSRF)\n### Summary\nAn improper URI validation vulnerability exists that enables an unauthorized\
  \ attacker to perform XML External Entities (XEE) attack, then send GET request to any HTTP\
  \ server. Attacker can abuse this to scan internal networks and gain information about them\
  \ then exploit further. Moreover, attacker can read limited `.xsd` file on system.\n\n###\
  \ Details\nBy default, GeoServer use `PreventLocalEntityResolver` class from GeoTools to filter\
  \ out malicious URIs in XML entities before resolving them. The URI must match the regex `(?i)(jar:file|http|vfs)[^?#;]*\\\
  \\.xsd`. But the regex leaves a chance for attackers to request to any HTTP server or limited\
  \ file.\n\n### Impact\n\nAn unauthenticated attacker can:\n1. Scan internal network to gain\
  \ insight about it and exploit further.\n2. SSRF to endpoint ends with `.xsd`.\n3. Read limited\
  \ `.xsd` file on system.\n\n### Mitigation\n\n1. Define the system property ``ENTITY_RESOLUTION_ALLOWLIST``\
  \ to limit the supported external schema locaitons.\n2. The built-in allow list covers the\
  \ locations required for the operation of OGC web services: ``www.w3.org``,``schemas.opengis.net``,``www.opengis.net``,``inspire.ec.europa.eu/schemas``.\n\
  3. The [user guide](https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities)\
  \ provides details on how to add additional locations (this is required for app-schema plugin\
  \ where a schema is supplied to define an output format).\n\n### Resolution \n\n1. GeoServer\
  \ 2.25.0 and greater default to the use of ``ENTITY_RESOLUTION_ALLOWLIST`` and does not require\
  \ you to provide a system property.\n2. The use of ``ENTITY_RESOLUTION_ALLOWLIST`` is still\
  \ supported if you require additional schema locations to be supported beyond the built-in\
  \ allow list.\n3. GeoServer 2.25.1 change ``ENTITY_RESOLUTION_ALLOWLIST `` no longer supports\
  \ regular expressions\n\n### References\n\n* [External Entities Resolution](https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities)\
  \ (GeoServer User Guide)\n\n### Credits\n* Le Mau Anh Phong from VNG Security Response Center\
  \ & VNUHCM - University of Information Technology"
severities:
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06951'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06834'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10972'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11026'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1111'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11135'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10928'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11006'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11016'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12425'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12385'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12392'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12317'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12299'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11895'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11918'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11941'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11957'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12461'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12387'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12767'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12833'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12819'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16105'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1611'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16066'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16134'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16245'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16216'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16236'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16162'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16192'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16209'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16089'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16095'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1593'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15914'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15961'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16024'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15964'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16051'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16071'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15998'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20047'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.2001'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20093'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20095'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20063'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20052'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20016'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.19964'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20027'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20033'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20014'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20022'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.2002'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20068'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00081'
    scoring_system: epss
    scoring_elements: '0.24292'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00081'
    scoring_system: epss
    scoring_elements: '0.24365'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '0.00114'
    scoring_system: epss
    scoring_elements: '0.30943'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-06-10T15:08:02Z/
    published_at: None
    url: https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-mc43-4fqr-c965
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/geoserver/geoserver
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/geoserver/geoserver
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-mc43-4fqr-c965
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-mc43-4fqr-c965
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-mc43-4fqr-c965
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-06-10T15:08:02Z/
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-mc43-4fqr-c965
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-34711
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-34711
weaknesses:
  - CWE-611
  - CWE-200
  - CWE-1035
  - CWE-937
  - CWE-918
  - CWE-20
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-34711
    reference_type:
    reference_id:
  - url: https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-mc43-4fqr-c965
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34711
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-mc43-4fqr-c965
    reference_type:
    reference_id: GHSA-mc43-4fqr-c965
