vulnerability_id: VCID-cne8-6yeq-vqhj
aliases:
  - CVE-2025-54880
  - GHSA-8gwm-58g9-j8pw
summary: "Mermaid does not properly sanitize architecture diagram iconText leading to XSS\n\
  ### Summary\nIn the default configuration of mermaid 11.9.0, user supplied input for architecture\
  \ diagram icons is passed to the d3 `html()` method, creating a sink for cross site scripting.\n\
  \n### Details\nArchitecture diagram service `iconText` values are passed to the d3 `html()`\
  \ method, allowing malicious users to inject arbitrary HTML and cause XSS when mermaid-js\
  \ is used in it's default configuration. \n\nThe vulnerability lies here:\n\n```ts\nexport\
  \ const drawServices = async function (\n  db: ArchitectureDB,\n  elem: D3Element,\n  services:\
  \ ArchitectureService[]\n): Promise<number> {\n  for (const service of services) {\n    /**\
  \ ... **/\n    } else if (service.iconText) {\n      bkgElem.html(\n        `<g>${await getIconSVG('blank',\
  \ { height: iconSize, width: iconSize, fallbackPrefix: architectureIcons.prefix })}</g>`\n\
  \      );\n      const textElemContainer = bkgElem.append('g');\n      const fo = textElemContainer\n\
  \        .append('foreignObject')\n        .attr('width', iconSize)\n        .attr('height',\
  \ iconSize);\n      const divElem = fo\n        .append('div')\n        .attr('class', 'node-icon-text')\n\
  \        .attr('style', `height: ${iconSize}px;`)\n        .append('div')\n        .html(service.iconText);\
  \ // <- iconText passed into innerHTML\n       /** ... **/\n};\n};\n```\n\nThis issue was\
  \ introduced with 734bde38777c9190a5a72e96421c83424442d4e4, around 15 months ago, which was\
  \ released in [v11.1.0](https://github.com/mermaid-js/mermaid/releases/tag/mermaid%4011.1.0).\n\
  \n### PoC\nRender the following diagram and observe the modified DOM.\n\n```\narchitecture-beta\n\
  \    group api(cloud)[API]\n    service db \"<img src=x onerror=\\\"document.write(`xss on\
  \ ${document.domain}`)\\\">\" [Database] in api\n```\n\nHere is a PoC on mermaid.live: https://mermaid.live/edit#pako:eNo9T8FOwzAM_ZXI4rBJpWrpRtuIISF24caZZdKyxOsiLUnlJjCo-u9kQ8wX-_n5-dkjKK8ROEhSRxNQhUh4v8cghWMpOvKxZ7I3M3XyUc83L-9v2z9qQPo0CpneMwFPxnZsILU6M--QyNNKCAHaq2jRhfyL0vLZ7jwMiWd3443Q3krjpt38Mv4sgG3WMsi9HHDLjLs4CwcZdGQ08EARM7BISZMgjJdLBIQjWhTAU6nxIOMpCBBuSrJeug_v7b8yPdMdgR_kaUgo9loGXBvZkbS3LqHTSK8-ugC8LMrrEuAjnIEvlnlVL9q6rZu6Lh-rRQbfwKuyyZuybcvqIaWiqKcMfq6uRd7Uy-kXhYFzcA\n\
  \n### Impact\nXSS on all sites that use mermaid and render user supplied diagrams without\
  \ further sanitization.\n\n### Remediation\nSanitize the value of `iconText` before passing\
  \ it to `html()`."
severities:
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09218'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0927'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09209'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11832'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11843'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11841'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11885'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11924'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12475'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.1253'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12545'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.1493'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15068'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.1503'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14993'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15009'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14907'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14878'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14924'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17182'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17165'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17901'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17852'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17915'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17882'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.1784'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17929'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.1792'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17783'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17757'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17796'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17785'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17871'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17847'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17816'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17756'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17853'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-8gwm-58g9-j8pw
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/2aa83302795183ea5c65caec3da1edd6cb4791fc
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/2aa83302795183ea5c65caec3da1edd6cb4791fc
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-08-19T17:09:29Z/
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/2aa83302795183ea5c65caec3da1edd6cb4791fc
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/734bde38777c9190a5a72e96421c83424442d4e4
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/734bde38777c9190a5a72e96421c83424442d4e4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-08-19T17:09:29Z/
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/734bde38777c9190a5a72e96421c83424442d4e4
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-8gwm-58g9-j8pw
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-8gwm-58g9-j8pw
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-8gwm-58g9-j8pw
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-08-19T17:09:29Z/
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-8gwm-58g9-j8pw
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-54880
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-54880
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-54880
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/commit/2aa83302795183ea5c65caec3da1edd6cb4791fc
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/commit/734bde38777c9190a5a72e96421c83424442d4e4
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-8gwm-58g9-j8pw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54880
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-8gwm-58g9-j8pw
    reference_type:
    reference_id: GHSA-8gwm-58g9-j8pw
