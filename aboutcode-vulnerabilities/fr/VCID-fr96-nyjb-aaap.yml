vulnerability_id: VCID-fr96-nyjb-aaap
aliases:
  - CVE-2021-47262
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  KVM: x86: Ensure liveliness of nested VM-Enter fail tracepoint message

  Use the __string() machinery provided by the tracing subystem to make a
  copy of the string literals consumed by the "nested VM-Enter failed"
  tracepoint.  A complete copy is necessary to ensure that the tracepoint
  can't outlive the data/memory it consumes and deference stale memory.

  Because the tracepoint itself is defined by kvm, if kvm-intel and/or
  kvm-amd are built as modules, the memory holding the string literals
  defined by the vendor modules will be freed when the module is unloaded,
  whereas the tracepoint and its data in the ring buffer will live until
  kvm is unloaded (or "indefinitely" if kvm is built-in).

  This bug has existed since the tracepoint was added, but was recently
  exposed by a new check in tracing to detect exactly this type of bug.

    fmt: '%s%s
    ' current_buffer: ' vmx_dirty_log_t-140127  [003] ....  kvm_nested_vmenter_failed: '
    WARNING: CPU: 3 PID: 140134 at kernel/trace/trace.c:3759 trace_check_vprintf+0x3be/0x3e0
    CPU: 3 PID: 140134 Comm: less Not tainted 5.13.0-rc1-ce2e73ce600a-req #184
    Hardware name: ASUS Q87M-E/Q87M-E, BIOS 1102 03/03/2014
    RIP: 0010:trace_check_vprintf+0x3be/0x3e0
    Code: <0f> 0b 44 8b 4c 24 1c e9 a9 fe ff ff c6 44 02 ff 00 49 8b 97 b0 20
    RSP: 0018:ffffa895cc37bcb0 EFLAGS: 00010282
    RAX: 0000000000000000 RBX: ffffa895cc37bd08 RCX: 0000000000000027
    RDX: 0000000000000027 RSI: 00000000ffffdfff RDI: ffff9766cfad74f8
    RBP: ffffffffc0a041d4 R08: ffff9766cfad74f0 R09: ffffa895cc37bad8
    R10: 0000000000000001 R11: 0000000000000001 R12: ffffffffc0a041d4
    R13: ffffffffc0f4dba8 R14: 0000000000000000 R15: ffff976409f2c000
    FS:  00007f92fa200740(0000) GS:ffff9766cfac0000(0000) knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: 0000559bd11b0000 CR3: 000000019fbaa002 CR4: 00000000001726e0
    Call Trace:
     trace_event_printf+0x5e/0x80
     trace_raw_output_kvm_nested_vmenter_failed+0x3a/0x60 [kvm]
     print_trace_line+0x1dd/0x4e0
     s_show+0x45/0x150
     seq_read_iter+0x2d5/0x4c0
     seq_read+0x106/0x150
     vfs_read+0x98/0x180
     ksys_read+0x5f/0xe0
     do_syscall_64+0x40/0xb0
     entry_SYSCALL_64_after_hwframe+0x44/0xae
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47262.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16077'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16026'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.161'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16103'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16075'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16055'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16047'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16049'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16067'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16092'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16087'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.12958'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.12926'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13091'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.131'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13134'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13173'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13145'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1313'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13146'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13166'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13193'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1318'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1315'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13136'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13074'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15857'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15929'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.30127'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/796d3bd4ac9316e70c181189318cd2bd98af34bc
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T19:08:01Z/
    published_at: None
    url: https://git.kernel.org/stable/c/796d3bd4ac9316e70c181189318cd2bd98af34bc
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/9fb088ce13bc3c59a51260207b487db3e556f275
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T19:08:01Z/
    published_at: None
    url: https://git.kernel.org/stable/c/9fb088ce13bc3c59a51260207b487db3e556f275
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/d046f724bbd725a24007b7e52b2d675249870888
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T19:08:01Z/
    published_at: None
    url: https://git.kernel.org/stable/c/d046f724bbd725a24007b7e52b2d675249870888
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/f31500b0d437a2464ca5972d8f5439e156b74960
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T19:08:01Z/
    published_at: None
    url: https://git.kernel.org/stable/c/f31500b0d437a2464ca5972d8f5439e156b74960
weaknesses:
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47262.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47262
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47262
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/796d3bd4ac9316e70c181189318cd2bd98af34bc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9fb088ce13bc3c59a51260207b487db3e556f275
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d046f724bbd725a24007b7e52b2d675249870888
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f31500b0d437a2464ca5972d8f5439e156b74960
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2282545
    reference_type:
    reference_id: 2282545
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47262
    reference_type:
    reference_id: CVE-2021-47262
