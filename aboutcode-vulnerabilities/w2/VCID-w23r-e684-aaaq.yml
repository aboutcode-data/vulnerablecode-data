vulnerability_id: VCID-w23r-e684-aaaq
aliases:
  - GHSA-cc97-g92w-jm65
summary: |
  TYPO3 CMS Insecure Deserialization & Arbitrary Code Execution
  Phar files (formerly known as "PHP archives") can act als self extracting archives which leads to the fact that source code is executed when Phar files are invoked. The Phar file format is not limited to be stored with a dedicated file extension - "bundle.phar" would be valid as well as "bundle.txt" would be. This way, Phar files can be obfuscated as image or text file which would not be denied from being uploaded and persisted to a TYPO3 installation. Due to a missing sanitization of user input, those Phar files can be invoked by manipulated URLs in TYPO3 backend forms. A valid backend user account is needed to exploit this vulnerability. In theory the attack vector would be possible in the TYPO3 frontend as well, however no functional exploit has been identified so far.
severities:
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-cc97-g92w-jm65
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms-core/2018-07-12-2.yaml
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms-core/2018-07-12-2.yaml
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/TYPO3-CMS/core
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/TYPO3-CMS/core
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/TYPO3-CMS/core/commit/81c6e9e6e49ee4f924bd340fb007d271fa44aa16
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/TYPO3-CMS/core/commit/81c6e9e6e49ee4f924bd340fb007d271fa44aa16
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/TYPO3-CMS/core/commit/854d03841b42123ab744c2591199b76ce65a8e45
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/TYPO3-CMS/core/commit/854d03841b42123ab744c2591199b76ce65a8e45
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/TYPO3-CMS/core/commit/aa4e270d04313fe7d8ea508a9c694db83875e981
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/TYPO3-CMS/core/commit/aa4e270d04313fe7d8ea508a9c694db83875e981
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/TYPO3-CMS/core/commit/dd0487bd8b4ec7204dbfff2b5812d797102a1778
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/TYPO3-CMS/core/commit/dd0487bd8b4ec7204dbfff2b5812d797102a1778
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://typo3.org/security/advisory/typo3-core-sa-2018-002
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://typo3.org/security/advisory/typo3-core-sa-2018-002
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-74
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms-core/2018-07-12-2.yaml
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3-CMS/core
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3-CMS/core/commit/81c6e9e6e49ee4f924bd340fb007d271fa44aa16
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3-CMS/core/commit/854d03841b42123ab744c2591199b76ce65a8e45
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3-CMS/core/commit/aa4e270d04313fe7d8ea508a9c694db83875e981
    reference_type:
    reference_id:
  - url: https://github.com/TYPO3-CMS/core/commit/dd0487bd8b4ec7204dbfff2b5812d797102a1778
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2018-002
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-cc97-g92w-jm65
    reference_type:
    reference_id: GHSA-cc97-g92w-jm65
