vulnerability_id: VCID-6ja6-36qz-aaap
aliases:
  - CVE-2021-27851
summary: A security vulnerability that can lead to local privilege escalation has been found
  in ’guix-daemon’. It affects multi-user setups in which ’guix-daemon’ runs locally. The attack
  consists in having an unprivileged user spawn a build process, for instance with `guix build`,
  that makes its build directory world-writable. The user then creates a hardlink to a root-owned
  file such as /etc/shadow in that build directory. If the user passed the --keep-failed option
  and the build eventually fails, the daemon changes ownership of the whole build tree, including
  the hardlink, to the user. At that point, the user has write access to the target file. Versions
  after and including v0.11.0-3298-g2608e40988, and versions prior to v1.2.0-75109-g94f0312546
  are vulnerable.
severities:
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11833'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09373'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09394'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09363'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.0932'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09265'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11688'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.1174'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11845'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11919'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11921'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11897'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11859'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11846'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.1184'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11843'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11855'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.1186'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11849'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09192'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.0917'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09312'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09324'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09303'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09337'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09325'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09344'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09353'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.12737'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
  - score: '2.1'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-27851
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-27851
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-27851
weaknesses:
  - CWE-59
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-27851
    reference_type:
    reference_id:
  - url: https://bugs.gnu.org/47229
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27851
    reference_type:
    reference_id:
  - url: https://guix.gnu.org/en/blog/2021/risk-of-local-privilege-escalation-via-guix-daemon/
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=985467
    reference_type:
    reference_id: 985467
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:gnu:guix:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:gnu:guix:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-27851
    reference_type:
    reference_id: CVE-2021-27851
