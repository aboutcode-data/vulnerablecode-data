vulnerability_id: VCID-xejf-2h45-yugj
aliases:
  - GHSA-wcx9-ccpj-hx3c
summary: |
  Coder vulnerable to post-auth URL redirection to untrusted site ('Open Redirect')
  ### Summary
  An issue on Coder's login page allows attackers to craft a Coder URL that when clicked by a logged in user could redirect them to a website the attacker controls, e.g. https://google.com.

  ### Details
  On the login page, Coder checks for the presence of a `redirect` query parameter. On successful login, the user would be redirected to the location of the parameter. Improper sanitization allows attackers to specify a URL outside of the Coder application to redirect users to.

  ### Impact
  Coder users could potentially be redirected to a untrusted website if tricked into clicking a URL crafted by the attacker. Coder authentication tokens are **not** leaked to the resulting website.

  To check if your deployment is vulnerable, visit the following URL for your Coder deployment:
  - `https://<coder url>/login?redirect=https%3A%2F%2Fcoder.com%2Fdocs`

  ### Patched Versions
  This vulnerability is remedied in
  - v2.16.1
  - v2.15.3
  - v2.14.4

  All versions prior to 2.3.1 are not affected.

  ### Thanks
  - https://github.com/jchristov

  ### References
  https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c
  https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6
severities:
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/coder/coder
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/coder
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c
weaknesses:
  - CWE-601
references:
  - url: https://github.com/coder/coder
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c
    reference_type:
    reference_id:
