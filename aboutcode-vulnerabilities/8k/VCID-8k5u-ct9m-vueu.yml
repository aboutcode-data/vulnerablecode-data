vulnerability_id: VCID-8k5u-ct9m-vueu
aliases:
  - CVE-2025-6224
  - GHSA-h34r-jxqm-qgpr
summary: "juju/utils leaks private key in certs\n### Summary\n\nCerts generated by v4 contain\
  \ their private key.\n\n## Details\n\n### Background\n\nRecently, I encountered an API in\
  \ Go that’s easy to misuse: sha512.Sum384 and sha512.New384().Sum look very similar and behave\
  \ very differently. https://go.dev/play/p/kDCqqoYk84k demonstrates this. I want to discuss\
  \ extending static analysis to detect this case with the go community, but before I do that,\
  \ I want to make a best-effort pass at open-source projects to fix the existing bugs. I figured\
  \ that if there were any vulnerabilities out there, they would be easy to find once that discussion\
  \ begins, so it’s better to address them early. \n\nThis work is a hobby project and has no\
  \ affiliation with my employer, so I may be slow to respond due to existing commitments. \n\
  \n### PoC\n\nhttps://go.dev/play/p/vSW0U3Hq4qk\n\n### Impact\n\n[This code](https://github.com/juju/utils/blob/0141ef0ee74a0cac603c5c9e4aff194008722f41/cert/cert.go#L120)\
  \ (cert.NewLeaf) generates certs with the SubjectKeyId set to `sha512.New384().Sum(/* private\
  \ */ key)`.\n\nIf a cert which was generated by cert.NewLeaf is transferred over the network\
  \ in plaintext, as is often the case in TLS handshakes, an attacker listening on that network\
  \ may sniff the cert and trivially extract the private key from it. This applies to client\
  \ and server TLS certs generated by vulnerable versions of this library.\n\nGetting the server\
  \ cert and its key would only require performing a TLS handshake (with a matching SNI) with\
  \ the server. At that point, the attacker could impersonate the server.\n\nSimilarly, getting\
  \ the client cert and its key would require getting the client to perform a TLS handshake\
  \ against an attacker-controlled server. At that point, an attacker could impersonate the\
  \ client."
severities:
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00833'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00835'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.0084'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01328'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01672'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01634'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01628'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01618'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01635'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01643'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01636'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01632'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01625'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01669'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01647'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01657'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01711'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01704'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01725'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01665'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0169'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01676'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01674'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01677'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01675'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01667'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01661'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01658'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01656'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01644'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03836'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03512'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03494'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03838'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00492'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00489'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00481'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00485'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00486'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00493'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.005'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00496'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00566'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00564'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00563'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00573'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00574'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/juju/utils
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/juju/utils
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/juju/utils/commit/766f27d7bcd10433453a9764509a864c17a46a76
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/juju/utils/commit/766f27d7bcd10433453a9764509a864c17a46a76
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/juju/utils/releases/tag/v4.0.4
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/juju/utils/releases/tag/v4.0.4
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/juju/utils/security/advisories/GHSA-h34r-jxqm-qgpr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/juju/utils/security/advisories/GHSA-h34r-jxqm-qgpr
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-07-01T14:30:33Z/
    published_at: None
    url: https://github.com/juju/utils/security/advisories/GHSA-h34r-jxqm-qgpr
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-6224
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-6224
weaknesses:
  - CWE-312
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-6224
    reference_type:
    reference_id:
  - url: https://github.com/juju/utils
    reference_type:
    reference_id:
  - url: https://github.com/juju/utils/commit/766f27d7bcd10433453a9764509a864c17a46a76
    reference_type:
    reference_id:
  - url: https://github.com/juju/utils/releases/tag/v4.0.4
    reference_type:
    reference_id:
  - url: https://github.com/juju/utils/security/advisories/GHSA-h34r-jxqm-qgpr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-6224
    reference_type:
    reference_id:
