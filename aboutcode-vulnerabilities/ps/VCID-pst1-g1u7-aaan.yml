vulnerability_id: VCID-pst1-g1u7-aaan
aliases:
  - CVE-2022-21704
  - GHSA-82v2-mx6x-wq7q
summary: |
  Incorrect Default Permissions in log4js
  log4js-node is a port of log4js to node. fileSync and dateFile appenders are world-readable (in unix). This could cause problems if log files contain sensitive information. This would affect any users that have not supplied their own permissions for the files via the mode parameter in the config. Users are advised to update.
severities:
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07463'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0743'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05664'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05719'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07395'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05709'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05734'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05676'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05714'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05711'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0572'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05736'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05724'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05723'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05716'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05725'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07467'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07454'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07457'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0746'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07477'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07494'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07527'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05705'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07551'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07564'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07555'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.18955'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.18323'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.18618'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.18716'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.18752'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.18842'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.18836'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.18852'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.18892'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19261'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19336'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19439'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19319'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19296'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19293'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19587'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: '0.00079'
    scoring_system: epss
    scoring_elements: '0.13468'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-82v2-mx6x-wq7q
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/log4js-node/log4js-node
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/log4js-node/log4js-node
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/log4js-node/log4js-node/blob/v6.4.0/CHANGELOG.md#640
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/log4js-node/log4js-node/blob/v6.4.0/CHANGELOG.md#640
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/log4js-node/log4js-node/pull/1141/commits/8042252861a1b65adb66931fdf702ead34fa9b76
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/log4js-node/log4js-node/pull/1141/commits/8042252861a1b65adb66931fdf702ead34fa9b76
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/log4js-node/log4js-node/security/advisories/GHSA-82v2-mx6x-wq7q
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/log4js-node/log4js-node/security/advisories/GHSA-82v2-mx6x-wq7q
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/log4js-node/streamroller/pull/87
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/log4js-node/streamroller/pull/87
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2022/12/msg00014.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2022/12/msg00014.html
  - score: '2.1'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21704
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21704
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21704
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-276
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-21704
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-21704
    reference_type:
    reference_id:
  - url: https://github.com/log4js-node/log4js-node
    reference_type:
    reference_id:
  - url: https://github.com/log4js-node/log4js-node/blob/v6.4.0/CHANGELOG.md#640
    reference_type:
    reference_id:
  - url: https://github.com/log4js-node/log4js-node/pull/1141/commits/8042252861a1b65adb66931fdf702ead34fa9b76
    reference_type:
    reference_id:
  - url: https://github.com/log4js-node/log4js-node/security/advisories/GHSA-82v2-mx6x-wq7q
    reference_type:
    reference_id:
  - url: https://github.com/log4js-node/streamroller/pull/87
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/12/msg00014.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:log4js_project:log4js:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:log4js_project:log4js:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21704
    reference_type:
    reference_id: CVE-2022-21704
  - url: https://github.com/advisories/GHSA-82v2-mx6x-wq7q
    reference_type:
    reference_id: GHSA-82v2-mx6x-wq7q
