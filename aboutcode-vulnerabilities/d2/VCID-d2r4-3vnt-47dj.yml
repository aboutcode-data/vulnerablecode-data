vulnerability_id: VCID-d2r4-3vnt-47dj
aliases:
  - CVE-2023-53538
summary: 'In the Linux kernel, the following vulnerability has been resolved:  btrfs: insert
  tree mod log move in push_node_left  There is a fairly unlikely race condition in tree mod
  log rewind that can result in a kernel panic which has the following trace:    [530.569] BTRFS
  critical (device sda3): unable to find logical 0 length 4096   [530.585] BTRFS critical (device
  sda3): unable to find logical 0 length 4096   [530.602] BUG: kernel NULL pointer dereference,
  address: 0000000000000002   [530.618] #PF: supervisor read access in kernel mode   [530.629]
  #PF: error_code(0x0000) - not-present page   [530.641] PGD 0 P4D 0   [530.647] Oops: 0000
  [#1] SMP   [530.654] CPU: 30 PID: 398973 Comm: below Kdump: loaded Tainted: G S         O  K   5.12.0-0_fbk13_clang_7455_gb24de3bdb045
  #1   [530.680] Hardware name: Quanta Mono Lake-M.2 SATA 1HY9U9Z001G/Mono Lake-M.2 SATA, BIOS
  F20_3A15 08/16/2017   [530.703] RIP: 0010:__btrfs_map_block+0xaa/0xd00   [530.755] RSP: 0018:ffffc9002c2f7600
  EFLAGS: 00010246   [530.767] RAX: ffffffffffffffea RBX: ffff888292e41000 RCX: f2702d8b8be15100   [530.784]
  RDX: ffff88885fda6fb8 RSI: ffff88885fd973c8 RDI: ffff88885fd973c8   [530.800] RBP: ffff888292e410d0
  R08: ffffffff82fd7fd0 R09: 00000000fffeffff   [530.816] R10: ffffffff82e57fd0 R11: ffffffff82e57d70
  R12: 0000000000000000   [530.832] R13: 0000000000001000 R14: 0000000000001000 R15: ffffc9002c2f76f0   [530.848]
  FS:  00007f38d64af000(0000) GS:ffff88885fd80000(0000) knlGS:0000000000000000   [530.866] CS:  0010
  DS: 0000 ES: 0000 CR0: 0000000080050033   [530.880] CR2: 0000000000000002 CR3: 00000002b6770004
  CR4: 00000000003706e0   [530.896] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000   [530.912]
  DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400   [530.928] Call Trace:   [530.934]  ?
  btrfs_printk+0x13b/0x18c   [530.943]  ? btrfs_bio_counter_inc_blocked+0x3d/0x130   [530.955]  btrfs_map_bio+0x75/0x330   [530.963]  ?
  kmem_cache_alloc+0x12a/0x2d0   [530.973]  ? btrfs_submit_metadata_bio+0x63/0x100   [530.984]  btrfs_submit_metadata_bio+0xa4/0x100   [530.995]  submit_extent_page+0x30f/0x360   [531.004]  read_extent_buffer_pages+0x49e/0x6d0   [531.015]  ?
  submit_extent_page+0x360/0x360   [531.025]  btree_read_extent_buffer_pages+0x5f/0x150   [531.037]  read_tree_block+0x37/0x60   [531.046]  read_block_for_search+0x18b/0x410   [531.056]  btrfs_search_old_slot+0x198/0x2f0   [531.066]  resolve_indirect_ref+0xfe/0x6f0   [531.076]  ?
  ulist_alloc+0x31/0x60   [531.084]  ? kmem_cache_alloc_trace+0x12e/0x2b0   [531.095]  find_parent_nodes+0x720/0x1830   [531.105]  ?
  ulist_alloc+0x10/0x60   [531.113]  iterate_extent_inodes+0xea/0x370   [531.123]  ? btrfs_previous_extent_item+0x8f/0x110   [531.134]  ?
  btrfs_search_path_in_tree+0x240/0x240   [531.146]  iterate_inodes_from_logical+0x98/0xd0   [531.157]  ?
  btrfs_search_path_in_tree+0x240/0x240   [531.168]  btrfs_ioctl_logical_to_ino+0xd9/0x180   [531.179]  btrfs_ioctl+0xe2/0x2eb0  This
  occurs when logical inode resolution takes a tree mod log sequence number, and then while
  backref walking hits a rewind on a busy node which has the following sequence of tree mod
  log operations (numbers filled in from a specific example, but they are somewhat arbitrary)    REMOVE_WHILE_FREEING
  slot 532   REMOVE_WHILE_FREEING slot 531   REMOVE_WHILE_FREEING slot 530   ...   REMOVE_WHILE_FREEING
  slot 0   REMOVE slot 455   REMOVE slot 454   REMOVE slot 453   ...   REMOVE slot 0   ADD slot
  455   ADD slot 454   ADD slot 453   ...   ADD slot 0   MOVE src slot 0 -> dst slot 456 nritems
  533   REMOVE slot 455   REMOVE slot 454   REMOVE slot 453   ...   REMOVE slot 0  When this
  sequence gets applied via btrfs_tree_mod_log_rewind, it allocates a fresh rewind eb, and first
  inserts the correct key info for the 533 elements, then overwrites the first 456 of them,
  then decrements the count by 456 via the add ops, then rewinds the move by doing a memmove
  from 456:988->0:532. We have never written anything past 532, ---truncated---'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53538.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03382'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03419'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0342'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05275'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05267'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0525'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05222'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05235'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05214'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05197'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05186'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05196'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05212'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05292'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0531'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05277'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05283'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05297'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.07233'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.07203'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-908
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53538.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53538
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-53538
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2401528
    reference_type:
    reference_id: 2401528
