vulnerability_id: VCID-zmpb-5ykt-que4
aliases:
  - CVE-2025-4981
  - GHSA-qh58-9v3j-wcjc
summary: |
  Mattermost allows authenticated users to write files to arbitrary locations
  Mattermost versions 10.5.x <= 10.5.5, 9.11.x <= 9.11.15, 10.8.x <= 10.8.0, 10.7.x <= 10.7.2, 10.6.x <= 10.6.5 fail to sanitize filenames in the archive extractor which allows authenticated users to write files to arbitrary locations on the filesystem via uploading archives with path traversal sequences in filenames, potentially leading to remote code execution. The vulnerability impacts instances where file uploads and document search by content is enabled (FileSettings.EnableFileAttachments = true and FileSettings.ExtractContent = true). These configuration settings are enabled by default.
severities:
  - score: '0.00205'
    scoring_system: epss
    scoring_elements: '0.42956'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00205'
    scoring_system: epss
    scoring_elements: '0.43'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45784'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45748'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45699'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45714'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45704'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45669'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45701'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45894'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45717'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00229'
    scoring_system: epss
    scoring_elements: '0.45767'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00264'
    scoring_system: epss
    scoring_elements: '0.49686'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00264'
    scoring_system: epss
    scoring_elements: '0.49648'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00264'
    scoring_system: epss
    scoring_elements: '0.49667'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00264'
    scoring_system: epss
    scoring_elements: '0.49677'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00264'
    scoring_system: epss
    scoring_elements: '0.49728'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00264'
    scoring_system: epss
    scoring_elements: '0.49699'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00264'
    scoring_system: epss
    scoring_elements: '0.49678'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00264'
    scoring_system: epss
    scoring_elements: '0.49645'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50608'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50645'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53354'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53403'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53359'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53398'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.5339'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53408'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53392'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53388'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53522'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53523'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53533'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53385'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53376'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53372'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53399'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53402'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.534'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53362'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53316'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53344'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53327'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53303'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53357'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00307'
    scoring_system: epss
    scoring_elements: '0.53387'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59897'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59668'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.5973'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59737'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59741'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.5974'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59753'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59903'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/mattermost/mattermost
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mattermost/mattermost
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/mattermost/mattermost/commit/65aec10162f612d98edf91cc66bf7e781868448b
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mattermost/mattermost/commit/65aec10162f612d98edf91cc66bf7e781868448b
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://mattermost.com/security-updates
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://mattermost.com/security-updates
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-06-20T13:06:30Z/
    published_at: None
    url: https://mattermost.com/security-updates
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-4981
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-4981
weaknesses:
  - CWE-427
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-4981
    reference_type:
    reference_id:
  - url: https://github.com/mattermost/mattermost
    reference_type:
    reference_id:
  - url: https://github.com/mattermost/mattermost/commit/65aec10162f612d98edf91cc66bf7e781868448b
    reference_type:
    reference_id:
  - url: https://mattermost.com/security-updates
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-4981
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mattermost:mattermost_server:10.8.0:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mattermost:mattermost_server:10.8.0:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mattermost:mattermost_server:10.8.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mattermost:mattermost_server:10.8.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mattermost:mattermost_server:10.8.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mattermost:mattermost_server:10.8.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mattermost:mattermost_server:10.8.0:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mattermost:mattermost_server:10.8.0:rc3:*:*:*:*:*:*
