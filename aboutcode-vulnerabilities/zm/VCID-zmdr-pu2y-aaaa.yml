vulnerability_id: VCID-zmdr-pu2y-aaaa
aliases:
  - CVE-2023-47128
  - GHSA-xq59-7jf3-rjc6
  - PYSEC-2023-241
summary: 'Piccolo is an object-relational mapping and query builder which supports asyncio.
  Prior to version 1.1.1, the handling of named transaction `savepoints` in all database implementations
  is vulnerable to SQL Injection via f-strings. While the likelihood of an end developer exposing
  a `savepoints` `name` parameter to a user is highly unlikely, it would not be unheard of.
  If a malicious user was able to abuse this functionality they would have essentially direct
  access to the database and the ability to modify data to the level of permissions associated
  with the database user. A non exhaustive list of actions possible based on database permissions
  is: Read all data stored in the database, including usernames and password hashes; insert
  arbitrary data into the database, including modifying existing records; and gain a shell on
  the underlying server. Version 1.1.1 fixes this issue.'
severities:
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.37396'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47751'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47763'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47905'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47734'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47628'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47647'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47729'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47551'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00120'
    scoring_system: epss
    scoring_elements: '0.47727'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50523'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50467'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53397'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53075'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53100'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53113'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45591'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45635'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45624'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45622'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45603'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45667'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45592'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45594'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45552'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45608'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45694'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45553'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45695'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00228'
    scoring_system: epss
    scoring_elements: '0.45614'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59209'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59146'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59092'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59185'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59191'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59219'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59237'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59217'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59221'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59247'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59266'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59286'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59279'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59277'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00421'
    scoring_system: epss
    scoring_elements: '0.59259'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: '0.00817'
    scoring_system: epss
    scoring_elements: '0.59499'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xq59-7jf3-rjc6
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/piccolo-orm/piccolo
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/piccolo-orm/piccolo
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/piccolo-orm/piccolo/commit/82679eb8cd1449cf31d87c9914a072e70168b6eb
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/piccolo-orm/piccolo/commit/82679eb8cd1449cf31d87c9914a072e70168b6eb
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/piccolo-orm/piccolo/security/advisories/GHSA-xq59-7jf3-rjc6
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/piccolo-orm/piccolo/security/advisories/GHSA-xq59-7jf3-rjc6
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/piccolo/PYSEC-2023-241.yaml
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/piccolo/PYSEC-2023-241.yaml
  - score: '9.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-47128
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-47128
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-89
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-47128
    reference_type:
    reference_id:
  - url: https://github.com/piccolo-orm/piccolo
    reference_type:
    reference_id:
  - url: https://github.com/piccolo-orm/piccolo/commit/82679eb8cd1449cf31d87c9914a072e70168b6eb
    reference_type:
    reference_id:
  - url: https://github.com/piccolo-orm/piccolo/security/advisories/GHSA-xq59-7jf3-rjc6
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/piccolo/PYSEC-2023-241.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:piccolo-orm:piccolo:1.1.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:piccolo-orm:piccolo:1.1.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-47128
    reference_type:
    reference_id: CVE-2023-47128
  - url: https://github.com/advisories/GHSA-xq59-7jf3-rjc6
    reference_type:
    reference_id: GHSA-xq59-7jf3-rjc6
