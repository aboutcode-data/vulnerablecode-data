vulnerability_id: VCID-zmnd-4469-jfh8
aliases:
  - CVE-2025-38224
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  can: kvaser_pciefd: refine error prone echo_skb_max handling logic

  echo_skb_max should define the supported upper limit of echo_skb[]
  allocated inside the netdevice's priv. The corresponding size value
  provided by this driver to alloc_candev() is KVASER_PCIEFD_CAN_TX_MAX_COUNT
  which is 17.

  But later echo_skb_max is rounded up to the nearest power of two (for the
  max case, that would be 32) and the tx/ack indices calculated further
  during tx/rx may exceed the upper array boundary. Kasan reported this for
  the ack case inside kvaser_pciefd_handle_ack_packet(), though the xmit
  function has actually caught the same thing earlier.

   BUG: KASAN: slab-out-of-bounds in kvaser_pciefd_handle_ack_packet+0x2d7/0x92a drivers/net/can/kvaser_pciefd.c:1528
   Read of size 8 at addr ffff888105e4f078 by task swapper/4/0

   CPU: 4 UID: 0 PID: 0 Comm: swapper/4 Not tainted 6.15.0 #12 PREEMPT(voluntary)
   Call Trace:
    <IRQ>
   dump_stack_lvl lib/dump_stack.c:122
   print_report mm/kasan/report.c:521
   kasan_report mm/kasan/report.c:634
   kvaser_pciefd_handle_ack_packet drivers/net/can/kvaser_pciefd.c:1528
   kvaser_pciefd_read_packet drivers/net/can/kvaser_pciefd.c:1605
   kvaser_pciefd_read_buffer drivers/net/can/kvaser_pciefd.c:1656
   kvaser_pciefd_receive_irq drivers/net/can/kvaser_pciefd.c:1684
   kvaser_pciefd_irq_handler drivers/net/can/kvaser_pciefd.c:1733
   __handle_irq_event_percpu kernel/irq/handle.c:158
   handle_irq_event kernel/irq/handle.c:210
   handle_edge_irq kernel/irq/chip.c:833
   __common_interrupt arch/x86/kernel/irq.c:296
   common_interrupt arch/x86/kernel/irq.c:286
    </IRQ>

  Tx max count definitely matters for kvaser_pciefd_tx_avail(), but for seq
  numbers' generation that's not the case - we're free to calculate them as
  would be more convenient, not taking tx max count into account. The only
  downside is that the size of echo_skb[] should correspond to the max seq
  number (not tx max count), so in some situations a bit more memory would
  be consumed than could be.

  Thus make the size of the underlying echo_skb[] sufficient for the rounded
  max tx value.

  Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38224.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01321'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01344'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02438'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04168'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04154'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04126'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04107'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04115'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04106'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0407'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04056'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04601'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04612'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04674'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04804'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04776'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04641'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0461'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04594'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04564'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05517'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05487'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05468'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05442'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05467'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05444'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05429'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05416'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05436'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05526'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05214'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05191'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05209'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05307'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05324'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05367'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05281'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05273'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05242'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05321'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05326'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05507'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05497'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05534'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05478'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0545'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0548'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05504'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05513'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05542'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08328'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38224.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38224
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/54ec8b08216f3be2cc98b33633d3c8ea79749895
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a6550c9aa11e2f57f9cdaa6249cdd44d446be874
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d8a054b6e6824a8b52c3977ebd38c9583a63efac
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2376402
    reference_type:
    reference_id: 2376402
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38224
    reference_type:
    reference_id: CVE-2025-38224
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
