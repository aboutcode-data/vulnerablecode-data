vulnerability_id: VCID-k9v6-u62q-euh4
aliases:
  - CVE-2022-50002
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net/mlx5: LAG,
  fix logic over MLX5_LAG_FLAG_NDEVS_READY  Only set MLX5_LAG_FLAG_NDEVS_READY if both netdevices
  are registered. Doing so guarantees that both ldev->pf[MLX5_LAG_P0].dev and ldev->pf[MLX5_LAG_P1].dev
  have valid pointers when MLX5_LAG_FLAG_NDEVS_READY is set.  The core issue is asymmetry in
  setting MLX5_LAG_FLAG_NDEVS_READY and clearing it. Setting it is done wrongly when both ldev->pf[MLX5_LAG_P0].dev
  and ldev->pf[MLX5_LAG_P1].dev are set; clearing it is done right when either of ldev->pf[i].netdev
  is cleared.  Consider the following scenario: 1. PF0 loads and sets ldev->pf[MLX5_LAG_P0].dev
  to a valid pointer 2. PF1 loads and sets both ldev->pf[MLX5_LAG_P1].dev and    ldev->pf[MLX5_LAG_P1].netdev
  with valid pointers. This results in    MLX5_LAG_FLAG_NDEVS_READY is set. 3. PF0 is unloaded
  before setting dev->pf[MLX5_LAG_P0].netdev.    MLX5_LAG_FLAG_NDEVS_READY remains set.  Further
  execution of mlx5_do_bond() will result in null pointer dereference when calling mlx5_lag_is_multipath()  This
  patch fixes the following call trace actually encountered:  [ 1293.475195] BUG: kernel NULL
  pointer dereference, address: 00000000000009a8 [ 1293.478756] #PF: supervisor read access
  in kernel mode [ 1293.481320] #PF: error_code(0x0000) - not-present page [ 1293.483686] PGD
  0 P4D 0 [ 1293.484434] Oops: 0000 [#1] SMP PTI [ 1293.485377] CPU: 1 PID: 23690 Comm: kworker/u16:2
  Not tainted 5.18.0-rc5_for_upstream_min_debug_2022_05_05_10_13 #1 [ 1293.488039] Hardware
  name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org
  04/01/2014 [ 1293.490836] Workqueue: mlx5_lag mlx5_do_bond_work [mlx5_core] [ 1293.492448]
  RIP: 0010:mlx5_lag_is_multipath+0x5/0x50 [mlx5_core] [ 1293.494044] Code: e8 70 40 ff e0 48
  8b 14 24 48 83 05 5c 1a 1b 00 01 e9 19 ff ff ff 48 83 05 47 1a 1b 00 01 eb d7 0f 1f 44 00
  00 0f 1f 44 00 00 <48> 8b 87 a8 09 00 00 48 85 c0 74 26 48 83 05 a7 1b 1b 00 01 41 b8 [ 1293.498673]
  RSP: 0018:ffff88811b2fbe40 EFLAGS: 00010202 [ 1293.500152] RAX: ffff88818a94e1c0 RBX: ffff888165eca6c0
  RCX: 0000000000000000 [ 1293.501841] RDX: 0000000000000001 RSI: ffff88818a94e1c0 RDI: 0000000000000000
  [ 1293.503585] RBP: 0000000000000000 R08: ffff888119886740 R09: ffff888165eca73c [ 1293.505286]
  R10: 0000000000000018 R11: 0000000000000018 R12: ffff88818a94e1c0 [ 1293.506979] R13: ffff888112729800
  R14: 0000000000000000 R15: ffff888112729858 [ 1293.508753] FS:  0000000000000000(0000) GS:ffff88852cc40000(0000)
  knlGS:0000000000000000 [ 1293.510782] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 [
  1293.512265] CR2: 00000000000009a8 CR3: 00000001032d4002 CR4: 0000000000370ea0 [ 1293.514001]
  DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 [ 1293.515806] DR3: 0000000000000000
  DR6: 00000000fffe0ff0 DR7: 0000000000000400'
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50002.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50002.json
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03363'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03388'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05462'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05454'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05288'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05243'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05228'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05237'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0524'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05271'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05314'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05255'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05257'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05948'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05947'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05902'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05949'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05985'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05866'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05862'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05911'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.0595'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06992'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06544'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06498'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06513'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06554'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06539'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06635'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06663'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06695'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06607'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06646'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06614'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06734'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06725'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06728'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06848'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06825'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06861'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06836'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06817'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.0686'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06944'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07002'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10553'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10523'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10602'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10537'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10528'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10521'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10507'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10635'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10592'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10604'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-821
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50002.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50002
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c040acf5744e87a7b3490f9ec8bedd0d15c9f29
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a6e675a66175869b7d87c0e1dd0ddf93e04f8098
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2373471
    reference_type:
    reference_id: 2373471
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50002
    reference_type:
    reference_id: CVE-2022-50002
  - url: https://access.redhat.com/errata/RHSA-2023:2458
    reference_type:
    reference_id: RHSA-2023:2458
  - url: https://access.redhat.com/errata/RHSA-2023:2951
    reference_type:
    reference_id: RHSA-2023:2951
