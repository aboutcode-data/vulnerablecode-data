vulnerability_id: VCID-k9xg-2jwj-j7c7
aliases:
  - CVE-2022-50770
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ocfs2: fix memory
  leak in ocfs2_mount_volume()  There is a memory leak reported by kmemleak:    unreferenced
  object 0xffff88810cc65e60 (size 32):     comm "mount.ocfs2", pid 23753, jiffies 4302528942
  (age 34735.105s)     hex dump (first 32 bytes):       10 00 00 00 00 00 00 00 00 01 01 01
  01 01 01 01  ................       01 01 01 01 01 01 01 01 00 00 00 00 00 00 00 00  ................     backtrace:       [<ffffffff8170f73d>]
  __kmalloc+0x4d/0x150       [<ffffffffa0ac3f51>] ocfs2_compute_replay_slots+0x121/0x330 [ocfs2]       [<ffffffffa0b65165>]
  ocfs2_check_volume+0x485/0x900 [ocfs2]       [<ffffffffa0b68129>] ocfs2_mount_volume.isra.0+0x1e9/0x650
  [ocfs2]       [<ffffffffa0b7160b>] ocfs2_fill_super+0xe0b/0x1740 [ocfs2]       [<ffffffff818e1fe2>]
  mount_bdev+0x312/0x400       [<ffffffff819a086d>] legacy_get_tree+0xed/0x1d0       [<ffffffff818de82d>]
  vfs_get_tree+0x7d/0x230       [<ffffffff81957f92>] path_mount+0xd62/0x1760       [<ffffffff81958a5a>]
  do_mount+0xca/0xe0       [<ffffffff81958d3c>] __x64_sys_mount+0x12c/0x1a0       [<ffffffff82f26f15>]
  do_syscall_64+0x35/0x80       [<ffffffff8300006a>] entry_SYSCALL_64_after_hwframe+0x46/0xb0  This
  call stack is related to two problems.  Firstly, the ocfs2 super uses "replay_map" to trace
  online/offline slots, in order to recover offline slots during recovery and mount.  But when
  ocfs2_truncate_log_init() returns an error in ocfs2_mount_volume(), the memory of "replay_map"
  will not be freed in error handling path.  Secondly, the memory of "replay_map" will not be
  freed if d_make_root() returns an error in ocfs2_fill_super(). But the memory of "replay_map"
  will be freed normally when completing recovery and mount in ocfs2_complete_mount_recovery().  Fix
  the first problem by adding error handling path to free "replay_map" when ocfs2_truncate_log_init()
  fails.  And fix the second problem by calling ocfs2_free_replay_slots(osb) in the error handling
  path "out_dismount".  In addition, since ocfs2_free_replay_slots() is static, it is necessary
  to remove its static attribute and declare it in header file.'
severities:
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0895'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50770
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08909'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50770
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50770.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50770
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-50770
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2425112
    reference_type:
    reference_id: 2425112
