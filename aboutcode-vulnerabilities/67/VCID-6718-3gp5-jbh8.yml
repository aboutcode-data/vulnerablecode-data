vulnerability_id: VCID-6718-3gp5-jbh8
aliases:
  - CVE-2025-32431
  - GHSA-6p68-w45g-48j7
summary: "Traefik has a possible vulnerability with the path matchers\n## Impact\n\nThere is\
  \ a potential vulnerability in Traefik managing the requests using a `PathPrefix`, `Path`\
  \ or `PathRegex` matcher.\n\nWhen Traefik is configured to route the requests to a backend\
  \ using a matcher based on the path, if the URL contains a `/../` in its path, it’s possible\
  \ to target a backend, exposed using another router, by-passing the middlewares chain.\n\n\
  ## Example\n\n```yaml\napiVersion: traefik.io/v1alpha1\nkind: IngressRoute\nmetadata:\n  name:\
  \ my-service\nspec:\n  routes:\n    - match: PathPrefix(‘/service’)\n      kind: Rule\n  \
  \    services:\n        - name: service-a\n          port: 8080\n      middlewares:\n    \
  \    - name: my-middleware-a\n    - match: PathPrefix(‘/service/sub-path’)\n      kind: Rule\n\
  \      services:\n        - name: service-a\n          port: 8080\n```\n\nIn such a case,\
  \ the request `http://mydomain.example.com/service/sub-path/../other-path` will reach the\
  \ backend `my-service-a` without operating the middleware `my-middleware-a` unless the computed\
  \ path is `http://mydomain.example.com/service/other-path` and should be computes by the first\
  \ router (operating `my-middleware-a`).\n\n## Patches\n\n- https://github.com/traefik/traefik/releases/tag/v2.11.24\n\
  - https://github.com/traefik/traefik/releases/tag/v3.3.6\n- https://github.com/traefik/traefik/releases/tag/v3.4.0-rc2\n\
  \n## Workaround\n\nAdd a `PathRegexp` rule to the matcher to prevent matching a route with\
  \ a `/../` in the path.\n\nExample: \n\n```yaml\nmatch: PathPrefix(`/service`) && !PathRegexp(`(?:(/\\\
  .\\./)+.*)`)\n```\n\n## For more information\n\nIf you have any questions or comments about\
  \ this advisory, please [[open an issue](https://github.com/traefik/traefik/issues)](https://github.com/traefik/traefik/issues)."
severities:
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13607'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32431
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13584'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32431
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.2177'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32431
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21772'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32431
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21751'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32431
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.27059'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32431
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.27053'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32431
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/traefik/traefik
  - score: '8.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/traefik/traefik/pull/11684
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/traefik/traefik/pull/11684
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-21T15:55:08Z/
    published_at: None
    url: https://github.com/traefik/traefik/pull/11684
  - score: '8.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/traefik/traefik/releases/tag/v2.11.24
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/traefik/traefik/releases/tag/v2.11.24
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-21T15:55:08Z/
    published_at: None
    url: https://github.com/traefik/traefik/releases/tag/v2.11.24
  - score: '8.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/traefik/traefik/releases/tag/v3.3.6
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/traefik/traefik/releases/tag/v3.3.6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-21T15:55:08Z/
    published_at: None
    url: https://github.com/traefik/traefik/releases/tag/v3.3.6
  - score: '8.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/traefik/traefik/releases/tag/v3.4.0-rc2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/traefik/traefik/releases/tag/v3.4.0-rc2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-21T15:55:08Z/
    published_at: None
    url: https://github.com/traefik/traefik/releases/tag/v3.4.0-rc2
  - score: '8.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/traefik/traefik/security/advisories/GHSA-6p68-w45g-48j7
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/traefik/traefik/security/advisories/GHSA-6p68-w45g-48j7
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-04-21T15:55:08Z/
    published_at: None
    url: https://github.com/traefik/traefik/security/advisories/GHSA-6p68-w45g-48j7
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-32431
weaknesses:
  - CWE-22
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-32431
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/releases/tag/v2.11.24
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/releases/tag/v3.3.6
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/releases/tag/v3.4.0-rc2
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/security/advisories/GHSA-6p68-w45g-48j7
    reference_type:
    reference_id:
  - url: https://github.com/traefik/traefik/pull/11684
    reference_type:
    reference_id: 11684
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32431
    reference_type:
    reference_id: CVE-2025-32431
