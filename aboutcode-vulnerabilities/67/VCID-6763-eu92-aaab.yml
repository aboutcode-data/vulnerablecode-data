vulnerability_id: VCID-6763-eu92-aaab
aliases:
  - CVE-2019-20920
  - GHSA-3cqr-58rm-57f8
summary: |
  Improper Control of Generation of Code ('Code Injection')
  Handlebars before 3.0.8 and 4.x before 4.5.3 is vulnerable to Arbitrary Code Execution. The lookup helper fails to properly validate templates, allowing attackers to submit templates that execute arbitrary JavaScript. This can be used to run arbitrary code on a server processing Handlebars templates or in a victim's browser (effectively serving as XSS).
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2019/CVE-2019-20920.html
  - score: Low
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2020:5179
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:2500
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:3917
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2019-20920.json
  - score: '0.005'
    scoring_system: epss
    scoring_elements: '0.63137'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.005'
    scoring_system: epss
    scoring_elements: '0.63233'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.005'
    scoring_system: epss
    scoring_elements: '0.63235'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.005'
    scoring_system: epss
    scoring_elements: '0.63257'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.005'
    scoring_system: epss
    scoring_elements: '0.63159'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.005'
    scoring_system: epss
    scoring_elements: '0.63273'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65652'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65618'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.64397'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.64415'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.6442'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65679'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65691'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65702'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65698'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65685'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65674'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65677'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.64425'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.64408'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.64393'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.64414'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.64411'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65667'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65678'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65711'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65709'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.65686'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80877'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80683'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80803'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80835'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80847'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80875'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80876'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80886'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80888'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80932'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80944'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.00699'
    scoring_system: epss
    scoring_elements: '0.80965'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.01186'
    scoring_system: epss
    scoring_elements: '0.84805'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.01186'
    scoring_system: epss
    scoring_elements: '0.84954'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.01186'
    scoring_system: epss
    scoring_elements: '0.84818'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.01186'
    scoring_system: epss
    scoring_elements: '0.84817'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: '0.01427'
    scoring_system: epss
    scoring_elements: '0.68645'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1882260
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20920
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-3cqr-58rm-57f8
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/handlebars-lang/handlebars.js/commit/156061eb7707575293613d7fdf90e2bdaac029ee
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/handlebars-lang/handlebars.js/commit/156061eb7707575293613d7fdf90e2bdaac029ee
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/handlebars-lang/handlebars.js/commit/d54137810a49939fd2ad01a91a34e182ece4528e
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/handlebars-lang/handlebars.js/commit/d54137810a49939fd2ad01a91a34e182ece4528e
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-20920
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-20920
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-20920
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://snyk.io/vuln/SNYK-JS-HANDLEBARS-534478
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://snyk.io/vuln/SNYK-JS-HANDLEBARS-534478
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://www.npmjs.com/advisories/1316
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.npmjs.com/advisories/1316
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://www.npmjs.com/advisories/1324
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.npmjs.com/advisories/1324
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.npmjs.com/package/handlebars
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.npmjs.com/package/handlebars
weaknesses:
  - CWE-20
  - CWE-79
  - CWE-94
  - CWE-937
  - CWE-1035
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2019/CVE-2019-20920.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2019-20920.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2019-20920
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20920
    reference_type:
    reference_id:
  - url: https://github.com/handlebars-lang/handlebars.js/commit/156061eb7707575293613d7fdf90e2bdaac029ee
    reference_type:
    reference_id:
  - url: https://github.com/handlebars-lang/handlebars.js/commit/d54137810a49939fd2ad01a91a34e182ece4528e
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/SNYK-JS-HANDLEBARS-534478
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1316
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1324
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/package/handlebars
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1882260
    reference_type:
    reference_id: 1882260
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:handlebarsjs:handlebars:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:handlebarsjs:handlebars:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2019-20920
    reference_type:
    reference_id: CVE-2019-20920
  - url: https://github.com/advisories/GHSA-3cqr-58rm-57f8
    reference_type:
    reference_id: GHSA-3cqr-58rm-57f8
  - url: https://access.redhat.com/errata/RHSA-2020:5179
    reference_type:
    reference_id: RHSA-2020:5179
  - url: https://access.redhat.com/errata/RHSA-2021:2500
    reference_type:
    reference_id: RHSA-2021:2500
  - url: https://access.redhat.com/errata/RHSA-2021:3917
    reference_type:
    reference_id: RHSA-2021:3917
  - url: https://access.redhat.com/errata/RHSA-2023:1334
    reference_type:
    reference_id: RHSA-2023:1334
