vulnerability_id: VCID-5q9y-rsx8-ukc3
aliases:
  - CVE-2024-56734
  - GHSA-8jhw-6pjj-8723
summary: |
  Better Auth has an Open Redirect Vulnerability in Verify Email Endpoint
  ## Summary
  An **open redirect vulnerability** has been identified in the **verify email endpoint** of Better Auth, potentially allowing attackers to redirect users to malicious websites. This issue affects users relying on email verification links generated by the library.

  ## Affected Versions
  - All versions prior to **v1.1.6**.

  ## Impact
  Attackers could craft malicious email verification links that exploit the redirect functionality to send users to untrusted domains. This can result in:

  - **Phishing attacks** – Users may unknowingly enter sensitive information on fake login pages.
  - **Reputation damage** – Trust issues for applications using Better Auth.

  ## Vulnerability Details
  The verify email callback endpoint accepts a `callbackURL` parameter. Unlike other verification methods, email verification only uses JWT to verify and redirect without proper validation of the target domain. The origin checker is bypassed in this scenario because it only checks for `POST` requests. An attacker can manipulate this parameter to redirect users to arbitrary URLs controlled by the attacker.

  **Example Exploit:**
  ```
  https://example.com/auth/verify-email?token=abcd1234&callbackURL=https://malicious-site.com
  ```

  ## Patches
  Upgrade to Better Auth **v1.1.6** or later. This version enforces domain validation for `callbackURL` for `/verify-email` path and for all other `GET` endpoints.

  ## Workarounds
  You can also use hooks to pre-check URLs in your auth instance to prevent this without upgrading:

  ```ts
  const auth = betterAuth({
      hooks: {
           before: (ctx) => {
              if (ctx.path === "/verify-email") {
                 const callbackURL = ctx.query.callbackURL; // Check if this is a trusted callback URL or not
              }
           }
      }
  })
  ```
severities:
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.27774'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.11576'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30731'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30855'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30859'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30791'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30774'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30768'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.3076'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30769'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30789'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30773'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30744'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26463'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26414'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26569'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26587'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26597'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26601'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.2656'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26532'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26536'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26572'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26608'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26613'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26581'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26573'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26554'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.3068'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30745'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.3081'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-8jhw-6pjj-8723
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth
  - score: '7.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-30T17:36:35Z/
    published_at: None
    url: https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723
  - score: '7.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-30T17:36:35Z/
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56734
weaknesses:
  - CWE-601
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-56734
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56734
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-8jhw-6pjj-8723
    reference_type:
    reference_id: GHSA-8jhw-6pjj-8723
