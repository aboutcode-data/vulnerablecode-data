vulnerability_id: VCID-5qt8-mga4-aaap
aliases:
  - GHSA-wpfr-6297-9v57
summary: |
  User object created with invalid provider data in GoTrue
  ### Impact
  _What kind of vulnerability is it? Who is impacted?_

  Under certain circumstances a valid user object would have been created with invalid provider metadata.

  This vulnerability affects everyone running an instance of GoTrue as a service. We advise you to update especially if you are using the provider metadata from the user object to secure other resources.

  ### Patches
  _Has the problem been patched? What versions should users upgrade to?_

  A patch is available with the release of version [1.0.1 on Github](https://github.com/netlify/gotrue/releases/tag/v1.0.1).

  ### Workarounds
  _Is there a way for users to fix or remediate the vulnerability without upgrading?_

  If you don't rely on the provider metadata in the user object, you might not be affected. We still strongly recommend upgrading.

  ### References
  _Are there any links users can visit to find out more?_

  This problem was initially found and reported by the team at Supabase: https://github.com/supabase/gotrue/security/advisories/GHSA-5hvv-9cqv-894r. We want to thank them for the cooperation around this report.

  In contrast to their advisory, we decided to set the severity to "Moderate" since the provider metadata is not an inherent security feature of this GoTrue codebase or the Netlify ecosystem.

  ### For more information
  If you have any questions or comments about this advisory:
  * Email us at [security@netlify.com](mailto:security@netlify.com)
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/netlify/gotrue
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/netlify/gotrue/commit/4d8a3b39fe485a5f83c70617d594be01130c5b83
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/netlify/gotrue/pull/313
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/netlify/gotrue/releases/tag/v1.0.1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/netlify/gotrue/security/advisories/GHSA-wpfr-6297-9v57
weaknesses: []
references:
  - url: https://github.com/netlify/gotrue
    reference_type:
    reference_id:
  - url: https://github.com/netlify/gotrue/commit/4d8a3b39fe485a5f83c70617d594be01130c5b83
    reference_type:
    reference_id:
  - url: https://github.com/netlify/gotrue/pull/313
    reference_type:
    reference_id:
  - url: https://github.com/netlify/gotrue/releases/tag/v1.0.1
    reference_type:
    reference_id:
  - url: https://github.com/netlify/gotrue/security/advisories/GHSA-wpfr-6297-9v57
    reference_type:
    reference_id:
