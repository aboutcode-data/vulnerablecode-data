vulnerability_id: VCID-gqp8-mpye-aaac
aliases:
  - CVE-2021-32618
  - GHSA-6qmf-fj6m-686c
  - PYSEC-2021-123
summary: The Python "Flask-Security-Too" package is used for adding security features to your
  Flask application. It is an is an independently maintained version of Flask-Security based
  on the 3.0.0 version of Flask-Security. All versions of Flask-Security-Too allow redirects
  after many successful views (e.g. /login) by honoring the ?next query param. There is code
  in FS to validate that the url specified in the next parameter is either relative OR has the
  same netloc (network location) as the requesting URL. This check utilizes Pythons urlsplit
  library. However many browsers are very lenient on the kind of URL they accept and 'fill in
  the blanks' when presented with a possibly incomplete URL. As a concrete example - setting
  http://login?next=\\\github.com will pass FS's relative URL check however many browsers will
  gladly convert this to http://github.com. Thus an attacker could send such a link to an unwitting
  user, using a legitimate site and have it redirect to whatever site they want. This is considered
  a low severity due to the fact that if Werkzeug is used (which is very common with Flask applications)
  as the WSGI layer, it by default ALWAYS ensures that the Location header is absolute - thus
  making this attack vector mute. It is possible for application writers to modify this default
  behavior by setting the `autocorrect_location_header=False`.
severities:
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46101'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46205'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.45767'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46015'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46499'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46423'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46400'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46241'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46224'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.46199'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00160'
    scoring_system: epss
    scoring_elements: '0.53321'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00160'
    scoring_system: epss
    scoring_elements: '0.53036'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00160'
    scoring_system: epss
    scoring_elements: '0.53025'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.00160'
    scoring_system: epss
    scoring_elements: '0.52999'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94602'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94476'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94468'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94478'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94479'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94475'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94474'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94482'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94483'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94486'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94488'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94487'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94489'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.9457'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94581'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94586'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94592'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94595'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94591'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.9459'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94596'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.17163'
    scoring_system: epss
    scoring_elements: '0.94599'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '0.39429'
    scoring_system: epss
    scoring_elements: '0.95919'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-6qmf-fj6m-686c
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/Flask-Middleware/flask-security
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Flask-Middleware/flask-security
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/Flask-Middleware/flask-security/commit/e39bb04615050448c1b8ba4caa7dacc0edd3e405
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Flask-Middleware/flask-security/commit/e39bb04615050448c1b8ba4caa7dacc0edd3e405
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/Flask-Middleware/flask-security/issues/486
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Flask-Middleware/flask-security/issues/486
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/Flask-Middleware/flask-security/pull/489
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Flask-Middleware/flask-security/pull/489
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/flask-security-too/PYSEC-2021-123.yaml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/flask-security-too/PYSEC-2021-123.yaml
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32618
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32618
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32618
  - score: Low
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-1965
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://web.archive.org/web/20210517211717/https://github.com/Flask-Middleware/flask-security/issues/486
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://web.archive.org/web/20210517211717/https://github.com/Flask-Middleware/flask-security/issues/486
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://web.archive.org/web/20211207121851/https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://web.archive.org/web/20211207121851/https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://web.archive.org/web/20220410062740/https://github.com/Flask-Middleware/flask-security/pull/489
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://web.archive.org/web/20220410062740/https://github.com/Flask-Middleware/flask-security/pull/489
weaknesses:
  - CWE-601
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-32618
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/Flask-Middleware/flask-security
    reference_type:
    reference_id:
  - url: https://github.com/Flask-Middleware/flask-security/commit/e39bb04615050448c1b8ba4caa7dacc0edd3e405
    reference_type:
    reference_id:
  - url: https://github.com/Flask-Middleware/flask-security/issues/486
    reference_type:
    reference_id:
  - url: https://github.com/Flask-Middleware/flask-security/pull/489
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/flask-security-too/PYSEC-2021-123.yaml
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20210517211717/https://github.com/Flask-Middleware/flask-security/issues/486
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20211207121851/https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c
    reference_type:
    reference_id:
  - url: https://web.archive.org/web/20220410062740/https://github.com/Flask-Middleware/flask-security/pull/489
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/AVG-1965
    reference_type:
    reference_id: AVG-1965
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:flask-security_project:flask-security:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:flask-security_project:flask-security:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32618
    reference_type:
    reference_id: CVE-2021-32618
  - url: https://github.com/advisories/GHSA-6qmf-fj6m-686c
    reference_type:
    reference_id: GHSA-6qmf-fj6m-686c
  - url: https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c
    reference_type:
    reference_id: GHSA-6qmf-fj6m-686c
