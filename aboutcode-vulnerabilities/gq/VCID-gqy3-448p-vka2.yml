vulnerability_id: VCID-gqy3-448p-vka2
aliases:
  - CVE-2025-61928
  - GHSA-99h5-pjcv-gr6v
summary: "Better Auth: Unauthenticated API key creation through api-key plugin\n### Summary\n\
  Unauthenticated attackers can create or modify API keys for any user by passing that user's\
  \ id in the request body to the `api/auth/api-key/create` route.\n\n### Details\nThe vulnerability\
  \ exists in the authentication logic at when checking for user authentication then derives\
  \ the user as `session?.user ?? (authRequired ? null : { id: ctx.body.userId })`. When no\
  \ session exists but `userId` is present in the request body, `authRequired` becomes false\
  \ and the user object is set to the attacker-controlled ID. Server-only field validation only\
  \ executes when `authRequired` is true (lines 280-295), allowing attackers to set privileged\
  \ fields. No additional authentication occurs before the database operation, so the malicious\
  \ payload is accepted. The same pattern exists in the update endpoint.\n\n### PoC\n```bash\n\
  curl -X POST http://localhost:3000/api/auth/api-key/create \\\n   -H 'Content-Type: application/json'\
  \ \\\n   -d '{\n         \"userId\": \"victim-user-id\",\n         \"name\": \"zeropath\"\n\
  \       }'\n```\nResponse contains the new API key whose userId matches the victim, confirming\
  \ the bypass. \n\n### Impact\nThis is a critical authentication bypass enabling full an unauthenticated\
  \ attacker can generate an API key for any user and immediately gain complete authenticated\
  \ access. This allows the attacker to perform any action as the victim user using the api\
  \ key, potentially compromise the user data and the application depending on the victim's\
  \ privileges.\n\nThis issue was found by [ZeroPath](https://zeropath.com)."
severities:
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29115'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.32524'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.32434'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.3245'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.32521'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.32532'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.32487'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.32503'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.32516'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.3252'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.38119'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00166'
    scoring_system: epss
    scoring_elements: '0.38417'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00166'
    scoring_system: epss
    scoring_elements: '0.38318'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00166'
    scoring_system: epss
    scoring_elements: '0.38302'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00166'
    scoring_system: epss
    scoring_elements: '0.38301'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.41098'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.41146'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-99h5-pjcv-gr6v
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-99h5-pjcv-gr6v
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/better-auth/better-auth
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/better-auth/better-auth/commit/556085067609c508f8c546ceef9003ee8c607d39
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/better-auth/better-auth/commit/556085067609c508f8c546ceef9003ee8c607d39
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth/commit/556085067609c508f8c546ceef9003ee8c607d39
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth/commit/556085067609c508f8c546ceef9003ee8c607d39
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-10-10T14:23:17Z/
    published_at: None
    url: https://github.com/better-auth/better-auth/commit/556085067609c508f8c546ceef9003ee8c607d39
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-99h5-pjcv-gr6v
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-99h5-pjcv-gr6v
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-99h5-pjcv-gr6v
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-99h5-pjcv-gr6v
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-99h5-pjcv-gr6v
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-99h5-pjcv-gr6v
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-10-10T14:23:17Z/
    published_at: None
    url: https://github.com/better-auth/better-auth/security/advisories/GHSA-99h5-pjcv-gr6v
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61928
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61928
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61928
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-306
  - CWE-285
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-61928
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/commit/556085067609c508f8c546ceef9003ee8c607d39
    reference_type:
    reference_id:
  - url: https://github.com/better-auth/better-auth/security/advisories/GHSA-99h5-pjcv-gr6v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61928
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-99h5-pjcv-gr6v
    reference_type:
    reference_id: GHSA-99h5-pjcv-gr6v
