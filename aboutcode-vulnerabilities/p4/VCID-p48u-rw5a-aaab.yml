vulnerability_id: VCID-p48u-rw5a-aaab
aliases:
  - CVE-2024-36401
  - GHSA-6jj6-gm7p-fcvv
summary: |
  Remote Code Execution (RCE) vulnerability in geoserver
  ### Summary
  Multiple OGC request parameters allow Remote Code Execution (RCE) by unauthenticated users through specially crafted input against a default GeoServer installation due to unsafely evaluating property names as XPath expressions.

  ### Details
  The GeoTools library API that GeoServer calls evaluates property/attribute names for feature types in a way that unsafely passes them to the commons-jxpath library which can execute arbitrary code when evaluating XPath expressions. This XPath evaluation is intended to be used only by complex feature types (i.e., Application Schema data stores) but is incorrectly being applied to simple feature types as well which makes this vulnerability apply to **ALL** GeoServer instances.

  ### PoC
  No public PoC is provided but this vulnerability has been confirmed to be exploitable through WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic and WPS Execute requests.

  ### Impact
  This vulnerability can lead to executing arbitrary code.

  ### Workaround

  A workaround exists by removing the `gt-complex-x.y.jar` file from the GeoServer where `x.y` is the GeoTools version (e.g., `gt-complex-31.1.jar` if running GeoServer 2.25.1). This will remove the vulnerable code from GeoServer but may break some GeoServer functionality or prevent GeoServer from deploying if the gt-complex module is needed by an extension you are using:

  Mitigation for `geoserver.war` deploy:

  1. Stop the application server
  2. Unzip `geoserver.war` into a directory
  3. Locate the file `WEB-INF/lib/gt-complex-x.y.jar` and remove
  4. Zip the directory into a new `geoserver.war`
  5. Restart the application server

  Mitigation for GeoServer binary:

  1. Stop Jetty
  2. Locate the file `webapps/geoserver/WEB-INF/lib/gt-complex-x.y.jar` and remove
  3. Restart Jetty

  The following extensions and community modules are known to have a direct dependency on `gt-complex` jar and are not expected function properly without it. This is not comprehensive list and additional GeoServer functionality may be dependent on the availability of `gt-complex` jar:
  * Extensions: Application Schema, Catalog Services for the Web, MongoDB Data Store
  * Community Modules: Features-Templating, OGC API Modules, Smart Data Loader, SOLR Data Store

  Patch available for prior releases:
  1. Patched `gt-app-schema`, `gt-complex` and `gt-xsd-core` jars may be downloaded from the release page for GeoServer: 2.25.1, 2.24.3, 2.24.2, 2.23.2, 2.21.5, 2.20.7, 2.20.4, 2.19.2, 2.18.0.
  2. To use follow the instructions above to locate `WEB-INF/lib` folder
  3. Replace `gt-app-schema`, `gt-complex` and `gt-xsd-core` jars with those supplied by the patch

  ### References
  https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w
  https://osgeo-org.atlassian.net/browse/GEOT-7587
  https://github.com/geotools/geotools/pull/4797
  https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852
severities:
  - score: '0.94372'
    scoring_system: epss
    scoring_elements: '0.9996'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94372'
    scoring_system: epss
    scoring_elements: '0.99959'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94418'
    scoring_system: epss
    scoring_elements: '0.99979'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94418'
    scoring_system: epss
    scoring_elements: '0.99973'
    published_at: '2025-05-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94418'
    scoring_system: epss
    scoring_elements: '0.99972'
    published_at: '2025-05-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94418'
    scoring_system: epss
    scoring_elements: '0.99978'
    published_at: '2025-05-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94418'
    scoring_system: epss
    scoring_elements: '0.99976'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94418'
    scoring_system: epss
    scoring_elements: '0.99975'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94418'
    scoring_system: epss
    scoring_elements: '0.99974'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94418'
    scoring_system: epss
    scoring_elements: '0.99977'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94425'
    scoring_system: epss
    scoring_elements: '0.99979'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94425'
    scoring_system: epss
    scoring_elements: '0.9998'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94425'
    scoring_system: epss
    scoring_elements: '0.99981'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94425'
    scoring_system: epss
    scoring_elements: '0.99982'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.94425'
    scoring_system: epss
    scoring_elements: '0.99983'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95173'
    scoring_system: epss
    scoring_elements: '0.99422'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95173'
    scoring_system: epss
    scoring_elements: '0.99421'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95277'
    scoring_system: epss
    scoring_elements: '0.99520'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95545'
    scoring_system: epss
    scoring_elements: '0.99461'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95679'
    scoring_system: epss
    scoring_elements: '0.99494'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95679'
    scoring_system: epss
    scoring_elements: '0.99491'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95679'
    scoring_system: epss
    scoring_elements: '0.99493'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95679'
    scoring_system: epss
    scoring_elements: '0.99497'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95852'
    scoring_system: epss
    scoring_elements: '0.99599'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.95852'
    scoring_system: epss
    scoring_elements: '0.99601'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: '0.96014'
    scoring_system: epss
    scoring_elements: '0.99627'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-6jj6-gm7p-fcvv
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H
    published_at: None
    url: https://github.com/geoserver/geoserver
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/geoserver/geoserver
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/geoserver/geoserver
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv
  - score: Act
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:Y/T:T/P:M/B:A/M:M/D:C/2024-07-13T03:55:17Z/
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/geotools/geotools/pull/4797
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H
    published_at: None
    url: https://github.com/geotools/geotools/pull/4797
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/geotools/geotools/pull/4797
  - score: Act
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:Y/T:T/P:M/B:A/M:M/D:C/2024-07-13T03:55:17Z/
    published_at: None
    url: https://github.com/geotools/geotools/pull/4797
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H
    published_at: None
    url: https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w
  - score: Act
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:Y/T:T/P:M/B:A/M:M/D:C/2024-07-13T03:55:17Z/
    published_at: None
    url: https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H
    published_at: None
    url: https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852
  - score: Act
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:Y/T:T/P:M/B:A/M:M/D:C/2024-07-13T03:55:17Z/
    published_at: None
    url: https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-36401
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-36401
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-36401
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-36401
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOT-7587
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOT-7587
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOT-7587
  - score: Act
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:Y/T:T/P:M/B:A/M:M/D:C/2024-07-13T03:55:17Z/
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOT-7587
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H
    published_at: None
    url: https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2024-36401
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2024-36401
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.vicarius.io/vsociety/posts/geoserver-rce-cve-2024-36401
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H
    published_at: None
    url: https://www.vicarius.io/vsociety/posts/geoserver-rce-cve-2024-36401
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.vicarius.io/vsociety/posts/geoserver-rce-cve-2024-36401
weaknesses:
  - CWE-94
  - CWE-1035
  - CWE-937
  - CWE-95
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-36401
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv
    reference_type:
    reference_id:
  - url: https://github.com/geotools/geotools/pull/4797
    reference_type:
    reference_id:
  - url: https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w
    reference_type:
    reference_id:
  - url: https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-36401
    reference_type:
    reference_id:
  - url: https://osgeo-org.atlassian.net/browse/GEOT-7587
    reference_type:
    reference_id:
  - url: https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2024-36401
    reference_type:
    reference_id:
  - url: https://www.vicarius.io/vsociety/posts/geoserver-rce-cve-2024-36401
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:geoserver:geoserver:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:geoserver:geoserver:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:geotools:geotools:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:geotools:geotools:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-6jj6-gm7p-fcvv
    reference_type:
    reference_id: GHSA-6jj6-gm7p-fcvv
