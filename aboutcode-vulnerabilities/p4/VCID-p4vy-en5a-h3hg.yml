vulnerability_id: VCID-p4vy-en5a-h3hg
aliases:
  - CVE-2024-23945
  - GHSA-77pm-w3hx-f8mj
summary: |
  Signing cookies is an application security feature that adds a digital signature to cookie data to verify its authenticity and integrity. The signature helps prevent malicious actors from modifying the cookie value, which can lead to security vulnerabilities and exploitation. Apache Hive’s service component accidentally exposes the signed cookie to the end user when there is a mismatch in signature between the current and expected cookie. Exposing the correct cookie signature can lead to further exploitation.

  The vulnerable CookieSigner logic was introduced in Apache Hive by HIVE-9710 (1.2.0) and in Apache Spark by SPARK-14987 (2.0.0). The affected components are the following:
  * org.apache.hive:hive-service
  * org.apache.spark:spark-hive-thriftserver_2.11
  * org.apache.spark:spark-hive-thriftserver_2.12
severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14767'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15080'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49396'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49413'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49436'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49445'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49435'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49416'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49401'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.4938'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49405'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49434'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49424'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.494'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49398'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49289'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.49301'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.51686'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.59051'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.58965'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.59008'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.59035'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.59003'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.59002'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.59005'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.65007'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.65027'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.65026'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.65014'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: '0.02086'
    scoring_system: epss
    scoring_elements: '0.73342'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-77pm-w3hx-f8mj
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/apache/hive
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/hive
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-24T01:50:23Z/
    published_at: None
    url: https://github.com/apache/hive
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/apache/hive/commit/7638cb1a3b07713cc490aa2909a37037f89e08b4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/hive/commit/7638cb1a3b07713cc490aa2909a37037f89e08b4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-24T01:50:23Z/
    published_at: None
    url: https://github.com/apache/hive/commit/7638cb1a3b07713cc490aa2909a37037f89e08b4
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/apache/spark
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/spark
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-24T01:50:23Z/
    published_at: None
    url: https://github.com/apache/spark
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/apache/spark/commit/cf59b1f51c16301f689b4e0f17ba4dbd140e1b19
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/spark/commit/cf59b1f51c16301f689b4e0f17ba4dbd140e1b19
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-24T01:50:23Z/
    published_at: None
    url: https://github.com/apache/spark/commit/cf59b1f51c16301f689b4e0f17ba4dbd140e1b19
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://issues.apache.org/jira/browse/HIVE-9710
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://issues.apache.org/jira/browse/HIVE-9710
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-24T01:50:23Z/
    published_at: None
    url: https://issues.apache.org/jira/browse/HIVE-9710
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://issues.apache.org/jira/browse/SPARK-14987
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://issues.apache.org/jira/browse/SPARK-14987
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-24T01:50:23Z/
    published_at: None
    url: https://issues.apache.org/jira/browse/SPARK-14987
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://lists.apache.org/thread/59r4mv7glrxpwkkdjvjbdljfpx3f5zzc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/59r4mv7glrxpwkkdjvjbdljfpx3f5zzc
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-24T01:50:23Z/
    published_at: None
    url: https://lists.apache.org/thread/59r4mv7glrxpwkkdjvjbdljfpx3f5zzc
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://lists.apache.org/thread/5o2ljnzrv8zvhjw9vy7b4rwjpc32hgfc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/5o2ljnzrv8zvhjw9vy7b4rwjpc32hgfc
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-24T01:50:23Z/
    published_at: None
    url: https://lists.apache.org/thread/5o2ljnzrv8zvhjw9vy7b4rwjpc32hgfc
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23945
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23945
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/12/23/2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/12/23/2
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-209
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-23945.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-23945
    reference_type:
    reference_id:
  - url: https://github.com/apache/hive
    reference_type:
    reference_id:
  - url: https://github.com/apache/spark
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23945
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/12/23/2
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2333857
    reference_type:
    reference_id: 2333857
  - url: https://lists.apache.org/thread/59r4mv7glrxpwkkdjvjbdljfpx3f5zzc
    reference_type:
    reference_id: 59r4mv7glrxpwkkdjvjbdljfpx3f5zzc
  - url: https://lists.apache.org/thread/5o2ljnzrv8zvhjw9vy7b4rwjpc32hgfc
    reference_type:
    reference_id: 5o2ljnzrv8zvhjw9vy7b4rwjpc32hgfc
  - url: https://github.com/apache/hive/commit/7638cb1a3b07713cc490aa2909a37037f89e08b4
    reference_type:
    reference_id: 7638cb1a3b07713cc490aa2909a37037f89e08b4
  - url: https://github.com/apache/spark/commit/cf59b1f51c16301f689b4e0f17ba4dbd140e1b19
    reference_type:
    reference_id: cf59b1f51c16301f689b4e0f17ba4dbd140e1b19
  - url: https://github.com/advisories/GHSA-77pm-w3hx-f8mj
    reference_type:
    reference_id: GHSA-77pm-w3hx-f8mj
  - url: https://issues.apache.org/jira/browse/HIVE-9710
    reference_type:
    reference_id: HIVE-9710
  - url: https://issues.apache.org/jira/browse/SPARK-14987
    reference_type:
    reference_id: SPARK-14987
