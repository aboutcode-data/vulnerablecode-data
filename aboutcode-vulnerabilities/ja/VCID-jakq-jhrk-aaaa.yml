vulnerability_id: VCID-jakq-jhrk-aaaa
aliases:
  - CVE-2017-18638
  - GHSA-vfj6-275q-4pvm
  - PYSEC-2019-151
summary: send_email in graphite-web/webapp/graphite/composer/views.py in Graphite through 1.1.5
  is vulnerable to SSRF. The vulnerable SSRF endpoint can be used by an attacker to have the
  Graphite web server request any resource. The response to this SSRF request is encoded into
  an image file and then sent to an e-mail address that can be supplied by the attacker. Thus,
  an attacker can exfiltrate any information.
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-18638.html
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2017-18638.json
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82820'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82900'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82890'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82884'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82855'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82848'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82699'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82981'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82961'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82955'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.00855'
    scoring_system: epss
    scoring_elements: '0.82913'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.03762'
    scoring_system: epss
    scoring_elements: '0.91764'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.03762'
    scoring_system: epss
    scoring_elements: '0.91710'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.03762'
    scoring_system: epss
    scoring_elements: '0.91707'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.03762'
    scoring_system: epss
    scoring_elements: '0.91706'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.86634'
    scoring_system: epss
    scoring_elements: '0.99348'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.86634'
    scoring_system: epss
    scoring_elements: '0.9935'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99399'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99422'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99423'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99424'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99426'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99427'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99428'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99429'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.9943'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99431'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99394'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99395'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99396'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99397'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.87481'
    scoring_system: epss
    scoring_elements: '0.99398'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '0.91813'
    scoring_system: epss
    scoring_elements: '0.99643'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html#second-bug-internal-graphite-ssrf
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html#second-bug-internal-graphite-ssrf
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=2001847
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18638
  - score: '5.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-vfj6-275q-4pvm
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/graphite-project/graphite-web
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/graphite-project/graphite-web
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/graphite-project/graphite-web/commit/71726a0e41a5263f49b973a7b856505a5b931c1f
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/graphite-project/graphite-web/commit/71726a0e41a5263f49b973a7b856505a5b931c1f
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/graphite-project/graphite-web/issues/2008
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/graphite-project/graphite-web/issues/2008
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/graphite-project/graphite-web/pull/2499
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/graphite-project/graphite-web/pull/2499
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/graphite-project/graphite-web/security/advisories/GHSA-vfj6-275q-4pvm
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/graphite-web/PYSEC-2019-151.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/graphite-web/PYSEC-2019-151.yaml
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2019/10/msg00030.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2019/10/msg00030.html
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-18638
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-18638
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-18638
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://www.youtube.com/watch?v=ds4Gp4xoaeA
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.youtube.com/watch?v=ds4Gp4xoaeA
weaknesses:
  - CWE-918
  - CWE-937
  - CWE-1035
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-18638.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2017-18638.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2017-18638
    reference_type:
    reference_id:
  - url: https://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html#second-bug-internal-graphite-ssrf
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18638
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/graphite-project/graphite-web
    reference_type:
    reference_id:
  - url: https://github.com/graphite-project/graphite-web/commit/71726a0e41a5263f49b973a7b856505a5b931c1f
    reference_type:
    reference_id:
  - url: https://github.com/graphite-project/graphite-web/issues/2008
    reference_type:
    reference_id:
  - url: https://github.com/graphite-project/graphite-web/pull/2499
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/graphite-web/PYSEC-2019-151.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2019/10/msg00030.html
    reference_type:
    reference_id:
  - url: https://www.youtube.com/watch?v=ds4Gp4xoaeA
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2001847
    reference_type:
    reference_id: 2001847
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:graphite_project:graphite:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:graphite_project:graphite:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-18638
    reference_type:
    reference_id: CVE-2017-18638
  - url: https://github.com/advisories/GHSA-vfj6-275q-4pvm
    reference_type:
    reference_id: GHSA-vfj6-275q-4pvm
  - url: https://github.com/graphite-project/graphite-web/security/advisories/GHSA-vfj6-275q-4pvm
    reference_type:
    reference_id: GHSA-vfj6-275q-4pvm
  - url: https://usn.ubuntu.com/6243-1/
    reference_type:
    reference_id: USN-6243-1
