vulnerability_id: VCID-3ugj-mr5y-1bf4
aliases:
  - CVE-2024-47735
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  RDMA/hns: Fix spin_unlock_irqrestore() called with IRQs enabled

  Fix missuse of spin_lock_irq()/spin_unlock_irq() when
  spin_lock_irqsave()/spin_lock_irqrestore() was hold.

  This was discovered through the lock debugging, and the corresponding
  log is as follows:

  raw_local_irq_restore() called with IRQs enabled
  WARNING: CPU: 96 PID: 2074 at kernel/locking/irqflag-debug.c:10 warn_bogus_irq_restore+0x30/0x40
  ...
  Call trace:
   warn_bogus_irq_restore+0x30/0x40
   _raw_spin_unlock_irqrestore+0x84/0xc8
   add_qp_to_list+0x11c/0x148 [hns_roce_hw_v2]
   hns_roce_create_qp_common.constprop.0+0x240/0x780 [hns_roce_hw_v2]
   hns_roce_create_qp+0x98/0x160 [hns_roce_hw_v2]
   create_qp+0x138/0x258
   ib_create_qp_kernel+0x50/0xe8
   create_mad_qp+0xa8/0x128
   ib_mad_port_open+0x218/0x448
   ib_mad_init_device+0x70/0x1f8
   add_client_context+0xfc/0x220
   enable_device_and_get+0xd0/0x140
   ib_register_device.part.0+0xf4/0x1c8
   ib_register_device+0x34/0x50
   hns_roce_register_device+0x174/0x3d0 [hns_roce_hw_v2]
   hns_roce_init+0xfc/0x2c0 [hns_roce_hw_v2]
   __hns_roce_hw_v2_init_instance+0x7c/0x1d0 [hns_roce_hw_v2]
   hns_roce_hw_v2_init_instance+0x9c/0x180 [hns_roce_hw_v2]
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47735.json
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02688'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.01879'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02689'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05188'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04024'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04032'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04039'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04053'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04052'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04082'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04113'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04107'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04103'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04098'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04076'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05238'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05254'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05298'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05285'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05287'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05259'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05247'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05208'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.052'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05214'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05219'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05234'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05227'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04042'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04027'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:59:57Z/
    published_at: None
    url: https://git.kernel.org/stable/c/07f0f643d7e570dbe8ef6f5c3367a43e3086a335
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:59:57Z/
    published_at: None
    url: https://git.kernel.org/stable/c/094a1821903f33fb91de4b71087773ee16aeb3a0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:59:57Z/
    published_at: None
    url: https://git.kernel.org/stable/c/2656336a84fcb6802f6e6c233f4661891deea24f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:59:57Z/
    published_at: None
    url: https://git.kernel.org/stable/c/29c0f546d3fd66238b42cf25bcd5f193bb1cf794
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:59:57Z/
    published_at: None
    url: https://git.kernel.org/stable/c/425589d4af09c49574bd71ac31f811362a5126c3
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:59:57Z/
    published_at: None
    url: https://git.kernel.org/stable/c/74d315b5af180220d561684d15897730135733a6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:59:57Z/
    published_at: None
    url: https://git.kernel.org/stable/c/a1a3403bb1826c8ec787f0d60c3e7b54f419129e
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47735
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47735
weaknesses:
  - CWE-667
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47735.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47735
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47735
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/07f0f643d7e570dbe8ef6f5c3367a43e3086a335
    reference_type:
    reference_id: 07f0f643d7e570dbe8ef6f5c3367a43e3086a335
  - url: https://git.kernel.org/stable/c/094a1821903f33fb91de4b71087773ee16aeb3a0
    reference_type:
    reference_id: 094a1821903f33fb91de4b71087773ee16aeb3a0
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2320199
    reference_type:
    reference_id: 2320199
  - url: https://git.kernel.org/stable/c/2656336a84fcb6802f6e6c233f4661891deea24f
    reference_type:
    reference_id: 2656336a84fcb6802f6e6c233f4661891deea24f
  - url: https://git.kernel.org/stable/c/29c0f546d3fd66238b42cf25bcd5f193bb1cf794
    reference_type:
    reference_id: 29c0f546d3fd66238b42cf25bcd5f193bb1cf794
  - url: https://git.kernel.org/stable/c/425589d4af09c49574bd71ac31f811362a5126c3
    reference_type:
    reference_id: 425589d4af09c49574bd71ac31f811362a5126c3
  - url: https://git.kernel.org/stable/c/74d315b5af180220d561684d15897730135733a6
    reference_type:
    reference_id: 74d315b5af180220d561684d15897730135733a6
  - url: https://git.kernel.org/stable/c/a1a3403bb1826c8ec787f0d60c3e7b54f419129e
    reference_type:
    reference_id: a1a3403bb1826c8ec787f0d60c3e7b54f419129e
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47735
    reference_type:
    reference_id: CVE-2024-47735
  - url: https://usn.ubuntu.com/7166-1/
    reference_type:
    reference_id: USN-7166-1
  - url: https://usn.ubuntu.com/7166-2/
    reference_type:
    reference_id: USN-7166-2
  - url: https://usn.ubuntu.com/7166-3/
    reference_type:
    reference_id: USN-7166-3
  - url: https://usn.ubuntu.com/7166-4/
    reference_type:
    reference_id: USN-7166-4
  - url: https://usn.ubuntu.com/7186-1/
    reference_type:
    reference_id: USN-7186-1
  - url: https://usn.ubuntu.com/7186-2/
    reference_type:
    reference_id: USN-7186-2
  - url: https://usn.ubuntu.com/7194-1/
    reference_type:
    reference_id: USN-7194-1
  - url: https://usn.ubuntu.com/7276-1/
    reference_type:
    reference_id: USN-7276-1
  - url: https://usn.ubuntu.com/7277-1/
    reference_type:
    reference_id: USN-7277-1
  - url: https://usn.ubuntu.com/7301-1/
    reference_type:
    reference_id: USN-7301-1
  - url: https://usn.ubuntu.com/7303-1/
    reference_type:
    reference_id: USN-7303-1
  - url: https://usn.ubuntu.com/7303-2/
    reference_type:
    reference_id: USN-7303-2
  - url: https://usn.ubuntu.com/7303-3/
    reference_type:
    reference_id: USN-7303-3
  - url: https://usn.ubuntu.com/7304-1/
    reference_type:
    reference_id: USN-7304-1
  - url: https://usn.ubuntu.com/7310-1/
    reference_type:
    reference_id: USN-7310-1
  - url: https://usn.ubuntu.com/7311-1/
    reference_type:
    reference_id: USN-7311-1
  - url: https://usn.ubuntu.com/7384-1/
    reference_type:
    reference_id: USN-7384-1
  - url: https://usn.ubuntu.com/7384-2/
    reference_type:
    reference_id: USN-7384-2
  - url: https://usn.ubuntu.com/7385-1/
    reference_type:
    reference_id: USN-7385-1
  - url: https://usn.ubuntu.com/7386-1/
    reference_type:
    reference_id: USN-7386-1
  - url: https://usn.ubuntu.com/7403-1/
    reference_type:
    reference_id: USN-7403-1
  - url: https://usn.ubuntu.com/7468-1/
    reference_type:
    reference_id: USN-7468-1
