vulnerability_id: VCID-rqcu-he5r-97ey
aliases:
  - CVE-2024-43783
  - GHSA-x6xq-whh3-gg32
summary: 'The Apollo Router Core is a configurable, high-performance graph router written in
  Rust to run a federated supergraph that uses Apollo Federation 2. Instances of the Apollo
  Router running versions >=1.21.0 and < 1.52.1 are impacted by a denial of service vulnerability
  if _all_ of the following are true: 1. The Apollo Router has been configured to support [External
  Coprocessing](https://www.apollographql.com/docs/router/customizations/coprocessor). 2. The
  Apollo Router has been configured to send request bodies to coprocessors. This is a non-default
  configuration and must be configured intentionally by administrators. Instances of the Apollo
  Router running versions >=1.7.0 and <1.52.1 are impacted by a denial-of-service vulnerability
  if all of the following are true: 1. Router has been configured to use a custom-developed
  Native Rust Plugin. 2. The plugin accesses Request.router_request in the RouterService layer.
  3. You are accumulating the body from Request.router_request into memory. If using an impacted
  configuration, the Router will load entire HTTP request bodies into memory without respect
  to other HTTP request size-limiting configurations like limits.http_max_request_bytes. This
  can cause the Router to be out-of-memory (OOM) terminated if a sufficiently large request
  is sent to the Router. By default, the Router sets limits.http_max_request_bytes to 2 MB.
  If you have an impacted configuration as defined above, please upgrade to at least Apollo
  Router 1.52.1. If you cannot upgrade, you can mitigate the denial-of-service opportunity impacting
  External Coprocessors by setting the coprocessor.router.request.body configuration option
  to false. Please note that changing this configuration option will change the information
  sent to any coprocessors you have configured and may impact functionality implemented by those
  coprocessors. If you have developed a Native Rust Plugin and cannot upgrade, you can update
  your plugin to either not accumulate the request body or enforce a maximum body size limit.
  You can also mitigate this issue by limiting HTTP body payload sizes prior to the Router (e.g.,
  in a proxy or web application firewall appliance).'
severities:
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36376'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37477'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37131'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37185'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37175'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37227'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37150'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37084'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36877'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36865'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36847'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36840'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36844'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36752'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36724'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36654'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56234'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56131'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56174'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56227'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56252'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56268'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.5619'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56214'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56223'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56232'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56237'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56254'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.00346'
    scoring_system: epss
    scoring_elements: '0.56245'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01277'
    scoring_system: epss
    scoring_elements: '0.77722'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01277'
    scoring_system: epss
    scoring_elements: '0.77716'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78988'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78993'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78972'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78981'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78982'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78916'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78921'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78937'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78955'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78951'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78954'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01429'
    scoring_system: epss
    scoring_elements: '0.78957'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: '0.01762'
    scoring_system: epss
    scoring_elements: '0.7131'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-x6xq-whh3-gg32
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/apollographql/router
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apollographql/router
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/apollographql/router/commit/7a9c020608a62dcaa306b72ed0f6980f15923b14
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apollographql/router/commit/7a9c020608a62dcaa306b72ed0f6980f15923b14
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/apollographql/router/releases/tag/v1.52.1
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apollographql/router/releases/tag/v1.52.1
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/apollographql/router/security/advisories/GHSA-x6xq-whh3-gg32
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apollographql/router/security/advisories/GHSA-x6xq-whh3-gg32
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-43783
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-43783
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://www.apollographql.com/docs/router/configuration/overview/#request-limits
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.apollographql.com/docs/router/configuration/overview/#request-limits
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://www.apollographql.com/docs/router/customizations/coprocessor
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.apollographql.com/docs/router/customizations/coprocessor
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://www.apollographql.com/docs/router/customizations/native
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.apollographql.com/docs/router/customizations/native
weaknesses:
  - CWE-770
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-43783
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/commit/7a9c020608a62dcaa306b72ed0f6980f15923b14
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/releases/tag/v1.52.1
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/security/advisories/GHSA-x6xq-whh3-gg32
    reference_type:
    reference_id:
  - url: https://www.apollographql.com/docs/router/configuration/overview/#request-limits
    reference_type:
    reference_id:
  - url: https://www.apollographql.com/docs/router/customizations/coprocessor
    reference_type:
    reference_id:
  - url: https://www.apollographql.com/docs/router/customizations/native
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apollographql:apollo_helms-charts_router:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apollographql:apollo_helms-charts_router:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apollographql:apollo_router:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apollographql:apollo_router:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apollographql:apollo-router:*:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:apollographql:apollo-router:*:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43783
    reference_type:
    reference_id: CVE-2024-43783
  - url: https://github.com/advisories/GHSA-x6xq-whh3-gg32
    reference_type:
    reference_id: GHSA-x6xq-whh3-gg32
