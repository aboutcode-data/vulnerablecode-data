vulnerability_id: VCID-ybk6-7snc-w7aj
aliases:
  - CVE-2024-47764
  - GHSA-pxg6-pf52-xh8x
summary: |
  cookie accepts cookie name, path, and domain with out of bounds characters
  ### Impact

  The cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. For example, `serialize("userName=<script>alert('XSS3')</script>; Max-Age=2592000; a", value)` would result in `"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a=test"`, setting `userName` cookie to `<script>` and ignoring `value`.

  A similar escape can be used for `path` and `domain`, which could be abused to alter other fields of the cookie.

  ### Patches

  Upgrade to 0.7.0, which updates the validation for `name`, `path`, and `domain`.

  ### Workarounds

  Avoid passing untrusted or arbitrary values for these fields, ensure they are set by the application instead of user input.

  ### References

  * https://github.com/jshttp/cookie/pull/167
severities:
  - score: '3.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47764.json
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07886'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06128'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06116'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06125'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06121'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06134'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06144'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06133'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06119'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06104'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06063'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07918'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.0796'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08063'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08129'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08111'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08033'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07993'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07978'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07962'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07953'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07945'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07956'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06069'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06039'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.0611'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06109'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.06123'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.14116'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-pxg6-pf52-xh8x
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jshttp/cookie
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jshttp/cookie/pull/167
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-74
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47764.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47764
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47764
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie/pull/167
    reference_type:
    reference_id:
  - url: https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2316549
    reference_type:
    reference_id: 2316549
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47764
    reference_type:
    reference_id: CVE-2024-47764
  - url: https://github.com/advisories/GHSA-pxg6-pf52-xh8x
    reference_type:
    reference_id: GHSA-pxg6-pf52-xh8x
