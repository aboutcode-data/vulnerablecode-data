vulnerability_id: VCID-x4n7-r1tr-7qeg
aliases:
  - CVE-2023-54019
summary: 'In the Linux kernel, the following vulnerability has been resolved:  sched/psi: use
  kernfs polling functions for PSI trigger polling  Destroying psi trigger in cgroup_file_release
  causes UAF issues when a cgroup is removed from under a polling process. This is happening
  because cgroup removal causes a call to cgroup_file_release while the actual file is still
  alive. Destroying the trigger at this point would also destroy its waitqueue head and if there
  is still a polling process on that file accessing the waitqueue, it will step on the freed
  pointer:  do_select   vfs_poll                            do_rmdir                              cgroup_rmdir                                kernfs_drain_open_files                                  cgroup_file_release                                    cgroup_pressure_release                                      psi_trigger_destroy                                        wake_up_pollfree(&t->event_wait)
  // vfs_poll is unblocked                                        synchronize_rcu                                        kfree(t)   poll_freewait
  -> UAF access to the trigger''s waitqueue head  Patch [1] fixed this issue for epoll() case
  using wake_up_pollfree(), however the same issue exists for synchronous poll() case. The root
  cause of this issue is that the lifecycles of the psi trigger''s waitqueue and of the file
  associated with the trigger are different. Fix this by using kernfs_generic_poll function
  when polling on cgroup-specific psi triggers. It internally uses kernfs_open_node->poll waitqueue
  head with its lifecycle tied to the file''s lifecycle. This also renders the fix in [1] obsolete,
  so revert it.  [1] commit c2dbe32d5db5 ("sched/psi: Fix use-after-free in ep_remove_wait_queue()")'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54019.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0513'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54019
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05111'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54019
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54019.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-54019
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-54019
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2424987
    reference_type:
    reference_id: 2424987
