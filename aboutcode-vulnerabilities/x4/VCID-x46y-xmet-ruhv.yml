vulnerability_id: VCID-x46y-xmet-ruhv
aliases:
  - CVE-2025-21878
summary: 'In the Linux kernel, the following vulnerability has been resolved:  i2c: npcm: disable
  interrupt enable bit before devm_request_irq  The customer reports that there is a soft lockup
  issue related to the i2c driver. After checking, the i2c module was doing a tx transfer and
  the bmc machine reboots in the middle of the i2c transaction, the i2c module keeps the status
  without being reset.  Due to such an i2c module status, the i2c irq handler keeps getting
  triggered since the i2c irq handler is registered in the kernel booting process after the
  bmc machine is doing a warm rebooting. The continuous triggering is stopped by the soft lockup
  watchdog timer.  Disable the interrupt enable bit in the i2c module before calling devm_request_irq
  to fix this issue since the i2c relative status bit is read-only.  Here is the soft lockup
  log. [   28.176395] watchdog: BUG: soft lockup - CPU#0 stuck for 26s! [swapper/0:1] [   28.183351]
  Modules linked in: [   28.186407] CPU: 0 PID: 1 Comm: swapper/0 Not tainted 5.15.120-yocto-s-dirty-bbebc78
  #1 [   28.201174] pstate: 40000005 (nZcv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--) [   28.208128]
  pc : __do_softirq+0xb0/0x368 [   28.212055] lr : __do_softirq+0x70/0x368 [   28.215972] sp
  : ffffff8035ebca00 [   28.219278] x29: ffffff8035ebca00 x28: 0000000000000002 x27: ffffff80071a3780
  [   28.226412] x26: ffffffc008bdc000 x25: ffffffc008bcc640 x24: ffffffc008be50c0 [   28.233546]
  x23: ffffffc00800200c x22: 0000000000000000 x21: 000000000000001b [   28.240679] x20: 0000000000000000
  x19: ffffff80001c3200 x18: ffffffffffffffff [   28.247812] x17: ffffffc02d2e0000 x16: ffffff8035eb8b40
  x15: 00001e8480000000 [   28.254945] x14: 02c3647e37dbfcb6 x13: 02c364f2ab14200c x12: 0000000002c364f2
  [   28.262078] x11: 00000000fa83b2da x10: 000000000000b67e x9 : ffffffc008010250 [   28.269211]
  x8 : 000000009d983d00 x7 : 7fffffffffffffff x6 : 0000036d74732434 [   28.276344] x5 : 00ffffffffffffff
  x4 : 0000000000000015 x3 : 0000000000000198 [   28.283476] x2 : ffffffc02d2e0000 x1 : 00000000000000e0
  x0 : ffffffc008bdcb40 [   28.290611] Call trace: [   28.293052]  __do_softirq+0xb0/0x368 [   28.296625]  __irq_exit_rcu+0xe0/0x100
  [   28.300374]  irq_exit+0x14/0x20 [   28.303513]  handle_domain_irq+0x68/0x90 [   28.307440]  gic_handle_irq+0x78/0xb0
  [   28.311098]  call_on_irq_stack+0x20/0x38 [   28.315019]  do_interrupt_handler+0x54/0x5c
  [   28.319199]  el1_interrupt+0x2c/0x4c [   28.322777]  el1h_64_irq_handler+0x14/0x20 [   28.326872]  el1h_64_irq+0x74/0x78
  [   28.330269]  __setup_irq+0x454/0x780 [   28.333841]  request_threaded_irq+0xd0/0x1b4 [   28.338107]  devm_request_threaded_irq+0x84/0x100
  [   28.342809]  npcm_i2c_probe_bus+0x188/0x3d0 [   28.346990]  platform_probe+0x6c/0xc4 [   28.350653]  really_probe+0xcc/0x45c
  [   28.354227]  __driver_probe_device+0x8c/0x160 [   28.358578]  driver_probe_device+0x44/0xe0
  [   28.362670]  __driver_attach+0x124/0x1d0 [   28.366589]  bus_for_each_dev+0x7c/0xe0 [   28.370426]  driver_attach+0x28/0x30
  [   28.373997]  bus_add_driver+0x124/0x240 [   28.377830]  driver_register+0x7c/0x124 [   28.381662]  __platform_driver_register+0x2c/0x34
  [   28.386362]  npcm_i2c_init+0x3c/0x5c [   28.389937]  do_one_initcall+0x74/0x230 [   28.393768]  kernel_init_freeable+0x24c/0x2b4
  [   28.398126]  kernel_init+0x28/0x130 [   28.401614]  ret_from_fork+0x10/0x20 [   28.405189]
  Kernel panic - not syncing: softlockup: hung tasks [   28.411011] SMP: stopping secondary
  CPUs [   28.414933] Kernel Offset: disabled [   28.418412] CPU features: 0x00000000,00000802
  [   28.427644] Rebooting in 20 seconds..'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-21878.json
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03942'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03922'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0369'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05898'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05887'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05897'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05891'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05904'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05913'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05906'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0584'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05878'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05877'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05876'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.05892'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17515'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17289'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17361'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17454'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17531'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17527'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17509'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17475'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17466'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.1749'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.1751'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.17508'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19328'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-21878.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-21878
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-21878
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/12d0e39916705b68d2d8ba20a8e35d1d27afc260
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1b267e1b87d52b16e7dfcc7ab2ab760f6f8f9ca9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/545b563eb00d0576775da4011b3f7ffefc9e8c60
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/846e371631c57365eeb89e5db1ab0f344169af93
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd1998e243f5fa25d348a384ba0b6c84d980f2b2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e3aea1dba97d31eceed7b622000af0406988b9c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f32d7b4dc6e791523c70e83049645dcba2a2aa33
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355395
    reference_type:
    reference_id: 2355395
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21878
    reference_type:
    reference_id: CVE-2025-21878
