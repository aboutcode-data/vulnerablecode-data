vulnerability_id: VCID-2kjq-d2p1-kkaa
aliases:
  - CVE-2025-66405
  - GHSA-hhh5-2cvx-vmfp
summary: |
  Portkey.ai Gateway: Server-Side Request Forgery (SSRF) in Custom Host
  ### Summary
  The gateway determines the destination baseURL by prioritizing the value in the x-portkey-custom-host request header. The proxy route then appends the client-specified path to perform an external fetch. This can be maliciously used by users for SSRF (CWE-918) attack

  ### Impact
  This vulnerability can be exploited to force the server to make requests to arbitrary hosts on the internal network. This could allow an attacker to exfiltrate sensitive data, for instance, by accessing the AWS metadata service.

  ### Patches
  The issue is patched in 1.14.0 (https://github.com/Portkey-AI/gateway/pull/1372)

  The vulnerability resides within the gateway's request processing function which handles the `x-portkey-custom-host` header. This parameter was passed directly or with insufficient validation/sanitization to an internal HTTP request function.

  **The fix (v1.14.0) implements a robust allow-list policy:**

  1. All custom host inputs are now strictly validated to ensure the resulting URI points only to trusted, expected external services.

  2. The implementation now explicitly blocks requests to non-routable IP addresses, loopback addresses, private networks and standard metadata endpoints.

  ### Credit
  This vulnerability was discovered and reported responsibly by @im-soohyun. We thank them for their adherence to coordinated vulnerability disclosure principles.

  ### References
  https://cwe.mitre.org/data/definitions/918.html
severities:
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.17619'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66405
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.17604'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66405
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-hhh5-2cvx-vmfp
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Portkey-AI/gateway
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/Portkey-AI/gateway/commit/b5a7825ba5f4e6918deb32d9969899ce2229a885
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Portkey-AI/gateway/commit/b5a7825ba5f4e6918deb32d9969899ce2229a885
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-02T14:11:14Z/
    published_at: None
    url: https://github.com/Portkey-AI/gateway/commit/b5a7825ba5f4e6918deb32d9969899ce2229a885
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/Portkey-AI/gateway/pull/1372
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Portkey-AI/gateway/pull/1372
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-02T14:11:14Z/
    published_at: None
    url: https://github.com/Portkey-AI/gateway/pull/1372
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/Portkey-AI/gateway/security/advisories/GHSA-hhh5-2cvx-vmfp
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/Portkey-AI/gateway/security/advisories/GHSA-hhh5-2cvx-vmfp
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Portkey-AI/gateway/security/advisories/GHSA-hhh5-2cvx-vmfp
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-02T14:11:14Z/
    published_at: None
    url: https://github.com/Portkey-AI/gateway/security/advisories/GHSA-hhh5-2cvx-vmfp
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66405
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-918
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-66405
    reference_type:
    reference_id:
  - url: https://github.com/Portkey-AI/gateway
    reference_type:
    reference_id:
  - url: https://github.com/Portkey-AI/gateway/commit/b5a7825ba5f4e6918deb32d9969899ce2229a885
    reference_type:
    reference_id:
  - url: https://github.com/Portkey-AI/gateway/pull/1372
    reference_type:
    reference_id:
  - url: https://github.com/Portkey-AI/gateway/security/advisories/GHSA-hhh5-2cvx-vmfp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66405
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-hhh5-2cvx-vmfp
    reference_type:
    reference_id: GHSA-hhh5-2cvx-vmfp
