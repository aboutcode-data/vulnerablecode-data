vulnerability_id: VCID-w13w-pn2k-hyfm
aliases:
  - CVE-2024-50110
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  xfrm: fix one more kernel-infoleak in algo dumping

  During fuzz testing, the following issue was discovered:

  BUG: KMSAN: kernel-infoleak in _copy_to_iter+0x598/0x2a30
   _copy_to_iter+0x598/0x2a30
   __skb_datagram_iter+0x168/0x1060
   skb_copy_datagram_iter+0x5b/0x220
   netlink_recvmsg+0x362/0x1700
   sock_recvmsg+0x2dc/0x390
   __sys_recvfrom+0x381/0x6d0
   __x64_sys_recvfrom+0x130/0x200
   x64_sys_call+0x32c8/0x3cc0
   do_syscall_64+0xd8/0x1c0
   entry_SYSCALL_64_after_hwframe+0x79/0x81

  Uninit was stored to memory at:
   copy_to_user_state_extra+0xcc1/0x1e00
   dump_one_state+0x28c/0x5f0
   xfrm_state_walk+0x548/0x11e0
   xfrm_dump_sa+0x1e0/0x840
   netlink_dump+0x943/0x1c40
   __netlink_dump_start+0x746/0xdb0
   xfrm_user_rcv_msg+0x429/0xc00
   netlink_rcv_skb+0x613/0x780
   xfrm_netlink_rcv+0x77/0xc0
   netlink_unicast+0xe90/0x1280
   netlink_sendmsg+0x126d/0x1490
   __sock_sendmsg+0x332/0x3d0
   ____sys_sendmsg+0x863/0xc30
   ___sys_sendmsg+0x285/0x3e0
   __x64_sys_sendmsg+0x2d6/0x560
   x64_sys_call+0x1316/0x3cc0
   do_syscall_64+0xd8/0x1c0
   entry_SYSCALL_64_after_hwframe+0x79/0x81

  Uninit was created at:
   __kmalloc+0x571/0xd30
   attach_auth+0x106/0x3e0
   xfrm_add_sa+0x2aa0/0x4230
   xfrm_user_rcv_msg+0x832/0xc00
   netlink_rcv_skb+0x613/0x780
   xfrm_netlink_rcv+0x77/0xc0
   netlink_unicast+0xe90/0x1280
   netlink_sendmsg+0x126d/0x1490
   __sock_sendmsg+0x332/0x3d0
   ____sys_sendmsg+0x863/0xc30
   ___sys_sendmsg+0x285/0x3e0
   __x64_sys_sendmsg+0x2d6/0x560
   x64_sys_call+0x1316/0x3cc0
   do_syscall_64+0xd8/0x1c0
   entry_SYSCALL_64_after_hwframe+0x79/0x81

  Bytes 328-379 of 732 are uninitialized
  Memory access of size 732 starts at ffff88800e18e000
  Data copied to user address 00007ff30f48aff0

  CPU: 2 PID: 18167 Comm: syz-executor.0 Not tainted 6.8.11 #1
  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014

  Fixes copying of xfrm algorithms where some random
  data of the structure fields can end up in userspace.
  Padding in structures may be filled with random (possibly sensitve)
  data and should never be given directly to user-space.

  A similar issue was resolved in the commit
  8222d5910dae ("xfrm: Zero padding when dumping algos and encap")

  Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-50110.json
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-50110.json
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-50110.json
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.02852'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03406'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03398'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03385'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03343'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03341'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0335'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03348'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03351'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03396'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03392'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06344'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.05135'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.0511'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.05118'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.0638'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06406'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06501'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06457'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06461'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06443'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06429'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06386'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06383'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06393'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06881'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.0689'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06889'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.06458'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50110
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50110
weaknesses:
  - CWE-908
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-50110.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-50110
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50110
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1e8fbd2441cb2ea28d6825f2985bf7d84af060bb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/610d4cea9b442b22b4820695fc3335e64849725e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6889cd2a93e1e3606b3f6e958aa0924e836de4d2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c73bca72b84b453c8d26a5e7673b20adb294bf54
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dc2ad8e8818e4bf1a93db78d81745b4877b32972
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2323930
    reference_type:
    reference_id: 2323930
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50110
    reference_type:
    reference_id: CVE-2024-50110
  - url: https://access.redhat.com/errata/RHSA-2024:10943
    reference_type:
    reference_id: RHSA-2024:10943
  - url: https://access.redhat.com/errata/RHSA-2024:10944
    reference_type:
    reference_id: RHSA-2024:10944
  - url: https://access.redhat.com/errata/RHSA-2024:11486
    reference_type:
    reference_id: RHSA-2024:11486
  - url: https://access.redhat.com/errata/RHSA-2025:1658
    reference_type:
    reference_id: RHSA-2025:1658
  - url: https://usn.ubuntu.com/7276-1/
    reference_type:
    reference_id: USN-7276-1
  - url: https://usn.ubuntu.com/7277-1/
    reference_type:
    reference_id: USN-7277-1
  - url: https://usn.ubuntu.com/7288-1/
    reference_type:
    reference_id: USN-7288-1
  - url: https://usn.ubuntu.com/7288-2/
    reference_type:
    reference_id: USN-7288-2
  - url: https://usn.ubuntu.com/7289-1/
    reference_type:
    reference_id: USN-7289-1
  - url: https://usn.ubuntu.com/7289-2/
    reference_type:
    reference_id: USN-7289-2
  - url: https://usn.ubuntu.com/7289-3/
    reference_type:
    reference_id: USN-7289-3
  - url: https://usn.ubuntu.com/7289-4/
    reference_type:
    reference_id: USN-7289-4
  - url: https://usn.ubuntu.com/7291-1/
    reference_type:
    reference_id: USN-7291-1
  - url: https://usn.ubuntu.com/7305-1/
    reference_type:
    reference_id: USN-7305-1
  - url: https://usn.ubuntu.com/7308-1/
    reference_type:
    reference_id: USN-7308-1
  - url: https://usn.ubuntu.com/7310-1/
    reference_type:
    reference_id: USN-7310-1
  - url: https://usn.ubuntu.com/7331-1/
    reference_type:
    reference_id: USN-7331-1
  - url: https://usn.ubuntu.com/7388-1/
    reference_type:
    reference_id: USN-7388-1
  - url: https://usn.ubuntu.com/7389-1/
    reference_type:
    reference_id: USN-7389-1
  - url: https://usn.ubuntu.com/7390-1/
    reference_type:
    reference_id: USN-7390-1
  - url: https://usn.ubuntu.com/7449-1/
    reference_type:
    reference_id: USN-7449-1
  - url: https://usn.ubuntu.com/7449-2/
    reference_type:
    reference_id: USN-7449-2
  - url: https://usn.ubuntu.com/7450-1/
    reference_type:
    reference_id: USN-7450-1
  - url: https://usn.ubuntu.com/7451-1/
    reference_type:
    reference_id: USN-7451-1
  - url: https://usn.ubuntu.com/7452-1/
    reference_type:
    reference_id: USN-7452-1
  - url: https://usn.ubuntu.com/7453-1/
    reference_type:
    reference_id: USN-7453-1
  - url: https://usn.ubuntu.com/7458-1/
    reference_type:
    reference_id: USN-7458-1
  - url: https://usn.ubuntu.com/7468-1/
    reference_type:
    reference_id: USN-7468-1
