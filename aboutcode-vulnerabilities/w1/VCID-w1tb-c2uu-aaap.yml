vulnerability_id: VCID-w1tb-c2uu-aaap
aliases:
  - CVE-2023-38704
  - GHSA-5r27-rw8r-7967
summary: |
  import-in-the-middle is a module loading interceptor specifically for ESM modules. The import-in-the-middle loader works by generating a wrapper module on the fly. The wrapper uses the module specifier to load the original module and add some wrapping code. Prior to version 1.4.2, it allows for remote code execution in cases where an application passes user-supplied input directly to the `import()` function. This vulnerability has been patched in import-in-the-middle version 1.4.2.

  Some workarounds are available. Do not pass any user-supplied input to `import()`. Instead, verify it against a set of allowed values. If using import-in-the-middle, directly or indirectly, and support for EcmaScript Modules is not needed, ensure that no options are set, either via command-line or the `NODE_OPTIONS` environment variable, that would enable loader hooks.
severities:
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67091'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67076'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67068'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67064'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67102'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.6702'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67055'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67084'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.6706'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67073'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67065'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67103'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67081'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00563'
    scoring_system: epss
    scoring_elements: '0.67088'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81126'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81136'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81187'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81199'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81220'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81142'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.80935'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81055'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81087'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81098'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00717'
    scoring_system: epss
    scoring_elements: '0.81125'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00836'
    scoring_system: epss
    scoring_elements: '0.81835'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00836'
    scoring_system: epss
    scoring_elements: '0.81837'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00836'
    scoring_system: epss
    scoring_elements: '0.81847'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.00836'
    scoring_system: epss
    scoring_elements: '0.81989'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86313'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86275'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86263'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86298'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86296'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86311'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86317'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86309'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86315'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86324'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86333'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86344'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86336'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86339'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.03389'
    scoring_system: epss
    scoring_elements: '0.86335'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: '0.06649'
    scoring_system: epss
    scoring_elements: '0.84967'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5r27-rw8r-7967
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/DataDog/import-in-the-middle
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/DataDog/import-in-the-middle
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/DataDog/import-in-the-middle/commit/2531cdd9d1d73f9eaa87c16967f60cb276c1971b
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/DataDog/import-in-the-middle/commit/2531cdd9d1d73f9eaa87c16967f60cb276c1971b
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/DataDog/import-in-the-middle/security/advisories/GHSA-5r27-rw8r-7967
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/DataDog/import-in-the-middle/security/advisories/GHSA-5r27-rw8r-7967
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/DataDog/import-in-the-middle/security/advisories/GHSA-5r27-rw8r-7967
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38704
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38704
weaknesses:
  - CWE-20
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-38704
    reference_type:
    reference_id:
  - url: https://github.com/DataDog/import-in-the-middle
    reference_type:
    reference_id:
  - url: https://github.com/DataDog/import-in-the-middle/commit/2531cdd9d1d73f9eaa87c16967f60cb276c1971b
    reference_type:
    reference_id:
  - url: https://github.com/DataDog/import-in-the-middle/security/advisories/GHSA-5r27-rw8r-7967
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:datadoghq:import-in-the-middle:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:datadoghq:import-in-the-middle:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38704
    reference_type:
    reference_id: CVE-2023-38704
  - url: https://github.com/advisories/GHSA-5r27-rw8r-7967
    reference_type:
    reference_id: GHSA-5r27-rw8r-7967
