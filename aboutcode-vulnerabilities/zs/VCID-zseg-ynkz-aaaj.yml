vulnerability_id: VCID-zseg-ynkz-aaaj
aliases:
  - CVE-2021-41125
  - GHSA-jwqp-28gf-p498
  - PYSEC-2021-363
summary: Scrapy is a high-level web crawling and scraping framework for Python. If you use `HttpAuthMiddleware`
  (i.e. the `http_user` and `http_pass` spider attributes) for HTTP authentication, all requests
  will expose your credentials to the request target. This includes requests generated by Scrapy
  components, such as `robots.txt` requests sent by Scrapy when the `ROBOTSTXT_OBEY` setting
  is set to `True`, or as requests reached through redirects. Upgrade to Scrapy 2.5.1 and use
  the new `http_auth_domain` spider attribute to control which domains are allowed to receive
  the configured HTTP authentication credentials. If you are using Scrapy 1.8 or a lower version,
  and upgrading to Scrapy 2.5.1 is not an option, you may upgrade to Scrapy 1.8.1 instead. If
  you cannot upgrade, set your HTTP authentication credentials on a per-request basis, using
  for example the `w3lib.http.basic_auth_header` function to convert your credentials into a
  value that you can assign to the `Authorization` header of your request, instead of defining
  your credentials globally using `HttpAuthMiddleware`.
severities:
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#module-scrapy.downloadermiddlewares.httpauth
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#module-scrapy.downloadermiddlewares.httpauth
  - score: '0.00246'
    scoring_system: epss
    scoring_elements: '0.64039'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00246'
    scoring_system: epss
    scoring_elements: '0.63807'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00246'
    scoring_system: epss
    scoring_elements: '0.63797'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00246'
    scoring_system: epss
    scoring_elements: '0.63781'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63301'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61763'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61713'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61809'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61812'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61841'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.6186'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.6184'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61832'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61833'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61852'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61868'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.6189'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61889'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.6188'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.61863'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63221'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63261'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63298'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63323'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63328'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63297'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.633'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63304'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63314'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.0047'
    scoring_system: epss
    scoring_elements: '0.63318'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77570'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77607'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77259'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77398'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77432'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77444'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77487'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77486'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77490'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77505'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77512'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.00520'
    scoring_system: epss
    scoring_elements: '0.77586'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: '0.01114'
    scoring_system: epss
    scoring_elements: '0.65042'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-jwqp-28gf-p498
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/scrapy/PYSEC-2021-363.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/scrapy/PYSEC-2021-363.yaml
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/scrapy/scrapy
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/scrapy/scrapy
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/scrapy/scrapy/security/advisories/GHSA-jwqp-28gf-p498
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2022/03/msg00021.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2022/03/msg00021.html
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41125
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41125
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41125
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2447
  - score: '5.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://w3lib.readthedocs.io/en/latest/w3lib.html#w3lib.http.basic_auth_header
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://w3lib.readthedocs.io/en/latest/w3lib.html#w3lib.http.basic_auth_header
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-200
  - CWE-522
references:
  - url: http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#module-scrapy.downloadermiddlewares.httpauth
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-41125
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41125
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/scrapy/PYSEC-2021-363.yaml
    reference_type:
    reference_id:
  - url: https://github.com/scrapy/scrapy
    reference_type:
    reference_id:
  - url: https://github.com/scrapy/scrapy/commit/b01d69a1bf48060daec8f751368622352d8b85a6
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2022/03/msg00021.html
    reference_type:
    reference_id:
  - url: https://w3lib.readthedocs.io/en/latest/w3lib.html#w3lib.http.basic_auth_header
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/AVG-2447
    reference_type:
    reference_id: AVG-2447
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:scrapy:scrapy:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:scrapy:scrapy:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41125
    reference_type:
    reference_id: CVE-2021-41125
  - url: https://github.com/advisories/GHSA-jwqp-28gf-p498
    reference_type:
    reference_id: GHSA-jwqp-28gf-p498
  - url: https://github.com/scrapy/scrapy/security/advisories/GHSA-jwqp-28gf-p498
    reference_type:
    reference_id: GHSA-jwqp-28gf-p498
