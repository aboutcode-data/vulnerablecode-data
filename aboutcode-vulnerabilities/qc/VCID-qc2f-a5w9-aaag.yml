vulnerability_id: VCID-qc2f-a5w9-aaag
aliases:
  - CVE-2022-39387
  - GHSA-m7gv-v8xx-v47w
summary: XWiki OIDC has various tools to manipulate OpenID Connect protocol in XWiki. Prior
  to version 1.29.1, even if a wiki has an OpenID provider configured through its xwiki.properties,
  it is possible to provide a third party provider its details through request parameters. One
  can then bypass the XWiki authentication altogether by specifying its own provider through
  the oidc.endpoint.* request parameters (or by using an XWiki-based OpenID provider with oidc.xwikiprovider.
  With the same approach, one could also provide a specific group mapping through oidc.groups.mapping
  that would make his user automatically part of the XWikiAdminGroup. This issue has been patched,
  please upgrade to 1.29.1. There is no workaround, an upgrade of the authenticator is required.
severities:
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.44265'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.44596'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.44263'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.44287'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32671'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28223'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28183'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28323'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.2834'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28347'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28377'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28343'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28303'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28308'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28345'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28375'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28383'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28341'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.28311'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32633'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32694'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32756'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32802'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32806'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32735'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32713'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32712'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32708'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32722'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.32691'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52648'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52914'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52861'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52834'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52691'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52664'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52647'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52642'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52226'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52498'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52563'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.52580'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: '0.00156'
    scoring_system: epss
    scoring_elements: '0.23459'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-m7gv-v8xx-v47w
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://github.com/xwiki-contrib/oidc
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki-contrib/oidc
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://github.com/xwiki-contrib/oidc/commit/0247af1417925b9734ab106ad7cd934ee870ac89
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki-contrib/oidc/commit/0247af1417925b9734ab106ad7cd934ee870ac89
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:49:27Z/
    published_at: None
    url: https://github.com/xwiki-contrib/oidc/commit/0247af1417925b9734ab106ad7cd934ee870ac89
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://github.com/xwiki-contrib/oidc/security/advisories/GHSA-m7gv-v8xx-v47w
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki-contrib/oidc/security/advisories/GHSA-m7gv-v8xx-v47w
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki-contrib/oidc/security/advisories/GHSA-m7gv-v8xx-v47w
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:49:27Z/
    published_at: None
    url: https://github.com/xwiki-contrib/oidc/security/advisories/GHSA-m7gv-v8xx-v47w
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://jira.xwiki.org/browse/OIDC-118
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/OIDC-118
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:49:27Z/
    published_at: None
    url: https://jira.xwiki.org/browse/OIDC-118
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39387
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39387
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-287
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-39387
    reference_type:
    reference_id:
  - url: https://github.com/xwiki-contrib/oidc
    reference_type:
    reference_id:
  - url: https://github.com/xwiki-contrib/oidc/commit/0247af1417925b9734ab106ad7cd934ee870ac89
    reference_type:
    reference_id:
  - url: https://github.com/xwiki-contrib/oidc/security/advisories/GHSA-m7gv-v8xx-v47w
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/OIDC-118
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:openid_connect:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:openid_connect:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39387
    reference_type:
    reference_id: CVE-2022-39387
  - url: https://github.com/advisories/GHSA-m7gv-v8xx-v47w
    reference_type:
    reference_id: GHSA-m7gv-v8xx-v47w
