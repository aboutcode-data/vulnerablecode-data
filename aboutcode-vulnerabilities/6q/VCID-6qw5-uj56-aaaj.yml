vulnerability_id: VCID-6qw5-uj56-aaaj
aliases:
  - CVE-2022-39252
  - GHSA-vp68-2wrm-69qm
summary: matrix-rust-sdk is an implementation of a Matrix client-server library in Rust, and
  matrix-sdk-crypto is the Matrix encryption library. Prior to version 0.6, when a user requests
  a room key from their devices, the software correctly remembers the request. When the user
  receives a forwarded room key, the software accepts it without checking who the room key came
  from. This allows homeservers to try to insert room keys of questionable validity, potentially
  mounting an impersonation attack. Version 0.6 fixes this issue.
severities:
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20869'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17389'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17336'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17483'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17505'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17538'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17553'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17526'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17512'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17498'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17545'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17542'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17521'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17496'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.17466'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20713'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20779'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20833'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20893'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20885'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.2085'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20848'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20858'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20863'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.2088'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20882'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20887'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20879'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.38937'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.39265'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.38565'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.38825'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.38904'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.38932'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.39022'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.39017'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.39028'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.39040'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.39053'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.39230'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.39291'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.39359'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.38953'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.38965'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.18846'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-vp68-2wrm-69qm
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/commit/093fb5d0aa21c0b5eaea6ec96b477f1075271cbb
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/commit/093fb5d0aa21c0b5eaea6ec96b477f1075271cbb
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/commit/093fb5d0aa21c0b5eaea6ec96b477f1075271cbb
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:29Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/commit/093fb5d0aa21c0b5eaea6ec96b477f1075271cbb
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/commit/41449d2cc360e347f5d4e1c154ec1e3185f11acd
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/commit/41449d2cc360e347f5d4e1c154ec1e3185f11acd
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/commit/41449d2cc360e347f5d4e1c154ec1e3185f11acd
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:29Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/commit/41449d2cc360e347f5d4e1c154ec1e3185f11acd
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/releases/tag/matrix-sdk-0.6.0
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/releases/tag/matrix-sdk-0.6.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/releases/tag/matrix-sdk-0.6.0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:29Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/releases/tag/matrix-sdk-0.6.0
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-vp68-2wrm-69qm
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-vp68-2wrm-69qm
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-vp68-2wrm-69qm
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:29Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-vp68-2wrm-69qm
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39252
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39252
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2022-0085.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2022-0085.html
weaknesses:
  - CWE-322
  - CWE-287
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-39252
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/commit/093fb5d0aa21c0b5eaea6ec96b477f1075271cbb
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/commit/41449d2cc360e347f5d4e1c154ec1e3185f11acd
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/releases/tag/matrix-sdk-0.6.0
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-vp68-2wrm-69qm
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2022-0085.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:matrix-rust-sdk:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:matrix-rust-sdk:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39252
    reference_type:
    reference_id: CVE-2022-39252
  - url: https://github.com/advisories/GHSA-vp68-2wrm-69qm
    reference_type:
    reference_id: GHSA-vp68-2wrm-69qm
