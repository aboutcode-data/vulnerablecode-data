vulnerability_id: VCID-fygs-ph8q-aaaa
aliases:
  - CVE-2021-40824
  - GHSA-jjmc-4p83-pp26
summary: A logic error in the room key sharing functionality of Element Android before 1.2.2
  and matrix-android-sdk2 (aka Matrix SDK for Android) before 1.2.2 allows a malicious Matrix
  homeserver present in an encrypted room to steal room encryption keys (via crafted Matrix
  protocol messages) that were originally sent by affected Matrix clients participating in that
  room. This allows the attacker to decrypt end-to-end encrypted messages sent by affected clients.
severities:
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37352'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37306'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37319'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37338'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37559'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37698'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37620'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.36837'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37113'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37185'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37216'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37310'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.38156'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.37825'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.37862'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.37855'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47011'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47135'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47037'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47043'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47054'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47075'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47076'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47086'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47067'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47047'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44188'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44164'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44294'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44306'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44318'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44332'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.4431'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44275'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44299'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44319'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44344'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.4435'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.4432'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.44287'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47002'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47058'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47111'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.47134'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: '0.005'
    scoring_system: epss
    scoring_elements: '0.48847'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-jjmc-4p83-pp26
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-android-sdk2/releases/tag/v1.2.2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-android-sdk2/releases/tag/v1.2.2
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40824
  - score: '5.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40824
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40824
weaknesses:
  - CWE-327
  - CWE-937
  - CWE-1035
  - CWE-290
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-40824
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-android-sdk2/releases/tag/v1.2.2
    reference_type:
    reference_id:
  - url: https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:element:*:*:*:*:*:android:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:element:*:*:*:*:*:android:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:matrix-android-sdk2:*:*:*:*:*:android:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:matrix-android-sdk2:*:*:*:*:*:android:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-40824
    reference_type:
    reference_id: CVE-2021-40824
  - url: https://github.com/advisories/GHSA-jjmc-4p83-pp26
    reference_type:
    reference_id: GHSA-jjmc-4p83-pp26
