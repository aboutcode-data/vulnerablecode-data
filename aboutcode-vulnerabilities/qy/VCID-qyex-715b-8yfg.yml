vulnerability_id: VCID-qyex-715b-8yfg
aliases:
  - CVE-2023-53586
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: target:
  Fix multiple LUN_RESET handling  This fixes a bug where an initiator thinks a LUN_RESET has
  cleaned up running commands when it hasn''t. The bug was added in commit 51ec502a3266 ("target:
  Delete tmr from list before processing").  The problem occurs when:   1. We have N I/O cmds
  running in the target layer spread over 2 sessions.   2. The initiator sends a LUN_RESET for
  each session.   3. session1''s LUN_RESET loops over all the running commands from both     sessions
  and moves them to its local drain_task_list.   4. session2''s LUN_RESET does not see the LUN_RESET
  from session1 because     the commit above has it remove itself. session2 also does not see
  any     commands since the other reset moved them off the state lists.   5. sessions2''s LUN_RESET
  will then complete with a successful response.   6. sessions2''s inititor believes the running
  commands on its session are     now cleaned up due to the successful response and cleans up
  the running     commands from its side. It then restarts them.   7. The commands do eventually
  complete on the backend and the target     starts to return aborted task statuses for them.
  The initiator will     either throw a invalid ITT error or might accidentally lookup a new     task
  if the ITT has been reallocated already.  Fix the bug by reverting the patch, and serialize
  the execution of LUN_RESETs and Preempt and Aborts.  Also prevent us from waiting on LUN_RESETs
  in core_tmr_drain_tmr_list, because it turns out the original patch fixed a bug that was not
  mentioned. For LUN_RESET1 core_tmr_drain_tmr_list can see a second LUN_RESET and wait on it.
  Then the second reset will run core_tmr_drain_tmr_list and see the first reset and wait on
  it resulting in a deadlock.'
severities:
  - score: '5.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53586.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53586.json
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04935'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04959'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04964'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07843'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07813'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07796'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07906'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0784'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0783'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07833'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07847'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07893'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07923'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07837'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07895'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07909'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07903'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.10113'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.10072'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
  - score: 6
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-821
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53586.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53586
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-53586
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2401541
    reference_type:
    reference_id: 2401541
  - url: https://access.redhat.com/errata/RHSA-2024:2394
    reference_type:
    reference_id: RHSA-2024:2394
  - url: https://access.redhat.com/errata/RHSA-2024:3138
    reference_type:
    reference_id: RHSA-2024:3138
