vulnerability_id: VCID-gpbg-xdc3-aaas
aliases:
  - CVE-2023-42443
  - GHSA-c647-pxm2-c52w
  - PYSEC-2023-306
summary: |
  Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine (EVM). In version 0.3.9 and prior, under certain conditions, the memory used by the builtins `raw_call`, `create_from_blueprint` and `create_copy_of` can be corrupted. For `raw_call`, the argument buffer of the call can be corrupted, leading to incorrect `calldata` in the sub-context. For `create_from_blueprint` and `create_copy_of`, the buffer for the to-be-deployed bytecode can be corrupted, leading to deploying incorrect bytecode.

  Each builtin has conditions that must be fulfilled for the corruption to happen. For `raw_call`, the `data` argument of the builtin must be `msg.data` and the `value` or `gas` passed to the builtin must be some complex expression that results in writing to the memory. For `create_copy_of`, the `value` or `salt` passed to the builtin must be some complex expression that results in writing to the memory. For `create_from_blueprint`, either no constructor parameters should be passed to the builtin or `raw_args` should be set to True, and the `value` or `salt` passed to the builtin must be some complex expression that results in writing to the memory.

  As of time of publication, no patched version exists. The issue is still being investigated, and there might be other cases where the corruption might happen. When the builtin is being called from an `internal` function `F`, the issue is not present provided that the function calling `F` wrote to memory before calling `F`. As a workaround, the complex expressions that are being passed as kwargs to the builtin should be cached in memory prior to the call to the builtin.
severities:
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51582'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51745'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51306'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51676'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51655'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.52012'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51954'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51929'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51783'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51756'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51738'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.54895'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.54605'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.54588'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.54567'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45227'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45235'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45293'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45351'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45379'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45376'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45275'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45271'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45281'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45295'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.453'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45312'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00225'
    scoring_system: epss
    scoring_elements: '0.45268'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56549'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56525'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56565'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56537'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56547'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56561'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56573'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56456'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.564'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56496'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56501'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56522'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.5654'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56523'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.56508'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: '0.00985'
    scoring_system: epss
    scoring_elements: '0.62913'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-c647-pxm2-c52w
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2023-306.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2023-306.yaml
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/vyperlang/vyper
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vyperlang/vyper
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vyperlang/vyper/commit/79303fc4fcba06994ee5c6a7baef57bdb185006c
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper/commit/79303fc4fcba06994ee5c6a7baef57bdb185006c
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vyperlang/vyper/issues/3609
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper/issues/3609
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vyperlang/vyper/pull/3610
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper/pull/3610
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vyperlang/vyper/security/advisories/GHSA-c647-pxm2-c52w
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper/security/advisories/GHSA-c647-pxm2-c52w
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper/security/advisories/GHSA-c647-pxm2-c52w
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-42443
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-42443
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-42443
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-787
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-42443
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2023-306.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/commit/79303fc4fcba06994ee5c6a7baef57bdb185006c
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/issues/3609
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/pull/3610
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-c647-pxm2-c52w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*
    reference_type:
    reference_id: cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-42443
    reference_type:
    reference_id: CVE-2023-42443
  - url: https://github.com/advisories/GHSA-c647-pxm2-c52w
    reference_type:
    reference_id: GHSA-c647-pxm2-c52w
