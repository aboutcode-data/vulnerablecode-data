vulnerability_id: VCID-p11u-m65c-aaag
aliases:
  - CVE-2022-31166
  - GHSA-g4h6-qp44-wqvx
summary: XWiki Platform Old Core is a core package for XWiki Platform, a generic wiki platform.
  Starting in versions 11.3.7, 11.0.3, and 12.0RC1, it is possible to exploit a bug in XWikiRights
  resolution of groups to obtain privilege escalation. More specifically, editing a right with
  the object editor leads to adding a supplementary empty value to groups which is then resolved
  as a reference to XWiki.WebHome page. Adding an XWikiGroup xobject to that page then transforms
  it to a group, any user put in that group would then obtain the privileges related to the
  edited right. Note that this security issue is normally mitigated by the fact that XWiki.WebHome
  (and XWiki space in general) should be protected by default for edit rights. The problem has
  been patched in XWiki 13.10.4 and 14.2RC1 to not consider anymore empty values in XWikiRights.
  It's possible to work around the problem by setting appropriate rights on XWiki.WebHome page
  to prevent users to edit it.
severities:
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.71069'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.71321'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.71318'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.71271'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.71259'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.71221'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.71325'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.71316'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00351'
    scoring_system: epss
    scoring_elements: '0.40674'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00384'
    scoring_system: epss
    scoring_elements: '0.73936'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00384'
    scoring_system: epss
    scoring_elements: '0.73914'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00384'
    scoring_system: epss
    scoring_elements: '0.73897'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.00384'
    scoring_system: epss
    scoring_elements: '0.73833'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.703'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69323'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69344'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69324'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.6933'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69333'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.6934'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69349'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69339'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69328'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.6931'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70244'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70269'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70323'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70326'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70302'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70298'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70307'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70303'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70308'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70318'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70319'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.70316'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69216'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69211'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69297'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.0068'
    scoring_system: epss
    scoring_elements: '0.69304'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.01267'
    scoring_system: epss
    scoring_elements: '0.85393'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.01267'
    scoring_system: epss
    scoring_elements: '0.85489'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.01267'
    scoring_system: epss
    scoring_elements: '0.85389'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: '0.01267'
    scoring_system: epss
    scoring_elements: '0.85378'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-g4h6-qp44-wqvx
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/pull/1800
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/pull/1800
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:42:19Z/
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/pull/1800
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g4h6-qp44-wqvx
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g4h6-qp44-wqvx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g4h6-qp44-wqvx
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:42:19Z/
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g4h6-qp44-wqvx
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-15776
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-15776
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:42:19Z/
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-15776
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-18386
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-18386
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:42:19Z/
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-18386
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31166
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31166
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-269
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-31166
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/pull/1800
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-g4h6-qp44-wqvx
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-15776
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-18386
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31166
    reference_type:
    reference_id: CVE-2022-31166
  - url: https://github.com/advisories/GHSA-g4h6-qp44-wqvx
    reference_type:
    reference_id: GHSA-g4h6-qp44-wqvx
