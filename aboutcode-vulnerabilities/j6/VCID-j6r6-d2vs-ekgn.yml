vulnerability_id: VCID-j6r6-d2vs-ekgn
aliases:
  - CVE-2024-29198
  - GHSA-5gw5-jccf-6hxw
summary: |
  GeoServer Vulnerable to Unauthenticated SSRF via TestWfsPost
  ### Summary

  It possible to achieve Service Side Request Forgery (SSRF) via the Demo request endpoint if Proxy Base URL has not been set.

  ### Details

  A unauthenticated user can supply a request that will be issued by the server. This can be used to enumerate internal networks and also in the case of cloud instances can be used to obtain sensitive data.

  ### Mitigation

  1. When using GeoServer with a proxy, manage the proxy base value as a system administrator, use the application property ``PROXY_BASE_URL`` to provide a non-empty value that cannot be overridden by the user interface or incoming request.

  2. When using GeoServer directly without a proxy, block all access to TestWfsPost by editing the web.xml file. Adding this block right before the end:

     ```xml
        <security-constraint>
             <web-resource-collection>
                 <web-resource-name>BlockDemoRequests</web-resource-name>
                 <url-pattern>/TestWfsPost/*</url-pattern>
             </web-resource-collection>
             <auth-constraint>
                 <role-name>BLOCKED</role-name>
             </auth-constraint>
         </security-constraint>
     ```

  ### Resolution

  Upgrading to GeoServer 2.24.4, or 2.25.2, removes the ``TestWfsPost`` servlet resolving this issue.

  The demo request page functionality is now implemented directly in the browser.

  ### Reference

  - https://osgeo-org.atlassian.net/browse/GEOS-11794
  - https://osgeo-org.atlassian.net/browse/GEOS-11390
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40822
severities:
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06941'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06825'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1092'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1102'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10963'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11105'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11129'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10999'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10965'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11008'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12355'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12351'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12392'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12429'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.88801'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.88797'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.8877'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.8879'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.88785'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.88784'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.88782'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.8878'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.88768'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.888'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04667'
    scoring_system: epss
    scoring_elements: '0.88807'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89289'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89293'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89291'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89301'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89302'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.893'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89299'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89298'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89284'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89274'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89277'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89294'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89287'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89237'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89235'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.04998'
    scoring_system: epss
    scoring_elements: '0.89157'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.05147'
    scoring_system: epss
    scoring_elements: '0.8954'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.05147'
    scoring_system: epss
    scoring_elements: '0.89545'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.05678'
    scoring_system: epss
    scoring_elements: '0.89948'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.05678'
    scoring_system: epss
    scoring_elements: '0.90007'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.08781'
    scoring_system: epss
    scoring_elements: '0.92142'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.08781'
    scoring_system: epss
    scoring_elements: '0.92138'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.08781'
    scoring_system: epss
    scoring_elements: '0.92141'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.09464'
    scoring_system: epss
    scoring_elements: '0.92436'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.09464'
    scoring_system: epss
    scoring_elements: '0.92441'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.12325'
    scoring_system: epss
    scoring_elements: '0.93595'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.12325'
    scoring_system: epss
    scoring_elements: '0.93597'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.12325'
    scoring_system: epss
    scoring_elements: '0.93555'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.12325'
    scoring_system: epss
    scoring_elements: '0.93589'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: '0.12325'
    scoring_system: epss
    scoring_elements: '0.93585'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5gw5-jccf-6hxw
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/geoserver/geoserver
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/geoserver/geoserver
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-5gw5-jccf-6hxw
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-5gw5-jccf-6hxw
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-5gw5-jccf-6hxw
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-10T14:34:24Z/
    published_at: None
    url: https://github.com/geoserver/geoserver/security/advisories/GHSA-5gw5-jccf-6hxw
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40822
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40822
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-29198
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-29198
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOS-11390
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOS-11390
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-10T14:34:24Z/
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOS-11390
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOS-11794
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOS-11794
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-10T14:34:24Z/
    published_at: None
    url: https://osgeo-org.atlassian.net/browse/GEOS-11794
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-918
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-29198
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver
    reference_type:
    reference_id:
  - url: https://github.com/geoserver/geoserver/security/advisories/GHSA-5gw5-jccf-6hxw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-29198
    reference_type:
    reference_id:
  - url: https://osgeo-org.atlassian.net/browse/GEOS-11390
    reference_type:
    reference_id:
  - url: https://osgeo-org.atlassian.net/browse/GEOS-11794
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-40822
    reference_type:
    reference_id: CVE-2021-40822
  - url: https://github.com/advisories/GHSA-5gw5-jccf-6hxw
    reference_type:
    reference_id: GHSA-5gw5-jccf-6hxw
