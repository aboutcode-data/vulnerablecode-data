vulnerability_id: VCID-q3a9-zr9k-qybs
aliases:
  - CVE-2025-38000
summary: 'In the Linux kernel, the following vulnerability has been resolved:  sch_hfsc: Fix
  qlen accounting bug when using peek in hfsc_enqueue()  When enqueuing the first packet to
  an HFSC class, hfsc_enqueue() calls the child qdisc''s peek() operation before incrementing
  sch->q.qlen and sch->qstats.backlog. If the child qdisc uses qdisc_peek_dequeued(), this may
  trigger an immediate dequeue and potential packet drop. In such cases, qdisc_tree_reduce_backlog()
  is called, but the HFSC qdisc''s qlen and backlog have not yet been updated, leading to inconsistent
  queue accounting. This can leave an empty HFSC class in the active list, causing further consequences
  like use-after-free.  This patch fixes the bug by moving the increment of sch->q.qlen and
  sch->qstats.backlog before the call to the child qdisc''s peek() operation. This ensures that
  queue length and backlog are always accurate when packet drops or dequeues are triggered during
  the peek.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38000.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38000.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05121'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0514'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04968'
    published_at: '2025-06-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0497'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07583'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07599'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07535'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07512'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0758'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07473'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07549'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07652'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0858'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08446'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08438'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08384'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08369'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08228'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08551'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08498'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08415'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08421'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09391'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09394'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09367'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12671'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13393'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16566'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16212'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16261'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16268'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16341'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16322'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16369'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16429'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16367'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16452'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16466'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16497'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16471'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16468'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16583'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16525'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16603'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16579'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16598'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21489'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21398'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21462'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21458'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21437'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21414'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21368'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21319'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21413'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.214'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21404'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21391'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21387'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21384'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21457'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21487'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: 7
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38000.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38000
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38000
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1034e3310752e8675e313f7271b348914008719a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3f3a22eebbc32b4fa8ce9c1d5f9db214b45b9335
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3f981138109f63232a5fb7165938d4c945cc1b9d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/49b21795b8e5654a7df3d910a12e1060da4c04cf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/89c301e929a0db14ebd94b4d97764ce1d6981653
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/93c276942e75de0e5bc91576300d292e968f5a02
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f1dde3eb17dc1b8bd07aed00004b1e05fc87a3d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f9f593e34d2fb67644372c8f7b033bdc622ad228
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2370786
    reference_type:
    reference_id: 2370786
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38000
    reference_type:
    reference_id: CVE-2025-38000
  - url: https://access.redhat.com/errata/RHSA-2025:12209
    reference_type:
    reference_id: RHSA-2025:12209
  - url: https://access.redhat.com/errata/RHSA-2025:14413
    reference_type:
    reference_id: RHSA-2025:14413
  - url: https://access.redhat.com/errata/RHSA-2025:14511
    reference_type:
    reference_id: RHSA-2025:14511
  - url: https://access.redhat.com/errata/RHSA-2025:14692
    reference_type:
    reference_id: RHSA-2025:14692
  - url: https://access.redhat.com/errata/RHSA-2025:14742
    reference_type:
    reference_id: RHSA-2025:14742
  - url: https://access.redhat.com/errata/RHSA-2025:14744
    reference_type:
    reference_id: RHSA-2025:14744
  - url: https://access.redhat.com/errata/RHSA-2025:14746
    reference_type:
    reference_id: RHSA-2025:14746
  - url: https://access.redhat.com/errata/RHSA-2025:14748
    reference_type:
    reference_id: RHSA-2025:14748
  - url: https://access.redhat.com/errata/RHSA-2025:15035
    reference_type:
    reference_id: RHSA-2025:15035
  - url: https://access.redhat.com/errata/RHSA-2025:16538
    reference_type:
    reference_id: RHSA-2025:16538
  - url: https://access.redhat.com/errata/RHSA-2025:16539
    reference_type:
    reference_id: RHSA-2025:16539
  - url: https://access.redhat.com/errata/RHSA-2025:16540
    reference_type:
    reference_id: RHSA-2025:16540
  - url: https://access.redhat.com/errata/RHSA-2025:16541
    reference_type:
    reference_id: RHSA-2025:16541
  - url: https://access.redhat.com/errata/RHSA-2025:16580
    reference_type:
    reference_id: RHSA-2025:16580
  - url: https://access.redhat.com/errata/RHSA-2025:16582
    reference_type:
    reference_id: RHSA-2025:16582
  - url: https://access.redhat.com/errata/RHSA-2025:16583
    reference_type:
    reference_id: RHSA-2025:16583
  - url: https://usn.ubuntu.com/7608-1/
    reference_type:
    reference_id: USN-7608-1
  - url: https://usn.ubuntu.com/7608-2/
    reference_type:
    reference_id: USN-7608-2
  - url: https://usn.ubuntu.com/7608-3/
    reference_type:
    reference_id: USN-7608-3
  - url: https://usn.ubuntu.com/7608-4/
    reference_type:
    reference_id: USN-7608-4
  - url: https://usn.ubuntu.com/7608-5/
    reference_type:
    reference_id: USN-7608-5
  - url: https://usn.ubuntu.com/7608-6/
    reference_type:
    reference_id: USN-7608-6
  - url: https://usn.ubuntu.com/7608-7/
    reference_type:
    reference_id: USN-7608-7
  - url: https://usn.ubuntu.com/7609-1/
    reference_type:
    reference_id: USN-7609-1
  - url: https://usn.ubuntu.com/7609-2/
    reference_type:
    reference_id: USN-7609-2
  - url: https://usn.ubuntu.com/7609-3/
    reference_type:
    reference_id: USN-7609-3
  - url: https://usn.ubuntu.com/7609-4/
    reference_type:
    reference_id: USN-7609-4
  - url: https://usn.ubuntu.com/7609-5/
    reference_type:
    reference_id: USN-7609-5
  - url: https://usn.ubuntu.com/7610-1/
    reference_type:
    reference_id: USN-7610-1
  - url: https://usn.ubuntu.com/7610-2/
    reference_type:
    reference_id: USN-7610-2
  - url: https://usn.ubuntu.com/7610-3/
    reference_type:
    reference_id: USN-7610-3
  - url: https://usn.ubuntu.com/7611-1/
    reference_type:
    reference_id: USN-7611-1
  - url: https://usn.ubuntu.com/7611-2/
    reference_type:
    reference_id: USN-7611-2
  - url: https://usn.ubuntu.com/7611-3/
    reference_type:
    reference_id: USN-7611-3
  - url: https://usn.ubuntu.com/7611-4/
    reference_type:
    reference_id: USN-7611-4
  - url: https://usn.ubuntu.com/7618-1/
    reference_type:
    reference_id: USN-7618-1
  - url: https://usn.ubuntu.com/7627-1/
    reference_type:
    reference_id: USN-7627-1
  - url: https://usn.ubuntu.com/7627-2/
    reference_type:
    reference_id: USN-7627-2
  - url: https://usn.ubuntu.com/7628-1/
    reference_type:
    reference_id: USN-7628-1
  - url: https://usn.ubuntu.com/7653-1/
    reference_type:
    reference_id: USN-7653-1
  - url: https://usn.ubuntu.com/7655-1/
    reference_type:
    reference_id: USN-7655-1
  - url: https://usn.ubuntu.com/7665-2/
    reference_type:
    reference_id: USN-7665-2
  - url: https://usn.ubuntu.com/7671-1/
    reference_type:
    reference_id: USN-7671-1
  - url: https://usn.ubuntu.com/7671-2/
    reference_type:
    reference_id: USN-7671-2
  - url: https://usn.ubuntu.com/7671-3/
    reference_type:
    reference_id: USN-7671-3
  - url: https://usn.ubuntu.com/7686-1/
    reference_type:
    reference_id: USN-7686-1
  - url: https://usn.ubuntu.com/7712-1/
    reference_type:
    reference_id: USN-7712-1
  - url: https://usn.ubuntu.com/7712-2/
    reference_type:
    reference_id: USN-7712-2
