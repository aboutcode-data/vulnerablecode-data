vulnerability_id: VCID-q32n-86f1-tyhm
aliases:
  - CVE-2022-49740
summary: 'In the Linux kernel, the following vulnerability has been resolved:  wifi: brcmfmac:
  Check the count value of channel spec to prevent out-of-bounds reads  This patch fixes slab-out-of-bounds
  reads in brcmfmac that occur in brcmf_construct_chaninfo() and brcmf_enable_bw40_2g() when
  the count value of channel specifications provided by the device is greater than the length
  of ''list->element[]'', decided by the size of the ''list'' allocated with kzalloc(). The
  patch adds checks that make the functions free the buffer and return -EINVAL if that is the
  case. Note that the negative return is handled by the caller, brcmf_setup_wiphybands() or
  brcmf_cfg80211_attach().  Found by a modified version of syzkaller.  Crash Report from brcmf_construct_chaninfo():
  ================================================================== BUG: KASAN: slab-out-of-bounds
  in brcmf_setup_wiphybands+0x1238/0x1430 Read of size 4 at addr ffff888115f24600 by task kworker/0:2/1896  CPU:
  0 PID: 1896 Comm: kworker/0:2 Tainted: G        W  O      5.14.0+ #132 Hardware name: QEMU
  Standard PC (i440FX + PIIX, 1996), BIOS rel-1.12.1-0-ga5cab58e9a3f-prebuilt.qemu.org 04/01/2014
  Workqueue: usb_hub_wq hub_event Call Trace:  dump_stack_lvl+0x57/0x7d  print_address_description.constprop.0.cold+0x93/0x334  kasan_report.cold+0x83/0xdf  brcmf_setup_wiphybands+0x1238/0x1430  brcmf_cfg80211_attach+0x2118/0x3fd0  brcmf_attach+0x389/0xd40  brcmf_usb_probe+0x12de/0x1690  usb_probe_interface+0x25f/0x710  really_probe+0x1be/0xa90  __driver_probe_device+0x2ab/0x460  driver_probe_device+0x49/0x120  __device_attach_driver+0x18a/0x250  bus_for_each_drv+0x123/0x1a0  __device_attach+0x207/0x330  bus_probe_device+0x1a2/0x260  device_add+0xa61/0x1ce0  usb_set_configuration+0x984/0x1770  usb_generic_driver_probe+0x69/0x90  usb_probe_device+0x9c/0x220  really_probe+0x1be/0xa90  __driver_probe_device+0x2ab/0x460  driver_probe_device+0x49/0x120  __device_attach_driver+0x18a/0x250  bus_for_each_drv+0x123/0x1a0  __device_attach+0x207/0x330  bus_probe_device+0x1a2/0x260  device_add+0xa61/0x1ce0  usb_new_device.cold+0x463/0xf66  hub_event+0x10d5/0x3330  process_one_work+0x873/0x13e0  worker_thread+0x8b/0xd10  kthread+0x379/0x450  ret_from_fork+0x1f/0x30  Allocated
  by task 1896:  kasan_save_stack+0x1b/0x40  __kasan_kmalloc+0x7c/0x90  kmem_cache_alloc_trace+0x19e/0x330  brcmf_setup_wiphybands+0x290/0x1430  brcmf_cfg80211_attach+0x2118/0x3fd0  brcmf_attach+0x389/0xd40  brcmf_usb_probe+0x12de/0x1690  usb_probe_interface+0x25f/0x710  really_probe+0x1be/0xa90  __driver_probe_device+0x2ab/0x460  driver_probe_device+0x49/0x120  __device_attach_driver+0x18a/0x250  bus_for_each_drv+0x123/0x1a0  __device_attach+0x207/0x330  bus_probe_device+0x1a2/0x260  device_add+0xa61/0x1ce0  usb_set_configuration+0x984/0x1770  usb_generic_driver_probe+0x69/0x90  usb_probe_device+0x9c/0x220  really_probe+0x1be/0xa90  __driver_probe_device+0x2ab/0x460  driver_probe_device+0x49/0x120  __device_attach_driver+0x18a/0x250  bus_for_each_drv+0x123/0x1a0  __device_attach+0x207/0x330  bus_probe_device+0x1a2/0x260  device_add+0xa61/0x1ce0  usb_new_device.cold+0x463/0xf66  hub_event+0x10d5/0x3330  process_one_work+0x873/0x13e0  worker_thread+0x8b/0xd10  kthread+0x379/0x450  ret_from_fork+0x1f/0x30  The
  buggy address belongs to the object at ffff888115f24000  which belongs to the cache kmalloc-2k
  of size 2048 The buggy address is located 1536 bytes inside of  2048-byte region [ffff888115f24000,
  ffff888115f24800)  Memory state around the buggy address:  ffff888115f24500: 00 00 00 00 00
  00 00 00 00 00 00 00 00 00 00 00  ffff888115f24580: 00 00 00 00 00 00 00 00 00 00 00 00 00
  00 00 00 >ffff888115f24600: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc                    ^  ffff888115f24680:
  fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc  ffff888115f24700: fc fc fc fc fc fc fc fc
  fc fc fc fc fc fc fc fc ==================================================================  Crash
  Report from brcmf_enable_bw40_2g(): ========== ---truncated---'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49740.json
  - score: '6.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49740.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01076'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01089'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01085'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01082'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01086'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01074'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01071'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01063'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01065'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0108'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01075'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01458'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02289'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02211'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.02095'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03557'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03491'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03482'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0348'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03484'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03493'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03494'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03495'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0351'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03543'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03552'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03547'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03537'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49740
weaknesses:
  - CWE-125
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49740.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-49740
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-49740
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4920ab131b2dbae7464b72bdcac465d070254209
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9cf5e99c1ae1a85286a76c9a970202750538394c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b2e412879595821ff1b5545cbed5f108fba7f5b6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e4991910f15013db72f6ec0db7038ea67a57052e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f06de1bb6d61f0c18b0213bbc6298960037f9d42
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355532
    reference_type:
    reference_id: 2355532
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49740
    reference_type:
    reference_id: CVE-2022-49740
