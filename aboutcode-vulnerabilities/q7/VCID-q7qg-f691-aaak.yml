vulnerability_id: VCID-q7qg-f691-aaak
aliases:
  - CVE-2023-39347
  - GHSA-gj2r-phwg-6rww
summary: 'Cilium is a networking, observability, and security solution with an eBPF-based dataplane.
  An attacker with the ability to update pod labels can cause Cilium to apply incorrect network
  policies. This issue arises due to the fact that on pod update, Cilium incorrectly uses user-provided
  pod labels to select the policies which apply to the workload in question. This can affect
  Cilium network policies that use the namespace, service account or cluster constructs to restrict
  traffic, Cilium clusterwide network policies that use Cilium namespace labels to select the
  Pod and Kubernetes network policies. Non-existent construct names can be provided, which bypass
  all network policies applicable to the construct. For example, providing a pod with a non-existent
  namespace as the value of the `io.kubernetes.pod.namespace` label results in none of the namespaced
  CiliumNetworkPolicies applying to the pod in question. This attack requires the attacker to
  have Kubernetes API Server access, as described in the Cilium Threat Model. This issue has
  been resolved in: Cilium versions 1.14.2, 1.13.7, and 1.12.14. Users are advised to upgrade.
  As a workaround an admission webhook can be used to prevent pod label updates to the `k8s:io.kubernetes.pod.namespace`
  and `io.cilium.k8s.policy.*` keys.'
severities:
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07668'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0774'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07632'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07671'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07769'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07828'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07814'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07687'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07602'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07703'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07665'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0767'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07658'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07663'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14942'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14783'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14736'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14896'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14906'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14927'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14965'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14946'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14934'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14963'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.15005'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.1501'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14983'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14959'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14909'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.13202'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:L
    published_at: None
    url: https://docs.cilium.io/en/latest/security/threat-model/#kubernetes-api-server-attacker
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.cilium.io/en/latest/security/threat-model/#kubernetes-api-server-attacker
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/cilium/cilium
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cilium/cilium
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:L
    published_at: None
    url: https://github.com/cilium/cilium/security/advisories/GHSA-gj2r-phwg-6rww
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cilium/cilium/security/advisories/GHSA-gj2r-phwg-6rww
  - score: '9.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-39347
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-39347
weaknesses:
  - CWE-345
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-39347
    reference_type:
    reference_id:
  - url: https://docs.cilium.io/en/latest/security/threat-model/#kubernetes-api-server-attacker
    reference_type:
    reference_id:
  - url: https://github.com/cilium/cilium
    reference_type:
    reference_id:
  - url: https://github.com/cilium/cilium/security/advisories/GHSA-gj2r-phwg-6rww
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:cilium:cilium:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:cilium:cilium:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-39347
    reference_type:
    reference_id: CVE-2023-39347
