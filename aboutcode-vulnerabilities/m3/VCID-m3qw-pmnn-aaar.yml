vulnerability_id: VCID-m3qw-pmnn-aaar
aliases:
  - GHSA-4m3g-6r7g-jv4f
summary: |
  Arbitrary JavaScript execution due to using outdated libraries
  ### Summary
  gradio-pdf projects with dependencies on the pdf.js library are vulnerable to CVE-2024-4367, which allows arbitrary JavaScript execution.

  ### PoC
  1. Generate a pdf file with a malicious script in the fontmatrix. (This will run `alert(‘XSS’)`.)
  [poc.pdf](https://github.com/user-attachments/files/15516798/poc.pdf)

  2. Run the app. In this PoC, I've used the demo for a simple proof.
  ![1](https://github.com/freddyaboulton/gradio-pdf/assets/114328108/d1bb7626-3d0f-4984-8873-297658d6e77e)

  3. Upload a PDF file containing the script.
  ![2](https://github.com/freddyaboulton/gradio-pdf/assets/114328108/803d8080-c946-446e-bb34-cf5640e1b4de)

  4. Check that the script is running.
  ![3](https://github.com/freddyaboulton/gradio-pdf/assets/114328108/4956b95f-acca-4bb1-a3c2-7dfc96adf890)


  ### Impact
  Malicious scripts can be injected into the code, and when linked with vulnerabilities such as CSRF, it can cause even greater damage. In particular, It can become a source of further attacks, especially when linked to social engineering.

  ### Mitigation
  Upgrade the pdf.js to v4.2.67, which removes the vulnerability. (or set the option `isEvalSupported` to `false`.)

  ### Reference
  1. https://codeanlabs.com/blog/research/cve-2024-4367-arbitrary-js-execution-in-pdf-js/
  2. https://github.com/mozilla/pdf.js/pull/18015
severities:
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-4m3g-6r7g-jv4f
  - score: '3.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/freddyaboulton/gradio-pdf
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/freddyaboulton/gradio-pdf
  - score: '3.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/freddyaboulton/gradio-pdf/commit/67edd0c625fae7b855186727ee9678297602ee45
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/freddyaboulton/gradio-pdf/commit/67edd0c625fae7b855186727ee9678297602ee45
  - score: '3.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/freddyaboulton/gradio-pdf/security/advisories/GHSA-4m3g-6r7g-jv4f
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/freddyaboulton/gradio-pdf/security/advisories/GHSA-4m3g-6r7g-jv4f
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://github.com/freddyaboulton/gradio-pdf
    reference_type:
    reference_id:
  - url: https://github.com/freddyaboulton/gradio-pdf/commit/67edd0c625fae7b855186727ee9678297602ee45
    reference_type:
    reference_id:
  - url: https://github.com/freddyaboulton/gradio-pdf/security/advisories/GHSA-4m3g-6r7g-jv4f
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-4m3g-6r7g-jv4f
    reference_type:
    reference_id: GHSA-4m3g-6r7g-jv4f
