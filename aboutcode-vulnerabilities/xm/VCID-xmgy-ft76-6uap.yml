vulnerability_id: VCID-xmgy-ft76-6uap
aliases:
  - CVE-2022-49759
summary: 'In the Linux kernel, the following vulnerability has been resolved:  VMCI: Use threaded
  irqs instead of tasklets  The vmci_dispatch_dgs() tasklet function calls vmci_read_data()
  which uses wait_event() resulting in invalid sleep in an atomic context (and therefore potentially
  in a deadlock).  Use threaded irqs to fix this issue and completely remove usage of tasklets.  [   20.264639]
  BUG: sleeping function called from invalid context at drivers/misc/vmw_vmci/vmci_guest.c:145
  [   20.264643] in_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 762, name: vmtoolsd
  [   20.264645] preempt_count: 101, expected: 0 [   20.264646] RCU nest depth: 0, expected:
  0 [   20.264647] 1 lock held by vmtoolsd/762: [   20.264648]  #0: ffff0000874ae440 (sk_lock-AF_VSOCK){+.+.}-{0:0},
  at: vsock_connect+0x60/0x330 [vsock] [   20.264658] Preemption disabled at: [   20.264659]
  [<ffff80000151d7d8>] vmci_send_datagram+0x44/0xa0 [vmw_vmci] [   20.264665] CPU: 0 PID: 762
  Comm: vmtoolsd Not tainted 5.19.0-0.rc8.20220727git39c3c396f813.60.fc37.aarch64 #1 [   20.264667]
  Hardware name: VMware, Inc. VBSA/VBSA, BIOS VEFI 12/31/2020 [   20.264668] Call trace: [   20.264669]  dump_backtrace+0xc4/0x130
  [   20.264672]  show_stack+0x24/0x80 [   20.264673]  dump_stack_lvl+0x88/0xb4 [   20.264676]  dump_stack+0x18/0x34
  [   20.264677]  __might_resched+0x1a0/0x280 [   20.264679]  __might_sleep+0x58/0x90 [   20.264681]  vmci_read_data+0x74/0x120
  [vmw_vmci] [   20.264683]  vmci_dispatch_dgs+0x64/0x204 [vmw_vmci] [   20.264686]  tasklet_action_common.constprop.0+0x13c/0x150
  [   20.264688]  tasklet_action+0x40/0x50 [   20.264689]  __do_softirq+0x23c/0x6b4 [   20.264690]  __irq_exit_rcu+0x104/0x214
  [   20.264691]  irq_exit_rcu+0x1c/0x50 [   20.264693]  el1_interrupt+0x38/0x6c [   20.264695]  el1h_64_irq_handler+0x18/0x24
  [   20.264696]  el1h_64_irq+0x68/0x6c [   20.264697]  preempt_count_sub+0xa4/0xe0 [   20.264698]  _raw_spin_unlock_irqrestore+0x64/0xb0
  [   20.264701]  vmci_send_datagram+0x7c/0xa0 [vmw_vmci] [   20.264703]  vmci_datagram_dispatch+0x84/0x100
  [vmw_vmci] [   20.264706]  vmci_datagram_send+0x2c/0x40 [vmw_vmci] [   20.264709]  vmci_transport_send_control_pkt+0xb8/0x120
  [vmw_vsock_vmci_transport] [   20.264711]  vmci_transport_connect+0x40/0x7c [vmw_vsock_vmci_transport]
  [   20.264713]  vsock_connect+0x278/0x330 [vsock] [   20.264715]  __sys_connect_file+0x8c/0xc0
  [   20.264718]  __sys_connect+0x84/0xb4 [   20.264720]  __arm64_sys_connect+0x2c/0x3c [   20.264721]  invoke_syscall+0x78/0x100
  [   20.264723]  el0_svc_common.constprop.0+0x68/0x124 [   20.264724]  do_el0_svc+0x38/0x4c
  [   20.264725]  el0_svc+0x60/0x180 [   20.264726]  el0t_64_sync_handler+0x11c/0x150 [   20.264728]  el0t_64_sync+0x190/0x194'
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49759.json
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49759.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01025'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01022'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01019'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0101'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01007'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00999'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01001'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01012'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01017'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01018'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01375'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02395'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02328'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.01692'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03656'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03601'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03591'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03589'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03592'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03606'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0361'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03626'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03657'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03663'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03664'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03645'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04605'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49759
weaknesses:
  - CWE-667
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49759.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-49759
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3daed6345d5880464f46adab871d208e1baa2f3a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/548ea9dd5e01b0ecf53d2563004c80abd636743d
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355497
    reference_type:
    reference_id: 2355497
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49759
    reference_type:
    reference_id: CVE-2022-49759
  - url: https://access.redhat.com/errata/RHSA-2024:3138
    reference_type:
    reference_id: RHSA-2024:3138
