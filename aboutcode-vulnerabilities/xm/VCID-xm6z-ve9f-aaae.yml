vulnerability_id: VCID-xm6z-ve9f-aaae
aliases:
  - CVE-2021-20291
  - GHSA-7qw8-847f-pggm
summary: A deadlock vulnerability was found in 'github.com/containers/storage' in versions before
  1.28.1. When a container image is processed, each layer is unpacked using `tar`. If one of
  those layers is not a valid `tar` archive this causes an error leading to an unexpected situation
  where the code indefinitely waits for the tar unpacked stream, which never finishes. An attacker
  could use this vulnerability to craft a malicious image, which when downloaded and stored
  by an application using containers/storage, would then cause a deadlock leading to a Denial
  of Service (DoS).
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:1150
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:2438
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:4154
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-20291.json
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26705'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26721'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26733'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26737'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30935'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30954'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.31019'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.31011'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30966'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30902'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30837'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26693'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26714'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26752'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26747'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.2671'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30899'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26672'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30934'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26698'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26597'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26551'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.3094'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30951'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30932'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30926'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.26668'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30913'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.19623'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00433'
    scoring_system: epss
    scoring_elements: '0.74463'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00433'
    scoring_system: epss
    scoring_elements: '0.74290'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00433'
    scoring_system: epss
    scoring_elements: '0.74278'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00433'
    scoring_system: epss
    scoring_elements: '0.74260'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77686'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77364'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77504'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77539'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77549'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77591'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77590'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77594'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77607'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77614'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77670'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '0.00524'
    scoring_system: epss
    scoring_elements: '0.77705'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/containers/storage
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/containers/storage
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/containers/storage/commit/306fcabc964470e4b3b87a43a8f6b7d698209ee1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/containers/storage/commit/306fcabc964470e4b3b87a43a8f6b7d698209ee1
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/containers/storage/pull/860
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/containers/storage/pull/860
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/R5D7XL7FL24TWFMGQ3K2S72EOUSLZMKL
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/R5D7XL7FL24TWFMGQ3K2S72EOUSLZMKL
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SPYOHNG2Q7DCAQZMGYLMENLKALGDLG3X
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SPYOHNG2Q7DCAQZMGYLMENLKALGDLG3X
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WX24EITRXVHDM5M223BVTJA2ODF2FSHI
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WX24EITRXVHDM5M223BVTJA2ODF2FSHI
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZNMB7O2UIXE34PGSCSOULGHPX5LIJBMM
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZNMB7O2UIXE34PGSCSOULGHPX5LIJBMM
  - score: '7.1'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:N/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20291
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20291
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20291
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2021-0100
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2021-0100
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://unit42.paloaltonetworks.com/cve-2021-20291
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://unit42.paloaltonetworks.com/cve-2021-20291
weaknesses:
  - CWE-667
  - CWE-400
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-20291.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-20291
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20291
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/containers/storage
    reference_type:
    reference_id:
  - url: https://github.com/containers/storage/commit/306fcabc964470e4b3b87a43a8f6b7d698209ee1
    reference_type:
    reference_id:
  - url: https://github.com/containers/storage/pull/860
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/R5D7XL7FL24TWFMGQ3K2S72EOUSLZMKL/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/SPYOHNG2Q7DCAQZMGYLMENLKALGDLG3X/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WX24EITRXVHDM5M223BVTJA2ODF2FSHI/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZNMB7O2UIXE34PGSCSOULGHPX5LIJBMM/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/R5D7XL7FL24TWFMGQ3K2S72EOUSLZMKL
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/R5D7XL7FL24TWFMGQ3K2S72EOUSLZMKL/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SPYOHNG2Q7DCAQZMGYLMENLKALGDLG3X
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SPYOHNG2Q7DCAQZMGYLMENLKALGDLG3X/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WX24EITRXVHDM5M223BVTJA2ODF2FSHI
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WX24EITRXVHDM5M223BVTJA2ODF2FSHI/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZNMB7O2UIXE34PGSCSOULGHPX5LIJBMM
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZNMB7O2UIXE34PGSCSOULGHPX5LIJBMM/
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2021-0100
    reference_type:
    reference_id:
  - url: https://unit42.paloaltonetworks.com/cve-2021-20291
    reference_type:
    reference_id:
  - url: https://unit42.paloaltonetworks.com/cve-2021-20291/
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=988942
    reference_type:
    reference_id: 988942
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:redhat:openshift_container_platform:4.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:redhat:openshift_container_platform:4.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:storage_project:storage:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:storage_project:storage:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-20291
    reference_type:
    reference_id: CVE-2021-20291
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1939485
    reference_type:
    reference_id: RHBA-2022:0348
  - url: https://access.redhat.com/errata/RHSA-2021:1150
    reference_type:
    reference_id: RHSA-2021:1150
  - url: https://access.redhat.com/errata/RHSA-2021:2438
    reference_type:
    reference_id: RHSA-2021:2438
  - url: https://access.redhat.com/errata/RHSA-2021:4154
    reference_type:
    reference_id: RHSA-2021:4154
  - url: https://access.redhat.com/errata/RHSA-2022:7954
    reference_type:
    reference_id: RHSA-2022:7954
  - url: https://access.redhat.com/errata/RHSA-2022:7955
    reference_type:
    reference_id: RHSA-2022:7955
  - url: https://access.redhat.com/errata/RHSA-2022:8008
    reference_type:
    reference_id: RHSA-2022:8008
