vulnerability_id: VCID-5d53-m8dg-aaas
aliases:
  - CVE-2023-52843
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  llc: verify mac len before reading mac header

  LLC reads the mac header with eth_hdr without verifying that the skb
  has an Ethernet header.

  Syzbot was able to enter llc_rcv on a tun device. Tun can insert
  packets without mac len and with user configurable skb->protocol
  (passing a tun_pi header when not configuring IFF_NO_PI).

      BUG: KMSAN: uninit-value in llc_station_ac_send_test_r net/llc/llc_station.c:81 [inline]
      BUG: KMSAN: uninit-value in llc_station_rcv+0x6fb/0x1290 net/llc/llc_station.c:111
      llc_station_ac_send_test_r net/llc/llc_station.c:81 [inline]
      llc_station_rcv+0x6fb/0x1290 net/llc/llc_station.c:111
      llc_rcv+0xc5d/0x14a0 net/llc/llc_input.c:218
      __netif_receive_skb_one_core net/core/dev.c:5523 [inline]
      __netif_receive_skb+0x1a6/0x5a0 net/core/dev.c:5637
      netif_receive_skb_internal net/core/dev.c:5723 [inline]
      netif_receive_skb+0x58/0x660 net/core/dev.c:5782
      tun_rx_batched+0x3ee/0x980 drivers/net/tun.c:1555
      tun_get_user+0x54c5/0x69c0 drivers/net/tun.c:2002

  Add a mac_len test before all three eth_hdr(skb) calls under net/llc.

  There are further uses in include/net/llc_pdu.h. All these are
  protected by a test skb->protocol == ETH_P_802_2. Which does not
  protect against this tun scenario.

  But the mac_len test added in this patch in llc_fixup_skb will
  indirectly protect those too. That is called from llc_rcv before any
  other LLC code.

  It is tempting to just add a blanket mac_len check in llc_rcv, but
  not sure whether that could break valid LLC paths that do not assume
  an Ethernet header. 802.2 LLC may be used on top of non-802.3
  protocols in principle. The below referenced commit shows that used
  to, on top of Token Ring.

  At least one of the three eth_hdr uses goes back to before the start
  of git history. But the one that syzbot exercises is introduced in
  this commit. That commit is old enough (2008), that effectively all
  stable kernels should receive this.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52843.json
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14083'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14371'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14461'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14482'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14548'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14541'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14556'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14611'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14691'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14976'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15033'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15128'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14714'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14726'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15080'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14767'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39505'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39495'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39572'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39631'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39672'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39673'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39567'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39577'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39571'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39565'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39579'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39564'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.39538'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47939'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47926'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47917'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47947'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47802'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.4778'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47911'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.4791'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47925'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47934'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47904'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47873'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47895'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '0.00843'
    scoring_system: epss
    scoring_elements: '0.60118'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-20
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52843.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52843
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52843
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0a720d0259ad3521ec6c9e4199f9f6fc75bac77a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/352887b3edd007cf9b0abc30fe9d98622acd859b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3a2653828ffc6101aef80bf58d5b77484239f779
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b3ba18703a63f6fd487183b9262b08e5632da1b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/900a4418e3f66a32db6baaf23f92b99c20ae6535
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9a3f9054a5227d7567cba1fb821df48ccecad10c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cbdcdf42d15dac74c7287679fb2a9d955f8feb1f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f980e9a57dfb9530f1f4ee41a2420f2a256d7b29
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff5cb6a4f0c6d7fbdc84858323fb4b7af32cfd79
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2282662
    reference_type:
    reference_id: 2282662
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52843
    reference_type:
    reference_id: CVE-2023-52843
