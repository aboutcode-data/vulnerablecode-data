vulnerability_id: VCID-5d3z-a795-aaas
aliases:
  - CVE-2024-40633
  - GHSA-55rf-8q29-4g43
summary: "Sylius has a security vulnerability via adjustments API endpoint\n### Impact\nA security\
  \ vulnerability was discovered in the `/api/v2/shop/adjustments/{id}` endpoint, which retrieves\
  \ order adjustments based on incremental integer IDs. The vulnerability allows an attacker\
  \ to enumerate valid adjustment IDs and retrieve order tokens. Using these tokens, an attacker\
  \ can access guest customer order details - sensitive guest customer information. \n\n###\
  \ Patches\nThe issue is fixed in versions: 1.12.19, 1.13.4 and above. The `/api/v2/shop/adjustments/{id}`\
  \ will always return `404` status.\n\n### Workarounds\n\nUsing YAML configuration:\n\nCreate\
  \ `config/api_platform/Adjustment.yaml` file:\n\n```yaml\n# config/api_platform/Adjustment.yaml\n\
  \n'%sylius.model.adjustment.class%':\n    itemOperations:\n        shop_get:\n           \
  \ controller: ApiPlatform\\Core\\Action\\NotFoundAction\n            read: false\n       \
  \     output: false\n```\n\nOr using XML configuration:\n\nCopy the original configuration\
  \ from vendor:\n\n```bash\ncp vendor/sylius/sylius/src/Sylius/Bundle/ApiBundle/Resources/config/api_resources/Adjustment.xml\
  \ config/api_platform\n```\n\nAnd change the `shop_get` operation in copied `config/api_platform/Adjustment.xml`\
  \ file:\n\n```xml\n<!-- config/api_platform/Adjustment.xml -->\n\n...\n<itemOperation name=\"\
  shop_get\">\n    <attribute name=\"method\">GET</attribute>\n    <attribute name=\"path\"\
  >/shop/adjustments/{id}</attribute>\n    <attribute name=\"controller\">ApiPlatform\\Core\\\
  Action\\NotFoundAction</attribute>\n    <attribute name=\"read\">false</attribute>\n    <attribute\
  \ name=\"output\">false</attribute>\n</itemOperation>\n...\n```\n\n### For more information\n\
  If you have any questions or comments about this advisory:\n\n- Open an issue in [Sylius issues](https://github.com/Sylius/Sylius/issues)\n\
  - Email us at [security@sylius.com](mailto:security@sylius.com)"
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25247'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25293'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30897'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30835'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.309'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30964'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.31009'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.31017'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30952'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30934'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30933'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30924'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30931'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30949'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30938'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30911'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.18863'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29046'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29052'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29086'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29118'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29121'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29079'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29074'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29087'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29085'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.29119'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.3116'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.31118'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.31144'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-55rf-8q29-4g43
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/Sylius/Sylius
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Sylius/Sylius
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/Sylius/Sylius/commit/d833b2871caa3b8d1f0a8207378bb778f0b90464
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Sylius/Sylius/commit/d833b2871caa3b8d1f0a8207378bb778f0b90464
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/Sylius/Sylius/security/advisories/GHSA-55rf-8q29-4g43
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Sylius/Sylius/security/advisories/GHSA-55rf-8q29-4g43
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40633
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40633
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-200
  - CWE-639
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-40633
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/Sylius
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/Sylius/commit/d833b2871caa3b8d1f0a8207378bb778f0b90464
    reference_type:
    reference_id:
  - url: https://github.com/Sylius/Sylius/security/advisories/GHSA-55rf-8q29-4g43
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-40633
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-55rf-8q29-4g43
    reference_type:
    reference_id: GHSA-55rf-8q29-4g43
