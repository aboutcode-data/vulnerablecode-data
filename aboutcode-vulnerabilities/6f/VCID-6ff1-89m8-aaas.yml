vulnerability_id: VCID-6ff1-89m8-aaas
aliases:
  - CVE-2021-31876
summary: Bitcoin Core 0.12.0 through 0.21.1 does not properly implement the replacement policy
  specified in BIP125, which makes it easier for attackers to trigger a loss of funds, or a
  denial of service attack against downstream projects such as Lightning network nodes. An unconfirmed
  child transaction with nSequence = 0xff_ff_ff_ff, spending an unconfirmed parent with nSequence
  <= 0xff_ff_ff_fd, should be replaceable because there is inherited signaling by the child
  transaction. However, the actual PreChecks implementation does not enforce this. Instead,
  mempool rejects the replacement attempt of the unconfirmed child transaction.
severities:
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54425'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54449'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54496'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.53815'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54093'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54147'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54165'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54234'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54230'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54240'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54256'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54284'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00298'
    scoring_system: epss
    scoring_elements: '0.69003'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00298'
    scoring_system: epss
    scoring_elements: '0.69226'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00298'
    scoring_system: epss
    scoring_elements: '0.69008'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00298'
    scoring_system: epss
    scoring_elements: '0.68985'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00417'
    scoring_system: epss
    scoring_elements: '0.44804'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.63995'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.63993'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.64'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.64009'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.64011'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62511'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62486'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.6258'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62583'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62607'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62624'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62602'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62596'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62598'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62575'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62591'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.6261'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62609'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62601'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.62586'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.63916'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.63951'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.63989'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.64013'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.64017'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.63983'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '0.00484'
    scoring_system: epss
    scoring_elements: '0.63982'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
  - score: '6.4'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-31876
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-31876
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-31876
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-1486
weaknesses:
  - CWE-863
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-31876
    reference_type:
    reference_id:
  - url: https://bitcoinops.org/en/newsletters/2021/05/12/
    reference_type:
    reference_id:
  - url: https://bitcoinops.org/en/topics/replace-by-fee/
    reference_type:
    reference_id:
  - url: https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures#CVE-2021-31876
    reference_type:
    reference_id:
  - url: https://github.com/bitcoin/bitcoin
    reference_type:
    reference_id:
  - url: https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1014166
    reference_type:
    reference_id: 1014166
  - url: https://security.archlinux.org/AVG-1486
    reference_type:
    reference_id: AVG-1486
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:bitcoin:bitcoin:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:bitcoin:bitcoin:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-31876
    reference_type:
    reference_id: CVE-2021-31876
