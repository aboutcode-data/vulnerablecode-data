vulnerability_id: VCID-bamg-c3k7-aaap
aliases:
  - GHSA-4qhx-g9wp-g9m6
  - GMS-2019-58
summary: |
  Failure to sanitize quotes which can lead to sql injection in squel
  All versions of `squel` are vulnerable to sql injection.

  The `squel` package does not properly escape user provided input when provided using the `setFields` method. This could lead to sql injection if the query was then executed.

  Proof of concept demonstrating the injection of a single quote into a generated sql statement from user provided input.
  ```
  > console.log(squel.insert().into('buh').setFields({foo: "bar'baz"}).toString());
  INSERT INTO buh (foo) VALUES ('bar'baz')
  ``` ## Recommendation

  There is no fix at this time and the issue has been reported publicly. Consider using another query builder that provides strong guarantees for input sanitization to prevent sql injection attacks.
severities:
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-4qhx-g9wp-g9m6
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/hiddentao/squel
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/hiddentao/squel/issues/350
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.npmjs.com/advisories/575
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-89
  - CWE-74
references:
  - url: https://github.com/hiddentao/squel
    reference_type:
    reference_id:
  - url: https://github.com/hiddentao/squel/issues/350
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/575
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-4qhx-g9wp-g9m6
    reference_type:
    reference_id: GHSA-4qhx-g9wp-g9m6
