vulnerability_id: VCID-fqmc-mb8e-aaab
aliases:
  - CVE-2021-20328
  - GHSA-rghw-6px2-fgwc
summary: Specific versions of the Java driver that support client-side field level encryption
  (CSFLE) fail to perform correct host name verification on the KMS server’s certificate. This
  vulnerability in combination with a privileged network position active MITM attack could result
  in interception of traffic between the Java driver and the KMS service rendering Field Level
  Encryption ineffective. This issue was discovered during internal testing and affects all
  versions of the Java driver that support CSFLE. The Java async, Scala, and reactive streams
  drivers are not impacted. This vulnerability does not impact driver traffic payloads with
  CSFLE-supported key services originating from applications residing inside the AWS, GCP, and
  Azure network fabrics due to compensating controls in these environments. This issue does
  not impact driver workloads that don’t use Field Level Encryption.
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:0871
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:4767
  - score: '6.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-20328.json
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18900'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18902'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18120'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19184'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18419'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18517'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18552'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18642'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18635'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18653'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18691'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18754'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19138'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19064'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19241'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18923'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1447'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.11691'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.11635'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14312'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14371'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14469'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1455'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14553'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1452'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14461'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14465'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14477'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14486'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14496'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14494'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14487'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11836'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11632'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11594'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11756'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11759'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11794'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11833'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11813'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11823'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11846'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11878'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11861'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11843'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.17502'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1934236
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-rghw-6px2-fgwc
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://jira.mongodb.org/browse/JAVA-4017
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.mongodb.org/browse/JAVA-4017
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:A/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20328
  - score: '6.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20328
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20328
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-295
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-20328.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-20328
    reference_type:
    reference_id:
  - url: https://jira.mongodb.org/browse/JAVA-4017
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1934236
    reference_type:
    reference_id: '1934236'
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mongodb:java_driver:*:*:*:*:*:mongodb:*:*
    reference_type:
    reference_id: cpe:2.3:a:mongodb:java_driver:*:*:*:*:*:mongodb:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:quarkus:quarkus:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:quarkus:quarkus:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:quarkus:quarkus:1.13.3:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:quarkus:quarkus:1.13.3:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-20328
    reference_type:
    reference_id: CVE-2021-20328
  - url: https://github.com/advisories/GHSA-rghw-6px2-fgwc
    reference_type:
    reference_id: GHSA-rghw-6px2-fgwc
  - url: https://access.redhat.com/errata/RHSA-2021:0871
    reference_type:
    reference_id: RHSA-2021:0871
  - url: https://access.redhat.com/errata/RHSA-2021:4767
    reference_type:
    reference_id: RHSA-2021:4767
  - url: https://access.redhat.com/errata/RHSA-2021:4918
    reference_type:
    reference_id: RHSA-2021:4918
