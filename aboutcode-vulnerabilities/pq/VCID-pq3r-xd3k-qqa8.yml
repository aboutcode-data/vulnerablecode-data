vulnerability_id: VCID-pq3r-xd3k-qqa8
aliases:
  - GHSA-mgr9-6c2j-jxrq
summary: |
  Pterodactyl has a Reflected XSS vulnerability in “Create New Database Host”
  > [!NOTE]
  > Message from the Pterodactyl team:
  >
  > The Pterodactyl team has evaluated this as a minor security issue but does not consider it something that should be assigned a CVE, nor does it require active patching by vulnerable systems.
  >
  > This issue is entirely self-inflicted and requires an administrative user paste an _obviously_ incorrect value into a database host field, submit it, and run into the XSS when the error message is rendered. However, we have determined that this fix is good security hygiene and may prevent issues in other areas not yet discovered.

  ### Summary
  When an administrative user creates a new database host they are prompted to provide a `Host` value which is expected to be a domain or IP address. When an invalid value is encountered and passed back to `gethostaddr` and/or directly to the MySQL connection tooling, an error is returned. This error is then passed back along to the front-end, but was not properly sanitized when rendered.

  Therefore it is possible for an admin to _knowingly_ paste a malicious payload such as `<script>prompt(document.domain)</script>` into the `Host` field and XSS themselves.
severities:
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-mgr9-6c2j-jxrq
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pterodactyl/panel
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pterodactyl/panel/commit/1570ff250939b75b3ba8cd03e5025d8293544ed4
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/pterodactyl/panel/security/advisories/GHSA-mgr9-6c2j-jxrq
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pterodactyl/panel/security/advisories/GHSA-mgr9-6c2j-jxrq
weaknesses:
  - CWE-79
references:
  - url: https://github.com/pterodactyl/panel
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/panel/commit/1570ff250939b75b3ba8cd03e5025d8293544ed4
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/panel/security/advisories/GHSA-mgr9-6c2j-jxrq
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-mgr9-6c2j-jxrq
    reference_type:
    reference_id: GHSA-mgr9-6c2j-jxrq
