vulnerability_id: VCID-rjk5-r2br-aaad
aliases:
  - CVE-2023-38489
  - GHSA-5mvj-rvp8-rf45
summary: |
  Kirby is a content management system. A vulnerability in versions prior to 3.5.8.3, 3.6.6.3, 3.7.5.2, 3.8.4.1, and 3.9.6 affects all Kirby sites with user accounts (unless Kirby's API and Panel are disabled in the config). It can only be abused if a Kirby user is logged in on a device or browser that is shared with potentially untrusted users or if an attacker already maliciously used a previous password to log in to a Kirby site as the affected user.

  Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization. In the variation described in this advisory, it allows attackers to stay logged in to a Kirby site on another device even if the logged in user has since changed their password. Kirby did not invalidate user sessions that were created with a password that was since changed by the user or by a site admin. If a user changed their password to lock out an attacker who was already in possession of the previous password or of a login session on another device or browser, the attacker would not be reliably prevented from accessing the Kirby site as the affected user.

  The problem has been patched in Kirby 3.5.8.3, 3.6.6.3, 3.7.5.2, 3.8.4.1, and 3.9.6. In all of the mentioned releases, the maintainers have updated the authentication implementation to keep track of the hashed password in each active session. If the password changed since the login, the session is invalidated. To enforce this fix even if the vulnerability was previously abused, all users are logged out from the Kirby site after updating to one of the patched releases.
severities:
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37323'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37342'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37367'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37401'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37393'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37416'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.3741'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37414'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37514'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.3751'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37465'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.37394'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56301'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.55894'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56159'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56227'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56248'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56312'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56306'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56313'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56337'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56481'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56518'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.56562'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.55355'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.55377'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.55389'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00180'
    scoring_system: epss
    scoring_elements: '0.55673'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53726'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53728'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53715'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53679'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.5366'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53704'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53737'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53698'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53573'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53554'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53653'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.53659'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.5368'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00338'
    scoring_system: epss
    scoring_elements: '0.537'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: '0.00726'
    scoring_system: epss
    scoring_elements: '0.57132'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5mvj-rvp8-rf45
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/getkirby/kirby
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getkirby/kirby
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/getkirby/kirby/commit/7a0a2014c69fdb925ea02f30e7793bb50115e931
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getkirby/kirby/commit/7a0a2014c69fdb925ea02f30e7793bb50115e931
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.5.8.3
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.5.8.3
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.6.6.3
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.6.6.3
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.7.5.2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.7.5.2
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.8.4.1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.8.4.1
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.9.6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getkirby/kirby/releases/tag/3.9.6
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/getkirby/kirby/security/advisories/GHSA-5mvj-rvp8-rf45
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getkirby/kirby/security/advisories/GHSA-5mvj-rvp8-rf45
  - score: '7.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38489
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38489
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-613
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-38489
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/commit/7a0a2014c69fdb925ea02f30e7793bb50115e931
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.5.8.3
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.6.6.3
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.7.5.2
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.8.4.1
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/releases/tag/3.9.6
    reference_type:
    reference_id:
  - url: https://github.com/getkirby/kirby/security/advisories/GHSA-5mvj-rvp8-rf45
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:getkirby:kirby:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:getkirby:kirby:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38489
    reference_type:
    reference_id: CVE-2023-38489
  - url: https://github.com/advisories/GHSA-5mvj-rvp8-rf45
    reference_type:
    reference_id: GHSA-5mvj-rvp8-rf45
