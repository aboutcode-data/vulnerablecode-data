vulnerability_id: VCID-qmbf-hf2c-aaas
aliases:
  - CVE-2021-32785
summary: mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP
  server that functions as an OpenID Connect Relying Party, authenticating users against an
  OpenID Connect Provider. When mod_auth_openidc versions prior to 2.4.9 are configured to use
  an unencrypted Redis cache (`OIDCCacheEncrypt off`, `OIDCSessionType server-cache`, `OIDCCacheType
  redis`), `mod_auth_openidc` wrongly performed argument interpolation before passing Redis
  requests to `hiredis`, which would perform it again and lead to an uncontrolled format string
  bug. Initial assessment shows that this bug does not appear to allow gaining arbitrary code
  execution, but can reliably provoke a denial of service by repeatedly crashing the Apache
  workers. This bug has been corrected in version 2.4.9 by performing argument interpolation
  only once, using the `hiredis` API. As a workaround, this vulnerability can be mitigated by
  setting `OIDCCacheEncrypt` to `on`, as cache keys are cryptographically hashed before use
  when this option is enabled.
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-32785.json
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.5799'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56218'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56235'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56217'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56204'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56221'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56244'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.5626'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56268'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56252'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56237'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56223'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.57904'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.57946'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.57992'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.5802'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.58033'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.57979'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.57975'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.57978'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.57986'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.57991'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.58003'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.58'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56148'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.5609'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56191'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00373'
    scoring_system: epss
    scoring_elements: '0.56196'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00554'
    scoring_system: epss
    scoring_elements: '0.77433'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00554'
    scoring_system: epss
    scoring_elements: '0.77417'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00555'
    scoring_system: epss
    scoring_elements: '0.77588'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00555'
    scoring_system: epss
    scoring_elements: '0.77448'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81578'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81606'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81610'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81616'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81623'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81668'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81701'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81679'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81415'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81538'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.00751'
    scoring_system: epss
    scoring_elements: '0.81568'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: '0.01021'
    scoring_system: epss
    scoring_elements: '0.63584'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1986100
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32785
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32785
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32785
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://www.oracle.com/security-alerts/cpuapr2022.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.oracle.com/security-alerts/cpuapr2022.html
weaknesses:
  - CWE-134
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-32785.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-32785
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32785
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/commit/dc672688dc1f2db7df8ad4abebc367116017a449
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9
    reference_type:
    reference_id:
  - url: https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-55r8-6w97-xxr4
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/04/msg00034.html
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20210902-0001/
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuapr2022.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1986100
    reference_type:
    reference_id: '1986100'
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=991583
    reference_type:
    reference_id: 991583
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:netapp:cloud_backup:-:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:netapp:cloud_backup:-:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32785
    reference_type:
    reference_id: CVE-2021-32785
