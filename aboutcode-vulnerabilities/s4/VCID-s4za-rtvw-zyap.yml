vulnerability_id: VCID-s4za-rtvw-zyap
aliases:
  - CVE-2025-25291
  - GHSA-4vc4-m8qh-g8jm
summary: ruby-saml provides security assertion markup language (SAML) single sign-on (SSO) for
  Ruby. An authentication bypass vulnerability was found in ruby-saml prior to versions 1.12.4
  and 1.18.0 due to a parser differential. ReXML and Nokogiri parse XML differently; the parsers
  can generate entirely different document structures from the same XML input. That allows an
  attacker to be able to execute a Signature Wrapping attack. This issue may lead to authentication
  bypass. Versions 1.12.4 and 1.18.0 fix the issue.
severities:
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://about.gitlab.com/releases/2025/03/12/patch-release-gitlab-17-9-2-released
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://about.gitlab.com/releases/2025/03/12/patch-release-gitlab-17-9-2-released
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://about.gitlab.com/releases/2025/03/12/patch-release-gitlab-17-9-2-released
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-03T20:06:31Z/
    published_at: None
    url: https://about.gitlab.com/releases/2025/03/12/patch-release-gitlab-17-9-2-released
  - score: '0.00792'
    scoring_system: epss
    scoring_elements: '0.58889'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01087'
    scoring_system: epss
    scoring_elements: '0.75914'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01113'
    scoring_system: epss
    scoring_elements: '0.76304'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01113'
    scoring_system: epss
    scoring_elements: '0.76325'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01113'
    scoring_system: epss
    scoring_elements: '0.76327'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01113'
    scoring_system: epss
    scoring_elements: '0.76301'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01113'
    scoring_system: epss
    scoring_elements: '0.76297'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01113'
    scoring_system: epss
    scoring_elements: '0.76318'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.0113'
    scoring_system: epss
    scoring_elements: '0.76369'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01166'
    scoring_system: epss
    scoring_elements: '0.7677'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01166'
    scoring_system: epss
    scoring_elements: '0.76765'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01211'
    scoring_system: epss
    scoring_elements: '0.77253'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01211'
    scoring_system: epss
    scoring_elements: '0.77255'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01283'
    scoring_system: epss
    scoring_elements: '0.77843'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01283'
    scoring_system: epss
    scoring_elements: '0.77857'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01795'
    scoring_system: epss
    scoring_elements: '0.81738'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01795'
    scoring_system: epss
    scoring_elements: '0.81736'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.01795'
    scoring_system: epss
    scoring_elements: '0.81728'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.02067'
    scoring_system: epss
    scoring_elements: '0.82907'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.02067'
    scoring_system: epss
    scoring_elements: '0.82908'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.02067'
    scoring_system: epss
    scoring_elements: '0.82911'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.02067'
    scoring_system: epss
    scoring_elements: '0.82914'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.02067'
    scoring_system: epss
    scoring_elements: '0.82923'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.02067'
    scoring_system: epss
    scoring_elements: '0.82912'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.02067'
    scoring_system: epss
    scoring_elements: '0.82901'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.02067'
    scoring_system: epss
    scoring_elements: '0.82876'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '0.02067'
    scoring_system: epss
    scoring_elements: '0.82863'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.blog/security/sign-in-as-anyone-bypassing-saml-sso-authentication-with-parser-differentials
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.blog/security/sign-in-as-anyone-bypassing-saml-sso-authentication-with-parser-differentials
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://github.blog/security/sign-in-as-anyone-bypassing-saml-sso-authentication-with-parser-differentials
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-03T20:06:31Z/
    published_at: None
    url: https://github.blog/security/sign-in-as-anyone-bypassing-saml-sso-authentication-with-parser-differentials
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-4vc4-m8qh-g8jm
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/omniauth/omniauth-saml/security/advisories/GHSA-hw46-3hmr-x9xv
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/omniauth/omniauth-saml/security/advisories/GHSA-hw46-3hmr-x9xv
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://github.com/omniauth/omniauth-saml/security/advisories/GHSA-hw46-3hmr-x9xv
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-03T20:06:31Z/
    published_at: None
    url: https://github.com/omniauth/omniauth-saml/security/advisories/GHSA-hw46-3hmr-x9xv
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/ruby-saml/CVE-2025-25291.yml
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/commit/e76c5b36bac40aedbf1ba7ffaaf495be63328cd9
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/commit/e76c5b36bac40aedbf1ba7ffaaf495be63328cd9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/commit/e76c5b36bac40aedbf1ba7ffaaf495be63328cd9
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-03T20:06:31Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/commit/e76c5b36bac40aedbf1ba7ffaaf495be63328cd9
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/commit/e9c1cdbd0f9afa467b585de279db0cbd0fb8ae97
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/commit/e9c1cdbd0f9afa467b585de279db0cbd0fb8ae97
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/commit/e9c1cdbd0f9afa467b585de279db0cbd0fb8ae97
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-03T20:06:31Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/commit/e9c1cdbd0f9afa467b585de279db0cbd0fb8ae97
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.12.4
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.12.4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.12.4
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-03T20:06:31Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.12.4
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.18.0
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.18.0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.18.0
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-03T20:06:31Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.18.0
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-4vc4-m8qh-g8jm
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-4vc4-m8qh-g8jm
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-4vc4-m8qh-g8jm
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-4vc4-m8qh-g8jm
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-4vc4-m8qh-g8jm
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-4vc4-m8qh-g8jm
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-03T20:06:31Z/
    published_at: None
    url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-4vc4-m8qh-g8jm
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://news.ycombinator.com/item?id=43374519
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-25291
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://portswigger.net/research/saml-roulette-the-hacker-always-wins
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://portswigger.net/research/saml-roulette-the-hacker-always-wins
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-03-17T17:18:44Z/
    published_at: None
    url: https://portswigger.net/research/saml-roulette-the-hacker-always-wins
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-04-03T20:06:31Z/
    published_at: None
    url: https://portswigger.net/research/saml-roulette-the-hacker-always-wins
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20250314-0010
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-347
  - CWE-436
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-25291
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-25291
    reference_type:
    reference_id:
  - url: https://github.com/SAML-Toolkits/ruby-saml
    reference_type:
    reference_id:
  - url: https://github.com/SAML-Toolkits/ruby-saml/security/advisories/GHSA-4vc4-m8qh-g8jm
    reference_type:
    reference_id:
  - url: https://news.ycombinator.com/item?id=43374519
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20250314-0010
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20250314-0010/
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1100441
    reference_type:
    reference_id: 1100441
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-25291
    reference_type:
    reference_id: CVE-2025-25291
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/ruby-saml/CVE-2025-25291.yml
    reference_type:
    reference_id: CVE-2025-25291.YML
  - url: https://github.com/SAML-Toolkits/ruby-saml/commit/e76c5b36bac40aedbf1ba7ffaaf495be63328cd9
    reference_type:
    reference_id: e76c5b36bac40aedbf1ba7ffaaf495be63328cd9
  - url: https://github.com/SAML-Toolkits/ruby-saml/commit/e9c1cdbd0f9afa467b585de279db0cbd0fb8ae97
    reference_type:
    reference_id: e9c1cdbd0f9afa467b585de279db0cbd0fb8ae97
  - url: https://github.com/advisories/GHSA-4vc4-m8qh-g8jm
    reference_type:
    reference_id: GHSA-4vc4-m8qh-g8jm
  - url: https://github.com/omniauth/omniauth-saml/security/advisories/GHSA-hw46-3hmr-x9xv
    reference_type:
    reference_id: GHSA-hw46-3hmr-x9xv
  - url: https://about.gitlab.com/releases/2025/03/12/patch-release-gitlab-17-9-2-released
    reference_type:
    reference_id: patch-release-gitlab-17-9-2-released
  - url: https://portswigger.net/research/saml-roulette-the-hacker-always-wins
    reference_type:
    reference_id: saml-roulette-the-hacker-always-wins
  - url: https://github.blog/security/sign-in-as-anyone-bypassing-saml-sso-authentication-with-parser-differentials
    reference_type:
    reference_id: sign-in-as-anyone-bypassing-saml-sso-authentication-with-parser-differentials
  - url: https://usn.ubuntu.com/7409-1/
    reference_type:
    reference_id: USN-7409-1
  - url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.12.4
    reference_type:
    reference_id: v1.12.4
  - url: https://github.com/SAML-Toolkits/ruby-saml/releases/tag/v1.18.0
    reference_type:
    reference_id: v1.18.0
