vulnerability_id: VCID-9c7v-a8mz-aaap
aliases:
  - GHSA-h5vj-f7r9-w564
  - GMS-2020-536
summary: |
  Entropy Backdoor in text-qrcode
  All versions of `text-qrcode` contain malicious code that overwrites the `randomBytes` method for the `crypto` module with a function that generates weak entropy. Instead of generating bytes, the infected randomBytes will generate 3 bytes of entropy and hash them, resulting in a byte value being returned, but one that is easily guessable. Uninstall `text-qrcode` immediately. If the module was used to generate entropy that is load bearing, all such instances of generated entropy must be replaced. This includes things like bitcoin wallets, private keys, encrypted messages, etc.
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-h5vj-f7r9-w564
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.npmjs.com/advisories/738
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.npmjs.com/advisories/738
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-506
references:
  - url: https://www.npmjs.com/advisories/738
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-h5vj-f7r9-w564
    reference_type:
    reference_id: GHSA-h5vj-f7r9-w564
