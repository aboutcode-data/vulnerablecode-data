vulnerability_id: VCID-shes-3t72-syff
aliases:
  - GHSA-rj4j-2jph-gg43
summary: |
  LF Edge eKuiper is vulnerable to Arbitrary File Read/Write via unsanitized names and zip extraction
  ### Summary
  Multiple path traversal and unsafe path handling vulnerabilities were discovered in eKuiper prior to the fixes implemented in PR [lf-edge/ekuiper#3911](https://github.com/lf-edge/ekuiper/pull/3911). The issues allow attacker-controlled input (rule names, schema versions, plugin names, uploaded file names, and ZIP entries) to influence file system paths used by the application. In vulnerable deployments, this can permit files to be created, overwritten, or extracted outside the intended directories, potentially enabling disclosure of sensitive files, tampering with configuration or plugin binaries, denial of service, or other host compromise scenarios.

  Several components used unvalidated user input when constructing filesystem paths or when extracting archives. In each case, input was accepted and used directly in path operations (join, create, delete, extract) without sufficient sanitization or canonicalization, allowing the input to include path separators, `..` segments, or absolute paths.

  ### Impact
  **Arbitrary file overwrite / deletion:** attackers could overwrite or delete files outside the intended directory, which can corrupt application data, remove logs, or disable services.

  ### Resources
  - https://github.com/lf-edge/ekuiper/commit/58362b089c76f08c400fe0dbb3667e6e871eaffd
  - https://github.com/lf-edge/ekuiper/pull/3911
severities:
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lf-edge/ekuiper
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lf-edge/ekuiper/commit/58362b089c76f08c400fe0dbb3667e6e871eaffd
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lf-edge/ekuiper/pull/3911
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lf-edge/ekuiper/security/advisories/GHSA-rj4j-2jph-gg43
weaknesses:
  - CWE-22
  - CWE-23
references:
  - url: https://github.com/lf-edge/ekuiper
    reference_type:
    reference_id:
  - url: https://github.com/lf-edge/ekuiper/commit/58362b089c76f08c400fe0dbb3667e6e871eaffd
    reference_type:
    reference_id:
  - url: https://github.com/lf-edge/ekuiper/pull/3911
    reference_type:
    reference_id:
  - url: https://github.com/lf-edge/ekuiper/security/advisories/GHSA-rj4j-2jph-gg43
    reference_type:
    reference_id:
