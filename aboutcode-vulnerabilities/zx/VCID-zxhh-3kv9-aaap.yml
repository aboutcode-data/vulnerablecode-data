vulnerability_id: VCID-zxhh-3kv9-aaap
aliases:
  - CVE-2024-27304
  - GHSA-mrww-27vc-gghv
summary: pgx is a PostgreSQL driver and toolkit for Go. SQL injection can occur if an attacker
  can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the
  calculated message size can cause the one large message to be sent as multiple messages under
  the attacker's control. The problem is resolved in v4.18.2 and v5.5.4. As a workaround, reject
  user input large enough to cause a single query or bind message to exceed 4 GB in size.
severities:
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-27304.json
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12271'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11609'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11632'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11700'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11696'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11709'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11764'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11819'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12119'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12225'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11891'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11841'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11828'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12177'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11214'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11518'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28623'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28766'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28756'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28726'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28692'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28685'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.2872'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28762'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28731'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28732'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28718'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28588'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.31498'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.37911'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.33641'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.37894'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.37961'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.38034'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.38077'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.38082'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.37983'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.3798'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.37988'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.37963'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.37977'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.37967'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.0016'
    scoring_system: epss
    scoring_elements: '0.37939'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00242'
    scoring_system: epss
    scoring_elements: '0.44797'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '0.00405'
    scoring_system: epss
    scoring_elements: '0.44128'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-03-06T20:31:57Z/
    published_at: None
    url: https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-03-06T20:31:57Z/
    published_at: None
    url: https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/jackc/pgx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jackc/pgx
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-03-06T20:31:57Z/
    published_at: None
    url: https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-03-06T20:31:57Z/
    published_at: None
    url: https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-03-06T20:31:57Z/
    published_at: None
    url: https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-03-06T20:31:57Z/
    published_at: None
    url: https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-27304
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-27304
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.youtube.com/watch?v=Tfg1B8u1yvE
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.youtube.com/watch?v=Tfg1B8u1yvE
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-03-06T20:31:57Z/
    published_at: None
    url: https://www.youtube.com/watch?v=Tfg1B8u1yvE
weaknesses:
  - CWE-190
  - CWE-89
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-27304.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-27304
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27304
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgx
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df
    reference_type:
    reference_id:
  - url: https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1065687
    reference_type:
    reference_id: 1065687
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2268269
    reference_type:
    reference_id: 2268269
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-27304
    reference_type:
    reference_id: CVE-2024-27304
  - url: https://access.redhat.com/errata/RHSA-2024:1321
    reference_type:
    reference_id: RHSA-2024:1321
  - url: https://www.youtube.com/watch?v=Tfg1B8u1yvE
    reference_type:
    reference_id: watch?v=Tfg1B8u1yvE
