vulnerability_id: VCID-zxvs-rx8z-63bx
aliases:
  - CVE-2025-38279
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Do not\
  \ include stack ptr register in precision backtracking bookkeeping\n\nYi Lai reported an issue\
  \ ([1]) where the following warning appears\nin kernel dmesg:\n  [   60.643604] verifier backtracking\
  \ bug\n  [   60.643635] WARNING: CPU: 10 PID: 2315 at kernel/bpf/verifier.c:4302 __mark_chain_precision+0x3a6c/0x3e10\n\
  \  [   60.648428] Modules linked in: bpf_testmod(OE)\n  [   60.650471] CPU: 10 UID: 0 PID:\
  \ 2315 Comm: test_progs Tainted: G           OE       6.15.0-rc4-gef11287f8289-dirty #327\
  \ PREEMPT(full)\n  [   60.654385] Tainted: [O]=OOT_MODULE, [E]=UNSIGNED_MODULE\n  [   60.656682]\
  \ Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qemu.org\
  \ 04/01/2014\n  [   60.660475] RIP: 0010:__mark_chain_precision+0x3a6c/0x3e10\n  [   60.662814]\
  \ Code: 5a 30 84 89 ea e8 c4 d9 01 00 80 3d 3e 7d d8 04 00 0f 85 60 fa ff ff c6 05 31 7d d8\
  \ 04\n                       01 48 c7 c7 00 58 30 84 e8 c4 06 a5 ff <0f> 0b e9 46 fa ff ff\
  \ 48 ...\n  [   60.668720] RSP: 0018:ffff888116cc7298 EFLAGS: 00010246\n  [   60.671075] RAX:\
  \ 54d70e82dfd31900 RBX: ffff888115b65e20 RCX: 0000000000000000\n  [   60.673659] RDX: 0000000000000001\
  \ RSI: 0000000000000004 RDI: 00000000ffffffff\n  [   60.676241] RBP: 0000000000000400 R08:\
  \ ffff8881f6f23bd3 R09: 1ffff1103ede477a\n  [   60.678787] R10: dffffc0000000000 R11: ffffed103ede477b\
  \ R12: ffff888115b60ae8\n  [   60.681420] R13: 1ffff11022b6cbc4 R14: 00000000fffffff2 R15:\
  \ 0000000000000001\n  [   60.684030] FS:  00007fc2aedd80c0(0000) GS:ffff88826fa8a000(0000)\
  \ knlGS:0000000000000000\n  [   60.686837] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n\
  \  [   60.689027] CR2: 000056325369e000 CR3: 000000011088b002 CR4: 0000000000370ef0\n  [ \
  \  60.691623] Call Trace:\n  [   60.692821]  <TASK>\n  [   60.693960]  ? __pfx_verbose+0x10/0x10\n\
  \  [   60.695656]  ? __pfx_disasm_kfunc_name+0x10/0x10\n  [   60.697495]  check_cond_jmp_op+0x16f7/0x39b0\n\
  \  [   60.699237]  do_check+0x58fa/0xab10\n  ...\n\nFurther analysis shows the warning is\
  \ at line 4302 as below:\n\n  4294                 /* static subprog call instruction, which\n\
  \  4295                  * means that we are exiting current subprog,\n  4296            \
  \      * so only r1-r5 could be still requested as\n  4297                  * precise, r0\
  \ and r6-r10 or any stack slot in\n  4298                  * the current frame should be zero\
  \ by now\n  4299                  */\n  4300                 if (bt_reg_mask(bt) & ~BPF_REGMASK_ARGS)\
  \ {\n  4301                         verbose(env, \"BUG regs %x\\n\", bt_reg_mask(bt));\n \
  \ 4302                         WARN_ONCE(1, \"verifier backtracking bug\");\n  4303      \
  \                   return -EFAULT;\n  4304                 }\n\nWith the below test (also\
  \ in the next patch):\n  __used __naked static void __bpf_jmp_r10(void)\n  {\n\tasm volatile\
  \ (\n\t\"r2 = 2314885393468386424 ll;\"\n\t\"goto +0;\"\n\t\"if r2 <= r10 goto +3;\"\n\t\"\
  if r1 >= -1835016 goto +0;\"\n\t\"if r2 <= 8 goto +0;\"\n\t\"if r3 <= 0 goto +0;\"\n\t\"exit;\"\
  \n\t::: __clobber_all);\n  }\n\n  SEC(\"?raw_tp\")\n  __naked void bpf_jmp_r10(void)\n  {\n\
  \tasm volatile (\n\t\"r3 = 0 ll;\"\n\t\"call __bpf_jmp_r10;\"\n\t\"r0 = 0;\"\n\t\"exit;\"\n\
  \t::: __clobber_all);\n  }\n\nThe following is the verifier failure log:\n  0: (18) r3 = 0x0\
  \                      ; R3_w=0\n  2: (85) call pc+2\n  caller:\n   R10=fp0\n  callee:\n \
  \  frame1: R1=ctx() R3_w=0 R10=fp0\n  5: frame1: R1=ctx() R3_w=0 R10=fp0\n  ; asm volatile\
  \ (\"                                 \\ @ verifier_precision.c:184\n  5: (18) r2 = 0x20202000256c6c78\
  \       ; frame1: R2_w=0x20202000256c6c78\n  7: (05) goto pc+0\n  8: (bd) if r2 <= r10 goto\
  \ pc+3        ; frame1: R2_w=0x20202000256c6c78 R10=fp0\n  9: (35) if r1 >= 0xffe3fff8 goto\
  \ pc+0         ; frame1: R1=ctx()\n  10: (b5) if r2 <= 0x8 goto pc+0\n  mark_precise: frame1:\
  \ last_idx 10 first_idx 0 subseq_idx -1\n  mark_precise: frame1: regs=r2 stack= before 9:\
  \ (35) if r1 >= 0xffe3fff8 goto pc+0\n  mark_precise: frame1: regs=r2 stack= before 8: (bd)\
  \ if r2 <= r10 goto pc+3\n  mark_preci\n---truncated---"
severities:
  - score: '3.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38279.json
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38279.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03042'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05071'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.0682'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06809'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06796'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.08037'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.08018'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06869'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.06889'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07753'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07877'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0789'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07884'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07824'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07795'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07776'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07871'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07804'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07797'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07761'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07769'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07864'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07831'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07394'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07445'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07474'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07411'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07484'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07469'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07643'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07629'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07633'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07757'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0771'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07756'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07736'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07717'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07751'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07819'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07521'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07511'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07563'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07602'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.0758'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08545'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08579'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08513'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0854'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08595'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08614'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08572'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-824
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38279.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38279
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4265682c29c92f52c0da6fad5a79b5801462c8de
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac49b7560b4b08b1e4043a29214cc7ad77644c00
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2d2115e56c4a02377189bfc3a9a7933552a7b0f
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2379178
    reference_type:
    reference_id: 2379178
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38279
    reference_type:
    reference_id: CVE-2025-38279
  - url: https://usn.ubuntu.com/7769-1/
    reference_type:
    reference_id: USN-7769-1
  - url: https://usn.ubuntu.com/7769-2/
    reference_type:
    reference_id: USN-7769-2
  - url: https://usn.ubuntu.com/7769-3/
    reference_type:
    reference_id: USN-7769-3
  - url: https://usn.ubuntu.com/7770-1/
    reference_type:
    reference_id: USN-7770-1
  - url: https://usn.ubuntu.com/7771-1/
    reference_type:
    reference_id: USN-7771-1
  - url: https://usn.ubuntu.com/7789-1/
    reference_type:
    reference_id: USN-7789-1
  - url: https://usn.ubuntu.com/7789-2/
    reference_type:
    reference_id: USN-7789-2
