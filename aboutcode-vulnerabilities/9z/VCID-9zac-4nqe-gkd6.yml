vulnerability_id: VCID-9zac-4nqe-gkd6
aliases:
  - CVE-2026-21445
  - GHSA-c5cp-vx83-jhqx
summary: "Langflow Missing Authentication on Critical API Endpoints\n### Summary\nMultiple critical\
  \ API endpoints in Langflow are missing authentication controls, allowing any unauthenticated\
  \ user to access sensitive user conversation data, transaction histories, and perform destructive\
  \ operations including message deletion. This affects endpoints handling personal data and\
  \ system operations that should require proper authorization.\n\n### Details\nThe vulnerability\
  \ exists in three API endpoints within `src/backend/base/langflow/api/v1/monitor.py` that\
  \ are missing the required `dependencies=[Depends(get_current_active_user)]` authentication\
  \ dependency:\n\n**Affected Endpoints:**\n\n1. **GET `/api/v1/monitor/messages`** (Line 61)\n\
  \   ```python\n   @router.get(\"/messages\")  # ❌ Missing authentication\n   async def get_messages(\n\
  \       session: DbSession,\n       flow_id: Annotated[UUID | None, Query()] = None,\n   \
  \    session_id: Annotated[str | None, Query()] = None,\n       # ... other parameters\n \
  \  ) -> list[MessageResponse]:\n   ```\n\n2. **GET `/api/v1/monitor/transactions`** (Line\
  \ 183)\n   ```python\n   @router.get(\"/transactions\")  # ❌ Missing authentication\n   async\
  \ def get_transactions(\n       flow_id: Annotated[UUID, Query()],\n       session: DbSession,\n\
  \       params: Annotated[Params | None, Depends(custom_params)],\n   ) -> Page[TransactionTable]:\n\
  \   ```\n\n3. **DELETE `/api/v1/monitor/messages/session/{session_id}`** (Line 165)\n   ```python\n\
  \   @router.delete(\"/messages/session/{session_id}\", status_code=204)  # ❌ Missing authentication\n\
  \   async def delete_messages_session(\n       session_id: str,\n       session: DbSession,\n\
  \   ):\n   ```\n\n**Inconsistency Evidence:**\nOther endpoints in the same file properly implement\
  \ authentication:\n```python\n@router.get(\"/messages/sessions\", dependencies=[Depends(get_current_active_user)])\
  \  # ✅ Properly secured\n@router.delete(\"/messages\", status_code=204, dependencies=[Depends(get_current_active_user)])\
  \  # ✅ Properly secured\n```\n\n### PoC\nComplete reproduction steps to demonstrate the vulnerability:\n\
  \n**Prerequisites:**\n1. Start a Langflow server instance\n2. Ensure no authentication headers\
  \ or API keys are provided\n\n**Reproduction Commands:**\n```bash\n# 1. Access all user conversations\
  \ without authentication\ncurl http://localhost:7860/api/v1/monitor/messages\n\n# 2. Access\
  \ transaction history without authentication\ncurl \"http://localhost:7860/api/v1/monitor/transactions?flow_id=00000000-0000-0000-0000-000000000000\"\
  \n\n# 3. Delete user messages by session without authentication\ncurl -X DELETE http://localhost:7860/api/v1/monitor/messages/session/00000000-0000-0000-0000-000000000000\n\
  ```\n\n**Expected vs Actual Behavior:**\n- **Expected:** All requests should return `401 Unauthorized`\
  \ \n- **Actual:** All requests return successful responses with sensitive data or perform\
  \ destructive operations\n\n### Impact\n\n**Vulnerability Type:** Broken Authentication and\
  \ Authorization (OWASP Top 10 - A01:2021)\n\n**Severity:** High\n\n**Who is Impacted:**\n\
  - **All Langflow users**: Personal conversation data exposed to unauthorized access\n- **System\
  \ administrators**: Transaction logs disclosed\n\n**Specific Impacts:**\n1. **Data Breach**:\
  \ Unauthorized access to user conversations containing potentially sensitive personal information\n\
  2. **Privacy Violation**: Transaction histories and user activity patterns exposed without\
  \ consent\n3. **Data Destruction**: Malicious actors can delete user conversation histories\
  \ without authorization\n4. **Compliance Risk**: Potential violations of data protection regulations\
  \ (GDPR, CCPA, etc.)\n5. **System Intelligence**: Attackers can gather information about system\
  \ usage patterns and user behavior\n\n**Attack Scenarios:**\n- Malicious users accessing proprietary\
  \ conversation data\n- Malicious users deleting other users' conversation histories\n- Automated\
  \ scraping of all user conversations for data harvesting\n- Reconnaissance attacks to understand\
  \ system architecture and usage patterns\n\n**Recommended Fix:**\nAdd authentication dependencies\
  \ to all affected endpoints:\n\n```python\n@router.get(\"/messages\", dependencies=[Depends(get_current_active_user)])\n\
  @router.get(\"/transactions\", dependencies=[Depends(get_current_active_user)])\n@router.delete(\"\
  /messages/session/{session_id}\", dependencies=[Depends(get_current_active_user)])\n```\n\n\
  **Environment:**\n- Langflow Version: Current main branch\n- Affected Components: API v1 monitoring\
  \ endpoints\n- Authentication System: FastAPI dependency injection with `get_current_active_user`\n\
  \n<img width=\"1908\" height=\"1029\" alt=\"25-090901\" src=\"https://github.com/user-attachments/assets/44bd03b4-6ada-45b7-b81b-9cb83747172b\"\
  \ />"
severities:
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.3759'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2026-21445
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.37562'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2026-21445
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-c5cp-vx83-jhqx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/langflow-ai/langflow
  - score: '8.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/langflow-ai/langflow/commit/3fed9fe1b5658f2c8656dbd73508e113a96e486a
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/langflow-ai/langflow/commit/3fed9fe1b5658f2c8656dbd73508e113a96e486a
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2026-01-05T16:07:45Z/
    published_at: None
    url: https://github.com/langflow-ai/langflow/commit/3fed9fe1b5658f2c8656dbd73508e113a96e486a
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/langflow-ai/langflow/releases/tag/1.7.1
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/langflow-ai/langflow/security/advisories/GHSA-c5cp-vx83-jhqx
  - score: '8.8'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/langflow-ai/langflow/security/advisories/GHSA-c5cp-vx83-jhqx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/langflow-ai/langflow/security/advisories/GHSA-c5cp-vx83-jhqx
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2026-01-05T16:07:45Z/
    published_at: None
    url: https://github.com/langflow-ai/langflow/security/advisories/GHSA-c5cp-vx83-jhqx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21445
weaknesses:
  - CWE-306
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2026-21445
    reference_type:
    reference_id:
  - url: https://github.com/langflow-ai/langflow
    reference_type:
    reference_id:
  - url: https://github.com/langflow-ai/langflow/commit/3fed9fe1b5658f2c8656dbd73508e113a96e486a
    reference_type:
    reference_id:
  - url: https://github.com/langflow-ai/langflow/releases/tag/1.7.1
    reference_type:
    reference_id:
  - url: https://github.com/langflow-ai/langflow/security/advisories/GHSA-c5cp-vx83-jhqx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-21445
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-c5cp-vx83-jhqx
    reference_type:
    reference_id: GHSA-c5cp-vx83-jhqx
