vulnerability_id: VCID-pw4y-bxww-zbgb
aliases:
  - CVE-2025-22120
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: goto right label 'out_mmap_sem' in ext4_setattr()

  Otherwise, if ext4_inode_attach_jinode() fails, a hung task will
  happen because filemap_invalidate_unlock() isn't called to unlock
  mapping->invalidate_lock. Like this:

  EXT4-fs error (device sda) in ext4_setattr:5557: Out of memory
  INFO: task fsstress:374 blocked for more than 122 seconds.
        Not tainted 6.14.0-rc1-next-20250206-xfstests-dirty #726
  "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.
  task:fsstress state:D stack:0     pid:374   tgid:374   ppid:373
                                    task_flags:0x440140 flags:0x00000000
  Call Trace:
   <TASK>
   __schedule+0x2c9/0x7f0
   schedule+0x27/0xa0
   schedule_preempt_disabled+0x15/0x30
   rwsem_down_read_slowpath+0x278/0x4c0
   down_read+0x59/0xb0
   page_cache_ra_unbounded+0x65/0x1b0
   filemap_get_pages+0x124/0x3e0
   filemap_read+0x114/0x3d0
   vfs_read+0x297/0x360
   ksys_read+0x6c/0xe0
   do_syscall_64+0x4b/0x110
   entry_SYSCALL_64_after_hwframe+0x76/0x7e
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22120.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03277'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03268'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03279'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03264'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03263'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04937'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04901'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04923'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04919'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04929'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04931'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04944'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22120.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-22120
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/32d872e3905746ff1048078256cb00f946b97d8a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7e91ae31e2d264155dfd102101afc2de7bd74a64
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2360213
    reference_type:
    reference_id: 2360213
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22120
    reference_type:
    reference_id: CVE-2025-22120
