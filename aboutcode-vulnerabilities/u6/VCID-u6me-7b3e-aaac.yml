vulnerability_id: VCID-u6me-7b3e-aaac
aliases:
  - CVE-2023-22745
summary: tpm2-tss is an open source software implementation of the Trusted Computing Group (TCG)
  Trusted Platform Module (TPM) 2 Software Stack (TSS2). In affected versions `Tss2_RC_SetHandler`
  and `Tss2_RC_Decode` both index into `layer_handler` with an 8 bit layer number, but the array
  only has `TPM2_ERROR_TSS2_RC_LAYER_COUNT` entries, so trying to add a handler for higher-numbered
  layers or decode a response code with such a layer number reads/writes past the end of the
  buffer. This Buffer overrun, could result in arbitrary code execution. An example attack would
  be a MiTM bus attack that returns 0xFFFFFFFF for the RC. Given the common use case of TPM
  modules an attacker must have local access to the target machine with local system privileges
  which allows access to the TPM system. Usually TPM access requires administrative privilege.
severities:
  - score: '6.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-22745.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04176'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03331'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03333'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0333'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03332'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03324'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03366'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0338'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03387'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03378'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03374'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04202'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04239'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04271'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04252'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04265'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0425'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04244'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04198'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04196'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04206'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04207'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0422'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04208'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03364'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03358'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03345'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.07319'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19301'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19291'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19306'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19343'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19383'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19671'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.18826'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19845'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19745'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19082'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19186'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19222'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tpm2-software/tpm2-tss/commit/306490c8d848c367faa2d9df81f5e69dab46ffb5
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-03-10T21:01:10Z/
    published_at: None
    url: https://github.com/tpm2-software/tpm2-tss/commit/306490c8d848c367faa2d9df81f5e69dab46ffb5
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tpm2-software/tpm2-tss/security/advisories/GHSA-4j3v-fh23-vx67
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-03-10T21:01:10Z/
    published_at: None
    url: https://github.com/tpm2-software/tpm2-tss/security/advisories/GHSA-4j3v-fh23-vx67
  - score: '6.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-22745
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-22745
weaknesses:
  - CWE-120
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-22745.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-22745
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-22745
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tpm2-software/tpm2-tss/commit/306490c8d848c367faa2d9df81f5e69dab46ffb5
    reference_type:
    reference_id:
  - url: https://github.com/tpm2-software/tpm2-tss/security/advisories/GHSA-4j3v-fh23-vx67
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1029369
    reference_type:
    reference_id: 1029369
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2162610
    reference_type:
    reference_id: 2162610
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:tpm2_software_stack_project:tpm2_software_stack:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:tpm2_software_stack_project:tpm2_software_stack:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-22745
    reference_type:
    reference_id: CVE-2023-22745
  - url: https://access.redhat.com/errata/RHSA-2023:6685
    reference_type:
    reference_id: RHSA-2023:6685
  - url: https://access.redhat.com/errata/RHSA-2023:7166
    reference_type:
    reference_id: RHSA-2023:7166
  - url: https://access.redhat.com/errata/RHSA-2024:4408
    reference_type:
    reference_id: RHSA-2024:4408
  - url: https://access.redhat.com/errata/RHSA-2024:4739
    reference_type:
    reference_id: RHSA-2024:4739
  - url: https://usn.ubuntu.com/6796-1/
    reference_type:
    reference_id: USN-6796-1
