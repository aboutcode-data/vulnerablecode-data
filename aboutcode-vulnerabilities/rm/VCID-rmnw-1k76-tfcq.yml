vulnerability_id: VCID-rmnw-1k76-tfcq
aliases:
  - CVE-2022-48898
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/msm/dp: do not complete dp_aux_cmd_fifo_tx() if irq is not for aux transfer

  There are 3 possible interrupt sources are handled by DP controller,
  HPDstatus, Controller state changes and Aux read/write transaction.
  At every irq, DP controller have to check isr status of every interrupt
  sources and service the interrupt if its isr status bits shows interrupts
  are pending. There is potential race condition may happen at current aux
  isr handler implementation since it is always complete dp_aux_cmd_fifo_tx()
  even irq is not for aux read or write transaction. This may cause aux read
  transaction return premature if host aux data read is in the middle of
  waiting for sink to complete transferring data to host while irq happen.
  This will cause host's receiving buffer contains unexpected data. This
  patch fixes this problem by checking aux isr and return immediately at
  aux isr handler if there are no any isr status bits set.

  Current there is a bug report regrading eDP edid corruption happen during
  system booting up. After lengthy debugging to found that VIDEO_READY
  interrupt was continuously firing during system booting up which cause
  dp_aux_isr() to complete dp_aux_cmd_fifo_tx() prematurely to retrieve data
  from aux hardware buffer which is not yet contains complete data transfer
  from sink. This cause edid corruption.

  Follows are the signature at kernel logs when problem happen,
  EDID has corrupt header
  panel-simple-dp-aux aux-aea0000.edp: Couldn't identify panel via EDID

  Changes in v2:
  -- do complete if (ret == IRQ_HANDLED) ay dp-aux_isr()
  -- add more commit text

  Changes in v3:
  -- add Stephen suggested
  -- dp_aux_isr() return IRQ_XXX back to caller
  -- dp_ctrl_isr() return IRQ_XXX back to caller

  Changes in v4:
  -- split into two patches

  Changes in v5:
  -- delete empty line between tags

  Changes in v6:
  -- remove extra "that" and fixed line more than 75 char at commit text

  Patchwork: https://patchwork.freedesktop.org/patch/516121/
severities:
  - score: '4.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48898.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04464'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03467'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03457'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03456'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03464'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03466'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03481'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03514'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03524'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0353'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03521'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03511'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04412'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04445'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0448'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04469'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0445'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04441'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04397'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04398'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04406'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04407'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03493'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03489'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04538'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04528'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0449'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '0.00094'
    scoring_system: epss
    scoring_elements: '0.15772'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '4.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48898
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48898
weaknesses:
  - CWE-362
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48898.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-48898
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48898
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1cba0d150fa102439114a91b3e215909efc9f169
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/785607e5e6fb52caf141e4580de40405565f04f1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/984ad875db804948c86ca9e1c2e784ae8252715a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b7dcbca46db3c77fdb02c2a9d6239e5aa3b06a59
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2306419
    reference_type:
    reference_id: 2306419
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48898
    reference_type:
    reference_id: CVE-2022-48898
