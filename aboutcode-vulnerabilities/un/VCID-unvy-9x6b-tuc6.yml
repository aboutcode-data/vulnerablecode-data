vulnerability_id: VCID-unvy-9x6b-tuc6
aliases:
  - CVE-2024-52811
summary: The ngtcp2 project is an effort to implement IETF QUIC protocol in C. In affected versions
  acks are not validated before being written to the qlog leading to a buffer overflow. In `ngtcp2_conn::conn_recv_pkt`
  for an ACK, there was new logic that got added to skip `conn_recv_ack` if an ack has already
  been processed in the payload. However, this causes us to also skip `ngtcp2_pkt_validate_ack`.
  The ack which was skipped still got written to qlog. The bug occurs in `ngtcp2_qlog::write_ack_frame`.
  It is now possible to reach this code with an invalid ack, suppose `largest_ack=0` and `first_ack_range=15`.
  Subtracting `largest_ack - first_ack_range` will lead to an integer underflow which is 20
  chars long. However, the ngtcp2 qlog code assumes the number written is a signed integer and
  only accounts for 19 characters of overhead (see `NGTCP2_QLOG_ACK_FRAME_RANGE_OVERHEAD`).
  Therefore, we overwrite the buffer causing a heap overflow. This is high priority and could
  potentially impact many users if they enable qlog. qlog is disabled by default. Due to its
  overhead, it is most likely used for debugging purpose, but the actual use is unknown. ngtcp2
  v1.9.1 fixes the bug and users are advised to upgrade. Users unable to upgrade should not
  turn on qlog.
severities:
  - score: '8.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-52811.json
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10757'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12471'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1249'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12489'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12495'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1248'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29188'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29077'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29042'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29179'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29194'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29191'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29225'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29185'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29148'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29154'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.33637'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.33699'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.33741'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.33744'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.33667'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.33649'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.33653'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29218'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.29173'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.33572'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '0.0044'
    scoring_system: epss
    scoring_elements: '0.45997'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/ngtcp2/ngtcp2/commit/44b662bd139c23fee1703bf256c13349e2e624a1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-11-25T20:14:23Z/
    published_at: None
    url: https://github.com/ngtcp2/ngtcp2/commit/44b662bd139c23fee1703bf256c13349e2e624a1
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/ngtcp2/ngtcp2/commit/e550c1a414318d0f3f01fca1a621ae0b0428ca15
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-11-25T20:14:23Z/
    published_at: None
    url: https://github.com/ngtcp2/ngtcp2/commit/e550c1a414318d0f3f01fca1a621ae0b0428ca15
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://github.com/ngtcp2/ngtcp2/security/advisories/GHSA-4gmv-gf46-r4g5
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2024-11-25T20:14:23Z/
    published_at: None
    url: https://github.com/ngtcp2/ngtcp2/security/advisories/GHSA-4gmv-gf46-r4g5
weaknesses:
  - CWE-670
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-52811.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-52811
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2328752
    reference_type:
    reference_id: 2328752
  - url: https://github.com/ngtcp2/ngtcp2/commit/44b662bd139c23fee1703bf256c13349e2e624a1
    reference_type:
    reference_id: 44b662bd139c23fee1703bf256c13349e2e624a1
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-52811
    reference_type:
    reference_id: CVE-2024-52811
  - url: https://github.com/ngtcp2/ngtcp2/commit/e550c1a414318d0f3f01fca1a621ae0b0428ca15
    reference_type:
    reference_id: e550c1a414318d0f3f01fca1a621ae0b0428ca15
  - url: https://github.com/ngtcp2/ngtcp2/security/advisories/GHSA-4gmv-gf46-r4g5
    reference_type:
    reference_id: GHSA-4gmv-gf46-r4g5
