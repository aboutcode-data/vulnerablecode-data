vulnerability_id: VCID-ynf2-sann-aaad
aliases:
  - GMS-2016-74
summary: |
  Broken CORS
  Sails has an issue with the CORS configuration where the value of the origin header is reflected as the value for the Access-Control-Allow-Origin header. This would allow an attacker to make AJAX requests to vulnerable hosts through cross site scripting or a malicious HTML Document, effectively bypassing the Same Origin Policy. Note that this is only an issue when `allRoutes` is set to `true` and `origin` is set to `*` or left commented out in the sails CORS config file. The problem can be compounded when the cors `credentials` setting is not provided. At that point authenticated cross domain requests are possible.
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://sailsjs.org/documentation/concepts/security/cors
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://sailsjs.org/documentation/reference/configuration/sails-config-cors
weaknesses:
  - CWE-937
  - CWE-1035
references:
  - url: http://sailsjs.org/documentation/concepts/security/cors
    reference_type:
    reference_id:
  - url: http://sailsjs.org/documentation/reference/configuration/sails-config-cors
    reference_type:
    reference_id:
  - url: https://github.com/balderdashy/sails/commit/ca43e0507af79f15361789a3489013b01c8e1825
    reference_type:
    reference_id:
