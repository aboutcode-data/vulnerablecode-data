vulnerability_id: VCID-tmvc-qjnk-2yae
aliases:
  - CVE-2023-54155
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: core: remove
  unnecessary frame_sz check in bpf_xdp_adjust_tail()  Syzkaller reported the following issue:
  ======================================= Too BIG xdp->frame_sz = 131072 WARNING: CPU: 0 PID:
  5020 at net/core/filter.c:4121   ____bpf_xdp_adjust_tail net/core/filter.c:4121 [inline] WARNING:
  CPU: 0 PID: 5020 at net/core/filter.c:4121   bpf_xdp_adjust_tail+0x466/0xa10 net/core/filter.c:4103
  ... Call Trace:  <TASK>  bpf_prog_4add87e5301a4105+0x1a/0x1c  __bpf_prog_run include/linux/filter.h:600
  [inline]  bpf_prog_run_xdp include/linux/filter.h:775 [inline]  bpf_prog_run_generic_xdp+0x57e/0x11e0
  net/core/dev.c:4721  netif_receive_generic_xdp net/core/dev.c:4807 [inline]  do_xdp_generic+0x35c/0x770
  net/core/dev.c:4866  tun_get_user+0x2340/0x3ca0 drivers/net/tun.c:1919  tun_chr_write_iter+0xe8/0x210
  drivers/net/tun.c:2043  call_write_iter include/linux/fs.h:1871 [inline]  new_sync_write fs/read_write.c:491
  [inline]  vfs_write+0x650/0xe40 fs/read_write.c:584  ksys_write+0x12f/0x250 fs/read_write.c:637  do_syscall_x64
  arch/x86/entry/common.c:50 [inline]  do_syscall_64+0x38/0xb0 arch/x86/entry/common.c:80  entry_SYSCALL_64_after_hwframe+0x63/0xcd  xdp->frame_sz
  > PAGE_SIZE check was introduced in commit c8741e2bfe87 ("xdp: Allow bpf_xdp_adjust_tail()
  to grow packet size"). But Jesper Dangaard Brouer <jbrouer@redhat.com> noted that after introducing
  the xdp_init_buff() which all XDP driver use - it''s safe to remove this check. The original
  intend was to catch cases where XDP drivers have not been updated to use xdp.frame_sz, but
  that is not longer a concern (since xdp_init_buff).  Running the initial syzkaller repro it
  was discovered that the contiguous physical memory allocation is used for both xdp paths in
  tun_get_user(), e.g. tun_build_skb() and tun_alloc_skb(). It was also stated by Jesper Dangaard
  Brouer <jbrouer@redhat.com> that XDP can work on higher order pages, as long as this is contiguous
  physical memory (e.g. a page).'
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54155.json
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05589'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54155
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05572'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54155
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54155.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-54155
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2425206
    reference_type:
    reference_id: 2425206
