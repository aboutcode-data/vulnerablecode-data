vulnerability_id: VCID-tn1j-hr6n-ebfy
aliases:
  - CVE-2025-38734
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net/smc: fix
  UAF on smcsk after smc_listen_out()  BPF CI testing report a UAF issue:    [   16.446633]
  BUG: kernel NULL pointer dereference, address: 000000000000003  0   [   16.447134] #PF: supervisor
  read access in kernel mod  e   [   16.447516] #PF: error_code(0x0000) - not-present pag  e   [   16.447878]
  PGD 0 P4D   0   [   16.448063] Oops: Oops: 0000 [#1] PREEMPT SMP NOPT  I   [   16.448409]
  CPU: 0 UID: 0 PID: 9 Comm: kworker/0:1 Tainted: G           OE      6.13.0-rc3-g89e8a75fda73-dirty
  #4  2   [   16.449124] Tainted: [O]=OOT_MODULE, [E]=UNSIGNED_MODUL  E   [   16.449502] Hardware
  name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/201  4   [   16.450201]
  Workqueue: smc_hs_wq smc_listen_wor  k   [   16.450531] RIP: 0010:smc_listen_work+0xc02/0x159  0   [   16.452158]
  RSP: 0018:ffffb5ab40053d98 EFLAGS: 0001024  6   [   16.452526] RAX: 0000000000000001 RBX:
  0000000000000002 RCX: 000000000000030  0   [   16.452994] RDX: 0000000000000280 RSI: 00003513840053f0
  RDI: 000000000000000  0   [   16.453492] RBP: ffffa097808e3800 R08: ffffa09782dba1e0 R09:
  000000000000000  5   [   16.453987] R10: 0000000000000000 R11: 0000000000000000 R12: ffffa0978274640  0   [   16.454497]
  R13: 0000000000000000 R14: 0000000000000000 R15: ffffa09782d4092  0   [   16.454996] FS:  0000000000000000(0000)
  GS:ffffa097bbc00000(0000) knlGS:000000000000000  0   [   16.455557] CS:  0010 DS: 0000 ES:
  0000 CR0: 000000008005003  3   [   16.455961] CR2: 0000000000000030 CR3: 0000000102788004
  CR4: 0000000000770ef  0   [   16.456459] PKRU: 5555555  4   [   16.456654] Call Trace  :   [   16.456832]  <TASK  >   [   16.456989]  ?
  __die+0x23/0x7  0   [   16.457215]  ? page_fault_oops+0x180/0x4c  0   [   16.457508]  ? __lock_acquire+0x3e6/0x249  0   [   16.457801]  ?
  exc_page_fault+0x68/0x20  0   [   16.458080]  ? asm_exc_page_fault+0x26/0x3  0   [   16.458389]  ?
  smc_listen_work+0xc02/0x159  0   [   16.458689]  ? smc_listen_work+0xc02/0x159  0   [   16.458987]  ?
  lock_is_held_type+0x8f/0x10  0   [   16.459284]  process_one_work+0x1ea/0x6d  0   [   16.459570]  worker_thread+0x1c3/0x38  0   [   16.459839]  ?
  __pfx_worker_thread+0x10/0x1  0   [   16.460144]  kthread+0xe0/0x11  0   [   16.460372]  ?
  __pfx_kthread+0x10/0x1  0   [   16.460640]  ret_from_fork+0x31/0x5  0   [   16.460896]  ?
  __pfx_kthread+0x10/0x1  0   [   16.461166]  ret_from_fork_asm+0x1a/0x3  0   [   16.461453]  </TASK  >   [   16.461616]
  Modules linked in: bpf_testmod(OE) [last unloaded: bpf_testmod(OE)  ]   [   16.462134] CR2:
  000000000000003  0   [   16.462380] ---[ end trace 0000000000000000 ]---   [   16.462710]
  RIP: 0010:smc_listen_work+0xc02/0x1590  The direct cause of this issue is that after smc_listen_out_connected(),
  newclcsock->sk may be NULL since it will releases the smcsk. Therefore, if the application
  closes the socket immediately after accept, newclcsock->sk can be NULL. A possible execution
  order could be as follows:  smc_listen_work                                 | userspace -----------------------------------------------------------------
  lock_sock(sk)                                   | smc_listen_out_connected()                      |
  | \- smc_listen_out                             | |    | \- release_sock                          |      |
  |- sk->sk_data_ready()                   |                                                 |
  fd = accept();                                                 | close(fd);                                                 |  \-
  socket->sk = NULL; /* newclcsock->sk is NULL now */ SMC_STAT_SERV_SUCC_INC(sock_net(newclcsock->sk))  Since
  smc_listen_out_connected() will not fail, simply swapping the order of the code can easily
  fix this issue.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38734.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03034'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03035'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03044'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05592'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05611'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04719'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04727'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04709'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04841'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0485'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04838'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05016'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05021'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0506'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04952'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04663'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0464'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.047'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0473'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04783'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.057'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05743'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05757'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05771'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05753'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05725'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0571'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05687'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05696'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0568'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05673'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05654'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05664'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05683'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0578'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05752'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05668'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-362
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38734.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38734
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38734
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2393484
    reference_type:
    reference_id: 2393484
