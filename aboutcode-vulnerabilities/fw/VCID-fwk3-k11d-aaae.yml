vulnerability_id: VCID-fwk3-k11d-aaae
aliases:
  - CVE-2024-23644
  - GHSA-9f9p-cp3c-72jf
summary: |
  Trillium is a composable toolkit for building internet applications with async rust. In `trillium-http` prior to 0.3.12 and `trillium-client` prior to 0.5.4, insufficient validation of outbound header values may lead to request splitting or response splitting attacks in scenarios where attackers have sufficient control over headers. This only affects use cases where attackers have control of request headers, and can insert "\r\n" sequences. Specifically, if untrusted and unvalidated input is inserted into header names or values.

  Outbound `trillium_http::HeaderValue` and `trillium_http::HeaderName` can be constructed infallibly and were not checked for illegal bytes when sending requests from the client or responses from the server. Thus, if an attacker has sufficient control over header values (or names) in a request or response that they could inject `\r\n` sequences, they could get the client and server out of sync, and then pivot to gain control over other parts of requests or responses. (i.e. exfiltrating data from other requests, SSRF, etc.)

  In `trillium-http` versions 0.3.12 and later, if a header name is invalid in server response headers, the specific header and any associated values are omitted from network transmission. Additionally, if a header value is invalid in server response headers, the individual header value is omitted from network transmission. Other headers values with the same header name will still be sent. In `trillium-client` versions 0.5.4 and later, if any header name or header value is invalid in the client request headers, awaiting the client Conn returns an `Error::MalformedHeader` prior to any network access. As a workaround, Trillium services and client applications should sanitize or validate untrusted input that is included in header values and header names. Carriage return, newline, and null characters are not allowed.
severities:
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28532'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29377'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29378'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29373'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29300'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29241'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.29015'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28965'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28949'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28947'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28953'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28901'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28870'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28792'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.34372'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33990'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50596'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50618'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50623'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.5054'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50551'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50564'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50578'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.5058'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50603'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50584'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50559'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50533'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50493'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00275'
    scoring_system: epss
    scoring_elements: '0.50539'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71482'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71386'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.7138'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71457'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71462'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71494'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71471'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71468'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71475'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71481'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71491'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71484'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.00777'
    scoring_system: epss
    scoring_elements: '0.71474'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: '0.01501'
    scoring_system: epss
    scoring_elements: '0.69338'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-9f9p-cp3c-72jf
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/trillium-rs/trillium
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/trillium-rs/trillium
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/trillium-rs/trillium/commit/16a42b3f8378a3fa4e61ece3e3e37e6a530df51d
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/trillium-rs/trillium/commit/16a42b3f8378a3fa4e61ece3e3e37e6a530df51d
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/trillium-rs/trillium/commit/8d468f85e27b8d0943d6f43ce9f8c7397141a999
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/trillium-rs/trillium/commit/8d468f85e27b8d0943d6f43ce9f8c7397141a999
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/trillium-rs/trillium/security/advisories/GHSA-9f9p-cp3c-72jf
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/trillium-rs/trillium/security/advisories/GHSA-9f9p-cp3c-72jf
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23644
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23644
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2024-0008.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2024-0008.html
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2024-0009.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2024-0009.html
weaknesses:
  - CWE-436
  - CWE-113
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-23644
    reference_type:
    reference_id:
  - url: https://github.com/trillium-rs/trillium
    reference_type:
    reference_id:
  - url: https://github.com/trillium-rs/trillium/commit/16a42b3f8378a3fa4e61ece3e3e37e6a530df51d
    reference_type:
    reference_id:
  - url: https://github.com/trillium-rs/trillium/commit/8d468f85e27b8d0943d6f43ce9f8c7397141a999
    reference_type:
    reference_id:
  - url: https://github.com/trillium-rs/trillium/security/advisories/GHSA-9f9p-cp3c-72jf
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2024-0008.html
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2024-0009.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:trillium:trillium-http:*:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:trillium:trillium-http:*:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:trillium:trillium:*:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:trillium:trillium:*:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23644
    reference_type:
    reference_id: CVE-2024-23644
  - url: https://github.com/advisories/GHSA-9f9p-cp3c-72jf
    reference_type:
    reference_id: GHSA-9f9p-cp3c-72jf
