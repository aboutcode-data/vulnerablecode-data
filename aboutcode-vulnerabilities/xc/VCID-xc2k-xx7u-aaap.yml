vulnerability_id: VCID-xc2k-xx7u-aaap
aliases:
  - CVE-2023-38686
  - GHSA-p6hw-wm59-3g5g
  - PYSEC-2023-139
summary: Sydent is an identity server for the Matrix communications protocol. Prior to version
  2.5.6, if configured to send emails using TLS, Sydent does not verify SMTP servers' certificates.
  This makes  Sydent's emails vulnerable to interception via a man-in-the-middle (MITM) attack.
  Attackers with privileged access to the network can intercept room invitations and address
  confirmation emails. This is patched in Sydent 2.5.6. When patching, make sure that Sydent
  trusts the certificate of the server it is connecting to. This should happen automatically
  when using properly issued certificates. Those who use self-signed certificates should make
  sure to copy their Certification Authority certificate, or their self signed certificate if
  using only one, to the trust store of your operating system. As a workaround, one can ensure
  Sydent's emails fail to send by setting the configured SMTP server to a loopback or non-routable
  address under one's control which does not have a listening SMTP server.
severities:
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21041'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.22139'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.22154'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.22167'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21997'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21900'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21832'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21572'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21541'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21524'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21513'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21519'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21449'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21416'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21328'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17146'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16917'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16992'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.1709'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17162'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17145'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17117'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17108'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17134'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17157'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17152'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27378'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20234'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20033'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20196'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20211'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.2023'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20188'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20165'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20198'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20207'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.2024'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20242'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20199'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20186'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20168'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.20081'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.20417'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://docs.python.org/3/library/ssl.html?highlight=ssl#security-considerations
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.python.org/3/library/ssl.html?highlight=ssl#security-considerations
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p6hw-wm59-3g5g
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p6hw-wm59-3g5g
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/sydent
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/sydent
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/sydent/commit/1cd748307c6b168b66154e6c4db715d4b9551261
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/sydent/commit/1cd748307c6b168b66154e6c4db715d4b9551261
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/sydent/pull/574
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/sydent/pull/574
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/sydent/releases/tag/v2.5.6
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/sydent/releases/tag/v2.5.6
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/sydent/security/advisories/GHSA-p6hw-wm59-3g5g
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/sydent/security/advisories/GHSA-p6hw-wm59-3g5g
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/sydent/security/advisories/GHSA-p6hw-wm59-3g5g
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/sydent/security/advisories/GHSA-p6hw-wm59-3g5g
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-sydent/PYSEC-2023-139.yaml
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-sydent/PYSEC-2023-139.yaml
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/python/cpython/issues/91826
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/python/cpython/issues/91826
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38686
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38686
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://peps.python.org/pep-0476
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://peps.python.org/pep-0476
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://peps.python.org/pep-0476/
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-295
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-38686
    reference_type:
    reference_id:
  - url: https://docs.python.org/3/library/ssl.html?highlight=ssl#security-considerations
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/commit/1cd748307c6b168b66154e6c4db715d4b9551261
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/pull/574
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/releases/tag/v2.5.6
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/sydent/security/advisories/GHSA-p6hw-wm59-3g5g
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-sydent/PYSEC-2023-139.yaml
    reference_type:
    reference_id:
  - url: https://github.com/python/cpython/issues/91826
    reference_type:
    reference_id:
  - url: https://peps.python.org/pep-0476
    reference_type:
    reference_id:
  - url: https://peps.python.org/pep-0476/
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1043162
    reference_type:
    reference_id: 1043162
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:sydent:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:sydent:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38686
    reference_type:
    reference_id: CVE-2023-38686
  - url: https://github.com/advisories/GHSA-p6hw-wm59-3g5g
    reference_type:
    reference_id: GHSA-p6hw-wm59-3g5g
