vulnerability_id: VCID-djqp-grc3-4kfx
aliases:
  - CVE-2025-38385
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: usb: lan78xx: fix WARN in __netif_napi_del_locked on disconnect

  Remove redundant netif_napi_del() call from disconnect path.

  A WARN may be triggered in __netif_napi_del_locked() during USB device
  disconnect:

    WARNING: CPU: 0 PID: 11 at net/core/dev.c:7417 __netif_napi_del_locked+0x2b4/0x350

  This happens because netif_napi_del() is called in the disconnect path while
  NAPI is still enabled. However, it is not necessary to call netif_napi_del()
  explicitly, since unregister_netdev() will handle NAPI teardown automatically
  and safely. Removing the redundant call avoids triggering the warning.

  Full trace:
   lan78xx 1-1:1.0 enu1: Failed to read register index 0x000000c4. ret = -ENODEV
   lan78xx 1-1:1.0 enu1: Failed to set MAC down with error -ENODEV
   lan78xx 1-1:1.0 enu1: Link is Down
   lan78xx 1-1:1.0 enu1: Failed to read register index 0x00000120. ret = -ENODEV
   ------------[ cut here ]------------
   WARNING: CPU: 0 PID: 11 at net/core/dev.c:7417 __netif_napi_del_locked+0x2b4/0x350
   Modules linked in: flexcan can_dev fuse
   CPU: 0 UID: 0 PID: 11 Comm: kworker/0:1 Not tainted 6.16.0-rc2-00624-ge926949dab03 #9 PREEMPT
   Hardware name: SKOV IMX8MP CPU revC - bd500 (DT)
   Workqueue: usb_hub_wq hub_event
   pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
   pc : __netif_napi_del_locked+0x2b4/0x350
   lr : __netif_napi_del_locked+0x7c/0x350
   sp : ffffffc085b673c0
   x29: ffffffc085b673c0 x28: ffffff800b7f2000 x27: ffffff800b7f20d8
   x26: ffffff80110bcf58 x25: ffffff80110bd978 x24: 1ffffff0022179eb
   x23: ffffff80110bc000 x22: ffffff800b7f5000 x21: ffffff80110bc000
   x20: ffffff80110bcf38 x19: ffffff80110bcf28 x18: dfffffc000000000
   x17: ffffffc081578940 x16: ffffffc08284cee0 x15: 0000000000000028
   x14: 0000000000000006 x13: 0000000000040000 x12: ffffffb0022179e8
   x11: 1ffffff0022179e7 x10: ffffffb0022179e7 x9 : dfffffc000000000
   x8 : 0000004ffdde8619 x7 : ffffff80110bcf3f x6 : 0000000000000001
   x5 : ffffff80110bcf38 x4 : ffffff80110bcf38 x3 : 0000000000000000
   x2 : 0000000000000000 x1 : 1ffffff0022179e7 x0 : 0000000000000000
   Call trace:
    __netif_napi_del_locked+0x2b4/0x350 (P)
    lan78xx_disconnect+0xf4/0x360
    usb_unbind_interface+0x158/0x718
    device_remove+0x100/0x150
    device_release_driver_internal+0x308/0x478
    device_release_driver+0x1c/0x30
    bus_remove_device+0x1a8/0x368
    device_del+0x2e0/0x7b0
    usb_disable_device+0x244/0x540
    usb_disconnect+0x220/0x758
    hub_event+0x105c/0x35e0
    process_one_work+0x760/0x17b0
    worker_thread+0x768/0xce8
    kthread+0x3bc/0x690
    ret_from_fork+0x10/0x20
   irq event stamp: 211604
   hardirqs last  enabled at (211603): [<ffffffc0828cc9ec>] _raw_spin_unlock_irqrestore+0x84/0x98
   hardirqs last disabled at (211604): [<ffffffc0828a9a84>] el1_dbg+0x24/0x80
   softirqs last  enabled at (211296): [<ffffffc080095f10>] handle_softirqs+0x820/0xbc8
   softirqs last disabled at (210993): [<ffffffc080010288>] __do_softirq+0x18/0x20
   ---[ end trace 0000000000000000 ]---
   lan78xx 1-1:1.0 enu1: failed to kill vid 0081/0
severities:
  - score: '2.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:P/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38385.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38385.json
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04367'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04354'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04528'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04559'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04594'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0449'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0452'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04529'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04539'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05489'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05469'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05564'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05579'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05619'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05464'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05521'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05515'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05484'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05454'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05578'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05512'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06144'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06141'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06126'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06164'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06129'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06111'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06146'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06211'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06245'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06261'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0625'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06202'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06182'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06172'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06183'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06166'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06163'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06145'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06156'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06246'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06222'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-404
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38385.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38385
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38385
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/17a37b9a5dd945d86110838fb471e7139ba993a2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/510a6095d754df9d727f644ec5076b7929d6c9ea
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6c7ffc9af7186ed79403a3ffee9a1e5199fc7450
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7135056a49035597198280820c61b8c5dbe4a1d0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/968a419c95131e420f12bbdba19e96e2f6b071c4
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2383438
    reference_type:
    reference_id: 2383438
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38385
    reference_type:
    reference_id: CVE-2025-38385
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
