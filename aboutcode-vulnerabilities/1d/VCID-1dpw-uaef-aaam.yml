vulnerability_id: VCID-1dpw-uaef-aaam
aliases:
  - CVE-2023-31135
  - GHSA-92wq-q9pq-gw47
summary: Dgraph is an open source distributed GraphQL database. Existing Dgraph audit logs are
  vulnerable to brute force attacks due to nonce collisions. The first 12 bytes come from a
  baseIv which is initialized when an audit log is created. The last 4 bytes come from the length
  of the log line being encrypted. This is problematic because two log lines will often have
  the same length, so due to these collisions we are reusing the same nonce many times. All
  audit logs generated by versions of Dgraph <v23.0.0 are affected. Attackers must have access
  to the system the logs are stored on. Dgraph users should upgrade to v23.0.0. Users unable
  to upgrade should store existing audit logs in a secure location and for extra security, encrypt
  using an external tool like `gpg`.
severities:
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04473'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04371'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04374'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04379'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04378'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04385'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04383'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04399'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04409'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04438'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04431'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04429'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0442'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04397'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.05464'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10802'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10861'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10793'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10789'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10795'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10686'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10641'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10868'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10845'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10813'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10733'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10784'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10808'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.108'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19192'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19186'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19261'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19364'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19215'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19189'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.19468'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://en.wikipedia.org/wiki/Cryptographic_nonce
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://en.wikipedia.org/wiki/Cryptographic_nonce
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://en.wikipedia.org/wiki/Cryptographic_nonce
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-22T16:46:42Z/
    published_at: None
    url: https://en.wikipedia.org/wiki/Cryptographic_nonce
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/dgraph-io/dgraph
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dgraph-io/dgraph
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/dgraph-io/dgraph/pull/8323
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/dgraph-io/dgraph/pull/8323
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dgraph-io/dgraph/pull/8323
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-22T16:46:42Z/
    published_at: None
    url: https://github.com/dgraph-io/dgraph/pull/8323
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/dgraph-io/dgraph/releases/tag/v23.0.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dgraph-io/dgraph/releases/tag/v23.0.0
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-22T16:46:42Z/
    published_at: None
    url: https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-22T16:46:42Z/
    published_at: None
    url: https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31135
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-31135
weaknesses:
  - CWE-326
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-31135
    reference_type:
    reference_id:
  - url: https://en.wikipedia.org/wiki/Cryptographic_nonce
    reference_type:
    reference_id:
  - url: https://github.com/dgraph-io/dgraph
    reference_type:
    reference_id:
  - url: https://github.com/dgraph-io/dgraph/pull/8323
    reference_type:
    reference_id:
  - url: https://github.com/dgraph-io/dgraph/releases/tag/v23.0.0
    reference_type:
    reference_id:
  - url: https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:dgraph:dgraph:*:*:*:*:*:go:*:*
    reference_type:
    reference_id: cpe:2.3:a:dgraph:dgraph:*:*:*:*:*:go:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-31135
    reference_type:
    reference_id: CVE-2023-31135
