vulnerability_id: VCID-c7g5-pfey-aaaf
aliases:
  - GHSA-5j5w-g665-5m35
summary: |
  Ambiguous OCI manifest parsing
  ### Impact

  In the OCI Distribution Specification version 1.0.0 and prior and in the OCI Image Specification version 1.0.1 and prior, manifest and index documents are ambiguous without an accompanying Content-Type HTTP header.  Versions of containerd prior to 1.4.12 and 1.5.8 treat the Content-Type header as trusted and deserialize the document according to that header.  If the Content-Type header changed between pulls of the same ambiguous document (with the same digest), the document may be interpreted differently, meaning that the digest alone is insufficient to unambiguously identify the content of the image.

  ### Patches

  This issue has been fixed in containerd 1.4.12 and 1.5.8.  Image pulls for manifests that contain a “manifests” field or indices which contain a “layers” field are rejected.

  ### Workarounds

  Ensure you only pull images from trusted sources.

  ### References

  https://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m
  https://github.com/opencontainers/image-spec/security/advisories/GHSA-77vh-xpmg-72qh

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [containerd](https://github.com/containerd/containerd/issues/new/choose)
  * Email us at [security@containerd.io](mailto:security@containerd.io)
severities:
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/containerd/containerd
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/containerd/containerd
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/containerd/containerd/commit/26c76a3014e71af5ad2f396ec76e0e0ecc8e25a3
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/containerd/containerd/commit/26c76a3014e71af5ad2f396ec76e0e0ecc8e25a3
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/containerd/containerd/commit/db00065a969a983ceb0a409833f93f705f284ea4
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/containerd/containerd/commit/db00065a969a983ceb0a409833f93f705f284ea4
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/containerd/containerd/releases/tag/v1.4.12
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/containerd/containerd/releases/tag/v1.4.12
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/containerd/containerd/releases/tag/v1.5.8
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/containerd/containerd/releases/tag/v1.5.8
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/containerd/containerd/security/advisories/GHSA-5j5w-g665-5m35
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/containerd/containerd/security/advisories/GHSA-5j5w-g665-5m35
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/opencontainers/image-spec/security/advisories/GHSA-77vh-xpmg-72qh
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/opencontainers/image-spec/security/advisories/GHSA-77vh-xpmg-72qh
weaknesses:
  - CWE-843
references:
  - url: https://github.com/containerd/containerd
    reference_type:
    reference_id:
  - url: https://github.com/containerd/containerd/commit/26c76a3014e71af5ad2f396ec76e0e0ecc8e25a3
    reference_type:
    reference_id:
  - url: https://github.com/containerd/containerd/commit/db00065a969a983ceb0a409833f93f705f284ea4
    reference_type:
    reference_id:
  - url: https://github.com/containerd/containerd/releases/tag/v1.4.12
    reference_type:
    reference_id:
  - url: https://github.com/containerd/containerd/releases/tag/v1.5.8
    reference_type:
    reference_id:
  - url: https://github.com/containerd/containerd/security/advisories/GHSA-5j5w-g665-5m35
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/image-spec/security/advisories/GHSA-77vh-xpmg-72qh
    reference_type:
    reference_id:
