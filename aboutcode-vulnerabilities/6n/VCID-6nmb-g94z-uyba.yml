vulnerability_id: VCID-6nmb-g94z-uyba
aliases:
  - CVE-2025-23387
  - GHSA-5qmp-9x47-92q8
summary: "Rancher's SAML-based login via CLI can be denied by unauthenticated users\n### Impact\n\
  A vulnerability has been identified within Rancher where it is possible for an unauthenticated\
  \ user to list all CLI authentication tokens and delete them before the CLI is able to get\
  \ the token value. This effectively prevents users from logging in via the CLI when using\
  \ rancher token as the execution command (instead of the token directly being in the kubeconfig).\
  \ \n\nNote that this token is not the kubeconfig token and if an attacker is able to intercept\
  \ it they can't use it to impersonate a real user since it is encrypted.\n\nThis happens because\
  \ for SAML-based authentication providers, the login flow from the CLI works by generating\
  \ a link to be pasted in the browser, and then polling every 10 seconds for the `/v3-public/authTokens/<token\
  \ name>` endpoint.  The `<token name>` is randomly generated by the CLI. Once the login flow\
  \ succeeds, Rancher creates an auth token (with an encrypted token value). The CLI then deletes\
  \ the authToken.\n\n\nRancher deployments using only the local authentication provider, or\
  \ non-SAML-based authentication providers, are not impacted by this vulnerability. SAML-based\
  \ users not using the CLI are also not impacted.\n\n\nPlease consult the associated  [MITRE\
  \ ATT&CK - Technique - Account Access Removal](https://attack.mitre.org/techniques/T1531/)\
  \ for further information about this category of attack.\n\n### Patches\nThe fix involves\
  \ removing GET and DELETE methods for the authTokens collection.\n\nPatched versions include\
  \ releases `v2.8.13`, `v2.9.7` and `v2.10.3`.\n\n### Workarounds\nUsers can refrain from using\
  \ the Rancher CLI to log in as a workaround. Otherwise, users are advised to upgrade to a\
  \ patched version of Rancher Manager.\n\n### References\nIf you have any questions or comments\
  \ about this advisory:\n- Reach out to the [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy)\
  \ for security related inquiries.\n- Open an issue in the [Rancher](https://github.com/rancher/rancher/issues/new/choose)\
  \ repository.\n- Verify with our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/)\
  \ and [product support lifecycle](https://www.suse.com/lifecycle/)."
severities:
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13912'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19134'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22568'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22505'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19077'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19109'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26077'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26144'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26145'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.2611'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.2609'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26079'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26089'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26095'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26118'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26099'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26084'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.261'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23387
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23387
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-11T13:27:25Z/
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23387
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/rancher/rancher
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-5qmp-9x47-92q8
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-5qmp-9x47-92q8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-11T13:27:25Z/
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-5qmp-9x47-92q8
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-23387
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-23387
weaknesses:
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-23387
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/security/advisories/GHSA-5qmp-9x47-92q8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23387
    reference_type:
    reference_id:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23387
    reference_type:
    reference_id: show_bug.cgi?id=CVE-2025-23387
