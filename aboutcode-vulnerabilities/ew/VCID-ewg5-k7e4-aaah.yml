vulnerability_id: VCID-ewg5-k7e4-aaah
aliases:
  - CVE-2021-47005
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  PCI: endpoint: Fix NULL pointer dereference for ->get_features()

  get_features ops of pci_epc_ops may return NULL, causing NULL pointer
  dereference in pci_epf_test_alloc_space function. Let us add a check for
  pci_epc_feature pointer in pci_epf_test_bind before we access it to avoid
  any such NULL pointer dereference and return -ENOTSUPP in case
  pci_epc_feature is not found.

  When the patch is not applied and EPC features is not implemented in the
  platform driver, we see the following dump due to kernel NULL pointer
  dereference.

  Call trace:
   pci_epf_test_bind+0xf4/0x388
   pci_epf_bind+0x3c/0x80
   pci_epc_epf_link+0xa8/0xcc
   configfs_symlink+0x1a4/0x48c
   vfs_symlink+0x104/0x184
   do_symlinkat+0x80/0xd4
   __arm64_sys_symlinkat+0x1c/0x24
   el0_svc_common.constprop.3+0xb8/0x170
   el0_svc_handler+0x70/0x88
   el0_svc+0x8/0x640
  Code: d2800581 b9403ab9 f9404ebb 8b394f60 (f9400400)
  ---[ end trace a438e3c5a24f9df0 ]---
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47005.json
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00562'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.12096'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11972'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11935'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.12101'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.12135'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.12172'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.1215'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '0.00205'
    scoring_system: epss
    scoring_elements: '0.28576'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00596'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00591'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00457'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00459'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00458'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00463'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00462'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00465'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00653'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00654'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00651'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00649'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00589'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00595'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00586'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00587'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.0059'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47005
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47005
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47005.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47005
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47005
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0169d4f0bee44fdfef908c13ed21fcb326c38695
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6613bc2301ba291a1c5a90e1dc24cf3edf223c03
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/679ebad058b8168f10e63876d63b0877fd2fe784
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bbed83d7060e07a5d309104d25a00f0a24441428
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2266861
    reference_type:
    reference_id: 2266861
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47005
    reference_type:
    reference_id: CVE-2021-47005
