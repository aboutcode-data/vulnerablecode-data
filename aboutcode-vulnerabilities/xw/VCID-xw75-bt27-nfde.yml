vulnerability_id: VCID-xw75-bt27-nfde
aliases:
  - CVE-2025-38346
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ftrace: Fix UAF when lookup kallsym after ftrace disabled

  The following issue happens with a buggy module:

  BUG: unable to handle page fault for address: ffffffffc05d0218
  PGD 1bd66f067 P4D 1bd66f067 PUD 1bd671067 PMD 101808067 PTE 0
  Oops: Oops: 0000 [#1] SMP KASAN PTI
  Tainted: [O]=OOT_MODULE, [E]=UNSIGNED_MODULE
  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
  RIP: 0010:sized_strscpy+0x81/0x2f0
  RSP: 0018:ffff88812d76fa08 EFLAGS: 00010246
  RAX: 0000000000000000 RBX: ffffffffc0601010 RCX: dffffc0000000000
  RDX: 0000000000000038 RSI: dffffc0000000000 RDI: ffff88812608da2d
  RBP: 8080808080808080 R08: ffff88812608da2d R09: ffff88812608da68
  R10: ffff88812608d82d R11: ffff88812608d810 R12: 0000000000000038
  R13: ffff88812608da2d R14: ffffffffc05d0218 R15: fefefefefefefeff
  FS:  00007fef552de740(0000) GS:ffff8884251c7000(0000) knlGS:0000000000000000
  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
  CR2: ffffffffc05d0218 CR3: 00000001146f0000 CR4: 00000000000006f0
  DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
  DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
  Call Trace:
   <TASK>
   ftrace_mod_get_kallsym+0x1ac/0x590
   update_iter_mod+0x239/0x5b0
   s_next+0x5b/0xa0
   seq_read_iter+0x8c9/0x1070
   seq_read+0x249/0x3b0
   proc_reg_read+0x1b0/0x280
   vfs_read+0x17f/0x920
   ksys_read+0xf3/0x1c0
   do_syscall_64+0x5f/0x2e0
   entry_SYSCALL_64_after_hwframe+0x76/0x7e

  The above issue may happen as follows:
  (1) Add kprobe tracepoint;
  (2) insmod test.ko;
  (3)  Module triggers ftrace disabled;
  (4) rmmod test.ko;
  (5) cat /proc/kallsyms; --> Will trigger UAF as test.ko already removed;
  ftrace_mod_get_kallsym()
  ...
  strscpy(module_name, mod_map->mod->name, MODULE_NAME_LEN);
  ...

  The problem is when a module triggers an issue with ftrace and
  sets ftrace_disable. The ftrace_disable is set when an anomaly is
  discovered and to prevent any more damage, ftrace stops all text
  modification. The issue that happened was that the ftrace_disable stops
  more than just the text modification.

  When a module is loaded, its init functions can also be traced. Because
  kallsyms deletes the init functions after a module has loaded, ftrace
  saves them when the module is loaded and function tracing is enabled. This
  allows the output of the function trace to show the init function names
  instead of just their raw memory addresses.

  When a module is removed, ftrace_release_mod() is called, and if
  ftrace_disable is set, it just returns without doing anything more. The
  problem here is that it leaves the mod_list still around and if kallsyms
  is called, it will call into this code and access the module memory that
  has already been freed as it will return:

    strscpy(module_name, mod_map->mod->name, MODULE_NAME_LEN);

  Where the "mod" no longer exists and triggers a UAF bug.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38346.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05257'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0524'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04984'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04977'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04954'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07322'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07314'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07395'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0738'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07416'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08287'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08296'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08329'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08389'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0841'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08595'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08661'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08575'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08587'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08228'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08678'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08257'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10267'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09861'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09926'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09979'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0992'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10024'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09997'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10155'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10134'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10135'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10279'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10299'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10271'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10242'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10287'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10284'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1032'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10333'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16433'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16384'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16492'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16495'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16497'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16451'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16445'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16448'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16518'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16482'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16455'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38346.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38346
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38346
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/03a162933c4a03b9f1a84f7d8482903c7e1e11bb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6805582abb720681dd1c87ff677f155dcf4e86c9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/83a692a9792aa86249d68a8ac0b9d55ecdd255fa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8690cd3258455bbae64f809e1d3ee0f043661c71
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8e89c17dc8970c5f71a3a991f5724d4c8de42d8c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d064c68781c19f378af1ae741d9132d35d24b2bb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f78a786ad9a5443a29eef4dae60cde85b7375129
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f914b52c379c12288b7623bb814d0508dbe7481d
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2379237
    reference_type:
    reference_id: 2379237
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38346
    reference_type:
    reference_id: CVE-2025-38346
  - url: https://usn.ubuntu.com/7774-1/
    reference_type:
    reference_id: USN-7774-1
  - url: https://usn.ubuntu.com/7774-2/
    reference_type:
    reference_id: USN-7774-2
  - url: https://usn.ubuntu.com/7774-3/
    reference_type:
    reference_id: USN-7774-3
  - url: https://usn.ubuntu.com/7774-4/
    reference_type:
    reference_id: USN-7774-4
  - url: https://usn.ubuntu.com/7774-5/
    reference_type:
    reference_id: USN-7774-5
  - url: https://usn.ubuntu.com/7775-1/
    reference_type:
    reference_id: USN-7775-1
  - url: https://usn.ubuntu.com/7775-2/
    reference_type:
    reference_id: USN-7775-2
  - url: https://usn.ubuntu.com/7775-3/
    reference_type:
    reference_id: USN-7775-3
  - url: https://usn.ubuntu.com/7776-1/
    reference_type:
    reference_id: USN-7776-1
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
