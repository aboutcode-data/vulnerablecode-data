vulnerability_id: VCID-dqmh-pktz-b7d4
aliases:
  - CVE-2023-54303
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Disable
  preemption in bpf_perf_event_output  The nesting protection in bpf_perf_event_output relies
  on disabled preemption, which is guaranteed for kprobes and tracepoints.  However bpf_perf_event_output
  can be also called from uprobes context through bpf_prog_run_array_sleepable function which
  disables migration, but keeps preemption enabled.  This can cause task to be preempted by
  another one inside the nesting protection and lead eventually to two tasks using same perf_sample_data
  buffer and cause crashes like:    kernel tried to execute NX-protected page - exploit attempt?
  (uid: 0)   BUG: unable to handle page fault for address: ffffffff82be3eea   ...   Call Trace:    ?
  __die+0x1f/0x70    ? page_fault_oops+0x176/0x4d0    ? exc_page_fault+0x132/0x230    ? asm_exc_page_fault+0x22/0x30    ?
  perf_output_sample+0x12b/0x910    ? perf_event_output+0xd0/0x1d0    ? bpf_perf_event_output+0x162/0x1d0    ?
  bpf_prog_c6271286d9a4c938_krava1+0x76/0x87    ? __uprobe_perf_func+0x12b/0x540    ? uprobe_dispatcher+0x2c4/0x430    ?
  uprobe_notify_resume+0x2da/0xce0    ? atomic_notifier_call_chain+0x7b/0x110    ? exit_to_user_mode_prepare+0x13e/0x290    ?
  irqentry_exit_to_user_mode+0x5/0x30    ? asm_exc_int3+0x35/0x40  Fixing this by disabling
  preemption in bpf_perf_event_output.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54303.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0513'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54303
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05111'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54303
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54303.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-54303
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2426113
    reference_type:
    reference_id: 2426113
