vulnerability_id: VCID-4ya5-xepa-aaag
aliases:
  - CVE-2017-13704
summary: In dnsmasq before 2.78, if the DNS packet size does not match the expected size, the
  size parameter in a memset call gets a negative value. As it is an unsigned value, memset
  ends up writing up to 0xffffffff zero's (0xffffffffffffffff in 64 bit platforms), making dnsmasq
  crash.
severities:
  - score: High
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2017q3/011729.html
  - score: High
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-13704.html
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2017-13704.json
  - score: '0.22799'
    scoring_system: epss
    scoring_elements: '0.93344'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.62958'
    scoring_system: epss
    scoring_elements: '0.97987'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.62958'
    scoring_system: epss
    scoring_elements: '0.98010'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.62958'
    scoring_system: epss
    scoring_elements: '0.97986'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.62958'
    scoring_system: epss
    scoring_elements: '0.97985'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.97982'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.97969'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.97987'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.97988'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.97990'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.97991'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.97993'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.97997'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.98002'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.98004'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.64790'
    scoring_system: epss
    scoring_elements: '0.98007'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.98996'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.99024'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.98991'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.98992'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.98993'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.98994'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.98995'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.99014'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.99017'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.99018'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.99019'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.99021'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.9902'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.99022'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.99023'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: '0.79318'
    scoring_system: epss
    scoring_elements: '0.99025'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1495510
  - score: High
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-13704
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-13704
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-13704
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.googleblog.com/2017/10/behind-masq-yet-more-dns-and-dhcp.html
  - score: High
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=63437ffbb58837b214b4b92cb1c54bc5f3279928
weaknesses:
  - CWE-20
  - CWE-190
references:
  - url: http://lists.thekelleys.org.uk/pipermail/dnsmasq-discuss/2017q3/011729.html
    reference_type:
    reference_id:
  - url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-13704.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2017-13704.json
    reference_type:
    reference_id:
  - url: https://access.redhat.com/security/vulnerabilities/3199382
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2017-13704
    reference_type:
    reference_id:
  - url: https://cert-portal.siemens.com/productcert/pdf/ssa-689071.pdf
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-13704
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4TK6DWC53WSU6633EVZL7H4PCWBYHMHK/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4TK6DWC53WSU6633EVZL7H4PCWBYHMHK/
    reference_type:
    reference_id:
  - url: https://security.googleblog.com/2017/10/behind-masq-yet-more-dns-and-dhcp.html
    reference_type:
    reference_id:
  - url: https://www.mail-archive.com/dnsmasq-discuss%40lists.thekelleys.org.uk/msg11664.html
    reference_type:
    reference_id:
  - url: https://www.mail-archive.com/dnsmasq-discuss%40lists.thekelleys.org.uk/msg11665.html
    reference_type:
    reference_id:
  - url: https://www.mail-archive.com/dnsmasq-discuss@lists.thekelleys.org.uk/msg11664.html
    reference_type:
    reference_id:
  - url: https://www.mail-archive.com/dnsmasq-discuss@lists.thekelleys.org.uk/msg11665.html
    reference_type:
    reference_id:
  - url: https://www.synology.com/support/security/Synology_SA_17_59_Dnsmasq
    reference_type:
    reference_id:
  - url: http://thekelleys.org.uk/dnsmasq/CHANGELOG
    reference_type:
    reference_id:
  - url: http://thekelleys.org.uk/gitweb/?p=dnsmasq.git%3Ba=commit%3Bh=63437ffbb58837b214b4b92cb1c54bc5f3279928
    reference_type:
    reference_id:
  - url: http://thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=63437ffbb58837b214b4b92cb1c54bc5f3279928
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/101085
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/101977
    reference_type:
    reference_id:
  - url: http://www.securitytracker.com/id/1039474
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1495510
    reference_type:
    reference_id: 1495510
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=877102
    reference_type:
    reference_id: 877102
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:thekelleys:dnsmasq:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:thekelleys:dnsmasq:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:17.04:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:17.04:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:7.1:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:7.1:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:27:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:27:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:novell:leap:42.2:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:novell:leap:42.2:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:novell:leap:42.3:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:novell:leap:42.3:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:redhat:enterprise_linux_desktop:7.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:redhat:enterprise_linux_desktop:7.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:redhat:enterprise_linux_server:7.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:redhat:enterprise_linux_server:7.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:redhat:enterprise_linux_workstation:7.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:redhat:enterprise_linux_workstation:7.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-13704
    reference_type:
    reference_id: CVE-2017-13704
