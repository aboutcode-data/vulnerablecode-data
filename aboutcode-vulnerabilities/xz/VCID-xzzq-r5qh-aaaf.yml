vulnerability_id: VCID-xzzq-r5qh-aaaf
aliases:
  - GHSA-r2h5-3hgw-8j34
summary: |
  User data in TPM attestation vulnerable to MITM
  ### Impact
  Attestation *user data* (such as the digest of the public key in an aTLS connection) was bound to the issuer's TPM, but not to its PCR state. An attacker could intercept a node initialization, initialize the node themselves, and then impersonate an uninitialized node to the validator. In practice, this meant that a CSP insider with sufficient privileges would have been able to join a node under their control to a Constellation cluster.

  ### Patches
  The issue has been patched in [v2.5.2](https://github.com/edgelesssys/constellation/releases/tag/v2.5.2).

  ### Workarounds
  none
severities:
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/edgelesssys/constellation
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/edgelesssys/constellation/releases/tag/v2.5.2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/edgelesssys/constellation/security/advisories/GHSA-r2h5-3hgw-8j34
weaknesses:
  - CWE-200
references:
  - url: https://github.com/edgelesssys/constellation
    reference_type:
    reference_id:
  - url: https://github.com/edgelesssys/constellation/releases/tag/v2.5.2
    reference_type:
    reference_id:
  - url: https://github.com/edgelesssys/constellation/security/advisories/GHSA-r2h5-3hgw-8j34
    reference_type:
    reference_id:
