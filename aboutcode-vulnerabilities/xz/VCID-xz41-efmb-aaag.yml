vulnerability_id: VCID-xz41-efmb-aaag
aliases:
  - CVE-2021-47317
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  powerpc/bpf: Fix detecting BPF atomic instructions

  Commit 91c960b0056672 ("bpf: Rename BPF_XADD and prepare to encode other
  atomics in .imm") converted BPF_XADD to BPF_ATOMIC and added a way to
  distinguish instructions based on the immediate field. Existing JIT
  implementations were updated to check for the immediate field and to
  reject programs utilizing anything more than BPF_ADD (such as BPF_FETCH)
  in the immediate field.

  However, the check added to powerpc64 JIT did not look at the correct
  BPF instruction. Due to this, such programs would be accepted and
  incorrectly JIT'ed resulting in soft lockups, as seen with the atomic
  bounds test. Fix this by looking at the correct immediate value.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47317.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.2056'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17097'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20562'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20567'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17044'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17195'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17215'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17249'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17268'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17243'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17227'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17206'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17222'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17252'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17202'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17172'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20394'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.2046'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20517'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20577'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20573'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20559'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20536'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20532'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20543'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20546'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.34702'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47317.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47317
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0d435b6d94b05dcfd836d758a63145aa566618e2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/419ac821766cbdb9fd85872bb3f1a589df05c94c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7284dab07e4d51d453cc42851fae9ec4fac6ef2f
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2282463
    reference_type:
    reference_id: 2282463
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47317
    reference_type:
    reference_id: CVE-2021-47317
