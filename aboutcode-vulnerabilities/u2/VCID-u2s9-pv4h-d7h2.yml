vulnerability_id: VCID-u2s9-pv4h-d7h2
aliases:
  - CVE-2025-54469
  - GHSA-c8g6-qrwh-m3vp
summary: |
  NeuVector Enforcer is vulnerable to Command Injection and Buffer overflow
  ### Impact
  A vulnerability was identified in NeuVector, where the enforcer used environment variables `CLUSTER_RPC_PORT` and `CLUSTER_LAN_PORT` to generate a command to be executed via `popen`, without first sanitising their values.

  The entry process of the enforcer container is the monitor process. When the enforcer container stops, the monitor process checks whether the consul subprocess has exited. To perform this check, the monitor process uses the `popen` function to execute a shell command that determines whether the ports used by the consul subprocess are still active.

  The values of environment variables `CLUSTER_RPC_PORT` and `CLUSTER_LAN_PORT` are used directly to compose shell commands via popen without validation or sanitization.  This behavior could allow a malicious user to inject malicious commands through these variables within the enforcer container.

  In the patched version, the monitor process validates the values of `CLUSTER_RPC_PORT` and `CLUSTER_LAN_PORT` to ensure they contain only valid port numbers before invoking the `popen` command.

  If validation fails, the monitor process exits immediately, causing the enforcer container to terminate. This prevents the execution of any injected or malicious commands.


  ### Patches
  Patched versions include release `v5.4.7` and above.

  ### Workarounds
  There is no workaround for this issue. Users are recommended to upgrade, as soon as possible, to a version of NeuVector that contains the fix.

  ### References
  If you have any questions or comments about this advisory:
  - Reach out to the [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.
  - Open an issue in the [NeuVector](https://github.com/neuvector/neuvector/issues/new/choose) repository.
  - Verify with our [support matrix](https://www.suse.com/suse-neuvector/support-matrix/all-supported-versions/neuvector-v-all-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/#suse-security).
severities:
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1439'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54469
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14462'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54469
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14511'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54469
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.21983'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54469
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22046'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54469
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-54469
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-54469
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-10-30T14:00:21Z/
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-54469
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/neuvector/neuvector
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/neuvector/neuvector
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/neuvector/neuvector/security/advisories/GHSA-c8g6-qrwh-m3vp
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/neuvector/neuvector/security/advisories/GHSA-c8g6-qrwh-m3vp
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-10-30T14:00:21Z/
    published_at: None
    url: https://github.com/neuvector/neuvector/security/advisories/GHSA-c8g6-qrwh-m3vp
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-54469
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-54469
weaknesses:
  - CWE-78
  - CWE-120
  - CWE-77
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-54469
    reference_type:
    reference_id:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-54469
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/neuvector/neuvector
    reference_type:
    reference_id:
  - url: https://github.com/neuvector/neuvector/security/advisories/GHSA-c8g6-qrwh-m3vp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54469
    reference_type:
    reference_id:
