vulnerability_id: VCID-mnbm-gcyu-aaah
aliases:
  - CVE-2022-48652
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ice: Fix crash by keep old cfg when update TCs more than queues

  There are problems if allocated queues less than Traffic Classes.

  Commit a632b2a4c920 ("ice: ethtool: Prohibit improper channel config
  for DCB") already disallow setting less queues than TCs.

  Another case is if we first set less queues, and later update more TCs
  config due to LLDP, ice_vsi_cfg_tc() will failed but left dirty
  num_txq/rxq and tc_cfg in vsi, that will cause invalid pointer access.

  [   95.968089] ice 0000:3b:00.1: More TCs defined than queues/rings allocated.
  [   95.968092] ice 0000:3b:00.1: Trying to use more Rx queues (8), than were allocated (1)!
  [   95.968093] ice 0000:3b:00.1: Failed to config TC for VSI index: 0
  [   95.969621] general protection fault: 0000 [#1] SMP NOPTI
  [   95.969705] CPU: 1 PID: 58405 Comm: lldpad Kdump: loaded Tainted: G     U  W  O     --------- -t - 4.18.0 #1
  [   95.969867] Hardware name: O.E.M/BC11SPSCB10, BIOS 8.23 12/30/2021
  [   95.969992] RIP: 0010:devm_kmalloc+0xa/0x60
  [   95.970052] Code: 5c ff ff ff 31 c0 5b 5d 41 5c c3 b8 f4 ff ff ff eb f4 0f 1f 40 00 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 48 89 f8 89 d1 <8b> 97 60 02 00 00 48 8d 7e 18 48 39 f7 72 3f 55 89 ce 53 48 8b 4c
  [   95.970344] RSP: 0018:ffffc9003f553888 EFLAGS: 00010206
  [   95.970425] RAX: dead000000000200 RBX: ffffea003c425b00 RCX: 00000000006080c0
  [   95.970536] RDX: 00000000006080c0 RSI: 0000000000000200 RDI: dead000000000200
  [   95.970648] RBP: dead000000000200 R08: 00000000000463c0 R09: ffff888ffa900000
  [   95.970760] R10: 0000000000000000 R11: 0000000000000002 R12: ffff888ff6b40100
  [   95.970870] R13: ffff888ff6a55018 R14: 0000000000000000 R15: ffff888ff6a55460
  [   95.970981] FS:  00007f51b7d24700(0000) GS:ffff88903ee80000(0000) knlGS:0000000000000000
  [   95.971108] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
  [   95.971197] CR2: 00007fac5410d710 CR3: 0000000f2c1de002 CR4: 00000000007606e0
  [   95.971309] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
  [   95.971419] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
  [   95.971530] PKRU: 55555554
  [   95.971573] Call Trace:
  [   95.971622]  ice_setup_rx_ring+0x39/0x110 [ice]
  [   95.971695]  ice_vsi_setup_rx_rings+0x54/0x90 [ice]
  [   95.971774]  ice_vsi_open+0x25/0x120 [ice]
  [   95.971843]  ice_open_internal+0xb8/0x1f0 [ice]
  [   95.971919]  ice_ena_vsi+0x4f/0xd0 [ice]
  [   95.971987]  ice_dcb_ena_dis_vsi.constprop.5+0x29/0x90 [ice]
  [   95.972082]  ice_pf_dcb_cfg+0x29a/0x380 [ice]
  [   95.972154]  ice_dcbnl_setets+0x174/0x1b0 [ice]
  [   95.972220]  dcbnl_ieee_set+0x89/0x230
  [   95.972279]  ? dcbnl_ieee_del+0x150/0x150
  [   95.972341]  dcb_doit+0x124/0x1b0
  [   95.972392]  rtnetlink_rcv_msg+0x243/0x2f0
  [   95.972457]  ? dcb_doit+0x14d/0x1b0
  [   95.972510]  ? __kmalloc_node_track_caller+0x1d3/0x280
  [   95.972591]  ? rtnl_calcit.isra.31+0x100/0x100
  [   95.972661]  netlink_rcv_skb+0xcf/0xf0
  [   95.972720]  netlink_unicast+0x16d/0x220
  [   95.972781]  netlink_sendmsg+0x2ba/0x3a0
  [   95.975891]  sock_sendmsg+0x4c/0x50
  [   95.979032]  ___sys_sendmsg+0x2e4/0x300
  [   95.982147]  ? kmem_cache_alloc+0x13e/0x190
  [   95.985242]  ? __wake_up_common_lock+0x79/0x90
  [   95.988338]  ? __check_object_size+0xac/0x1b0
  [   95.991440]  ? _copy_to_user+0x22/0x30
  [   95.994539]  ? move_addr_to_user+0xbb/0xd0
  [   95.997619]  ? __sys_sendmsg+0x53/0x80
  [   96.000664]  __sys_sendmsg+0x53/0x80
  [   96.003747]  do_syscall_64+0x5b/0x1d0
  [   96.006862]  entry_SYSCALL_64_after_hwframe+0x65/0xca

  Only update num_txq/rxq when passed check, and restore tc_cfg if setup
  queue map failed.
severities:
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48652.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31834'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.2747'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31877'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31853'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27424'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27571'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27584'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27595'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27606'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27567'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27529'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27528'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27568'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27598'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27604'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.2757'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.27542'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31787'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31851'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31912'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31958'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31962'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31892'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31873'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31878'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31875'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31874'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31887'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '0.00512'
    scoring_system: epss
    scoring_elements: '0.49345'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-229
  - CWE-119
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48652.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-48652
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7c945e5b4787db47d728120b56c934ba05f99864
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a509702cac95a8b450228a037c8542f57e538e5b
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2277810
    reference_type:
    reference_id: 2277810
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48652
    reference_type:
    reference_id: CVE-2022-48652
