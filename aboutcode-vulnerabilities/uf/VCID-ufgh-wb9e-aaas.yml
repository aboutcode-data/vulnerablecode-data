vulnerability_id: VCID-ufgh-wb9e-aaas
aliases:
  - CVE-2021-46912
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: Make tcp_allowed_congestion_control readonly in non-init netns

  Currently, tcp_allowed_congestion_control is global and writable;
  writing to it in any net namespace will leak into all other net
  namespaces.

  tcp_available_congestion_control and tcp_allowed_congestion_control are
  the only sysctls in ipv4_net_table (the per-netns sysctl table) with a
  NULL data pointer; their handlers (proc_tcp_available_congestion_control
  and proc_allowed_congestion_control) have no other way of referencing a
  struct net. Thus, they operate globally.

  Because ipv4_net_table does not use designated initializers, there is no
  easy way to fix up this one "bad" table entry. However, the data pointer
  updating logic shouldn't be applied to NULL pointers anyway, so we
  instead force these entries to be read-only.

  These sysctls used to exist in ipv4_table (init-net only), but they were
  moved to the per-net ipv4_net_table, presumably without realizing that
  tcp_allowed_congestion_control was writable and thus introduced a leak.

  Because the intent of that commit was only to know (i.e. read) "which
  congestion algorithms are available or allowed", this read-only solution
  should be sufficient.

  The logic added in recent commit
  31c4d2f160eb: ("net: Ensure net namespace isolation of sysctls")
  does not and cannot check for NULL data pointers, because
  other table entries (e.g. /proc/sys/net/netfilter/nf_log/) have
  .data=NULL but use other methods (.extra2) to access the struct net.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-46912.json
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06779'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06766'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06767'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06776'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06792'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06787'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06771'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06754'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06717'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08739'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08791'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08904'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08973'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08731'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08805'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08811'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08795'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.088'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08808'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08859'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08873'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08959'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08935'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15654'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15811'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15788'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.1578'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15611'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15845'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '0.00253'
    scoring_system: epss
    scoring_elements: '0.33014'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
  - score: '3.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:L/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46912
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46912
weaknesses:
  - CWE-476
  - CWE-402
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-46912.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-46912
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46912
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1ccdf1bed140820240e383ba0accc474ffc7f006
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35d7491e2f77ce480097cabcaf93ed409e916e12
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/97684f0970f6e112926de631fdd98d9693c7e5c1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2266421
    reference_type:
    reference_id: 2266421
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-46912
    reference_type:
    reference_id: CVE-2021-46912
