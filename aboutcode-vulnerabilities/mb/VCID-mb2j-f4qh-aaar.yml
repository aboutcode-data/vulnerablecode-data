vulnerability_id: VCID-mb2j-f4qh-aaar
aliases:
  - CVE-2024-37297
  - GHSA-cv23-q6gh-xfrf
summary: "WooCommerce has a Cross-Site Scripting Vulnerability in checkout & registration forms\n\
  ### Impact\nA vulnerability introduced in WooCommerce 8.8 allows for cross-site scripting.\
  \ A bad actor can manipulate a link to include malicious HTML & JavaScript content. While\
  \ the content is not saved to the database, the links may be sent to victims for malicious\
  \ purposes. The injected JavaScript could hijack content & data stored in the browser, including\
  \ the session.\nThe URL content is read through the Sourcebuster.js library and then inserted\
  \ without proper sanitization to the classic checkout and registration forms.\n\n### Patches\n\
  ```diff\ndiff --git a/plugins/woocommerce/client/legacy/js/frontend/order-attribution.js b/plugins/woocommerce/client/legacy/js/frontend/order-attribution.js\n\
  index 79411e928e1..25eaa721c54 100644\n--- a/plugins/woocommerce/client/legacy/js/frontend/order-attribution.js\n\
  +++ b/plugins/woocommerce/client/legacy/js/frontend/order-attribution.js\n@@ -155,12 +155,16\
  \ @@\n \t\t * but it's not yet supported in Safari.\n \t\t */\n \t\tconnectedCallback() {\n\
  -\t\t\tlet inputs = '';\n+\t\t\tthis.innerHTML = '';\n+\t\t\tconst inputs = new DocumentFragment();\n\
  \ \t\t\tfor( const fieldName of this._fieldNames ) {\n-\t\t\t\tconst value = stringifyFalsyInputValue(\
  \ this.values[ fieldName ] );\n-\t\t\t\tinputs += `<input type=\"hidden\" name=\"${params.prefix}${fieldName}\"\
  \ value=\"${value}\"/>`;\n+\t\t\t\tconst input = document.createElement( 'input' );\n+\t\t\
  \t\tinput.type = 'hidden';\n+\t\t\t\tinput.name = `${params.prefix}${fieldName}`;\n+\t\t\t\
  \tinput.value = stringifyFalsyInputValue( ( this.values && this.values[ fieldName ] ) || ''\
  \ );\n+\t\t\t\tinputs.appendChild( input );\n \t\t\t}\n-\t\t\tthis.innerHTML = inputs;\n+\t\
  \t\tthis.appendChild( inputs );\n \t\t}\n \n \t\t/**\n```\n\n### Workarounds\nDisabling the\
  \ Order Attribution feature \n\n### References\nA8C SIRT: p3btAN-2L2-p2 (internal)\nPublic\
  \ disclosure: https://developer.woocommerce.com/2024/06/10/developer-advisory-xss-vulnerability-8-8-0/"
severities:
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39268'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39490'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39166'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39196'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39181'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39695'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39619'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39558'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39383'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39376'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39365'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39354'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39359'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.38896'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39163'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39240'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60571'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.6048'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60518'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60566'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60589'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60605'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60561'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60568'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60572'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60587'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00416'
    scoring_system: epss
    scoring_elements: '0.60567'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00736'
    scoring_system: epss
    scoring_elements: '0.70604'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.0074'
    scoring_system: epss
    scoring_elements: '0.70605'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00801'
    scoring_system: epss
    scoring_elements: '0.71963'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00801'
    scoring_system: epss
    scoring_elements: '0.71982'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00801'
    scoring_system: epss
    scoring_elements: '0.71861'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00801'
    scoring_system: epss
    scoring_elements: '0.71946'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00801'
    scoring_system: epss
    scoring_elements: '0.7195'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00801'
    scoring_system: epss
    scoring_elements: '0.71954'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.00865'
    scoring_system: epss
    scoring_elements: '0.73139'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.0094'
    scoring_system: epss
    scoring_elements: '0.74286'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.0094'
    scoring_system: epss
    scoring_elements: '0.7428'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.0094'
    scoring_system: epss
    scoring_elements: '0.74301'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.0094'
    scoring_system: epss
    scoring_elements: '0.74305'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.0094'
    scoring_system: epss
    scoring_elements: '0.74273'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.0094'
    scoring_system: epss
    scoring_elements: '0.74294'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '0.43944'
    scoring_system: epss
    scoring_elements: '0.9634'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://developer.woocommerce.com/2024/06/10/developer-advisory-xss-vulnerability-8-8-0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://developer.woocommerce.com/2024/06/10/developer-advisory-xss-vulnerability-8-8-0
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-cv23-q6gh-xfrf
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/woocommerce/woocommerce
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/woocommerce/woocommerce
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/woocommerce/woocommerce/commit/0e9888305d0cb9557e58f558526ab11cb3bcc4b4
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/woocommerce/woocommerce/commit/0e9888305d0cb9557e58f558526ab11cb3bcc4b4
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/woocommerce/woocommerce/commit/915e32a42762916b745a7e663c8b69a698da8b67
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/woocommerce/woocommerce/commit/915e32a42762916b745a7e663c8b69a698da8b67
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/woocommerce/woocommerce/security/advisories/GHSA-cv23-q6gh-xfrf
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/woocommerce/woocommerce/security/advisories/GHSA-cv23-q6gh-xfrf
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37297
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37297
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37297
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
  - CWE-80
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-37297
    reference_type:
    reference_id:
  - url: https://developer.woocommerce.com/2024/06/10/developer-advisory-xss-vulnerability-8-8-0
    reference_type:
    reference_id:
  - url: https://github.com/woocommerce/woocommerce
    reference_type:
    reference_id:
  - url: https://github.com/woocommerce/woocommerce/commit/0e9888305d0cb9557e58f558526ab11cb3bcc4b4
    reference_type:
    reference_id:
  - url: https://github.com/woocommerce/woocommerce/commit/915e32a42762916b745a7e663c8b69a698da8b67
    reference_type:
    reference_id:
  - url: https://github.com/woocommerce/woocommerce/security/advisories/GHSA-cv23-q6gh-xfrf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37297
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:woocommerce:woocommerce:*:*:*:*:*:wordpress:*:*
    reference_type:
    reference_id: cpe:2.3:a:woocommerce:woocommerce:*:*:*:*:*:wordpress:*:*
  - url: https://github.com/advisories/GHSA-cv23-q6gh-xfrf
    reference_type:
    reference_id: GHSA-cv23-q6gh-xfrf
