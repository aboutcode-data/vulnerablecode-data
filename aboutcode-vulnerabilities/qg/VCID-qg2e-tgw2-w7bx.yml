vulnerability_id: VCID-qg2e-tgw2-w7bx
aliases:
  - CVE-2025-38691
summary: 'In the Linux kernel, the following vulnerability has been resolved:  pNFS: Fix uninited
  ptr deref in block/scsi layout  The error occurs on the third attempt to encode extents. When
  function ext_tree_prepare_commit() reallocates a larger buffer to retry encoding extents,
  the "layoutupdate_pages" page array is initialized only after the retry loop. But ext_tree_free_commitdata()
  is called on every iteration and tries to put pages in the array, thus dereferencing uninitialized
  pointers.  An additional problem is that there is no limit on the maximum possible buffer_size.
  When there are too many extents, the client may create a layoutcommit that is larger than
  the maximum possible RPC size accepted by the server.  During testing, we observed two typical
  scenarios. First, one memory page for extents is enough when we work with small files, append
  data to the end of the file, or preallocate extents before writing. But when we fill a new
  large file without preallocating, the number of extents can be huge, and counting the number
  of written extents in ext_tree_encode_commit() does not help much. Since this number increases
  even more between unlocking and locking of ext_tree, the reallocated buffer may not be large
  enough again and again.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38691.json
  - score: '6.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38691.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04981'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07821'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07804'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12594'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12632'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12561'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1267'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12667'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12844'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12845'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1284'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12998'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12977'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.13012'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12391'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12515'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12466'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12543'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14253'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14238'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14285'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14259'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14297'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1433'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14284'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14294'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14276'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14207'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14315'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14323'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14281'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14286'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14407'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14359'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20127'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-824
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38691.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38691
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38691
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2393211
    reference_type:
    reference_id: 2393211
  - url: https://usn.ubuntu.com/7909-1/
    reference_type:
    reference_id: USN-7909-1
  - url: https://usn.ubuntu.com/7909-2/
    reference_type:
    reference_id: USN-7909-2
  - url: https://usn.ubuntu.com/7909-3/
    reference_type:
    reference_id: USN-7909-3
  - url: https://usn.ubuntu.com/7909-4/
    reference_type:
    reference_id: USN-7909-4
  - url: https://usn.ubuntu.com/7909-5/
    reference_type:
    reference_id: USN-7909-5
  - url: https://usn.ubuntu.com/7910-1/
    reference_type:
    reference_id: USN-7910-1
  - url: https://usn.ubuntu.com/7910-2/
    reference_type:
    reference_id: USN-7910-2
  - url: https://usn.ubuntu.com/7933-1/
    reference_type:
    reference_id: USN-7933-1
  - url: https://usn.ubuntu.com/7938-1/
    reference_type:
    reference_id: USN-7938-1
