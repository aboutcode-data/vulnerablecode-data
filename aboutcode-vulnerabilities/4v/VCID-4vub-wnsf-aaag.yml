vulnerability_id: VCID-4vub-wnsf-aaag
aliases:
  - CVE-2016-10045
  - GHSA-4pc3-96mx-wwc8
summary: 'The isMail transport in PHPMailer before 5.2.20 might allow remote attackers to pass
  extra parameters to the mail command and consequently execute arbitrary code by leveraging
  improper interaction between the escapeshellarg function and internal escaping performed in
  the mail function in PHP. NOTE: this vulnerability exists because of an incorrect fix for
  CVE-2016-10033.'
severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://openwall.com/lists/oss-security/2016/12/28/1
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://openwall.com/lists/oss-security/2016/12/28/1
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://packetstormsecurity.com/files/140286/PHPMailer-Remote-Code-Execution.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://packetstormsecurity.com/files/140286/PHPMailer-Remote-Code-Execution.html
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://packetstormsecurity.com/files/140350/PHPMailer-Sendmail-Argument-Injection.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://packetstormsecurity.com/files/140350/PHPMailer-Sendmail-Argument-Injection.html
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-10045.html
  - score: '0.89178'
    scoring_system: epss
    scoring_elements: '0.99001'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.89178'
    scoring_system: epss
    scoring_elements: '0.98986'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.89178'
    scoring_system: epss
    scoring_elements: '0.98984'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93713'
    scoring_system: epss
    scoring_elements: '0.99834'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93713'
    scoring_system: epss
    scoring_elements: '0.99832'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93713'
    scoring_system: epss
    scoring_elements: '0.99833'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93713'
    scoring_system: epss
    scoring_elements: '0.99831'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93791'
    scoring_system: epss
    scoring_elements: '0.99845'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93791'
    scoring_system: epss
    scoring_elements: '0.99858'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93791'
    scoring_system: epss
    scoring_elements: '0.99846'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93791'
    scoring_system: epss
    scoring_elements: '0.99857'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93791'
    scoring_system: epss
    scoring_elements: '0.99855'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93791'
    scoring_system: epss
    scoring_elements: '0.99856'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.93949'
    scoring_system: epss
    scoring_elements: '0.99868'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.96725'
    scoring_system: epss
    scoring_elements: '0.99716'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.96725'
    scoring_system: epss
    scoring_elements: '0.99704'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.96725'
    scoring_system: epss
    scoring_elements: '0.99712'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.96725'
    scoring_system: epss
    scoring_elements: '0.99714'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.96725'
    scoring_system: epss
    scoring_elements: '0.99715'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.96725'
    scoring_system: epss
    scoring_elements: '0.99718'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.96725'
    scoring_system: epss
    scoring_elements: '0.99719'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: '0.96725'
    scoring_system: epss
    scoring_elements: '0.99720'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10045
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://developer.joomla.org/security-centre/668-20161205-phpmailer-security-advisory.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://developer.joomla.org/security-centre/668-20161205-phpmailer-security-advisory.html
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://seclists.org/fulldisclosure/2016/Dec/81
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://seclists.org/fulldisclosure/2016/Dec/81
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-4pc3-96mx-wwc8
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/phpmailer/phpmailer/CVE-2016-10045.yaml
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/phpmailer/phpmailer/CVE-2016-10045.yaml
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer/releases/tag/v5.2.20
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer/releases/tag/v5.2.20
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer/security/advisories/GHSA-4pc3-96mx-wwc8
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer/security/advisories/GHSA-4pc3-96mx-wwc8
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer/security/advisories/GHSA-4pc3-96mx-wwc8
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer/wiki/About-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/PHPMailer/PHPMailer/wiki/About-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html
  - score: '7.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2016-10045
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2016-10045
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2016-10045
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2016-10045
  - score: High
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-142
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.exploit-db.com/exploits/40969
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.exploit-db.com/exploits/40969
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.exploit-db.com/exploits/40969/
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.exploit-db.com/exploits/40986
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.exploit-db.com/exploits/40986
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.exploit-db.com/exploits/40986
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.exploit-db.com/exploits/42221
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.exploit-db.com/exploits/42221
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.exploit-db.com/exploits/42221
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://www.rapid7.com/db/modules/exploit/multi/http/phpmailer_arg_injection
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.rapid7.com/db/modules/exploit/multi/http/phpmailer_arg_injection
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://www.securityfocus.com/archive/1/539967/100/0/threaded
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.securityfocus.com/archive/1/539967/100/0/threaded
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://www.securityfocus.com/bid/95130
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.securityfocus.com/bid/95130
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://www.securitytracker.com/id/1037533
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.securitytracker.com/id/1037533
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-77
references:
  - url: http://openwall.com/lists/oss-security/2016/12/28/1
    reference_type:
    reference_id:
  - url: http://packetstormsecurity.com/files/140286/PHPMailer-Remote-Code-Execution.html
    reference_type:
    reference_id:
  - url: http://packetstormsecurity.com/files/140350/PHPMailer-Sendmail-Argument-Injection.html
    reference_type:
    reference_id:
  - url: http://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-10045.html
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2016-10045
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10045
    reference_type:
    reference_id:
  - url: https://developer.joomla.org/security-centre/668-20161205-phpmailer-security-advisory.html
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2016/Dec/81
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer/releases/tag/v5.2.20
    reference_type:
    reference_id:
  - url: https://github.com/PHPMailer/PHPMailer/wiki/About-the-CVE-2016-10033-and-CVE-2016-10045-vulnerabilities
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/40969
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/40969/
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/40986
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/40986/
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/42221
    reference_type:
    reference_id:
  - url: https://www.exploit-db.com/exploits/42221/
    reference_type:
    reference_id:
  - url: http://www.rapid7.com/db/modules/exploit/multi/http/phpmailer_arg_injection
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/archive/1/539967/100/0/threaded
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/95130
    reference_type:
    reference_id:
  - url: http://www.securitytracker.com/id/1037533
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/ASA-201701-22
    reference_type:
    reference_id: ASA-201701-22
  - url: https://security.archlinux.org/AVG-142
    reference_type:
    reference_id: AVG-142
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:joomla:joomla\!:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:joomla:joomla\!:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:phpmailer_project:phpmailer:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:phpmailer_project:phpmailer:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:wordpress:wordpress:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:wordpress:wordpress:*:*:*:*:*:*:*:*
  - url: https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html
    reference_type: exploit
    reference_id: CVE-2016-10033
  - url: https://nvd.nist.gov/vuln/detail/CVE-2016-10045
    reference_type:
    reference_id: CVE-2016-10045
  - url: https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html
    reference_type: exploit
    reference_id: CVE-2016-10045;CVE-2016-10033
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/phpmailer/phpmailer/CVE-2016-10045.yaml
    reference_type:
    reference_id: CVE-2016-10045.YAML
  - url: https://github.com/advisories/GHSA-4pc3-96mx-wwc8
    reference_type:
    reference_id: GHSA-4pc3-96mx-wwc8
  - url: https://github.com/PHPMailer/PHPMailer/security/advisories/GHSA-4pc3-96mx-wwc8
    reference_type:
    reference_id: GHSA-4pc3-96mx-wwc8
  - url: https://usn.ubuntu.com/5956-1/
    reference_type:
    reference_id: USN-5956-1
