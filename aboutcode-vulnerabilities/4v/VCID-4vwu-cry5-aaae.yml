vulnerability_id: VCID-4vwu-cry5-aaae
aliases:
  - CVE-2021-21309
summary: 'Redis is an open-source, in-memory database that persists on disk. In affected versions
  of Redis an integer overflow bug in 32-bit Redis version 4.0 or newer could be exploited to
  corrupt the heap and potentially result with remote code execution. Redis 4.0 or newer uses
  a configurable limit for the maximum supported bulk input size. By default, it is 512MB which
  is a safe value for all platforms. If the limit is significantly increased, receiving a large
  request from a client may trigger several integer overflow scenarios, which would result with
  buffer overflow and heap corruption. We believe this could in certain conditions be exploited
  for remote code execution. By default, authenticated Redis users have access to all configuration
  parameters and can therefore use the “CONFIG SET proto-max-bulk-len” to change the safe default,
  making the system vulnerable. **This problem only affects 32-bit Redis (on a 32-bit system,
  or as a 32-bit executable running on a 64-bit system).** The problem is fixed in version 6.2,
  and the fix is back ported to 6.0.11 and 5.0.11. Make sure you use one of these versions if
  you are running 32-bit Redis. An additional workaround to mitigate the problem without patching
  the redis-server executable is to prevent clients from directly executing `CONFIG SET`: Using
  Redis 6.0 or newer, ACL configuration can be used to block the command. Using older versions,
  the `rename-command` configuration directive can be used to rename the command to a random
  string unknown to users, rendering it inaccessible. Please note that this workaround may have
  an additional impact on users or operational systems that expect `CONFIG SET` to behave in
  certain ways.'
severities:
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:2461
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:3016
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-21309.json
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.63115'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.63096'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.63109'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.63106'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61629'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.6305'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.63088'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61571'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61599'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61621'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.616'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.6159'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61594'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61617'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61631'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61654'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61651'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61646'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.6301'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.63095'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.63092'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.63089'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.6152'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.6312'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61472'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00465'
    scoring_system: epss
    scoring_elements: '0.61567'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78515'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78523'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78561'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78559'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78563'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78576'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78581'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78636'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78651'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78672'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78480'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00572'
    scoring_system: epss
    scoring_elements: '0.78348'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00647'
    scoring_system: epss
    scoring_elements: '0.79172'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00647'
    scoring_system: epss
    scoring_elements: '0.79190'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00647'
    scoring_system: epss
    scoring_elements: '0.79186'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.00647'
    scoring_system: epss
    scoring_elements: '0.79352'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: '0.01158'
    scoring_system: epss
    scoring_elements: '0.65643'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1932634
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '6.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21309
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21309
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21309
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-1619
weaknesses:
  - CWE-120
  - CWE-190
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-21309.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-21309
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21309
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/redis/redis/commit/c992857618db99776917f10bf4f2345a5fdc78b0
    reference_type:
    reference_id:
  - url: https://github.com/redis/redis/pull/8522
    reference_type:
    reference_id:
  - url: https://github.com/redis/redis/security/advisories/GHSA-hgj8-vff2-7cjf
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202103-02
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1932634
    reference_type:
    reference_id: '1932634'
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=983446
    reference_type:
    reference_id: 983446
  - url: https://security.archlinux.org/AVG-1619
    reference_type:
    reference_id: AVG-1619
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:redislabs:redis:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:redislabs:redis:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21309
    reference_type:
    reference_id: CVE-2021-21309
  - url: https://access.redhat.com/errata/RHSA-2021:2461
    reference_type:
    reference_id: RHSA-2021:2461
  - url: https://access.redhat.com/errata/RHSA-2021:3016
    reference_type:
    reference_id: RHSA-2021:3016
  - url: https://usn.ubuntu.com/USN-5221-1/
    reference_type:
    reference_id: USN-USN-5221-1
