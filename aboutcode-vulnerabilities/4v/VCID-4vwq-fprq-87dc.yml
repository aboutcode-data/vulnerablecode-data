vulnerability_id: VCID-4vwq-fprq-87dc
aliases:
  - CVE-2025-27403
  - GHSA-44f7-5fj5-h4px
summary: Ratify is a verification engine as a binary executable and on Kubernetes which enables
  verification of artifact security metadata and admits for deployment only those that comply
  with policies the user creates. In a Kubernetes environment, Ratify can be configured to authenticate
  to a private Azure Container Registry (ACR). The Azure workload identity and Azure managed
  identity authentication providers are configured in this setup. Users that configure a private
  ACR to be used with the Azure authentication providers may be impacted by a vulnerability
  that exists in versions prior to 1.2.3 and 1.3.2. Both Azure authentication providers attempt
  to exchange an Entra ID (EID) token for an ACR refresh token. However, Ratifyâ€™s Azure authentication
  providers did not verify that the target registry is an ACR. This could have led to the EID
  token being presented to a non-ACR registry during token exchange. EID tokens with ACR access
  can potentially be extracted and abused if a user workload contains an image reference to
  a malicious registry. As of versions 1.2.3 and 1.3.2, the Azure workload identity and Azure
  managed identity authentication providers are updated to add new validation prior to EID token
  exchange. Validation relies upon registry domain validation against a pre-configured list
  of well-known ACR endpoints. EID token exchange will be executed only if at least one of the
  configured well-known domain suffixes (wildcard support included) matches the registry domain
  of the image reference.
severities:
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22241'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.15236'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.26582'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.26572'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.26554'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.264'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30853'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30887'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30878'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30907'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30895'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.30867'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.37353'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.37321'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.37358'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.37331'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.37307'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.37293'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.42873'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.42776'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.42787'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.42847'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.42878'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.4278'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.39486'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.39457'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.39437'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.42727'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ratify-project/ratify
  - score: '7.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:N/VA:N/SC:H/SI:H/SA:L
    published_at: None
    url: https://github.com/ratify-project/ratify/commit/0ec0c08490e3d672ae64b1a220c90d5484f1c93f
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ratify-project/ratify/commit/0ec0c08490e3d672ae64b1a220c90d5484f1c93f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-03-11T14:38:16Z/
    published_at: None
    url: https://github.com/ratify-project/ratify/commit/0ec0c08490e3d672ae64b1a220c90d5484f1c93f
  - score: '7.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:N/VA:N/SC:H/SI:H/SA:L
    published_at: None
    url: https://github.com/ratify-project/ratify/commit/84c7c48fa76bb9a1c9583635d1e90bc25b1a546c
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ratify-project/ratify/commit/84c7c48fa76bb9a1c9583635d1e90bc25b1a546c
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-03-11T14:38:16Z/
    published_at: None
    url: https://github.com/ratify-project/ratify/commit/84c7c48fa76bb9a1c9583635d1e90bc25b1a546c
  - score: '7.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:H/VI:N/VA:N/SC:H/SI:H/SA:L
    published_at: None
    url: https://github.com/ratify-project/ratify/security/advisories/GHSA-44f7-5fj5-h4px
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ratify-project/ratify/security/advisories/GHSA-44f7-5fj5-h4px
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-03-11T14:38:16Z/
    published_at: None
    url: https://github.com/ratify-project/ratify/security/advisories/GHSA-44f7-5fj5-h4px
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-27403
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3511
weaknesses:
  - CWE-497
  - CWE-287
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-27403
    reference_type:
    reference_id:
  - url: https://github.com/ratify-project/ratify
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3511
    reference_type:
    reference_id:
  - url: https://github.com/ratify-project/ratify/commit/0ec0c08490e3d672ae64b1a220c90d5484f1c93f
    reference_type:
    reference_id: 0ec0c08490e3d672ae64b1a220c90d5484f1c93f
  - url: https://github.com/ratify-project/ratify/commit/84c7c48fa76bb9a1c9583635d1e90bc25b1a546c
    reference_type:
    reference_id: 84c7c48fa76bb9a1c9583635d1e90bc25b1a546c
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27403
    reference_type:
    reference_id: CVE-2025-27403
  - url: https://github.com/ratify-project/ratify/security/advisories/GHSA-44f7-5fj5-h4px
    reference_type:
    reference_id: GHSA-44f7-5fj5-h4px
