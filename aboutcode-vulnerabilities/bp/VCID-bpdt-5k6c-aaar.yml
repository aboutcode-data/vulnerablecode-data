vulnerability_id: VCID-bpdt-5k6c-aaar
aliases:
  - CVE-2023-34253
  - GHSA-j3v8-v77f-fvgm
summary: Grav is a file-based Web platform. Prior to version 1.7.42, the denylist introduced
  in commit 9d6a2d to prevent dangerous functions from being executed via injection of malicious
  templates was insufficient and could be easily subverted in multiple ways -- (1) using unsafe
  functions that are not banned, (2) using capitalised callable names, and (3) using fully-qualified
  names for referencing callables. Consequently, a low privileged attacker with login access
  to Grav Admin panel and page creation/update permissions is able to inject malicious templates
  to obtain remote code execution. A patch in version 1.7.42 improves the denylist.
severities:
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87540'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87616'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87599'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87593'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87583'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87600'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87591'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87589'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87570'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87561'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01533'
    scoring_system: epss
    scoring_elements: '0.87485'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.81975'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.81976'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.81968'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.81964'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.81974'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.81986'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.81978'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.81966'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.8194'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.01844'
    scoring_system: epss
    scoring_elements: '0.81922'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.02001'
    scoring_system: epss
    scoring_elements: '0.88530'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.02001'
    scoring_system: epss
    scoring_elements: '0.88535'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.02001'
    scoring_system: epss
    scoring_elements: '0.88544'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.02418'
    scoring_system: epss
    scoring_elements: '0.89684'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87599'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87601'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87606'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87603'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87597'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87582'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.8757'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87571'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87537'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87553'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87589'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.8759'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.04108'
    scoring_system: epss
    scoring_elements: '0.87581'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: '0.12748'
    scoring_system: epss
    scoring_elements: '0.89987'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-j3v8-v77f-fvgm
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:L
    published_at: None
    url: https://github.com/getgrav/grav
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-12-18T21:39:27Z/
    published_at: None
    url: https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/commit/244758d4383034fe4cd292d41e477177870b65ec
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/commit/244758d4383034fe4cd292d41e477177870b65ec
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-12-18T21:39:27Z/
    published_at: None
    url: https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/commit/8c2c1cb72611a399f13423fc6d0e1d998c03e5c8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/commit/8c2c1cb72611a399f13423fc6d0e1d998c03e5c8
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/commit/9d01140a63c77075ef09b26ef57cf186138151a5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/commit/9d01140a63c77075ef09b26ef57cf186138151a5
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-12-18T21:39:27Z/
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-12-18T21:39:27Z/
    published_at: None
    url: https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/
  - score: '7.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34253
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34253
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-12-18T21:39:27Z/
    published_at: None
    url: https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83
weaknesses:
  - CWE-94
  - CWE-937
  - CWE-1035
  - CWE-184
  - CWE-1336
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-34253
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/blob/1.7.40/system/src/Grav/Common/Utils.php#L1952-L2190
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/244758d4383034fe4cd292d41e477177870b65ec
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/71bbed12f950de8335006d7f91112263d8504f1b
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/8c2c1cb72611a399f13423fc6d0e1d998c03e5c8
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/9d01140a63c77075ef09b26ef57cf186138151a5
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-j3v8-v77f-fvgm
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66
    reference_type:
    reference_id:
  - url: https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/
    reference_type:
    reference_id:
  - url: https://www.github.com/getgrav/grav/commit/9d6a2dba09fd4e56f5cdfb9a399caea355bfeb83
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:getgrav:grav:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:getgrav:grav:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34253
    reference_type:
    reference_id: CVE-2023-34253
  - url: https://github.com/advisories/GHSA-j3v8-v77f-fvgm
    reference_type:
    reference_id: GHSA-j3v8-v77f-fvgm
