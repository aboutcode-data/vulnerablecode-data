vulnerability_id: VCID-63vj-aan6-aaac
aliases:
  - CVE-2024-40910
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ax25: Fix refcount imbalance on inbound connections

  When releasing a socket in ax25_release(), we call netdev_put() to
  decrease the refcount on the associated ax.25 device. However, the
  execution path for accepting an incoming connection never calls
  netdev_hold(). This imbalance leads to refcount errors, and ultimately
  to kernel crashes.

  A typical call trace for the above situation will start with one of the
  following errors:

      refcount_t: decrement hit 0; leaking memory.
      refcount_t: underflow; use-after-free.

  And will then have a trace like:

      Call Trace:
      <TASK>
      ? show_regs+0x64/0x70
      ? __warn+0x83/0x120
      ? refcount_warn_saturate+0xb2/0x100
      ? report_bug+0x158/0x190
      ? prb_read_valid+0x20/0x30
      ? handle_bug+0x3e/0x70
      ? exc_invalid_op+0x1c/0x70
      ? asm_exc_invalid_op+0x1f/0x30
      ? refcount_warn_saturate+0xb2/0x100
      ? refcount_warn_saturate+0xb2/0x100
      ax25_release+0x2ad/0x360
      __sock_release+0x35/0xa0
      sock_close+0x19/0x20
      [...]

  On reboot (or any attempt to remove the interface), the kernel gets
  stuck in an infinite loop:

      unregister_netdevice: waiting for ax0 to become free. Usage count = 0

  This patch corrects these issues by ensuring that we call netdev_hold()
  and ax25_dev_hold() for new connections in ax25_accept(). This makes the
  logic leading to ax25_accept() match the logic for ax25_bind(): in both
  cases we increment the refcount, which is ultimately decremented in
  ax25_release().
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-40910.json
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22192'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.2224'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22247'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28104'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28173'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28157'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28117'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28119'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28108'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28121'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28105'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28084'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24208'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24226'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24256'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24288'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.2428'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24241'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24224'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24195'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.2806'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.2812'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28185'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.2823'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.28226'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.24321'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.24261'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.24409'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.24435'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '0.00441'
    scoring_system: epss
    scoring_elements: '0.46073'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40910
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40910
weaknesses:
  - CWE-911
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-40910.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-40910
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-40910
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c34fb0bd4a4237592c5ecb5b2e2531900c55774
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/52100fd74ad07b53a4666feafff1cd11436362d3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a723a6c8d4831cc8e2c7b0c9f3f0c010d4671964
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f4df9d6c8d4e4c818252b0419c2165d66eabd4eb
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2297494
    reference_type:
    reference_id: 2297494
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-40910
    reference_type:
    reference_id: CVE-2024-40910
  - url: https://usn.ubuntu.com/6999-1/
    reference_type:
    reference_id: USN-6999-1
  - url: https://usn.ubuntu.com/6999-2/
    reference_type:
    reference_id: USN-6999-2
  - url: https://usn.ubuntu.com/7004-1/
    reference_type:
    reference_id: USN-7004-1
  - url: https://usn.ubuntu.com/7005-1/
    reference_type:
    reference_id: USN-7005-1
  - url: https://usn.ubuntu.com/7005-2/
    reference_type:
    reference_id: USN-7005-2
  - url: https://usn.ubuntu.com/7008-1/
    reference_type:
    reference_id: USN-7008-1
  - url: https://usn.ubuntu.com/7029-1/
    reference_type:
    reference_id: USN-7029-1
  - url: https://usn.ubuntu.com/7173-1/
    reference_type:
    reference_id: USN-7173-1
  - url: https://usn.ubuntu.com/7173-2/
    reference_type:
    reference_id: USN-7173-2
  - url: https://usn.ubuntu.com/7173-3/
    reference_type:
    reference_id: USN-7173-3
  - url: https://usn.ubuntu.com/7179-1/
    reference_type:
    reference_id: USN-7179-1
  - url: https://usn.ubuntu.com/7179-2/
    reference_type:
    reference_id: USN-7179-2
  - url: https://usn.ubuntu.com/7179-3/
    reference_type:
    reference_id: USN-7179-3
  - url: https://usn.ubuntu.com/7179-4/
    reference_type:
    reference_id: USN-7179-4
  - url: https://usn.ubuntu.com/7186-1/
    reference_type:
    reference_id: USN-7186-1
  - url: https://usn.ubuntu.com/7186-2/
    reference_type:
    reference_id: USN-7186-2
  - url: https://usn.ubuntu.com/7194-1/
    reference_type:
    reference_id: USN-7194-1
  - url: https://usn.ubuntu.com/7195-1/
    reference_type:
    reference_id: USN-7195-1
  - url: https://usn.ubuntu.com/7195-2/
    reference_type:
    reference_id: USN-7195-2
  - url: https://usn.ubuntu.com/7332-1/
    reference_type:
    reference_id: USN-7332-1
  - url: https://usn.ubuntu.com/7332-2/
    reference_type:
    reference_id: USN-7332-2
  - url: https://usn.ubuntu.com/7332-3/
    reference_type:
    reference_id: USN-7332-3
  - url: https://usn.ubuntu.com/7342-1/
    reference_type:
    reference_id: USN-7342-1
  - url: https://usn.ubuntu.com/7344-1/
    reference_type:
    reference_id: USN-7344-1
  - url: https://usn.ubuntu.com/7344-2/
    reference_type:
    reference_id: USN-7344-2
  - url: https://usn.ubuntu.com/7413-1/
    reference_type:
    reference_id: USN-7413-1
