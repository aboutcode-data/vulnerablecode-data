vulnerability_id: VCID-a6zq-6avz-fbgv
aliases:
  - CVE-2024-50104
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ASoC: qcom: sdm845: add missing soundwire runtime stream alloc

  During the migration of Soundwire runtime stream allocation from
  the Qualcomm Soundwire controller to SoC's soundcard drivers the sdm845
  soundcard was forgotten.

  At this point any playback attempt or audio daemon startup, for instance
  on sdm845-db845c (Qualcomm RB3 board), will result in stream pointer
  NULL dereference:

   Unable to handle kernel NULL pointer dereference at virtual
   address 0000000000000020
   Mem abort info:
     ESR = 0x0000000096000004
     EC = 0x25: DABT (current EL), IL = 32 bits
     SET = 0, FnV = 0
     EA = 0, S1PTW = 0
     FSC = 0x04: level 0 translation fault
   Data abort info:
     ISV = 0, ISS = 0x00000004, ISS2 = 0x00000000
     CM = 0, WnR = 0, TnD = 0, TagAccess = 0
     GCS = 0, Overlay = 0, DirtyBit = 0, Xs = 0
   user pgtable: 4k pages, 48-bit VAs, pgdp=0000000101ecf000
   [0000000000000020] pgd=0000000000000000, p4d=0000000000000000
   Internal error: Oops: 0000000096000004 [#1] PREEMPT SMP
   Modules linked in: ...
   CPU: 5 UID: 0 PID: 1198 Comm: aplay
   Not tainted 6.12.0-rc2-qcomlt-arm64-00059-g9d78f315a362-dirty #18
   Hardware name: Thundercomm Dragonboard 845c (DT)
   pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
   pc : sdw_stream_add_slave+0x44/0x380 [soundwire_bus]
   lr : sdw_stream_add_slave+0x44/0x380 [soundwire_bus]
   sp : ffff80008a2035c0
   x29: ffff80008a2035c0 x28: ffff80008a203978 x27: 0000000000000000
   x26: 00000000000000c0 x25: 0000000000000000 x24: ffff1676025f4800
   x23: ffff167600ff1cb8 x22: ffff167600ff1c98 x21: 0000000000000003
   x20: ffff167607316000 x19: ffff167604e64e80 x18: 0000000000000000
   x17: 0000000000000000 x16: ffffcec265074160 x15: 0000000000000000
   x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000000000
   x11: 0000000000000000 x10: 0000000000000000 x9 : 0000000000000000
   x8 : 0000000000000000 x7 : 0000000000000000 x6 : ffff167600ff1cec
   x5 : ffffcec22cfa2010 x4 : 0000000000000000 x3 : 0000000000000003
   x2 : ffff167613f836c0 x1 : 0000000000000000 x0 : ffff16761feb60b8
   Call trace:
    sdw_stream_add_slave+0x44/0x380 [soundwire_bus]
    wsa881x_hw_params+0x68/0x80 [snd_soc_wsa881x]
    snd_soc_dai_hw_params+0x3c/0xa4
    __soc_pcm_hw_params+0x230/0x660
    dpcm_be_dai_hw_params+0x1d0/0x3f8
    dpcm_fe_dai_hw_params+0x98/0x268
    snd_pcm_hw_params+0x124/0x460
    snd_pcm_common_ioctl+0x998/0x16e8
    snd_pcm_ioctl+0x34/0x58
    __arm64_sys_ioctl+0xac/0xf8
    invoke_syscall+0x48/0x104
    el0_svc_common.constprop.0+0x40/0xe0
    do_el0_svc+0x1c/0x28
    el0_svc+0x34/0xe0
    el0t_64_sync_handler+0x120/0x12c
    el0t_64_sync+0x190/0x194
   Code: aa0403fb f9418400 9100e000 9400102f (f8420f22)
   ---[ end trace 0000000000000000 ]---

  0000000000006108 <sdw_stream_add_slave>:
      6108:       d503233f        paciasp
      610c:       a9b97bfd        stp     x29, x30, [sp, #-112]!
      6110:       910003fd        mov     x29, sp
      6114:       a90153f3        stp     x19, x20, [sp, #16]
      6118:       a9025bf5        stp     x21, x22, [sp, #32]
      611c:       aa0103f6        mov     x22, x1
      6120:       2a0303f5        mov     w21, w3
      6124:       a90363f7        stp     x23, x24, [sp, #48]
      6128:       aa0003f8        mov     x24, x0
      612c:       aa0203f7        mov     x23, x2
      6130:       a9046bf9        stp     x25, x26, [sp, #64]
      6134:       aa0403f9        mov     x25, x4        <-- x4 copied to x25
      6138:       a90573fb        stp     x27, x28, [sp, #80]
      613c:       aa0403fb        mov     x27, x4
      6140:       f9418400        ldr     x0, [x0, #776]
      6144:       9100e000        add     x0, x0, #0x38
      6148:       94000000        bl      0 <mutex_lock>
      614c:       f8420f22        ldr     x2, [x25, #32]!  <-- offset 0x44
      ^^^
  This is 0x6108 + offset 0x44 from the beginning of sdw_stream_add_slave()
  where data abort happens.
  wsa881x_hw_params() is called with stream = NULL and passes it further
  in register x4 (5th argu
  ---truncated---
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-50104.json
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05498'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05525'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05534'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05517'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05516'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05503'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05509'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05545'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05566'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05588'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0559'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05644'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05557'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05537'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04164'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04166'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.042'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.03229'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04226'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04931'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04892'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04902'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04896'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04899'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04897'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04907'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04914'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04909'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04898'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04871'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50104
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50104
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-50104.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-50104
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d0e806b0cc6260b59c65e606034a63145169c04c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fc34d36879f87e5a3813fb66655b8bdb90c7b0d8
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2323954
    reference_type:
    reference_id: 2323954
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50104
    reference_type:
    reference_id: CVE-2024-50104
  - url: https://usn.ubuntu.com/7276-1/
    reference_type:
    reference_id: USN-7276-1
  - url: https://usn.ubuntu.com/7277-1/
    reference_type:
    reference_id: USN-7277-1
  - url: https://usn.ubuntu.com/7310-1/
    reference_type:
    reference_id: USN-7310-1
  - url: https://usn.ubuntu.com/7449-1/
    reference_type:
    reference_id: USN-7449-1
  - url: https://usn.ubuntu.com/7449-2/
    reference_type:
    reference_id: USN-7449-2
  - url: https://usn.ubuntu.com/7450-1/
    reference_type:
    reference_id: USN-7450-1
  - url: https://usn.ubuntu.com/7451-1/
    reference_type:
    reference_id: USN-7451-1
  - url: https://usn.ubuntu.com/7452-1/
    reference_type:
    reference_id: USN-7452-1
  - url: https://usn.ubuntu.com/7453-1/
    reference_type:
    reference_id: USN-7453-1
  - url: https://usn.ubuntu.com/7468-1/
    reference_type:
    reference_id: USN-7468-1
