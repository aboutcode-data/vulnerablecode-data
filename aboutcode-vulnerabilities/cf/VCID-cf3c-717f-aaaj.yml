vulnerability_id: VCID-cf3c-717f-aaaj
aliases:
  - CVE-2022-31142
  - GHSA-376v-xgjx-7mfr
summary: '@fastify/bearer-auth is a Fastify plugin to require bearer Authorization headers.
  @fastify/bearer-auth prior to versions 7.0.2 and 8.0.1 does not securely use crypto.timingSafeEqual.
  A malicious attacker could estimate the length of one valid bearer token. According to the
  corresponding RFC 6750, the bearer token has only base64 valid characters, reducing the range
  of characters for a brute force attack. Version 7.0.2 and 8.0.1 of @fastify/bearer-auth contain
  a patch. There are currently no known workarounds. The package fastify-bearer-auth, which
  covers versions 6.0.3 and prior, is also vulnerable starting at version 5.0.1. Users of fastify-bearer-auth
  should upgrade to a patched version of @fastify/bearer-auth.'
severities:
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.48049'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47756'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47775'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47856'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47853'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47872'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47884'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.48026'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.48127'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47199'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.46913'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.46911'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.46886'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47392'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00121'
    scoring_system: epss
    scoring_elements: '0.47680'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.3896'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.38982'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.39011'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.38985'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.38987'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.38978'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.3887'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.38905'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.48071'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45281'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45302'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45323'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45333'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45292'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45276'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.47936'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.47988'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.48045'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.48067'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.47979'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.47977'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.48009'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.48005'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.48016'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.47995'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.4797'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.47941'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.37075'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-376v-xgjx-7mfr
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/commit/0c468a616d7e56126dc468150f6a5a92e530b8e4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/commit/0c468a616d7e56126dc468150f6a5a92e530b8e4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:53:32Z/
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/commit/0c468a616d7e56126dc468150f6a5a92e530b8e4
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/commit/39353b15409ee99474545f615ffb16180cf3b716
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/commit/39353b15409ee99474545f615ffb16180cf3b716
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:53:32Z/
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/commit/39353b15409ee99474545f615ffb16180cf3b716
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/commit/f921a0582dc83112039004a9b5041141b50c5b3f
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/commit/f921a0582dc83112039004a9b5041141b50c5b3f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:53:32Z/
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/commit/f921a0582dc83112039004a9b5041141b50c5b3f
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/security/advisories/GHSA-376v-xgjx-7mfr
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/security/advisories/GHSA-376v-xgjx-7mfr
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:53:32Z/
    published_at: None
    url: https://github.com/fastify/fastify-bearer-auth/security/advisories/GHSA-376v-xgjx-7mfr
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://hackerone.com/reports/1633287
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://hackerone.com/reports/1633287
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:53:32Z/
    published_at: None
    url: https://hackerone.com/reports/1633287
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31142
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31142
weaknesses:
  - CWE-203
  - CWE-937
  - CWE-1035
  - CWE-208
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-31142
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/commit/0c468a616d7e56126dc468150f6a5a92e530b8e4
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/commit/39353b15409ee99474545f615ffb16180cf3b716
    reference_type:
    reference_id:
  - url: https://github.com/fastify/fastify-bearer-auth/commit/f921a0582dc83112039004a9b5041141b50c5b3f
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1633287
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fastify:bearer-auth:8.0.0:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:fastify:bearer-auth:8.0.0:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fastify:bearer-auth:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:fastify:bearer-auth:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31142
    reference_type:
    reference_id: CVE-2022-31142
  - url: https://github.com/advisories/GHSA-376v-xgjx-7mfr
    reference_type:
    reference_id: GHSA-376v-xgjx-7mfr
  - url: https://github.com/fastify/fastify-bearer-auth/security/advisories/GHSA-376v-xgjx-7mfr
    reference_type:
    reference_id: GHSA-376v-xgjx-7mfr
