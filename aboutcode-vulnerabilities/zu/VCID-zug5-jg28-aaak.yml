vulnerability_id: VCID-zug5-jg28-aaak
aliases:
  - CVE-2024-42241
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/shmem: disable PMD-sized page cache if needed

  For shmem files, it's possible that PMD-sized page cache can't be
  supported by xarray.  For example, 512MB page cache on ARM64 when the base
  page size is 64KB can't be supported by xarray.  It leads to errors as the
  following messages indicate when this sort of xarray entry is split.

  WARNING: CPU: 34 PID: 7578 at lib/xarray.c:1025 xas_split_alloc+0xf8/0x128
  Modules linked in: binfmt_misc nft_fib_inet nft_fib_ipv4 nft_fib_ipv6   \
  nft_fib nft_reject_inet nf_reject_ipv4 nf_reject_ipv6 nft_reject        \
  nft_ct nft_chain_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4  \
  ip_set rfkill nf_tables nfnetlink vfat fat virtio_balloon drm fuse xfs  \
  libcrc32c crct10dif_ce ghash_ce sha2_ce sha256_arm64 sha1_ce virtio_net \
  net_failover virtio_console virtio_blk failover dimlib virtio_mmio
  CPU: 34 PID: 7578 Comm: test Kdump: loaded Tainted: G W 6.10.0-rc5-gavin+ #9
  Hardware name: QEMU KVM Virtual Machine, BIOS edk2-20240524-1.el9 05/24/2024
  pstate: 83400005 (Nzcv daif +PAN -UAO +TCO +DIT -SSBS BTYPE=--)
  pc : xas_split_alloc+0xf8/0x128
  lr : split_huge_page_to_list_to_order+0x1c4/0x720
  sp : ffff8000882af5f0
  x29: ffff8000882af5f0 x28: ffff8000882af650 x27: ffff8000882af768
  x26: 0000000000000cc0 x25: 000000000000000d x24: ffff00010625b858
  x23: ffff8000882af650 x22: ffffffdfc0900000 x21: 0000000000000000
  x20: 0000000000000000 x19: ffffffdfc0900000 x18: 0000000000000000
  x17: 0000000000000000 x16: 0000018000000000 x15: 52f8004000000000
  x14: 0000e00000000000 x13: 0000000000002000 x12: 0000000000000020
  x11: 52f8000000000000 x10: 52f8e1c0ffff6000 x9 : ffffbeb9619a681c
  x8 : 0000000000000003 x7 : 0000000000000000 x6 : ffff00010b02ddb0
  x5 : ffffbeb96395e378 x4 : 0000000000000000 x3 : 0000000000000cc0
  x2 : 000000000000000d x1 : 000000000000000c x0 : 0000000000000000
  Call trace:
   xas_split_alloc+0xf8/0x128
   split_huge_page_to_list_to_order+0x1c4/0x720
   truncate_inode_partial_folio+0xdc/0x160
   shmem_undo_range+0x2bc/0x6a8
   shmem_fallocate+0x134/0x430
   vfs_fallocate+0x124/0x2e8
   ksys_fallocate+0x4c/0xa0
   __arm64_sys_fallocate+0x24/0x38
   invoke_syscall.constprop.0+0x7c/0xd8
   do_el0_svc+0xb4/0xd0
   el0_svc+0x44/0x1d8
   el0t_64_sync_handler+0x134/0x150
   el0t_64_sync+0x17c/0x180

  Fix it by disabling PMD-sized page cache when HPAGE_PMD_ORDER is larger
  than MAX_PAGECACHE_ORDER.  As Matthew Wilcox pointed, the page cache in a
  shmem file isn't represented by a multi-index entry and doesn't have this
  limitation when the xarry entry is split until commit 6b24ca4a1a8d ("mm:
  Use multi-index entries in the page cache").
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-42241.json
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07507'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0754'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07564'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07577'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07568'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07475'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07442'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07491'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08065'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08127'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08133'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08139'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.0814'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08143'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.151'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15105'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15041'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15065'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15029'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15009'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15001'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.14832'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1488'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15059'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15038'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1503'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.15468'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.15418'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.15491'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '0.00243'
    scoring_system: epss
    scoring_elements: '0.32258'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42241
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42241
weaknesses:
  - CWE-99
  - CWE-770
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-42241.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-42241
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/93893eacb372b0a4a30f7de6609b08c3ba6c4fd9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9fd154ba926b34c833b7bfc4c14ee2e931b3d743
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cd25208ca9b0097f8e079d692fc678f36fdbc3f9
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2303509
    reference_type:
    reference_id: 2303509
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42241
    reference_type:
    reference_id: CVE-2024-42241
  - url: https://access.redhat.com/errata/RHSA-2024:10771
    reference_type:
    reference_id: RHSA-2024:10771
  - url: https://access.redhat.com/errata/RHSA-2024:6744
    reference_type:
    reference_id: RHSA-2024:6744
  - url: https://access.redhat.com/errata/RHSA-2024:6745
    reference_type:
    reference_id: RHSA-2024:6745
  - url: https://usn.ubuntu.com/7089-1/
    reference_type:
    reference_id: USN-7089-1
  - url: https://usn.ubuntu.com/7089-2/
    reference_type:
    reference_id: USN-7089-2
  - url: https://usn.ubuntu.com/7089-3/
    reference_type:
    reference_id: USN-7089-3
  - url: https://usn.ubuntu.com/7089-4/
    reference_type:
    reference_id: USN-7089-4
  - url: https://usn.ubuntu.com/7089-5/
    reference_type:
    reference_id: USN-7089-5
  - url: https://usn.ubuntu.com/7089-6/
    reference_type:
    reference_id: USN-7089-6
  - url: https://usn.ubuntu.com/7089-7/
    reference_type:
    reference_id: USN-7089-7
  - url: https://usn.ubuntu.com/7090-1/
    reference_type:
    reference_id: USN-7090-1
  - url: https://usn.ubuntu.com/7095-1/
    reference_type:
    reference_id: USN-7095-1
  - url: https://usn.ubuntu.com/7156-1/
    reference_type:
    reference_id: USN-7156-1
