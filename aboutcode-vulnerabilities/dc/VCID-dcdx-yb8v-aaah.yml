vulnerability_id: VCID-dcdx-yb8v-aaah
aliases:
  - CVE-2022-25168
  - GHSA-8wm5-8h9c-47pc
summary: Apache Hadoop's FileUtil.unTar(File, File) API does not escape the input file name
  before being passed to the shell. An attacker can inject arbitrary commands. This is only
  used in Hadoop 3.3 InMemoryAliasMap.completeBootstrapTransfer, which is only ever run by a
  local user. It has been used in Hadoop 2.x for yarn localization, which does enable remote
  code execution. It is used in Apache Spark, from the SQL command ADD ARCHIVE. As the ADD ARCHIVE
  command adds new binaries to the classpath, being able to execute shell scripts does not confer
  new permissions to the caller. SPARK-38305. "Check existence of file before untarring/zipping",
  which is included in 3.3.0, 3.1.4, 3.2.2, prevents shell commands being executed, regardless
  of which version of the hadoop libraries are in use. Users should upgrade to Apache Hadoop
  2.10.2, 3.2.4, 3.3.3 or upper (including HADOOP-18136).
severities:
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-25168.json
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78411'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78329'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78364'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78373'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78410'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78518'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78500'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78484'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78429'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78426'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78413'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00564'
    scoring_system: epss
    scoring_elements: '0.78197'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00692'
    scoring_system: epss
    scoring_elements: '0.79992'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00692'
    scoring_system: epss
    scoring_elements: '0.80139'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00692'
    scoring_system: epss
    scoring_elements: '0.79996'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.00692'
    scoring_system: epss
    scoring_elements: '0.79982'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83646'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.8323'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83225'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83217'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83612'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83625'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83649'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83659'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83667'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83658'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.8366'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83655'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83656'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83654'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83123'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83119'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83169'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83171'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83192'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83199'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83196'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83212'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.02255'
    scoring_system: epss
    scoring_elements: '0.83221'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: '0.05938'
    scoring_system: epss
    scoring_elements: '0.83964'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=2119084
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-8wm5-8h9c-47pc
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/apache/hadoop
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/hadoop
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/hadoop/commit/cae749b076f35f0be13a926ee8cfbb7ce4402746
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/hadoop/commit/cae749b076f35f0be13a926ee8cfbb7ce4402746
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.apache.org/thread/mxqnb39jfrwgs3j6phwvlrfq4mlox130
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/mxqnb39jfrwgs3j6phwvlrfq4mlox130
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-25168
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-25168
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220915-0007
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220915-0007
weaknesses:
  - CWE-88
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-25168.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-25168
    reference_type:
    reference_id:
  - url: https://github.com/apache/hadoop
    reference_type:
    reference_id:
  - url: https://github.com/apache/hadoop/commit/cae749b076f35f0be13a926ee8cfbb7ce4402746
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/mxqnb39jfrwgs3j6phwvlrfq4mlox130
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220915-0007
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220915-0007/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2119084
    reference_type:
    reference_id: 2119084
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:hadoop:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:hadoop:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-25168
    reference_type:
    reference_id: CVE-2022-25168
  - url: https://github.com/advisories/GHSA-8wm5-8h9c-47pc
    reference_type:
    reference_id: GHSA-8wm5-8h9c-47pc
