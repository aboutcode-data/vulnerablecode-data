vulnerability_id: VCID-h3s8-3h4d-gyda
aliases:
  - CVE-2023-54177
summary: "In the Linux kernel, the following vulnerability has been resolved:  quota: fix warning\
  \ in dqgrab()  There's issue as follows when do fault injection: WARNING: CPU: 1 PID: 14870\
  \ at include/linux/quotaops.h:51 dquot_disable+0x13b7/0x18c0 Modules linked in: CPU: 1 PID:\
  \ 14870 Comm: fsconfig Not tainted 6.3.0-next-20230505-00006-g5107a9c821af-dirty #541 RIP:\
  \ 0010:dquot_disable+0x13b7/0x18c0 RSP: 0018:ffffc9000acc79e0 EFLAGS: 00010246 RAX: 0000000000000000\
  \ RBX: 0000000000000000 RCX: ffff88825e41b980 RDX: 0000000000000000 RSI: ffff88825e41b980\
  \ RDI: 0000000000000002 RBP: ffff888179f68000 R08: ffffffff82087ca7 R09: 0000000000000000\
  \ R10: 0000000000000001 R11: ffffed102f3ed026 R12: ffff888179f68130 R13: ffff888179f68110\
  \ R14: dffffc0000000000 R15: ffff888179f68118 FS:  00007f450a073740(0000) GS:ffff88882fc00000(0000)\
  \ knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00007ffe96f2efd8\
  \ CR3: 000000025c8ad000 CR4: 00000000000006e0 DR0: 0000000000000000 DR1: 0000000000000000\
  \ DR2: 0000000000000000 DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\
  \ Call Trace:  <TASK>  dquot_load_quota_sb+0xd53/0x1060  dquot_resume+0x172/0x230  ext4_reconfigure+0x1dc6/0x27b0\
  \  reconfigure_super+0x515/0xa90  __x64_sys_fsconfig+0xb19/0xd20  do_syscall_64+0x39/0xb0\
  \  entry_SYSCALL_64_after_hwframe+0x63/0xcd  Above issue may happens as follows: ProcessA\
  \              ProcessB                    ProcessC sys_fsconfig   vfs_fsconfig_locked   \
  \ reconfigure_super      ext4_remount       dquot_suspend -> suspend all type quota      \
  \             sys_fsconfig                   vfs_fsconfig_locked                     reconfigure_super\
  \                      ext4_remount                       dquot_resume                   \
  \     ret = dquot_load_quota_sb                         add_dquot_ref                    \
  \                        do_open  -> open file O_RDWR                                    \
  \         vfs_open                                              do_dentry_open           \
  \                                    get_write_access                                    \
  \            atomic_inc_unless_negative(&inode->i_writecount)                            \
  \                   ext4_file_open                                                dquot_file_open\
  \                                                 dquot_initialize                       \
  \                            __dquot_initialize                                          \
  \          dqget \t\t\t\t\t\t    atomic_inc(&dquot->dq_count);                           \
  \ __dquot_initialize                            __dquot_initialize                       \
  \      dqget                              if (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags))  \
  \                              ext4_acquire_dquot \t\t\t        -> Return error DQ_ACTIVE_B\
  \ flag isn't set                          dquot_disable \t\t\t  invalidate_dquots \t\t\t \
  \  if (atomic_read(&dquot->dq_count)) \t                    dqgrab \t\t\t     WARN_ON_ONCE(!test_bit(DQ_ACTIVE_B,\
  \ &dquot->dq_flags)) \t                      -> Trigger warning  In the above scenario, 'dquot->dq_flags'\
  \ has no DQ_ACTIVE_B is normal when dqgrab(). To solve above issue just replace the dqgrab()\
  \ use in invalidate_dquots() with atomic_inc(&dquot->dq_count)."
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54177.json
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0895'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54177
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08909'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54177
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54177.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-54177
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-54177
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2426252
    reference_type:
    reference_id: 2426252
