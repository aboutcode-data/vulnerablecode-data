vulnerability_id: VCID-u9z2-55yw-tbds
aliases:
  - CVE-2024-47755
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nvdimm: Fix devs leaks in scan_labels()

  scan_labels() leaks memory when label scanning fails and it falls back
  to just creating a default "seed" namespace for userspace to configure.
  Root can force the kernel to leak memory.

  Allocate the minimum resources unconditionally and release them when
  unneeded to avoid the memory leak.

  A kmemleak reports:
  unreferenced object 0xffff88800dda1980 (size 16):
    comm "kworker/u10:5", pid 69, jiffies 4294671781
    hex dump (first 16 bytes):
      00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
    backtrace (crc 0):
      [<00000000c5dea560>] __kmalloc+0x32c/0x470
      [<000000009ed43c83>] nd_region_register_namespaces+0x6fb/0x1120 [libnvdimm]
      [<000000000e07a65c>] nd_region_probe+0xfe/0x210 [libnvdimm]
      [<000000007b79ce5f>] nvdimm_bus_probe+0x7a/0x1e0 [libnvdimm]
      [<00000000a5f3da2e>] really_probe+0xc6/0x390
      [<00000000129e2a69>] __driver_probe_device+0x78/0x150
      [<000000002dfed28b>] driver_probe_device+0x1e/0x90
      [<00000000e7048de2>] __device_attach_driver+0x85/0x110
      [<0000000032dca295>] bus_for_each_drv+0x85/0xe0
      [<00000000391c5a7d>] __device_attach+0xbe/0x1e0
      [<0000000026dabec0>] bus_probe_device+0x94/0xb0
      [<00000000c590d936>] device_add+0x656/0x870
      [<000000003d69bfaa>] nd_async_device_register+0xe/0x50 [libnvdimm]
      [<000000003f4c52a4>] async_run_entry_fn+0x2e/0x110
      [<00000000e201f4b0>] process_one_work+0x1ee/0x600
      [<000000006d90d5a9>] worker_thread+0x183/0x350
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47755.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
  - score: '2.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:57:25Z/
    published_at: None
    url: https://git.kernel.org/stable/c/18a672c62d735744c6340eb3f5e58934a5d34cf2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:57:25Z/
    published_at: None
    url: https://git.kernel.org/stable/c/45db20bdb5695d06478d35e05fb2550441bed890
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:57:25Z/
    published_at: None
    url: https://git.kernel.org/stable/c/62c2aa6b1f565d2fc1ec11a6e9e8336ce37a6426
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:57:25Z/
    published_at: None
    url: https://git.kernel.org/stable/c/939053737edb49ba5bdc5846acb45f11d15b7ab4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T12:57:25Z/
    published_at: None
    url: https://git.kernel.org/stable/c/cdf0dfb3d183bbe0d0b6a6622c53d105074ad384
weaknesses:
  - CWE-400
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47755.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47755
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47755
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/18a672c62d735744c6340eb3f5e58934a5d34cf2
    reference_type:
    reference_id: 18a672c62d735744c6340eb3f5e58934a5d34cf2
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2320252
    reference_type:
    reference_id: 2320252
  - url: https://git.kernel.org/stable/c/45db20bdb5695d06478d35e05fb2550441bed890
    reference_type:
    reference_id: 45db20bdb5695d06478d35e05fb2550441bed890
  - url: https://git.kernel.org/stable/c/62c2aa6b1f565d2fc1ec11a6e9e8336ce37a6426
    reference_type:
    reference_id: 62c2aa6b1f565d2fc1ec11a6e9e8336ce37a6426
  - url: https://git.kernel.org/stable/c/939053737edb49ba5bdc5846acb45f11d15b7ab4
    reference_type:
    reference_id: 939053737edb49ba5bdc5846acb45f11d15b7ab4
  - url: https://git.kernel.org/stable/c/cdf0dfb3d183bbe0d0b6a6622c53d105074ad384
    reference_type:
    reference_id: cdf0dfb3d183bbe0d0b6a6622c53d105074ad384
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47755
    reference_type:
    reference_id: CVE-2024-47755
