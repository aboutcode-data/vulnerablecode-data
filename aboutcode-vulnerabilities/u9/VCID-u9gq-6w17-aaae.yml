vulnerability_id: VCID-u9gq-6w17-aaae
aliases:
  - CVE-2022-4696
summary: There exists a use-after-free vulnerability in the Linux kernel through io_uring and
  the IORING_OP_SPLICE operation. If IORING_OP_SPLICE is missing the IO_WQ_WORK_FILES flag,
  which signals that the operation won't use current->nsproxy, so its reference counter is not
  increased. This assumption is not always true as calling io_splice on specific files will
  call the get_uts function which will use current->nsproxy leading to invalidly decreasing
  its reference counter later causing the use-after-free vulnerability. We recommend upgrading
  to version 5.10.160 or above
severities:
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-4696.json
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01273'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00957'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00951'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00943'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00947'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00956'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00961'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00962'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00968'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00955'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.0095'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.0129'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01304'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01295'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01294'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01302'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01291'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01289'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01279'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00949'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.00954'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.06974'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19082'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19186'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19222'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19301'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19291'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19306'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19343'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19383'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.18826'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19745'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19845'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19570'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19554'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19837'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19671'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-4696
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-4696
weaknesses:
  - CWE-763
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-4696.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-4696
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2873
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3545
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3623
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-36280
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-41218
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-45934
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4696
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47929
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0179
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0266
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0394
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-23454
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-23455
    reference_type:
    reference_id:
  - url: https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=linux-5.10.y&id=75454b4bbfc7e6a4dd8338556f36ea9107ddf61a
    reference_type:
    reference_id:
  - url: https://kernel.dance/#75454b4bbfc7e6a4dd8338556f36ea9107ddf61a
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20230223-0003/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2164424
    reference_type:
    reference_id: 2164424
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.7:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.7:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-4696
    reference_type:
    reference_id: CVE-2022-4696
