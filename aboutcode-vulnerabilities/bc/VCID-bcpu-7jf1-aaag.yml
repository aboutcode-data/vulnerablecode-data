vulnerability_id: VCID-bcpu-7jf1-aaag
aliases:
  - CVE-2021-47599
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  btrfs: use latest_dev in btrfs_show_devname

  The test case btrfs/238 reports the warning below:

   WARNING: CPU: 3 PID: 481 at fs/btrfs/super.c:2509 btrfs_show_devname+0x104/0x1e8 [btrfs]
   CPU: 2 PID: 1 Comm: systemd Tainted: G        W  O 5.14.0-rc1-custom #72
   Hardware name: QEMU QEMU Virtual Machine, BIOS 0.0.0 02/06/2015
   Call trace:
     btrfs_show_devname+0x108/0x1b4 [btrfs]
     show_mountinfo+0x234/0x2c4
     m_show+0x28/0x34
     seq_read_iter+0x12c/0x3c4
     vfs_read+0x29c/0x2c8
     ksys_read+0x80/0xec
     __arm64_sys_read+0x28/0x34
     invoke_syscall+0x50/0xf8
     do_el0_svc+0x88/0x138
     el0_svc+0x2c/0x8c
     el0t_64_sync_handler+0x84/0xe4
     el0t_64_sync+0x198/0x19c

  Reason:
  While btrfs_prepare_sprout() moves the fs_devices::devices into
  fs_devices::seed_list, the btrfs_show_devname() searches for the devices
  and found none, leading to the warning as in above.

  Fix:
  latest_dev is updated according to the changes to the device list.
  That means we could use the latest_dev->name to show the device name in
  /proc/self/mounts, the pointer will be always valid as it's assigned
  before the device is deleted from the list in remove or replace.
  The RCU protection is sufficient as the device structure is freed after
  synchronization.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47599.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03411'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03416'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03424'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03417'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03405'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03369'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0336'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0337'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03367'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03363'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03362'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03376'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03395'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03387'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04551'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04608'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04636'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04668'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04647'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04648'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0463'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04622'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04577'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04581'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04582'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04594'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04587'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.15837'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '4.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47599
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47599
weaknesses:
  - CWE-362
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47599.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47599
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47599
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6605fd2f394bba0a0059df2b6cfc87b0b6d393a2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e342c2558016ead462f376b6c6c2ac5efc17f3b1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2293227
    reference_type:
    reference_id: 2293227
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47599
    reference_type:
    reference_id: CVE-2021-47599
