vulnerability_id: VCID-wu2j-ws79-2ude
aliases:
  - CVE-2025-49011
  - GHSA-cwwm-hr97-qfxm
summary: "SpiceDB checks involving relations with caveats can result in no permission when permission\
  \ is expected\n### Impact\n\nOn schemas involving arrows with caveats on the arrow’ed relation,\
  \ when the path to resolve a CheckPermission request involves the evaluation of multiple caveated\
  \ branches, requests may return a negative response when a positive response is expected.\n\
  \nFor example, given this schema:\n\n```\ndefinition user {}\n\ndefinition office {\n\trelation\
  \ parent: office\n\trelation manager: user\n\tpermission read = manager + parent->read\n}\n\
  \ndefinition group {\n\trelation parent: office\n\tpermission read = parent->read\n}\n\ndefinition\
  \ document {\n\trelation owner: group with equals\n\tpermission read = owner->read\n}\n\n\
  caveat equals(actual string, required string) {\n\tactual == required\n}\n```\n\nand these\
  \ relationships:\n\n```\noffice:headoffice#manager@user:maria\noffice:branch1#parent@office:headoffice\n\
  group:admins#parent@office:branch1\ngroup:managers#parent@office:headoffice\ndocument:budget#owner@group:admins[equals:{\"\
  required\":\"admin\"}]\ndocument:budget#owner@group:managers[equals:{\"required\":\"manager\"\
  }]\n```\n\nPermission for `'document:budget#read@user:maria with {\"actual\" : \"admin\"}'`\
  \ is returned as NO_PERMISSION when HAS_PERMISSION is the correct answer.\n\n### Patches\n\
  Upgrade to v1.44.2.\n\n### Workarounds\nDo not use caveats in your schema over an arrow’ed\
  \ relation."
severities:
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04651'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04789'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04653'
    published_at: '2025-06-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05199'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.0735'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07838'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07097'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07071'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07134'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07241'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07066'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07135'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07158'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07188'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.0798'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07922'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07875'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07891'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07867'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07889'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.0781'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07802'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07666'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08009'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08904'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09291'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09236'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09247'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09097'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09094'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09114'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08945'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08967'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08295'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08325'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08333'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08367'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08427'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08449'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08634'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08615'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08627'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08717'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08699'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08789'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08851'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08855'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12557'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12628'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12681'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1266'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12715'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1273'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12706'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1267'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12632'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12638'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12643'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12624'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12637'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1265'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12648'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/authzed/spicedb
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authzed/spicedb
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/authzed/spicedb/commit/fe8dd9f491f6975b3408c401e413a530eb181a67
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authzed/spicedb/commit/fe8dd9f491f6975b3408c401e413a530eb181a67
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-06T18:38:07Z/
    published_at: None
    url: https://github.com/authzed/spicedb/commit/fe8dd9f491f6975b3408c401e413a530eb181a67
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/authzed/spicedb/releases/tag/v1.44.2
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authzed/spicedb/releases/tag/v1.44.2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-06T18:38:07Z/
    published_at: None
    url: https://github.com/authzed/spicedb/releases/tag/v1.44.2
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/authzed/spicedb/security/advisories/GHSA-cwwm-hr97-qfxm
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authzed/spicedb/security/advisories/GHSA-cwwm-hr97-qfxm
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-06-06T18:38:07Z/
    published_at: None
    url: https://github.com/authzed/spicedb/security/advisories/GHSA-cwwm-hr97-qfxm
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-49011
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-49011
weaknesses:
  - CWE-358
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-49011
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/commit/fe8dd9f491f6975b3408c401e413a530eb181a67
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/releases/tag/v1.44.2
    reference_type:
    reference_id:
  - url: https://github.com/authzed/spicedb/security/advisories/GHSA-cwwm-hr97-qfxm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49011
    reference_type:
    reference_id:
