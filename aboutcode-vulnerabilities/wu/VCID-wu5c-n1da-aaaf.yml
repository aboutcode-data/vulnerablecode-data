vulnerability_id: VCID-wu5c-n1da-aaaf
aliases:
  - GHSA-jq87-2wxp-8349
summary: |
  ZendFramework Route Parameter Injection Via Query String in `Zend\Mvc`
  In Zend Framework 2, `Zend\Mvc\Router\Http\Query` is used primarily to allow appending query strings to URLs when assembled. However, due to the fact that it captures any query parameters into the RouteMatch, and the fact that RouteMatch parameters are merged with any parent routes, this can lead to overriding already captured routing parameters, bypassing constraints defined in the parents.

  As an example, consider the following route definition:
  ```
  array(
      'user' => array(
          'type' => 'segment',
          'options' => array(
              'route' => '/user/:key',
              'defaults' => array(
                  'controller' => 'UserController',
                  'action'     => 'show-action',
              ),
              'constraints' => array(
                  'key' => '[a-z0-9]+',
              ),
          ),
          'child_routes' => array(
              'query' => array('type' => 'query'),
          ),
      ),
  )
  ```
  If the request URI was /user/foo/?controller=SecretController&key=invalid_value, the RouteMatch returned after routing would contain the following:
  ```
  array(
      'controller' => 'SecretController',
      'action'     => 'show-action',
      'key'        => 'invalid_value',
  )
  ```
  This would lead to execution of a different controller than intended, with a value for the key parameter that bypassed the constraints outlined in the parent route.
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://framework.zend.com/security/advisory/ZF2013-01
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://framework.zend.com/security/advisory/ZF2013-01
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-jq87-2wxp-8349
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/zendframework/zendframework/ZF2013-01.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/zendframework/zendframework/ZF2013-01.yaml
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/zendframework/zendframework
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zendframework/zendframework
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/zendframework/zendframework/commit/0a7ec3407f02db29ea2ffd6daa71ead6fd151cfe
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zendframework/zendframework/commit/0a7ec3407f02db29ea2ffd6daa71ead6fd151cfe
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/zendframework/zendframework/commit/7fcb88ebc2d56f74aa943909f2b6b53f5c86b081
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zendframework/zendframework/commit/7fcb88ebc2d56f74aa943909f2b6b53f5c86b081
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-74
references:
  - url: https://framework.zend.com/security/advisory/ZF2013-01
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/zendframework/zendframework/ZF2013-01.yaml
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework/commit/0a7ec3407f02db29ea2ffd6daa71ead6fd151cfe
    reference_type:
    reference_id:
  - url: https://github.com/zendframework/zendframework/commit/7fcb88ebc2d56f74aa943909f2b6b53f5c86b081
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-jq87-2wxp-8349
    reference_type:
    reference_id: GHSA-jq87-2wxp-8349
