vulnerability_id: VCID-sf38-dvkp-qba2
aliases:
  - CVE-2024-53125
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: sync_linked_regs() must preserve subreg_def

  Range propagation must not affect subreg_def marks, otherwise the
  following example is rewritten by verifier incorrectly when
  BPF_F_TEST_RND_HI32 flag is set:

    0: call bpf_ktime_get_ns                   call bpf_ktime_get_ns
    1: r0 &= 0x7fffffff       after verifier   r0 &= 0x7fffffff
    2: w1 = w0                rewrites         w1 = w0
    3: if w0 < 10 goto +0     -------------->  r11 = 0x2f5674a6     (r)
    4: r1 >>= 32                               r11 <<= 32           (r)
    5: r0 = r1                                 r1 |= r11            (r)
    6: exit;                                   if w0 < 0xa goto pc+0
                                               r1 >>= 32
                                               r0 = r1
                                               exit

  (or zero extension of w1 at (2) is missing for architectures that
   require zero extension for upper register half).

  The following happens w/o this patch:
  - r0 is marked as not a subreg at (0);
  - w1 is marked as subreg at (2);
  - w1 subreg_def is overridden at (3) by copy_register_state();
  - w1 is read at (5) but mark_insn_zext() does not mark (2)
    for zero extension, because w1 subreg_def is not set;
  - because of BPF_F_TEST_RND_HI32 flag verifier inserts random
    value for hi32 bits of (2) (marked (r));
  - this random value is read at (5).
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53125.json
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53125.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11891'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12225'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.09695'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.16632'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.16608'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.1659'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.16434'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.16489'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26163'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26143'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.2613'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26133'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26138'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26159'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26141'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26127'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.2612'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22265'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22218'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22178'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22197'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22216'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22246'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22227'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22183'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22169'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.22142'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26051'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26117'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.26156'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.262'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-682
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53125.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-53125
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-53125
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/60fd3538d2a8fd44c41d25088c0ece3e1fd30659
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b57ac2d92c1f565743f6890a5b9cf317ed856b09
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bfe9446ea1d95f6cb7848da19dfd58d2eec6fd84
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dadf82c1b2608727bcc306843b540cd7414055a7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e2ef0f317a52e678fe8fa84b94d6a15b466d6ff0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e9bd9c498cb0f5843996dbe5cbce7a1836a83c70
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2330351
    reference_type:
    reference_id: 2330351
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-53125
    reference_type:
    reference_id: CVE-2024-53125
  - url: https://usn.ubuntu.com/7276-1/
    reference_type:
    reference_id: USN-7276-1
  - url: https://usn.ubuntu.com/7277-1/
    reference_type:
    reference_id: USN-7277-1
  - url: https://usn.ubuntu.com/7310-1/
    reference_type:
    reference_id: USN-7310-1
  - url: https://usn.ubuntu.com/7387-1/
    reference_type:
    reference_id: USN-7387-1
  - url: https://usn.ubuntu.com/7387-2/
    reference_type:
    reference_id: USN-7387-2
  - url: https://usn.ubuntu.com/7387-3/
    reference_type:
    reference_id: USN-7387-3
  - url: https://usn.ubuntu.com/7388-1/
    reference_type:
    reference_id: USN-7388-1
  - url: https://usn.ubuntu.com/7389-1/
    reference_type:
    reference_id: USN-7389-1
  - url: https://usn.ubuntu.com/7390-1/
    reference_type:
    reference_id: USN-7390-1
  - url: https://usn.ubuntu.com/7407-1/
    reference_type:
    reference_id: USN-7407-1
  - url: https://usn.ubuntu.com/7421-1/
    reference_type:
    reference_id: USN-7421-1
  - url: https://usn.ubuntu.com/7458-1/
    reference_type:
    reference_id: USN-7458-1
  - url: https://usn.ubuntu.com/7459-1/
    reference_type:
    reference_id: USN-7459-1
  - url: https://usn.ubuntu.com/7459-2/
    reference_type:
    reference_id: USN-7459-2
