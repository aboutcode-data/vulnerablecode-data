vulnerability_id: VCID-sf35-p9m4-fyek
aliases:
  - CVE-2022-48884
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/mlx5: Fix command stats access after free

  Command may fail while driver is reloading and can't accept FW commands
  till command interface is reinitialized. Such command failure is being
  logged to command stats. This results in NULL pointer access as command
  stats structure is being freed and reallocated during mlx5 devlink
  reload (see kernel log below).

  Fix it by making command stats statically allocated on driver probe.

  Kernel log:
  [ 2394.808802] BUG: unable to handle kernel paging request at 000000000002a9c0
  [ 2394.810610] PGD 0 P4D 0
  [ 2394.811811] Oops: 0002 [#1] SMP NOPTI
  ...
  [ 2394.815482] RIP: 0010:native_queued_spin_lock_slowpath+0x183/0x1d0
  ...
  [ 2394.829505] Call Trace:
  [ 2394.830667]  _raw_spin_lock_irq+0x23/0x26
  [ 2394.831858]  cmd_status_err+0x55/0x110 [mlx5_core]
  [ 2394.833020]  mlx5_access_reg+0xe7/0x150 [mlx5_core]
  [ 2394.834175]  mlx5_query_port_ptys+0x78/0xa0 [mlx5_core]
  [ 2394.835337]  mlx5e_ethtool_get_link_ksettings+0x74/0x590 [mlx5_core]
  [ 2394.836454]  ? kmem_cache_alloc_trace+0x140/0x1c0
  [ 2394.837562]  __rh_call_get_link_ksettings+0x33/0x100
  [ 2394.838663]  ? __rtnl_unlock+0x25/0x50
  [ 2394.839755]  __ethtool_get_link_ksettings+0x72/0x150
  [ 2394.840862]  duplex_show+0x6e/0xc0
  [ 2394.841963]  dev_attr_show+0x1c/0x40
  [ 2394.843048]  sysfs_kf_seq_show+0x9b/0x100
  [ 2394.844123]  seq_read+0x153/0x410
  [ 2394.845187]  vfs_read+0x91/0x140
  [ 2394.846226]  ksys_read+0x4f/0xb0
  [ 2394.847234]  do_syscall_64+0x5b/0x1a0
  [ 2394.848228]  entry_SYSCALL_64_after_hwframe+0x65/0xca
severities:
  - score: '6.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48884.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48884.json
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10099'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07922'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07926'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07962'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07961'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07964'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07969'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.0798'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.0799'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07978'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07951'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07938'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07896'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10047'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10207'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10274'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10261'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10243'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10164'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10153'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10147'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10149'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07773'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07749'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07903'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10407'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10464'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10486'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.24061'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
  - score: 7
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48884
weaknesses:
  - CWE-476
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48884.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-48884
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/da2e552b469a0cd130ff70a88ccc4139da428a65
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ddf458641a511e7dff19f3bf0cbbc5dd9fe08ce5
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2306405
    reference_type:
    reference_id: 2306405
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48884
    reference_type:
    reference_id: CVE-2022-48884
  - url: https://access.redhat.com/errata/RHSA-2023:2458
    reference_type:
    reference_id: RHSA-2023:2458
  - url: https://access.redhat.com/errata/RHSA-2023:2951
    reference_type:
    reference_id: RHSA-2023:2951
