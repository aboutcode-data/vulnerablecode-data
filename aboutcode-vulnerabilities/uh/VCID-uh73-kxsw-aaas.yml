vulnerability_id: VCID-uh73-kxsw-aaas
aliases:
  - CVE-2024-38374
  - GHSA-683x-4444-jxh8
summary: |
  Improper Restriction of XML External Entity Reference in org.cyclonedx:cyclonedx-core-java
  ### Impact

  Before deserializing CycloneDX Bill of Materials in XML format, _cyclonedx-core-java_ leverages XPath expressions to determine the schema version of the BOM. The `DocumentBuilderFactory` used to evaluate XPath expressions was not configured securely, making the library vulnerable to XML External Entity (XXE) injection.

  XXE injection can be exploited to exfiltrate local file content, or perform Server Side Request Forgery (SSRF) to access infrastructure adjacent to the vulnerable application.

  ### PoC

  ```java
  import org.cyclonedx.parsers.XmlParser;

  class Poc {

      public static void main(String[] args) {
          // Will throw org.cyclonedx.exception.ParseException: java.net.ConnectException: Connection refused
          new XmlParser().parse("""
              <?xml version="1.0" encoding="UTF-8"?>
              <!DOCTYPE bom [<!ENTITY % sp SYSTEM "https://localhost:1010/does-not-exist/file.dtd"> %sp;]>
              <bom xmlns="http://cyclonedx.org/schema/bom/1.5"/>
              """.getBytes());
      }

  }
  ```

  ### Patches

  The vulnerability has been fixed in _cyclonedx-core-java_ version 0.9.4.

  ### Workarounds

  If feasible, applications can reject XML documents before handing them to _cyclonedx-core-java_ for parsing.
  This may be an option if incoming CycloneDX BOMs are known to be in JSON format.

  ### References

  * Issue was fixed via <https://github.com/CycloneDX/cyclonedx-core-java/pull/434>
  * Issue was introduced via <https://github.com/CycloneDX/cyclonedx-core-java/commit/162aa594f347b3f612fe0a45071693c3cd398ce9>
  * <https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing>
  * <https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#xpathexpression>
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-38374.json
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20420'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20121'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19666'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19683'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19713'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19750'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20031'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20101'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20198'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20129'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20097'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19187'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19462'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19565'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19601'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19675'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.32267'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.32219'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.32183'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.32181'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.322'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.32272'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.32182'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.32096'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.32159'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35324'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35359'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.3534'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35302'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35351'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44997'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44879'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44852'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44983'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44992'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45003'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45016'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.4496'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44984'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45025'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45032'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45002'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.4499'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00265'
    scoring_system: epss
    scoring_elements: '0.47169'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: '0.00475'
    scoring_system: epss
    scoring_elements: '0.47753'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-683x-4444-jxh8
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/CycloneDX/cyclonedx-core-java
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/CycloneDX/cyclonedx-core-java
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/CycloneDX/cyclonedx-core-java/pull/434
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/CycloneDX/cyclonedx-core-java/pull/434
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/CycloneDX/cyclonedx-core-java/pull/434/commits/ab0bc9c530d24f737970dbd0287d1190b129853d
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/CycloneDX/cyclonedx-core-java/pull/434/commits/ab0bc9c530d24f737970dbd0287d1190b129853d
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/CycloneDX/cyclonedx-core-java/security/advisories/GHSA-683x-4444-jxh8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/CycloneDX/cyclonedx-core-java/security/advisories/GHSA-683x-4444-jxh8
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-38374
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-38374
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-611
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-38374.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-38374
    reference_type:
    reference_id:
  - url: https://github.com/CycloneDX/cyclonedx-core-java
    reference_type:
    reference_id:
  - url: https://github.com/CycloneDX/cyclonedx-core-java/pull/434
    reference_type:
    reference_id:
  - url: https://github.com/CycloneDX/cyclonedx-core-java/pull/434/commits/ab0bc9c530d24f737970dbd0287d1190b129853d
    reference_type:
    reference_id:
  - url: https://github.com/CycloneDX/cyclonedx-core-java/security/advisories/GHSA-683x-4444-jxh8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-38374
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2294737
    reference_type:
    reference_id: 2294737
  - url: https://github.com/advisories/GHSA-683x-4444-jxh8
    reference_type:
    reference_id: GHSA-683x-4444-jxh8
