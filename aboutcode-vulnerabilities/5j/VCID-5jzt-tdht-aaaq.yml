vulnerability_id: VCID-5jzt-tdht-aaaq
aliases:
  - CVE-2018-16872
summary: A flaw was found in qemu Media Transfer Protocol (MTP). The code opening files in usb_mtp_get_object
  and usb_mtp_get_partial_object and directories in usb_mtp_object_readdir doesn't consider
  that the underlying filesystem may have changed since the time lstat(2) was called in usb_mtp_object_alloc,
  a classical TOCTTOU problem. An attacker with write access to the host filesystem shared with
  a guest can use this property to navigate the host filesystem in the context of the QEMU process
  and read any file the QEMU process has access to. Access to the filesystem may be local or
  via a network share protocol such as CIFS.
severities:
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-16872.html
  - score: '5.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2018-16872.json
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.3424'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.34264'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.34291'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.49796'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50215'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50139'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50118'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50043'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50487'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50431'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50393'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50240'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50214'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50198'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.50208'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00160'
    scoring_system: epss
    scoring_elements: '0.53245'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00160'
    scoring_system: epss
    scoring_elements: '0.52962'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00160'
    scoring_system: epss
    scoring_elements: '0.52950'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00160'
    scoring_system: epss
    scoring_elements: '0.52923'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.40042'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.35958'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36085'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36102'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36103'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36127'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36093'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36057'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36069'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36098'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36129'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36066'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.36045'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.39868'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.39939'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.40002'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.40038'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.39938'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.39933'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.39944'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.39932'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.39948'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00177'
    scoring_system: epss
    scoring_elements: '0.35994'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: '0.00595'
    scoring_system: epss
    scoring_elements: '0.52788'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
  - score: low
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1656114
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11806
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12617
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16872
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-17958
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18849
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18954
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19364
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19489
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12155
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3812
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6778
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9824
  - score: 5
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.gnu.org/archive/html/qemu-devel/2018-12/msg03135.html
  - score: '3.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-16872
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-16872
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-16872
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-3923-1
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.openwall.com/lists/oss-security/2018/12/13/11
weaknesses:
  - CWE-367
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2019-03/msg00042.html
    reference_type:
    reference_id:
  - url: http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-16872.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2018-16872.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2018-16872
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-16872
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11806
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12617
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16872
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-17958
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18849
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18954
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19364
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19489
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12155
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3812
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6778
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9824
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2019/02/msg00041.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CGCFIFSIWUREEQQOZDZFBYKWZHXCWBZN/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KJMTVGDLA654HNCDGLCUEIP36SNJEKK7/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CGCFIFSIWUREEQQOZDZFBYKWZHXCWBZN/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KJMTVGDLA654HNCDGLCUEIP36SNJEKK7/
    reference_type:
    reference_id:
  - url: https://lists.gnu.org/archive/html/qemu-devel/2018-12/msg03135.html
    reference_type:
    reference_id:
  - url: https://seclists.org/bugtraq/2019/May/76
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3923-1
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3923-1/
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2019/dsa-4454
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2018/12/13/11
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/106212
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1656114
    reference_type:
    reference_id: 1656114
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916397
    reference_type:
    reference_id: 916397
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:qemu:qemu:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:qemu:qemu:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.10:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.10:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:29:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:29:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:30:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:30:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:opensuse:leap:42.3:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:opensuse:leap:42.3:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-16872
    reference_type:
    reference_id: CVE-2018-16872
