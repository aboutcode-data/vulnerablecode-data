vulnerability_id: VCID-5jek-3gpa-aaan
aliases:
  - CVE-2024-5478
  - GHSA-rpx8-fg6w-rm6x
summary: A Cross-site Scripting (XSS) vulnerability exists in the SAML metadata endpoint `/auth/saml/${org?.id}/metadata`
  of lunary-ai/lunary version 1.2.7. The vulnerability arises due to the application's failure
  to escape or validate the `orgId` parameter supplied by the user before incorporating it into
  the generated response. Specifically, the endpoint generates XML responses for SAML metadata,
  where the `orgId` parameter is directly embedded into the XML structure without proper sanitization
  or validation. This flaw allows an attacker to inject arbitrary JavaScript code into the generated
  SAML metadata page, leading to potential theft of user cookies or authentication tokens.
severities:
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18678'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18990'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19064'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19167'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18853'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18823'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18826'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18047'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19104'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18346'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18445'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18477'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18566'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18559'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18577'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18616'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29812'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29684'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29712'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29742'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29762'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29744'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29737'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29738'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29776'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29711'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29794'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.2986'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29861'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.29746'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.37847'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.37884'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40804'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40783'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40803'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40821'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40849'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40846'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40822'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40782'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40829'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40807'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.4081'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00211'
    scoring_system: epss
    scoring_elements: '0.40801'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: '0.00258'
    scoring_system: epss
    scoring_elements: '0.33451'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-rpx8-fg6w-rm6x
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/lunary-ai/lunary
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lunary-ai/lunary
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/lunary-ai/lunary/blob/main/packages/backend/src/api/v1/auth/saml.ts#L34
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lunary-ai/lunary/blob/main/packages/backend/src/api/v1/auth/saml.ts#L34
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://huntr.com/bounties/e899f496-d493-4c06-b596-cb0a88ad451b
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://huntr.com/bounties/e899f496-d493-4c06-b596-cb0a88ad451b
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-5478
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-5478
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-5478
    reference_type:
    reference_id:
  - url: https://github.com/lunary-ai/lunary
    reference_type:
    reference_id:
  - url: https://github.com/lunary-ai/lunary/blob/main/packages/backend/src/api/v1/auth/saml.ts#L34
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/e899f496-d493-4c06-b596-cb0a88ad451b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:lunary:lunary:1.2.7:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:lunary:lunary:1.2.7:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5478
    reference_type:
    reference_id: CVE-2024-5478
  - url: https://github.com/advisories/GHSA-rpx8-fg6w-rm6x
    reference_type:
    reference_id: GHSA-rpx8-fg6w-rm6x
