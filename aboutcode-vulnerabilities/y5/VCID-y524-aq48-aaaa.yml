vulnerability_id: VCID-y524-aq48-aaaa
aliases:
  - CVE-2021-40823
  - GHSA-23cm-x6j7-6hq3
summary: A logic error in the room key sharing functionality of matrix-js-sdk (aka Matrix Javascript
  SDK) before 12.4.1 allows a malicious Matrix homeserver present in an encrypted room to steal
  room encryption keys (via crafted Matrix protocol messages) that were originally sent by affected
  Matrix clients participating in that room. This allows the homeserver to decrypt end-to-end
  encrypted messages sent by affected clients.
severities:
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37185'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37310'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.36837'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37113'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37216'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37698'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37620'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37559'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37352'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37338'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37319'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37306'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.38156'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.37825'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.37862'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.37855'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49266'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.4675'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.4673'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49253'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49302'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.4936'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.4938'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49378'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49292'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49298'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49315'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49333'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49332'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49345'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49323'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.49297'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46619'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.4659'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46727'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46731'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46747'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46759'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46741'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46705'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46729'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46753'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46777'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46791'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00261'
    scoring_system: epss
    scoring_elements: '0.46761'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: '0.00547'
    scoring_system: epss
    scoring_elements: '0.50959'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-23cm-x6j7-6hq3
  - score: '4.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:N/I:N/A:L
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/commit/894c24880da0e1cc81818f51c0db80e3c9fb2be9
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/commit/894c24880da0e1cc81818f51c0db80e3c9fb2be9
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/releases/tag/v12.4.1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/releases/tag/v12.4.1
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-23cm-x6j7-6hq3
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40823
  - score: '5.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40823
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40823
  - score: High
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2377
weaknesses:
  - CWE-327
  - CWE-937
  - CWE-1035
  - CWE-290
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-40823
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40823
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-js-sdk
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-js-sdk/commit/894c24880da0e1cc81818f51c0db80e3c9fb2be9
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-js-sdk/releases/tag/v12.4.1
    reference_type:
    reference_id:
  - url: https://matrix.org/blog/2021/09/13/vulnerability-disclosure-key-sharing
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=866502
    reference_type:
    reference_id: 866502
  - url: https://security.archlinux.org/ASA-202109-4
    reference_type:
    reference_id: ASA-202109-4
  - url: https://security.archlinux.org/ASA-202109-5
    reference_type:
    reference_id: ASA-202109-5
  - url: https://security.archlinux.org/AVG-2377
    reference_type:
    reference_id: AVG-2377
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:javascript_sdk:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:javascript_sdk:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-40823
    reference_type:
    reference_id: CVE-2021-40823
  - url: https://github.com/advisories/GHSA-23cm-x6j7-6hq3
    reference_type:
    reference_id: GHSA-23cm-x6j7-6hq3
  - url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-23cm-x6j7-6hq3
    reference_type:
    reference_id: GHSA-23cm-x6j7-6hq3
