vulnerability_id: VCID-xjcr-1rad-aaah
aliases:
  - CVE-2021-47014
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/sched: act_ct: fix wild memory access when clearing fragments

  while testing re-assembly/re-fragmentation using act_ct, it's possible to
  observe a crash like the following one:

   KASAN: maybe wild-memory-access in range [0x0001000000000448-0x000100000000044f]
   CPU: 50 PID: 0 Comm: swapper/50 Tainted: G S                5.12.0-rc7+ #424
   Hardware name: Dell Inc. PowerEdge R730/072T6D, BIOS 2.4.3 01/17/2017
   RIP: 0010:inet_frag_rbtree_purge+0x50/0xc0
   Code: 00 fc ff df 48 89 c3 31 ed 48 89 df e8 a9 7a 38 ff 4c 89 fe 48 89 df 49 89 c6 e8 5b 3a 38 ff 48 8d 7b 40 48 89 f8 48 c1 e8 03 <42> 80 3c 20 00 75 59 48 8d bb d0 00 00 00 4c 8b 6b 40 48 89 f8 48
   RSP: 0018:ffff888c31449db8 EFLAGS: 00010203
   RAX: 0000200000000089 RBX: 000100000000040e RCX: ffffffff989eb960
   RDX: 0000000000000140 RSI: ffffffff97cfb977 RDI: 000100000000044e
   RBP: 0000000000000900 R08: 0000000000000000 R09: ffffed1186289350
   R10: 0000000000000003 R11: ffffed1186289350 R12: dffffc0000000000
   R13: 000100000000040e R14: 0000000000000000 R15: ffff888155e02160
   FS:  0000000000000000(0000) GS:ffff888c31440000(0000) knlGS:0000000000000000
   CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
   CR2: 00005600cb70a5b8 CR3: 0000000a2c014005 CR4: 00000000003706e0
   DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
   DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
   Call Trace:
    <IRQ>
    inet_frag_destroy+0xa9/0x150
    call_timer_fn+0x2d/0x180
    run_timer_softirq+0x4fe/0xe70
    __do_softirq+0x197/0x5a0
    irq_exit_rcu+0x1de/0x200
    sysvec_apic_timer_interrupt+0x6b/0x80
    </IRQ>

  when act_ct temporarily stores an IP fragment, restoring the skb qdisc cb
  results in putting random data in FRAG_CB(), and this causes those "wild"
  memory accesses later, when the rbtree is purged. Never overwrite the skb
  cb in case tcf_ct_handle_fragments() returns -EINPROGRESS.
severities:
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47014.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0292'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02921'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0294'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02929'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02353'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02357'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02359'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02399'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0242'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02416'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02404'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02397'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02917'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02948'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02941'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02902'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02906'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02897'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02896'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02882'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0288'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.1824'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.18266'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.18249'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.18223'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.18205'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.18057'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.18093'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.36936'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47014
weaknesses:
  - CWE-754
  - CWE-119
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47014.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47014
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47014
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0648941f4c8bbf8b4b6c0b270889ae7aa769b921
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f77bd544a6bbe69aa50d9ed09f13494cf36ff806
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2266738
    reference_type:
    reference_id: 2266738
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47014
    reference_type:
    reference_id: CVE-2021-47014
