vulnerability_id: VCID-ju2h-68a7-aaam
aliases:
  - CVE-2024-27070
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  f2fs: fix to avoid use-after-free issue in f2fs_filemap_fault

  syzbot reports a f2fs bug as below:

  BUG: KASAN: slab-use-after-free in f2fs_filemap_fault+0xd1/0x2c0 fs/f2fs/file.c:49
  Read of size 8 at addr ffff88807bb22680 by task syz-executor184/5058

  CPU: 0 PID: 5058 Comm: syz-executor184 Not tainted 6.7.0-syzkaller-09928-g052d534373b7 #0
  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 11/17/2023
  Call Trace:
   <TASK>
   __dump_stack lib/dump_stack.c:88 [inline]
   dump_stack_lvl+0x1e7/0x2d0 lib/dump_stack.c:106
   print_address_description mm/kasan/report.c:377 [inline]
   print_report+0x163/0x540 mm/kasan/report.c:488
   kasan_report+0x142/0x170 mm/kasan/report.c:601
   f2fs_filemap_fault+0xd1/0x2c0 fs/f2fs/file.c:49
   __do_fault+0x131/0x450 mm/memory.c:4376
   do_shared_fault mm/memory.c:4798 [inline]
   do_fault mm/memory.c:4872 [inline]
   do_pte_missing mm/memory.c:3745 [inline]
   handle_pte_fault mm/memory.c:5144 [inline]
   __handle_mm_fault+0x23b7/0x72b0 mm/memory.c:5285
   handle_mm_fault+0x27e/0x770 mm/memory.c:5450
   do_user_addr_fault arch/x86/mm/fault.c:1364 [inline]
   handle_page_fault arch/x86/mm/fault.c:1507 [inline]
   exc_page_fault+0x456/0x870 arch/x86/mm/fault.c:1563
   asm_exc_page_fault+0x26/0x30 arch/x86/include/asm/idtentry.h:570

  The root cause is: in f2fs_filemap_fault(), vmf->vma may be not alive after
  filemap_fault(), so it may cause use-after-free issue when accessing
  vmf->vma->vm_flags in trace_f2fs_filemap_fault(). So it needs to keep vm_flags
  in separated temporary variable for tracepoint use.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-27070.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18368'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1814'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18214'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18314'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18389'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1838'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18365'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18339'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18332'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18344'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1835'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18371'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18376'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18369'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.2099'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.2095'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20938'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20911'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.2093'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20948'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20989'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20849'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20799'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20952'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.2097'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20986'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20983'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20942'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.2091'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.40637'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-27070
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-27070.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-27070
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8186e16a766d709a08f188d2f4e84098f364bea1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eb70d5a6c932d9d23f4bb3e7b83782c21ac4b064
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2278511
    reference_type:
    reference_id: 2278511
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-27070
    reference_type:
    reference_id: CVE-2024-27070
  - url: https://usn.ubuntu.com/6816-1/
    reference_type:
    reference_id: USN-6816-1
  - url: https://usn.ubuntu.com/6817-1/
    reference_type:
    reference_id: USN-6817-1
  - url: https://usn.ubuntu.com/6817-2/
    reference_type:
    reference_id: USN-6817-2
  - url: https://usn.ubuntu.com/6817-3/
    reference_type:
    reference_id: USN-6817-3
  - url: https://usn.ubuntu.com/6878-1/
    reference_type:
    reference_id: USN-6878-1
