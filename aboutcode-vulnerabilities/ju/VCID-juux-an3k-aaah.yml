vulnerability_id: VCID-juux-an3k-aaah
aliases:
  - CVE-2023-30628
  - GHSA-cw6r-6ccx-5hwx
  - PYSEC-2023-273
summary: |
  Kiwi TCMS is an open source test management system. In kiwitcms/Kiwi v12.2 and prior and kiwitcms/enterprise v12.2 and prior,
  the `changelog.yml` workflow is vulnerable to command injection attacks because of using an untrusted `github.head_ref` field. The `github.head_ref` value is an attacker-controlled value. Assigning the value to `zzz";echo${IFS}"hello";#` can lead to command injection. Since the permission is not restricted, the attacker has a write-access to the repository. Commit 834c86dfd1b2492ccad7ebbfd6304bfec895fed2 of the kiwitcms/Kiwi repository and commit e39f7e156fdaf6fec09a15ea6f4e8fec8cdbf751 of the kiwitcms/enterprise repository contain a fix for this issue.
severities:
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84049'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01298'
    scoring_system: epss
    scoring_elements: '0.86397'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01298'
    scoring_system: epss
    scoring_elements: '0.86400'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01298'
    scoring_system: epss
    scoring_elements: '0.86407'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01298'
    scoring_system: epss
    scoring_elements: '0.86376'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01298'
    scoring_system: epss
    scoring_elements: '0.86370'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01298'
    scoring_system: epss
    scoring_elements: '0.86350'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01577'
    scoring_system: epss
    scoring_elements: '0.87812'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01577'
    scoring_system: epss
    scoring_elements: '0.87800'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.81826'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.81781'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.81843'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.81845'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.81833'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.81829'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.8183'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.81828'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.81835'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.81848'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.8184'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01816'
    scoring_system: epss
    scoring_elements: '0.818'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01997'
    scoring_system: epss
    scoring_elements: '0.89323'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.01997'
    scoring_system: epss
    scoring_elements: '0.89309'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.06028'
    scoring_system: epss
    scoring_elements: '0.93414'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.06028'
    scoring_system: epss
    scoring_elements: '0.93420'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.06557'
    scoring_system: epss
    scoring_elements: '0.93702'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.08450'
    scoring_system: epss
    scoring_elements: '0.94418'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92683'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92672'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92664'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92687'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92681'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92674'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92673'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92676'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92668'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.10774'
    scoring_system: epss
    scoring_elements: '0.92669'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '0.19846'
    scoring_system: epss
    scoring_elements: '0.9258'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/kiwitcms/enterprise/commit/e39f7e156fdaf6fec09a15ea6f4e8fec8cdbf751
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-03T20:56:03Z/
    published_at: None
    url: https://github.com/kiwitcms/enterprise/commit/e39f7e156fdaf6fec09a15ea6f4e8fec8cdbf751
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/kiwitcms/Kiwi/blob/37bfb87696093ce0393160e2725949185cc0651d/.github/workflows/changelog.yml#L18
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-03T20:56:03Z/
    published_at: None
    url: https://github.com/kiwitcms/Kiwi/blob/37bfb87696093ce0393160e2725949185cc0651d/.github/workflows/changelog.yml#L18
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/kiwitcms/Kiwi/commit/834c86dfd1b2492ccad7ebbfd6304bfec895fed2
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-03T20:56:03Z/
    published_at: None
    url: https://github.com/kiwitcms/Kiwi/commit/834c86dfd1b2492ccad7ebbfd6304bfec895fed2
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-cw6r-6ccx-5hwx
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-03T20:56:03Z/
    published_at: None
    url: https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-cw6r-6ccx-5hwx
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-30628
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-30628
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://securitylab.github.com/research/github-actions-untrusted-input/
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-03T20:56:03Z/
    published_at: None
    url: https://securitylab.github.com/research/github-actions-untrusted-input/
weaknesses:
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-30628
    reference_type:
    reference_id:
  - url: https://github.com/kiwitcms/enterprise/commit/e39f7e156fdaf6fec09a15ea6f4e8fec8cdbf751
    reference_type:
    reference_id:
  - url: https://github.com/kiwitcms/Kiwi/blob/37bfb87696093ce0393160e2725949185cc0651d/.github/workflows/changelog.yml#L18
    reference_type:
    reference_id:
  - url: https://github.com/kiwitcms/Kiwi/commit/834c86dfd1b2492ccad7ebbfd6304bfec895fed2
    reference_type:
    reference_id:
  - url: https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-cw6r-6ccx-5hwx
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/research/github-actions-untrusted-input/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:kiwitcms:kiwi_tcms:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:kiwitcms:kiwi_tcms:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-30628
    reference_type:
    reference_id: CVE-2023-30628
