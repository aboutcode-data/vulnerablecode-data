vulnerability_id: VCID-yu15-xd3j-87fb
aliases:
  - CVE-2025-39767
summary: "In the Linux kernel, the following vulnerability has been resolved:  LoongArch: Optimize\
  \ module load time by optimizing PLT/GOT counting  When enabling CONFIG_KASAN, CONFIG_PREEMPT_VOLUNTARY_BUILD\
  \ and CONFIG_PREEMPT_VOLUNTARY at the same time, there will be soft deadlock, the relevant\
  \ logs are as follows:  rcu: INFO: rcu_sched self-detected stall on CPU ... Call Trace: [<900000000024f9e4>]\
  \ show_stack+0x5c/0x180 [<90000000002482f4>] dump_stack_lvl+0x94/0xbc [<9000000000224544>]\
  \ rcu_dump_cpu_stacks+0x1fc/0x280 [<900000000037ac80>] rcu_sched_clock_irq+0x720/0xf88 [<9000000000396c34>]\
  \ update_process_times+0xb4/0x150 [<90000000003b2474>] tick_nohz_handler+0xf4/0x250 [<9000000000397e28>]\
  \ __hrtimer_run_queues+0x1d0/0x428 [<9000000000399b2c>] hrtimer_interrupt+0x214/0x538 [<9000000000253634>]\
  \ constant_timer_interrupt+0x64/0x80 [<9000000000349938>] __handle_irq_event_percpu+0x78/0x1a0\
  \ [<9000000000349a78>] handle_irq_event_percpu+0x18/0x88 [<9000000000354c00>] handle_percpu_irq+0x90/0xf0\
  \ [<9000000000348c74>] handle_irq_desc+0x94/0xb8 [<9000000001012b28>] handle_cpu_irq+0x68/0xa0\
  \ [<9000000001def8c0>] handle_loongarch_irq+0x30/0x48 [<9000000001def958>] do_vint+0x80/0xd0\
  \ [<9000000000268a0c>] kasan_mem_to_shadow.part.0+0x2c/0x2a0 [<90000000006344f4>] __asan_load8+0x4c/0x120\
  \ [<900000000025c0d0>] module_frob_arch_sections+0x5c8/0x6b8 [<90000000003895f0>] load_module+0x9e0/0x2958\
  \ [<900000000038b770>] __do_sys_init_module+0x208/0x2d0 [<9000000001df0c34>] do_syscall+0x94/0x190\
  \ [<900000000024d6fc>] handle_syscall+0xbc/0x158  After analysis, this is because the slow\
  \ speed of loading the amdgpu module leads to the long time occupation of the cpu and then\
  \ the soft deadlock.  When loading a module, module_frob_arch_sections() tries to figure out\
  \ the number of PLTs/GOTs that will be needed to handle all the RELAs. It will call the count_max_entries()\
  \ to find in an out-of-order date which counting algorithm has O(n^2) complexity.  To make\
  \ it faster, we sort the relocation list by info and addend. That way, to check for a duplicate\
  \ relocation, it just needs to compare with the previous entry. This reduces the complexity\
  \ of the algorithm to O(n  log n), as done in commit d4e0340919fb (\"arm64/module: Optimize\
  \ module load time by optimizing PLT counting\"). This gives sinificant reduction in module\
  \ load time for modules with large number of relocations.  After applying this patch, the\
  \ soft deadlock problem has been solved, and the kernel starts normally without \"Call Trace\"\
  .  Using the default configuration to test some modules, the results are as follows:  Module\
  \              Size ip_tables           36K fat                 143K radeon              2.5MB\
  \ amdgpu              16MB  Without this patch: Module              Module load time (ms)\t\
  Count(PLTs/GOTs) ip_tables           18\t\t\t\t59/6 fat                 0\t\t\t\t162/14 radeon\
  \              54\t\t\t\t1221/84 amdgpu              1411\t\t\t4525/1098  With this patch:\
  \ Module              Module load time (ms)\tCount(PLTs/GOTs) ip_tables           18\t\t\t\
  \t59/6 fat                 0\t\t\t\t162/14 radeon              22\t\t\t\t1221/84 amdgpu  \
  \            45\t\t\t\t4525/1098"
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39767.json
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01703'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03378'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02918'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02927'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04647'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04629'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0476'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04766'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04756'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04919'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04922'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04954'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04863'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04862'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04836'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04617'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04648'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04702'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04642'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05633'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05662'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05644'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05618'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05599'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05584'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05604'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05587'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05578'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05552'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05561'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05583'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05678'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0563'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39767.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-39767
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2394630
    reference_type:
    reference_id: 2394630
