vulnerability_id: VCID-a1av-szdh-yyeh
aliases:
  - CVE-2025-66295
  - GHSA-h756-wh59-hhjv
summary: |
  Grav vulnerable to Path traversal / arbitrary YAML write via user creation leading to Account Takeover / System Corruption
  ### Summary
  When a user with privilege of user creation creates a new user through the Admin UI and supplies a username containing path traversal sequences (for example ..\Nijat or ../Nijat), Grav writes the account YAML file to an unintended path outside user/accounts/. The written YAML can contain account fields such as email, fullname, twofa_secret, and hashed_password. In my tests,  I was able to cause the Admin UI to write the following content into arbitrary .yaml files (including files like email.yaml, system.yaml, or other site YAML files like admin.yaml) â€” demonstrating arbitrary YAML write / overwrite via the Admin UI.

  Example observed content written by the Admin UI (test data):
  username: ..\Nijat
  state: enabled
  email: [EMAIL@gmail.com](mailto:EMAIL@gmail.com)
  fullname: 'Nijat Alizada'
  language: en
  content_editor: default
  twofa_enabled: false
  twofa_secret: RWVEIHC2AFVD6FCR6UHCO3DS4HWXKKDT
  avatar: { }
  hashed_password: $2y$10$wl9Ktv3vUmDKCt8o6u2oOuRZr1I04OE0YZf2sJ1QcAherbNnk1XVC
  access:
  site:
  login: true


  ### Steps to Reproduce
  1. Log in to the Grav Admin UI as an administrator.
  2. Create a new user with the following values (example):
          a. Username: ..\POC-TOKEN-2025-09-29
          b. Fullname: POC-TOKEN-2025-09-29
          c. Email: poc+2025-09-29@example.test
          d. Password: (any password)
  Observe that a YAML file containing the POC-TOKEN is written outside user/accounts/ (for example in the parent directory of user/accounts)


  ### Impact
  1. Config corruption / service disruption: Overwriting system.yaml, email.yaml, or plugin config files with attacker-controlled YAML (even if limited to fields present in account YAML) could break functionality, disable services, or cause misconfiguration requiring recovery from backups.
  2. Account takeover, any user with create user privilege can modify other user's email and password by just creating a new user with the name "..\accounts\USERNAME_OF_VICTIM"


  ### Proof of Concept
  https://github.com/user-attachments/assets/cf503d74-f765-4031-8e22-71f6b3630847
severities:
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.2069'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66295
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20653'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66295
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-h756-wh59-hhjv
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/commit/3462d94d575064601689b236508c316242e15741
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/commit/3462d94d575064601689b236508c316242e15741
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-02T14:04:26Z/
    published_at: None
    url: https://github.com/getgrav/grav/commit/3462d94d575064601689b236508c316242e15741
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-h756-wh59-hhjv
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-h756-wh59-hhjv
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-h756-wh59-hhjv
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-02T14:04:26Z/
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-h756-wh59-hhjv
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66295
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66295
weaknesses:
  - CWE-22
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-66295
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/commit/3462d94d575064601689b236508c316242e15741
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-h756-wh59-hhjv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66295
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-h756-wh59-hhjv
    reference_type:
    reference_id: GHSA-h756-wh59-hhjv
