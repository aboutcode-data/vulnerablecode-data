vulnerability_id: VCID-8r95-cgft-aaaq
aliases:
  - CVE-2024-26681
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netdevsim: avoid potential loop in nsim_dev_trap_report_work()

  Many syzbot reports include the following trace [1]

  If nsim_dev_trap_report_work() can not grab the mutex,
  it should rearm itself at least one jiffie later.

  [1]
  Sending NMI from CPU 1 to CPUs 0:
  NMI backtrace for cpu 0
  CPU: 0 PID: 32383 Comm: kworker/0:2 Not tainted 6.8.0-rc2-syzkaller-00031-g861c0981648f #0
  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 11/17/2023
  Workqueue: events nsim_dev_trap_report_work
   RIP: 0010:bytes_is_nonzero mm/kasan/generic.c:89 [inline]
   RIP: 0010:memory_is_nonzero mm/kasan/generic.c:104 [inline]
   RIP: 0010:memory_is_poisoned_n mm/kasan/generic.c:129 [inline]
   RIP: 0010:memory_is_poisoned mm/kasan/generic.c:161 [inline]
   RIP: 0010:check_region_inline mm/kasan/generic.c:180 [inline]
   RIP: 0010:kasan_check_range+0x101/0x190 mm/kasan/generic.c:189
  Code: 07 49 39 d1 75 0a 45 3a 11 b8 01 00 00 00 7c 0b 44 89 c2 e8 21 ed ff ff 83 f0 01 5b 5d 41 5c c3 48 85 d2 74 4f 48 01 ea eb 09 <48> 83 c0 01 48 39 d0 74 41 80 38 00 74 f2 eb b6 41 bc 08 00 00 00
  RSP: 0018:ffffc90012dcf998 EFLAGS: 00000046
  RAX: fffffbfff258af1e RBX: fffffbfff258af1f RCX: ffffffff8168eda3
  RDX: fffffbfff258af1f RSI: 0000000000000004 RDI: ffffffff92c578f0
  RBP: fffffbfff258af1e R08: 0000000000000000 R09: fffffbfff258af1e
  R10: ffffffff92c578f3 R11: ffffffff8acbcbc0 R12: 0000000000000002
  R13: ffff88806db38400 R14: 1ffff920025b9f42 R15: ffffffff92c578e8
  FS:  0000000000000000(0000) GS:ffff8880b9800000(0000) knlGS:0000000000000000
  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
  CR2: 000000c00994e078 CR3: 000000002c250000 CR4: 00000000003506f0
  DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
  DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
  Call Trace:
   <NMI>
   </NMI>
   <TASK>
    instrument_atomic_read include/linux/instrumented.h:68 [inline]
    atomic_read include/linux/atomic/atomic-instrumented.h:32 [inline]
    queued_spin_is_locked include/asm-generic/qspinlock.h:57 [inline]
    debug_spin_unlock kernel/locking/spinlock_debug.c:101 [inline]
    do_raw_spin_unlock+0x53/0x230 kernel/locking/spinlock_debug.c:141
    __raw_spin_unlock_irqrestore include/linux/spinlock_api_smp.h:150 [inline]
    _raw_spin_unlock_irqrestore+0x22/0x70 kernel/locking/spinlock.c:194
    debug_object_activate+0x349/0x540 lib/debugobjects.c:726
    debug_work_activate kernel/workqueue.c:578 [inline]
    insert_work+0x30/0x230 kernel/workqueue.c:1650
    __queue_work+0x62e/0x11d0 kernel/workqueue.c:1802
    __queue_delayed_work+0x1bf/0x270 kernel/workqueue.c:1953
    queue_delayed_work_on+0x106/0x130 kernel/workqueue.c:1989
    queue_delayed_work include/linux/workqueue.h:563 [inline]
    schedule_delayed_work include/linux/workqueue.h:677 [inline]
    nsim_dev_trap_report_work+0x9c0/0xc80 drivers/net/netdevsim/dev.c:842
    process_one_work+0x886/0x15d0 kernel/workqueue.c:2633
    process_scheduled_works kernel/workqueue.c:2706 [inline]
    worker_thread+0x8b9/0x1290 kernel/workqueue.c:2787
    kthread+0x2c6/0x3a0 kernel/kthread.c:388
    ret_from_fork+0x45/0x80 arch/x86/kernel/process.c:147
    ret_from_fork_asm+0x11/0x20 arch/x86/entry/entry_64.S:242
   </TASK>
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26681.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14695'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11708'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.1467'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.1468'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14707'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11671'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11831'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11835'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11872'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.1191'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11889'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11901'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11911'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11922'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11954'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11943'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11923'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.119'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11843'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14498'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14558'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14657'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14737'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14739'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14705'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14675'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14666'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '0.00202'
    scoring_system: epss
    scoring_elements: '0.28281'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26681
weaknesses:
  - CWE-606
  - CWE-835
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26681.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-26681
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0193e0660cc6689c794794b471492923cfd7bfbc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6eecddd9c3c8d6e3a097531cdc6d500335b35e46
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ba5e1272142d051dcc57ca1d3225ad8a089f9858
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d91964cdada76740811b7c621239f9c407820dbc
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2272844
    reference_type:
    reference_id: 2272844
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26681
    reference_type:
    reference_id: CVE-2024-26681
  - url: https://usn.ubuntu.com/6895-1/
    reference_type:
    reference_id: USN-6895-1
  - url: https://usn.ubuntu.com/6895-2/
    reference_type:
    reference_id: USN-6895-2
  - url: https://usn.ubuntu.com/6895-3/
    reference_type:
    reference_id: USN-6895-3
  - url: https://usn.ubuntu.com/6895-4/
    reference_type:
    reference_id: USN-6895-4
  - url: https://usn.ubuntu.com/6900-1/
    reference_type:
    reference_id: USN-6900-1
