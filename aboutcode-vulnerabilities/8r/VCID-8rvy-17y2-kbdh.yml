vulnerability_id: VCID-8rvy-17y2-kbdh
aliases:
  - CVE-2025-59052
  - GHSA-68x2-mx4q-78m7
summary: |
  Angular SSR: Global Platform Injector Race Condition Leads to Cross-Request Data Leakage
  ### Impact

  Angular uses a DI container (the "platform injector") to hold request-specific state during server-side rendering. For historical reasons, the container was stored as a JavaScript module-scoped global variable. When multiple requests are processed concurrently, they could inadvertently share or overwrite the global injector state.

  In practical terms, this can lead to one request responding with data meant for a completely different request, leaking data or tokens included on the rendered page or in response headers. As long as an attacker had network access to send any traffic that received a rendered response, they may have been able to send a large number of requests and then inspect the responses for information leaks.

  The following APIs were vulnerable and required SSR-only breaking changes:

  * `bootstrapApplication`: This function previously implicitly retrieved the last platform injector that was created. It now requires an explicit `BootstrapContext` in a server environment. This function is only used for standalone applications. NgModule-based applications are not affected.
  * `getPlatform`: This function previously returned the last platform instance that was created. It now always returns `null` in a server environment.
  * `destroyPlatform`: This function previously destroyed the last platform instance that was created. It's now a no-op when called in a server environment.

  For `bootstrapApplication`, the framework now provides a new argument to the application's bootstrap function:

  ```ts
  // Before:
  const bootstrap = () => bootstrapApplication(AppComponent, config);

  // After:
  const bootstrap = (context: BootstrapContext) =>
    bootstrapApplication(AppComponent, config, context);
  ```

  As is usually the case for changes to Angular, an automatic schematic will take care of these code changes as part of ng update:

  ```sh
  # For apps on Angular v20:
  ng update @angular/cli @angular/core

  # For apps on Angular v19:
  ng update @angular/cli@19 @angular/core@19

  # For apps on Angular v18:
  ng update @angular/cli@18 @angular/core@18
  ```

  The schematic can also be invoked explicitly if the version bump was pulled in independently:

  ```sh
  # For apps on Angular v20:
  ng update @angular/core --name add-bootstrap-context-to-server-main

  # For apps on Angular v19:
  ng update @angular/core@19 --name add-bootstrap-context-to-server-main

  # For apps on Angular v18:
  ng update @angular/core@18 --name add-bootstrap-context-to-server-main
  ```

  For applications that still use `CommonEngine`, the `bootstrap` property in `CommonEngineOptions` also gains the same `context` argument in the patched versions of Angular.

  In local development (`ng serve`), Angular CLI triggered a codepath for Angular's "JIT" feature on the server even in applications that weren't using it in the browser. The codepath introduced async behavior between platform creation and application bootstrap, triggering the race condition even if an application didn't explicitly use `getPlatform` or custom async logic in `bootstrap`. Angular applications should never run in this mode outside of local development.

  ### Patches

  The issue has been patched in [all active release lines](https://angular.dev/reference/releases#actively-supported-versions) as well as in the v21 prerelease:

  * `@angular/platform-server`: 21.0.0-next.3
  * `@angular/platform-server`: 20.3.0
  * `@angular/platform-server`: 19.2.15
  * `@angular/platform-server:` 18.2.14

  * `@angular/ssr`: 21.0.0-next.3
  * `@angular/ssr`: 20.3.0
  * `@angular/ssr`: 19.2.16
  * `@angular/ssr`: 18.2.21

  ### Workarounds

  * Disable SSR via [Server Routes](https://angular.dev/guide/ssr#server-routing) (v19+) or builder options.
  * Remove any asynchronous behavior from custom `bootstrap` functions.
  * Remove uses of `getPlatform()` in application code.
  * Ensure that the server build defines `ngJitMode` as false.

  ### References

  * https://github.com/angular/angular/pull/63562
  * https://github.com/angular/angular-cli/pull/31108
severities:
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-59052.json
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09091'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09112'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14346'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14504'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14463'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14483'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14387'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14395'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14408'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14311'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14315'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14269'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14283'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14213'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14317'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14427'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1438'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14394'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15916'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15887'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15924'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15952'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1591'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15898'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15849'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15963'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15966'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15968'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15907'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15904'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15923'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16018'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15977'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18965'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-68x2-mx4q-78m7
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/angular/angular
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/angular/angular-cli/pull/31108
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/angular/angular-cli/pull/31108
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-09-10T20:24:52Z/
    published_at: None
    url: https://github.com/angular/angular-cli/pull/31108
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/angular/angular/pull/63562
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/angular/angular/pull/63562
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-09-10T20:24:52Z/
    published_at: None
    url: https://github.com/angular/angular/pull/63562
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/angular/angular/security/advisories/GHSA-68x2-mx4q-78m7
  - score: '7.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:L/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/angular/angular/security/advisories/GHSA-68x2-mx4q-78m7
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/angular/angular/security/advisories/GHSA-68x2-mx4q-78m7
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-09-10T20:24:52Z/
    published_at: None
    url: https://github.com/angular/angular/security/advisories/GHSA-68x2-mx4q-78m7
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59052
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-362
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-59052.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-59052
    reference_type:
    reference_id:
  - url: https://github.com/angular/angular
    reference_type:
    reference_id:
  - url: https://github.com/angular/angular-cli/pull/31108
    reference_type:
    reference_id:
  - url: https://github.com/angular/angular/pull/63562
    reference_type:
    reference_id:
  - url: https://github.com/angular/angular/security/advisories/GHSA-68x2-mx4q-78m7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59052
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2394458
    reference_type:
    reference_id: 2394458
  - url: https://github.com/advisories/GHSA-68x2-mx4q-78m7
    reference_type:
    reference_id: GHSA-68x2-mx4q-78m7
