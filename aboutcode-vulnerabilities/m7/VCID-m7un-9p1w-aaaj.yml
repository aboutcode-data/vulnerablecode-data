vulnerability_id: VCID-m7un-9p1w-aaaj
aliases:
  - CVE-2024-42356
  - GHSA-35jp-8cgg-p4wj
summary: "Shopware vulnerable to Server Side Template Injection in Twig using Context functions\n\
  ### Impact\nThe `context` variable is injected into almost any Twig Template and allows to\
  \ access to current language, currency information. The context object allows also to switch\
  \ for a short time the scope of the Context as a helper with a callable function. \n\nExample\
  \ call from PHP:\n\n```php\n$context->scope(Context::SYSTEM_SCOPE, static function (Context\
  \ $context) use ($mediaService, $media, &$fileBlob): void {\n    $fileBlob = $mediaService->loadFile($media->getId(),\
  \ $context);\n});\n```\n\nThis function can be called also from Twig and as the second parameter\
  \ allows any callable, it's possible to call from Twig any statically callable PHP function/method.\n\
  \nIt's not possible as customer to provide any Twig code, the attacker would require access\
  \ to Administration to exploit it using Mail templates or using App Scripts.\n\n### Patches\n\
  Update to Shopware 6.6.5.1 or 6.5.8.13\n\n### Workarounds\nFor older versions of 6.1, 6.2,\
  \ 6.3 and 6.4 corresponding security measures are also available via a plugin. For the full\
  \ range of functions, we recommend updating to the latest Shopware version."
severities:
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34630'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34404'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34476'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34504'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34604'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34602'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34608'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34858'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34647'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35504'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35138'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35180'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35171'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35004'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34926'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.34103'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.41766'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.41772'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.41764'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.41779'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.41886'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.41851'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.41786'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.41724'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00271'
    scoring_system: epss
    scoring_elements: '0.50206'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00271'
    scoring_system: epss
    scoring_elements: '0.50253'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00271'
    scoring_system: epss
    scoring_elements: '0.50274'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00271'
    scoring_system: epss
    scoring_elements: '0.50255'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00271'
    scoring_system: epss
    scoring_elements: '0.50232'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53826'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53769'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53752'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53771'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53795'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53815'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.5366'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53643'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53743'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53749'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.5377'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00339'
    scoring_system: epss
    scoring_elements: '0.53789'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00445'
    scoring_system: epss
    scoring_elements: '0.60712'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.00445'
    scoring_system: epss
    scoring_elements: '0.6073'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: '0.01076'
    scoring_system: epss
    scoring_elements: '0.64441'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-35jp-8cgg-p4wj
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/shopware/core/commit/04183e0c02af3b404eb7d52c683734bfe0595038
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/core/commit/04183e0c02af3b404eb7d52c683734bfe0595038
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/shopware/core/commit/a784aa1cec0624e36e0ee4d41aeebaed40e0442f
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/core/commit/a784aa1cec0624e36e0ee4d41aeebaed40e0442f
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/shopware/shopware
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/shopware/shopware/commit/8504ba7e56e53add6a1d5b9d45015e3d899cd0ac
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/commit/8504ba7e56e53add6a1d5b9d45015e3d899cd0ac
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/shopware/shopware/commit/e43423bcc93c618c3036f94c12aa29514da8cf2e
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/commit/e43423bcc93c618c3036f94c12aa29514da8cf2e
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-35jp-8cgg-p4wj
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-35jp-8cgg-p4wj
  - score: '7.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42356
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42356
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42356
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42356
weaknesses:
  - CWE-94
  - CWE-937
  - CWE-1035
  - CWE-1336
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-42356
    reference_type:
    reference_id:
  - url: https://github.com/shopware/core/commit/04183e0c02af3b404eb7d52c683734bfe0595038
    reference_type:
    reference_id:
  - url: https://github.com/shopware/core/commit/a784aa1cec0624e36e0ee4d41aeebaed40e0442f
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/8504ba7e56e53add6a1d5b9d45015e3d899cd0ac
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/e43423bcc93c618c3036f94c12aa29514da8cf2e
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/security/advisories/GHSA-35jp-8cgg-p4wj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42356
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:shopware:shopware:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:shopware:shopware:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-35jp-8cgg-p4wj
    reference_type:
    reference_id: GHSA-35jp-8cgg-p4wj
