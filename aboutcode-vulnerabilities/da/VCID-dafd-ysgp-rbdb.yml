vulnerability_id: VCID-dafd-ysgp-rbdb
aliases:
  - GHSA-3wfh-36rx-9537
summary: |
  Timing Attack Vulnerability in SCRAM Authentication
  ### Impact

  A timing attack vulnerability exists in the SCRAM Java implementation. The issue arises because `Arrays.equals` was used to compare secret values such as client proofs and server signatures. Since `Arrays.equals` performs a short-circuit comparison, the execution time varies depending on how many leading bytes match. This behavior could allow an attacker to perform a timing side-channel attack and potentially infer sensitive authentication material. All users relying on SCRAM authentication are impacted.

  ### Patches

  This vulnerability has been patched by replacing `Arrays.equals` with `MessageDigest.isEqual`, which ensures constant-time comparison.

  Users should upgrade to version **3.2** or later to mitigate this issue.

  ### Workarounds

  Because the attack requires high precision and repeated attempts, the risk is limited, but the only reliable mitigation is to upgrade to a patched release (version 3.2 or later).

  ### References

  - [Java `MessageDigest.isEqual` Documentation](https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/security/MessageDigest.html#isEqual(byte[],byte[]))
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/security/MessageDigest.html#isEqual(byte%5B%5D,byte%5B%5D)
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-3wfh-36rx-9537
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ongres/scram
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ongres/scram/commit/f04975680d4a67bc84cc6c61bbffd5186223e2e2
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/ongres/scram/security/advisories/GHSA-3wfh-36rx-9537
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ongres/scram/security/advisories/GHSA-3wfh-36rx-9537
weaknesses:
  - CWE-208
  - CWE-1035
  - CWE-937
  - CWE-385
references:
  - url: https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/security/MessageDigest.html#isEqual(byte%5B%5D,byte%5B%5D)
    reference_type:
    reference_id:
  - url: https://github.com/ongres/scram
    reference_type:
    reference_id:
  - url: https://github.com/ongres/scram/commit/f04975680d4a67bc84cc6c61bbffd5186223e2e2
    reference_type:
    reference_id:
  - url: https://github.com/ongres/scram/security/advisories/GHSA-3wfh-36rx-9537
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-3wfh-36rx-9537
    reference_type:
    reference_id: GHSA-3wfh-36rx-9537
