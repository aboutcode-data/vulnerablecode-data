vulnerability_id: VCID-a4np-2hfz-rya4
aliases:
  - CVE-2023-32197
  - GHSA-7h8m-pvw3-5gh4
summary: |
  Rancher allows privilege escalation in Windows nodes due to Insecure Access Control Lists
  ### Impact

  A vulnerability has been identified whereby Rancher Manager deployments containing Windows nodes have weak Access Control Lists (ACL), allowing `BUILTIN\Users` or `NT AUTHORITY\Authenticated Users` to view or edit sensitive files which could lead to privilege escalation.

  The affected files include binaries, scripts, configuration and log files:

  ```
  C:\etc\rancher\wins\config
  C:\var\lib\rancher\agent\rancher2_connection_info.json
  C:\etc\rancher\rke2\config.yaml.d\50-rancher.yaml
  C:\var\lib\rancher\agent\applied\*-*-applied.plan
  C:\usr\local\bin\rke2
  C:\var\lib\rancher\capr\idempotence\idempotent.sh
  ```

  RKE2 nodes expand the list to include the files below:

  ```
  C:\etc\rancher\node\password
  C:\var\lib\rancher\rke2\agent\logs\kubelet.log
  C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
  C:\var\lib\rancher\rke2\bin\*
  ```

  **This vulnerability is exclusive to deployments that contain Windows nodes. Linux-only environments are not affected by it.**

  Please consult the associated [MITRE ATT&CK - Technique - Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068/) for further information about this category of attack.

  ### Patches

  Patched versions include Rancher Manager `2.8.9` and `2.9.3`. For RKE2 Windows nodes, please refer to its [specific advisory](https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv). No patches are available for 2.7, therefore users are urged to upgrade to newer minor versions or to apply the manual workaround below.


  ### Workarounds

  Users are advised to upgrade to a patched version of Rancher Manager. When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running [this](https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md) PowerShell script as an Administrator on each node.


  ### References

  - [CVE-2023-32197](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197)
  - [RKE2â€™s GHSA-x7xj-jvwp-97rv](https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv)

  ### For more information

  If you have any questions or comments about this advisory:
  - Reach out to the [SUSE Rancher Security team](https://github.com/rancher/rancher/security/policy) for security related inquiries.
  - Open an issue in the [Rancher](https://github.com/rancher/rancher/issues/new/choose) repository.
  - Verify with our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/) and [product support lifecycle](https://www.suse.com/lifecycle/).
severities:
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00664'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.0068'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00679'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00672'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00674'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00667'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00488'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00489'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.0055'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00551'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-32197
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-32197
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-32197
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-32197
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-16T14:19:28Z/
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-32197
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/rancher/rancher
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:H/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-16T14:19:28Z/
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-32197
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-32197
weaknesses:
  - CWE-732
  - CWE-269
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-32197
    reference_type:
    reference_id:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-32197
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-32197
    reference_type:
    reference_id:
