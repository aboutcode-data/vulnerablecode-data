vulnerability_id: VCID-wcw6-7km7-aaah
aliases:
  - GHSA-m24x-r6q3-2vp9
summary: |
  Uncaught Exception processing HTTP Headers in SurrealDB
  The `ID`, `DB` and `NS` headers accepted by the SurrealDB HTTP REST API would fail to parse when containing some special characters. This would cause a panic which would crash the SurrealDB server, leading to denial of service.

  This issue only affects the SurrealDB binary; it does not affect the SurrealDB library.

  ### Impact

  An unauthenticated client may issue an HTTP request to the SurrealDB HTTP REST API containing one of the affected headers with values containing special characters in order to crash the SurrealDB server. This does not require the SurrealDB server to be running with any specific capabilities other than exposing the affected interface.

  ### Patches

  - Version 1.1.0 and later are not affected by this issue.

  ### Workarounds

  Concerned users unable to update may want to limit untrusted access to the SurrealDB HTTP REST API unless such access is required by the application. To limit the impact of the denial of service, SurrealDB administrators may also want to ensure that the SurrealDB process is running so that it can be automatically re-started after a crash.

  ### References

  - #2985 ([diff](https://github.com/surrealdb/surrealdb/pull/2985/files#diff-7ad06ddbb88d77138e5daf40a0dac5443d78947acd69a284a7c2bceb61f9c5f0L83-R119))
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-m24x-r6q3-2vp9
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/surrealdb/surrealdb
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/surrealdb/surrealdb/commit/a70ddb2e2aed2453730b81781e426486247609cb
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb/commit/a70ddb2e2aed2453730b81781e426486247609cb
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/surrealdb/surrealdb/pull/2985
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb/pull/2985
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-m24x-r6q3-2vp9
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-m24x-r6q3-2vp9
weaknesses: []
references:
  - url: https://github.com/surrealdb/surrealdb
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/commit/a70ddb2e2aed2453730b81781e426486247609cb
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/pull/2985
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-m24x-r6q3-2vp9
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-m24x-r6q3-2vp9
    reference_type:
    reference_id: GHSA-m24x-r6q3-2vp9
