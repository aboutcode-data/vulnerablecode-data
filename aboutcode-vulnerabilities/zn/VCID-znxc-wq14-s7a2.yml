vulnerability_id: VCID-znxc-wq14-s7a2
aliases:
  - CVE-2025-23389
  - GHSA-mq23-vvg7-xfm4
summary: "Rancher does not Properly Validate Account Bindings in SAML Authentication Enables\
  \ User Impersonation on First Login\n### Impact\nA vulnerability in Rancher has been discovered,\
  \ leading to a local user impersonation through SAML Authentication on first login.\n\nThe\
  \ issue occurs when a SAML authentication provider (AP) is configured (e.g. Keycloak). A newly\
  \ created AP user can impersonate any user on Rancher by manipulating cookie values during\
  \ their initial login to Rancher. This vulnerability could also be exploited if a Rancher\
  \ user (present on the AP) is removed, either manually or automatically via the [User Retention\
  \ feature](https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-user-retention)\
  \ with delete-inactive-user-after.\n\nMore precisely, Rancher validates only a subset of input\
  \ from the SAML assertion request; however, it trusts and uses values that are not properly\
  \ validated. An attacker could then configure the saml_Rancher_UserID cookie and the saml_Rancher_Action\
  \ cookie so that the user principal from the AP will be added to the user specified by the\
  \ attacker (from saml_Rancher_UserID). Rancher can then be deceived by setting saml_Rancher_UserID\
  \ to the admin's user ID and saml_Rancher_Action to testAndEnable, thereby executing the vulnerable\
  \ code path and leading to privilege escalation.\n\nNote that the vulnerability impacts all\
  \ SAML APs available in Rancher. However the following Rancher deployments are not affected:\n\
  1. Rancher deployments not using SAML-based AP.\n2. Rancher deployments using SAML-based AP,\
  \ where all SAML users are already signed in and linked to a Rancher account.\n\nPlease consult\
  \ the associated  [MITRE ATT&CK - Technique - Access Token Manipulation: Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001/)\
  \ for further information about this category of attack.\n\n### Patches\nThis vulnerability\
  \ is addressed by adding the UserID claim to a JWT signed token, which is protected against\
  \ tampering. \n\nPatched versions include releases `v2.8.13`, `v2.9.7` and `v2.10.3`.\n\n\
  ### Workarounds\nRancher deployments that can't upgrade, could temporarily disable the SAML-based\
  \ AP as a temporary workaround. However, upgrading is recommended.\n\n### References\nIf you\
  \ have any questions or comments about this advisory:\n- Reach out to the [SUSE Rancher Security\
  \ team](https://github.com/rancher/rancher/security/policy) for security related inquiries.\n\
  - Open an issue in the [Rancher](https://github.com/rancher/rancher/issues/new/choose) repository.\n\
  - Verify with our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/)\
  \ and [product support lifecycle](https://www.suse.com/lifecycle/)."
severities:
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.12262'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20501'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20435'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17218'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17247'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17269'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20858'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20815'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20874'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20867'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20851'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20831'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.2083'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.2084'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20844'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.2086'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20862'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20866'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23389
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23389
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-11T14:33:28Z/
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23389
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/rancher/rancher
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-mq23-vvg7-xfm4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-mq23-vvg7-xfm4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-11T14:33:28Z/
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-mq23-vvg7-xfm4
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-23389
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-23389
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3490
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3490
weaknesses:
  - CWE-287
  - CWE-284
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-23389
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/security/advisories/GHSA-mq23-vvg7-xfm4
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23389
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3490
    reference_type:
    reference_id:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2025-23389
    reference_type:
    reference_id: show_bug.cgi?id=CVE-2025-23389
