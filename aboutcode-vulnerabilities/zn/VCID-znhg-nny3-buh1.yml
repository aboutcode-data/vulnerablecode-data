vulnerability_id: VCID-znhg-nny3-buh1
aliases:
  - CVE-2023-52998
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: fec: Use
  page_pool_put_full_page when freeing rx buffers  The page_pool_release_page was used when
  freeing rx buffers, and this function just unmaps the page (if mapped) and does not recycle
  the page. So after hundreds of down/up the eth0, the system will out of memory. For more details,
  please refer to the following reproduce steps and bug logs. To solve this issue and refer
  to the doc of page pool, the page_pool_put_full_page should be used to replace page_pool_release_page.
  Because this API will try to recycle the page if the page refcnt equal to 1. After testing
  20000 times, the issue can not be reproduced anymore (about testing 391 times the issue will
  occur on i.MX8MN-EVK before).  Reproduce steps: Create the test script and run the script.
  The script content is as follows: LOOPS=20000 i=1 while [ $i -le $LOOPS ] do     echo "TINFO:ENET
  $curface up and down test $i times"     org_macaddr=$(cat /sys/class/net/eth0/address)     ifconfig
  eth0 down     ifconfig eth0  hw ether $org_macaddr up     i=$(expr $i + 1) done sleep 5 if
  cat /sys/class/net/eth0/operstate | grep ''up'';then     echo "TEST PASS" else     echo "TEST
  FAIL" fi  Bug detail logs: TINFO:ENET  up and down test 391 times [  850.471205] Qualcomm
  Atheros AR8031/AR8033 30be0000.ethernet-1:00: attached PHY driver (mii_bus:phy_addr=30be0000.ethernet-1:00,
  irq=POLL) [  853.535318] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready [  853.541694]
  fec 30be0000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx [  870.590531] page_pool_release_retry()
  stalled pool shutdown 199 inflight 60 sec [  931.006557] page_pool_release_retry() stalled
  pool shutdown 199 inflight 120 sec TINFO:ENET  up and down test 392 times [  991.426544] page_pool_release_retry()
  stalled pool shutdown 192 inflight 181 sec [ 1051.838531] page_pool_release_retry() stalled
  pool shutdown 170 inflight 241 sec [ 1093.751217] Qualcomm Atheros AR8031/AR8033 30be0000.ethernet-1:00:
  attached PHY driver (mii_bus:phy_addr=30be0000.ethernet-1:00, irq=POLL) [ 1096.446520] page_pool_release_retry()
  stalled pool shutdown 308 inflight 60 sec [ 1096.831245] fec 30be0000.ethernet eth0: Link
  is Up - 1Gbps/Full - flow control rx/tx [ 1096.839092] IPv6: ADDRCONF(NETDEV_CHANGE): eth0:
  link becomes ready [ 1112.254526] page_pool_release_retry() stalled pool shutdown 103 inflight
  302 sec [ 1156.862533] page_pool_release_retry() stalled pool shutdown 308 inflight 120 sec
  [ 1172.674516] page_pool_release_retry() stalled pool shutdown 103 inflight 362 sec [ 1217.278532]
  page_pool_release_retry() stalled pool shutdown 308 inflight 181 sec TINFO:ENET  up and down
  test 393 times [ 1233.086535] page_pool_release_retry() stalled pool shutdown 103 inflight
  422 sec [ 1277.698513] page_pool_release_retry() stalled pool shutdown 308 inflight 241 sec
  [ 1293.502525] page_pool_release_retry() stalled pool shutdown 86 inflight 483 sec [ 1338.110518]
  page_pool_release_retry() stalled pool shutdown 308 inflight 302 sec [ 1353.918540] page_pool_release_retry()
  stalled pool shutdown 32 inflight 543 sec [ 1361.179205] Qualcomm Atheros AR8031/AR8033 30be0000.ethernet-1:00:
  attached PHY driver (mii_bus:phy_addr=30be0000.ethernet-1:00, irq=POLL) [ 1364.255298] fec
  30be0000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx [ 1364.263189] IPv6:
  ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready [ 1371.998532] page_pool_release_retry()
  stalled pool shutdown 310 inflight 60 sec [ 1398.530542] page_pool_release_retry() stalled
  pool shutdown 308 inflight 362 sec [ 1414.334539] page_pool_release_retry() stalled pool shutdown
  16 inflight 604 sec [ 1432.414520] page_pool_release_retry() stalled pool shutdown 310 inflight
  120 sec [ 1458.942523] page_pool_release_retry() stalled pool shutdown 308 inflight 422 sec
  [ 1474.750521] page_pool_release_retry() stalled pool shutdown 16 inflight 664 sec TINFO:ENET  up
  and down test 394 times [ 1492.8305 ---truncated---'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52998.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.01571'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02645'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02651'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03829'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03837'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03861'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03859'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03881'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03912'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03906'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03901'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03895'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03882'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04946'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04969'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05001'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04986'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04962'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04951'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04923'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04919'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04929'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04931'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04937'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04944'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03839'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03828'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03826'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05568'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52998.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52998
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/554484a34e985a307756ee4794e60be31e3db2e5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e38553bdc377e3e7a6caa9dd9770d8b644d8dac3
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355505
    reference_type:
    reference_id: 2355505
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52998
    reference_type:
    reference_id: CVE-2023-52998
