vulnerability_id: VCID-cusb-cyfh-euhg
aliases:
  - GHSA-g9jg-w8vm-g96v
summary: |
  Trix has a stored XSS vulnerability through its attachment attribute
  ### Impact
  The Trix editor, in versions prior to 2.1.16, is vulnerable to XSS attacks through attachment payloads.

  An attacker could inject malicious code into a data-trix-attachment attribute that, when rendered as HTML and clicked on, could execute arbitrary JavaScript code within the context of the user's session, potentially leading to unauthorized actions being performed or sensitive information being disclosed.

  ### Patches
  Update Recommendation: Users should upgrade to Trix editor version 2.1.16 or later.

  ### Resources
  The XSS vulnerability was reported by HackerOne researcher [michaelcheers](https://hackerone.com/michaelcheers?type=user).
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-g9jg-w8vm-g96v
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/basecamp/trix
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/basecamp/trix
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/basecamp/trix/commit/73c20cf03ab2b56c0ef9c9b1aaf63f2de44f4010
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/basecamp/trix/commit/73c20cf03ab2b56c0ef9c9b1aaf63f2de44f4010
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/basecamp/trix/releases/tag/v2.1.16
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/basecamp/trix/releases/tag/v2.1.16
  - score: '4.6'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://github.com/basecamp/trix/security/advisories/GHSA-g9jg-w8vm-g96v
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/basecamp/trix/security/advisories/GHSA-g9jg-w8vm-g96v
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/basecamp/trix/security/advisories/GHSA-g9jg-w8vm-g96v
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/basecamp/trix/security/advisories/GHSA-g9jg-w8vm-g96v
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/action_text-trix/GHSA-g9jg-w8vm-g96v.yml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/action_text-trix/GHSA-g9jg-w8vm-g96v.yml
weaknesses:
  - CWE-79
references:
  - url: https://github.com/basecamp/trix
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix/commit/73c20cf03ab2b56c0ef9c9b1aaf63f2de44f4010
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix/releases/tag/v2.1.16
    reference_type:
    reference_id:
  - url: https://github.com/basecamp/trix/security/advisories/GHSA-g9jg-w8vm-g96v
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-g9jg-w8vm-g96v
    reference_type:
    reference_id: GHSA-g9jg-w8vm-g96v
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/action_text-trix/GHSA-g9jg-w8vm-g96v.yml
    reference_type:
    reference_id: GHSA-g9jg-w8vm-g96v.yml
