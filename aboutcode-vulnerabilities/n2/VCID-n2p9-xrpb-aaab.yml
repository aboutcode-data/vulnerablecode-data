vulnerability_id: VCID-n2p9-xrpb-aaab
aliases:
  - GHSA-xg2h-wx96-xgxr
summary: |
  RandomAlphaNumeric and CryptoRandomAlphaNumeric are not as random as they should be
  ### Impact

  A security-sensitive bug was discovered by Open Source Developer *Erik Sundell of Sundell Open Source Consulting AB*.

  The functions `RandomAlphaNumeric(int)` and `CryptoRandomAlphaNumeric(int)` are not as random as they should be. Small values of `int` in the functions above will return a smaller subset of results than they should. For example, `RandomAlphaNumeric(1)` will always return a digit in the 0-9 range, while `RandomAlphaNumeric(4)` will return around ~7 million of the ~13M possible permutations.

  This is considered a security release because programs that rely upon random generators for passwords are at an increased risk of brute force-style password guessing. There is also a higher probability of collision.

  The problem was the result of a mistaken regular expression that only accepted random strings if they contained a digit from `[0-9]`. That restriction has been removed.

  ### Patches

  This issue has been corrected in v1.1.1.

  ### Workarounds

  If you cannot upgrade to v1.1.1, you can work around the issue by calling `RandomAlphaNumericCustom(N, true, true)`|`CryptoRandomAlphaNumericCustom(N, true, true)`  instead. (Where `N` is the desired length, and `true` is the literal boolean `true`.)
severities:
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://github.com/Masterminds/goutils
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Masterminds/goutils
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://github.com/Masterminds/goutils/commit/869801f20f9f1e7ecdbdb6422049d8241270d5e1
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Masterminds/goutils/commit/869801f20f9f1e7ecdbdb6422049d8241270d5e1
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Masterminds/goutils/commit/f1923532a168b8203bfe956d8cd3b17ebece5982
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Masterminds/goutils/releases/tag/v1.1.1
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Masterminds/goutils/security/advisories/GHSA-xg2h-wx96-xgxr
weaknesses: []
references:
  - url: https://github.com/Masterminds/goutils
    reference_type:
    reference_id:
  - url: https://github.com/Masterminds/goutils/commit/869801f20f9f1e7ecdbdb6422049d8241270d5e1
    reference_type:
    reference_id:
  - url: https://github.com/Masterminds/goutils/commit/f1923532a168b8203bfe956d8cd3b17ebece5982
    reference_type:
    reference_id:
  - url: https://github.com/Masterminds/goutils/releases/tag/v1.1.1
    reference_type:
    reference_id:
  - url: https://github.com/Masterminds/goutils/security/advisories/GHSA-xg2h-wx96-xgxr
    reference_type:
    reference_id:
