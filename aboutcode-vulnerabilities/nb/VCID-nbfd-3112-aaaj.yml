vulnerability_id: VCID-nbfd-3112-aaaj
aliases:
  - CVE-2021-21413
  - GHSA-mmhj-4w6j-76h7
summary: |
  Improper Control of Dynamically-Managed Code Resources
  isolated-vm has API pitfalls which may make it easy for implementers to expose supposed secure isolates to the permissions of the main nodejs isolate. Reference objects allow access to the underlying reference's full prototype chain. In an environment where the implementer has exposed a Reference instance to an attacker they would be able to use it to acquire a Reference to the nodejs context's Function object. Similar application-specific attacks could be possible by modifying the local prototype of other API objects. Access to NativeModule objects could allow an attacker to load and run native code from anywhere on the filesystem.
severities:
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30467'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30485'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30442'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30415'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30418'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30455'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30483'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.3049'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30464'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30446'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30421'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34905'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34926'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34955'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34964'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34944'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34945'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34943'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34956'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.35044'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.35038'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34996'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34864'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.303'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30451'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30456'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.34929'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00137'
    scoring_system: epss
    scoring_elements: '0.30346'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.50959'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.50980'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.50977'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.51261'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55785'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55135'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55393'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55459'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55479'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55546'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55538'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55533'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55572'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55705'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00173'
    scoring_system: epss
    scoring_elements: '0.55740'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: '0.00344'
    scoring_system: epss
    scoring_elements: '0.40268'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-mmhj-4w6j-76h7
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/laverdet/isolated-vm/blob/main/CHANGELOG.md#v400
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/laverdet/isolated-vm/blob/main/CHANGELOG.md#v400
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/laverdet/isolated-vm/commit/2646e6c1558bac66285daeab54c7d490ed332b15
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/laverdet/isolated-vm/commit/2646e6c1558bac66285daeab54c7d490ed332b15
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/laverdet/isolated-vm/commit/27151bfecc260e96714443613880e3b2e6596704
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/laverdet/isolated-vm/commit/27151bfecc260e96714443613880e3b2e6596704
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/laverdet/isolated-vm/security/advisories/GHSA-mmhj-4w6j-76h7
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/laverdet/isolated-vm/security/advisories/GHSA-mmhj-4w6j-76h7
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements: AV:A/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21413
  - score: '9.6'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21413
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21413
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-913
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-21413
    reference_type:
    reference_id:
  - url: https://github.com/laverdet/isolated-vm/blob/main/CHANGELOG.md#v400
    reference_type:
    reference_id:
  - url: https://github.com/laverdet/isolated-vm/commit/2646e6c1558bac66285daeab54c7d490ed332b15
    reference_type:
    reference_id:
  - url: https://github.com/laverdet/isolated-vm/commit/27151bfecc260e96714443613880e3b2e6596704
    reference_type:
    reference_id:
  - url: https://github.com/laverdet/isolated-vm/security/advisories/GHSA-mmhj-4w6j-76h7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:isolated-vm_project:isolated-vm:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:isolated-vm_project:isolated-vm:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21413
    reference_type:
    reference_id: CVE-2021-21413
  - url: https://github.com/advisories/GHSA-mmhj-4w6j-76h7
    reference_type:
    reference_id: GHSA-mmhj-4w6j-76h7
