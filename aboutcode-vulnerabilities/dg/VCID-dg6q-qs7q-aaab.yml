vulnerability_id: VCID-dg6q-qs7q-aaab
aliases:
  - CVE-2021-39163
  - GHSA-jj53-8fmw-f2w2
  - PYSEC-2021-424
summary: Matrix is an ecosystem for open federated Instant Messaging and Voice over IP. In versions
  1.41.0 and prior, unauthorised users can access the name, avatar, topic and number of members
  of a room if they know the ID of the room. This vulnerability is limited to homeservers where
  the vulnerable homeserver is in the room and untrusted users are permitted to create groups
  (communities). By default, only homeserver administrators can create groups. However, homeserver
  administrators can already access this information in the database or using the admin API.
  As a result, only homeservers where the configuration setting `enable_group_creation` has
  been set to `true` are impacted. Server administrators should upgrade to 1.41.1 or higher
  to patch the vulnerability. There are two potential workarounds. Server administrators can
  set `enable_group_creation` to `false` in their homeserver configuration (this is the default
  value) to prevent creation of groups by non-administrators. Administrators that are using
  a reverse proxy could, with partial loss of group functionality, block the endpoints `/_matrix/client/r0/groups/{group_id}/rooms`
  and `/_matrix/client/unstable/groups/{group_id}/rooms`.
severities:
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.48293'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.48601'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.48326'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.48321'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.50905'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.50881'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.50864'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.50871'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.50879'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.50809'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.50787'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.50711'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.50446'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.51140'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.51089'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00139'
    scoring_system: epss
    scoring_elements: '0.51056'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50271'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47837'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47858'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47867'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47843'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47829'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47812'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50227'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50273'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.5033'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50353'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50357'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50269'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50279'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50294'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50312'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50315'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50338'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.5032'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.50296'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47713'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47691'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47824'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47839'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47849'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47822'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47792'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00272'
    scoring_system: epss
    scoring_elements: '0.47815'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: '0.00528'
    scoring_system: epss
    scoring_elements: '0.50071'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-jj53-8fmw-f2w2
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/matrix-org/synapse
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/matrix-org/synapse/commit/cb35df940a
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse/commit/cb35df940a
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/matrix-org/synapse/releases/tag/v1.41.1
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse/releases/tag/v1.41.1
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse/security/advisories/GHSA-jj53-8fmw-f2w2
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-424.yaml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-424.yaml
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN
  - score: '3.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39163
  - score: '3.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39163
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39163
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2334
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-39163
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/cb35df940a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/releases/tag/v1.41.1
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-424.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN/
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/AVG-2334
    reference_type:
    reference_id: AVG-2334
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39163
    reference_type:
    reference_id: CVE-2021-39163
  - url: https://github.com/advisories/GHSA-jj53-8fmw-f2w2
    reference_type:
    reference_id: GHSA-jj53-8fmw-f2w2
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-jj53-8fmw-f2w2
    reference_type:
    reference_id: GHSA-jj53-8fmw-f2w2
