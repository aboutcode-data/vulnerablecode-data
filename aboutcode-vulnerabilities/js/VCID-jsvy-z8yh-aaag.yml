vulnerability_id: VCID-jsvy-z8yh-aaag
aliases:
  - CVE-2022-39250
  - GHSA-5w8r-8pgj-5jmf
summary: |
  Key Exchange without Entity Authentication
  Matrix JavaScript SDK is the Matrix Client-Server software development kit (SDK) for JavaScript. Prior to version 19.7.0, an attacker cooperating with a malicious homeserver could interfere with the verification flow between two users, injecting its own cross-signing user identity in place of one of the usersâ€™ identities. This would lead to the other device trusting/verifying the user identity under the control of the homeserver instead of the intended one. The vulnerability is a bug in the matrix-js-sdk, caused by checking and signing user identities and devices in two separate steps, and inadequately fixing the keys to be signed between those steps. Even though the attack is partly made possible due to the design decision of treating cross-signing user identities as Matrix devices on the server side (with their device ID set to the public part of the user identity key), no other examined implementations were vulnerable. Starting with version 19.7.0, the matrix-js-sdk has been modified to double check that the key signed is the one that was verified instead of just referencing the key by ID. An additional check has been made to report an error when one of the device ID matches a cross-signing key. As this attack requires coordination between a malicious homeserver and an attacker, those who trust their homeservers do not need a particular workaround.
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-39250.json
  - score: '0.00114'
    scoring_system: epss
    scoring_elements: '0.45909'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00114'
    scoring_system: epss
    scoring_elements: '0.45606'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00114'
    scoring_system: epss
    scoring_elements: '0.45623'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00114'
    scoring_system: epss
    scoring_elements: '0.45599'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46824'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46803'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46809'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46727'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46709'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46622'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46360'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.47076'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.47000'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46979'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46836'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33108'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.2863'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28643'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28673'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28631'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28595'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28601'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28637'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28666'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28677'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28647'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28617'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.32988'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33049'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33153'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33157'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33079'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33055'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33057'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33056'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.3307'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33061'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.3304'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.33019'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28536'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28501'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.43675'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5w8r-8pgj-5jmf
  - score: '4.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:N/I:N/A:L
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/commit/a587d7c36026fe1fcf93dfff63588abee359be76
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/commit/a587d7c36026fe1fcf93dfff63588abee359be76
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:35Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/commit/a587d7c36026fe1fcf93dfff63588abee359be76
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/releases/tag/v19.7.0
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/releases/tag/v19.7.0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:35Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/releases/tag/v19.7.0
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-5w8r-8pgj-5jmf
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-5w8r-8pgj-5jmf
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:35Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-5w8r-8pgj-5jmf
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:35Z/
    published_at: None
    url: https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39250
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-39250
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://security.gentoo.org/glsa/202210-35
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.gentoo.org/glsa/202210-35
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-23T15:50:35Z/
    published_at: None
    url: https://security.gentoo.org/glsa/202210-35
  - score: high
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.mozilla.org/en-US/security/advisories/mfsa2022-43
weaknesses:
  - CWE-322
  - CWE-937
  - CWE-1035
  - CWE-287
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-39250.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-39250
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-39250
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-js-sdk
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-js-sdk/commit/a587d7c36026fe1fcf93dfff63588abee359be76
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-js-sdk/releases/tag/v19.7.0
    reference_type:
    reference_id:
  - url: https://matrix.org/blog/2022/09/28/upgrade-now-to-address-encryption-vulns-in-matrix-sdks-and-clients
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202210-35
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1021136
    reference_type:
    reference_id: 1021136
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2135395
    reference_type:
    reference_id: 2135395
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:javascript_sdk:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:javascript_sdk:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-39250
    reference_type:
    reference_id: CVE-2022-39250
  - url: https://github.com/advisories/GHSA-5w8r-8pgj-5jmf
    reference_type:
    reference_id: GHSA-5w8r-8pgj-5jmf
  - url: https://github.com/matrix-org/matrix-js-sdk/security/advisories/GHSA-5w8r-8pgj-5jmf
    reference_type:
    reference_id: GHSA-5w8r-8pgj-5jmf
  - url: https://www.mozilla.org/en-US/security/advisories/mfsa2022-43
    reference_type:
    reference_id: mfsa2022-43
  - url: https://access.redhat.com/errata/RHSA-2022:7178
    reference_type:
    reference_id: RHSA-2022:7178
  - url: https://access.redhat.com/errata/RHSA-2022:7181
    reference_type:
    reference_id: RHSA-2022:7181
  - url: https://access.redhat.com/errata/RHSA-2022:7182
    reference_type:
    reference_id: RHSA-2022:7182
  - url: https://access.redhat.com/errata/RHSA-2022:7183
    reference_type:
    reference_id: RHSA-2022:7183
  - url: https://access.redhat.com/errata/RHSA-2022:7184
    reference_type:
    reference_id: RHSA-2022:7184
  - url: https://access.redhat.com/errata/RHSA-2022:7190
    reference_type:
    reference_id: RHSA-2022:7190
  - url: https://usn.ubuntu.com/5724-1/
    reference_type:
    reference_id: USN-5724-1
