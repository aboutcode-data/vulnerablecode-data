vulnerability_id: VCID-knzd-1yvd-a7dt
aliases:
  - CVE-2025-38124
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: fix udp gso skb_segment after pull from frag_list

  Commit a1e40ac5b5e9 ("net: gso: fix udp gso fraglist segmentation after
  pull from frag_list") detected invalid geometry in frag_list skbs and
  redirects them from skb_segment_list to more robust skb_segment. But some
  packets with modified geometry can also hit bugs in that code. We don't
  know how many such cases exist. Addressing each one by one also requires
  touching the complex skb_segment code, which risks introducing bugs for
  other types of skbs. Instead, linearize all these packets that fail the
  basic invariants on gso fraglist skbs. That is more robust.

  If only part of the fraglist payload is pulled into head_skb, it will
  always cause exception when splitting skbs by skb_segment. For detailed
  call stack information, see below.

  Valid SKB_GSO_FRAGLIST skbs
  - consist of two or more segments
  - the head_skb holds the protocol headers plus first gso_size
  - one or more frag_list skbs hold exactly one segment
  - all but the last must be gso_size

  Optional datapath hooks such as NAT and BPF (bpf_skb_pull_data) can
  modify fraglist skbs, breaking these invariants.

  In extreme cases they pull one part of data into skb linear. For UDP,
  this  causes three payloads with lengths of (11,11,10) bytes were
  pulled tail to become (12,10,10) bytes.

  The skbs no longer meets the above SKB_GSO_FRAGLIST conditions because
  payload was pulled into head_skb, it needs to be linearized before pass
  to regular skb_segment.

      skb_segment+0xcd0/0xd14
      __udp_gso_segment+0x334/0x5f4
      udp4_ufo_fragment+0x118/0x15c
      inet_gso_segment+0x164/0x338
      skb_mac_gso_segment+0xc4/0x13c
      __skb_gso_segment+0xc4/0x124
      validate_xmit_skb+0x9c/0x2c0
      validate_xmit_skb_list+0x4c/0x80
      sch_direct_xmit+0x70/0x404
      __dev_queue_xmit+0x64c/0xe5c
      neigh_resolve_output+0x178/0x1c4
      ip_finish_output2+0x37c/0x47c
      __ip_finish_output+0x194/0x240
      ip_finish_output+0x20/0xf4
      ip_output+0x100/0x1a0
      NF_HOOK+0xc4/0x16c
      ip_forward+0x314/0x32c
      ip_rcv+0x90/0x118
      __netif_receive_skb+0x74/0x124
      process_backlog+0xe8/0x1a4
      __napi_poll+0x5c/0x1f8
      net_rx_action+0x154/0x314
      handle_softirqs+0x154/0x4b8

      [118.376811] [C201134] rxq0_pus: [name:bug&]kernel BUG at net/core/skbuff.c:4278!
      [118.376829] [C201134] rxq0_pus: [name:traps&]Internal error: Oops - BUG: 00000000f2000800 [#1] PREEMPT SMP
      [118.470774] [C201134] rxq0_pus: [name:mrdump&]Kernel Offset: 0x178cc00000 from 0xffffffc008000000
      [118.470810] [C201134] rxq0_pus: [name:mrdump&]PHYS_OFFSET: 0x40000000
      [118.470827] [C201134] rxq0_pus: [name:mrdump&]pstate: 60400005 (nZCv daif +PAN -UAO)
      [118.470848] [C201134] rxq0_pus: [name:mrdump&]pc : [0xffffffd79598aefc] skb_segment+0xcd0/0xd14
      [118.470900] [C201134] rxq0_pus: [name:mrdump&]lr : [0xffffffd79598a5e8] skb_segment+0x3bc/0xd14
      [118.470928] [C201134] rxq0_pus: [name:mrdump&]sp : ffffffc008013770
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38124.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03052'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04726'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04719'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04688'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04685'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04692'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04605'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04606'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04698'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05366'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0527'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05307'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05305'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05309'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05279'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05325'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05512'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06126'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05843'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05857'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05885'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05864'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05962'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05983'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0602'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05916'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05919'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05884'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05987'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05986'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05991'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06141'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06164'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06129'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06111'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06146'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06211'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06245'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06261'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.07164'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.07195'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11395'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1132'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1127'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11341'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11275'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11364'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11304'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11291'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11289'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15491'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15532'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-704
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38124.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38124
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38124
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0e65f38bd1aa14ea86e221b7bb814d38278d86c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3382a1ed7f778db841063f5d7e317ac55f9e7f72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4399f59a9467a324ed46657555f0e1f209a14acb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/85eef1748c024da1a191aed56b30a3a65958c50c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a04302867094bdc6efac1b598370fc47cf3f2388
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2376041
    reference_type:
    reference_id: 2376041
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38124
    reference_type:
    reference_id: CVE-2025-38124
  - url: https://access.redhat.com/errata/RHSA-2025:13962
    reference_type:
    reference_id: RHSA-2025:13962
  - url: https://access.redhat.com/errata/RHSA-2025:14009
    reference_type:
    reference_id: RHSA-2025:14009
  - url: https://usn.ubuntu.com/7769-1/
    reference_type:
    reference_id: USN-7769-1
  - url: https://usn.ubuntu.com/7769-2/
    reference_type:
    reference_id: USN-7769-2
  - url: https://usn.ubuntu.com/7769-3/
    reference_type:
    reference_id: USN-7769-3
  - url: https://usn.ubuntu.com/7770-1/
    reference_type:
    reference_id: USN-7770-1
  - url: https://usn.ubuntu.com/7771-1/
    reference_type:
    reference_id: USN-7771-1
  - url: https://usn.ubuntu.com/7789-1/
    reference_type:
    reference_id: USN-7789-1
  - url: https://usn.ubuntu.com/7789-2/
    reference_type:
    reference_id: USN-7789-2
