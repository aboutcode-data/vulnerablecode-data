vulnerability_id: VCID-npmx-g9da-e3eg
aliases:
  - CVE-2025-38050
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/hugetlb: fix kernel NULL pointer dereference when replacing free hugetlb folios

  A kernel crash was observed when replacing free hugetlb folios:

  BUG: kernel NULL pointer dereference, address: 0000000000000028
  PGD 0 P4D 0
  Oops: Oops: 0000 [#1] SMP NOPTI
  CPU: 28 UID: 0 PID: 29639 Comm: test_cma.sh Tainted 6.15.0-rc6-zp #41 PREEMPT(voluntary)
  RIP: 0010:alloc_and_dissolve_hugetlb_folio+0x1d/0x1f0
  RSP: 0018:ffffc9000b30fa90 EFLAGS: 00010286
  RAX: 0000000000000000 RBX: 0000000000342cca RCX: ffffea0043000000
  RDX: ffffc9000b30fb08 RSI: ffffea0043000000 RDI: 0000000000000000
  RBP: ffffc9000b30fb20 R08: 0000000000001000 R09: 0000000000000000
  R10: ffff88886f92eb00 R11: 0000000000000000 R12: ffffea0043000000
  R13: 0000000000000000 R14: 00000000010c0200 R15: 0000000000000004
  FS:  00007fcda5f14740(0000) GS:ffff8888ec1d8000(0000) knlGS:0000000000000000
  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
  CR2: 0000000000000028 CR3: 0000000391402000 CR4: 0000000000350ef0
  Call Trace:
  <TASK>
   replace_free_hugepage_folios+0xb6/0x100
   alloc_contig_range_noprof+0x18a/0x590
   ? srso_return_thunk+0x5/0x5f
   ? down_read+0x12/0xa0
   ? srso_return_thunk+0x5/0x5f
   cma_range_alloc.constprop.0+0x131/0x290
   __cma_alloc+0xcf/0x2c0
   cma_alloc_write+0x43/0xb0
   simple_attr_write_xsigned.constprop.0.isra.0+0xb2/0x110
   debugfs_attr_write+0x46/0x70
   full_proxy_write+0x62/0xa0
   vfs_write+0xf8/0x420
   ? srso_return_thunk+0x5/0x5f
   ? filp_flush+0x86/0xa0
   ? srso_return_thunk+0x5/0x5f
   ? filp_close+0x1f/0x30
   ? srso_return_thunk+0x5/0x5f
   ? do_dup2+0xaf/0x160
   ? srso_return_thunk+0x5/0x5f
   ksys_write+0x65/0xe0
   do_syscall_64+0x64/0x170
   entry_SYSCALL_64_after_hwframe+0x76/0x7e

  There is a potential race between __update_and_free_hugetlb_folio() and
  replace_free_hugepage_folios():

  CPU1                              CPU2
  __update_and_free_hugetlb_folio   replace_free_hugepage_folios
                                      folio_test_hugetlb(folio)
                                      -- It's still hugetlb folio.

    __folio_clear_hugetlb(folio)
    hugetlb_free_folio(folio)
                                      h = folio_hstate(folio)
                                      -- Here, h is NULL pointer

  When the above race condition occurs, folio_hstate(folio) returns NULL,
  and subsequent access to this NULL pointer will cause the system to crash.
  To resolve this issue, execute folio_hstate(folio) under the protection
  of the hugetlb_lock lock, ensuring that folio_hstate(folio) does not
  return NULL.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38050.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0309'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03065'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03993'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.04004'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04916'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04908'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04883'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0489'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04893'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04918'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04904'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04976'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04888'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05506'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05484'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0553'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05562'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05459'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05457'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05472'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0551'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06481'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06486'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06082'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06033'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06051'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06068'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06048'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06162'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06184'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06218'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06113'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0612'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06087'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06199'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06198'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0636'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06342'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06379'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06345'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06328'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06366'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06435'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06469'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09512'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09494'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09603'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09541'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0955'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09552'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09559'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09583'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0972'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0968'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09563'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38050.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38050
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/113ed54ad276c352ee5ce109bdcf0df118a43bda
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e97283978a9848190d451f7038ac399613445f79
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2373364
    reference_type:
    reference_id: 2373364
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38050
    reference_type:
    reference_id: CVE-2025-38050
  - url: https://usn.ubuntu.com/7769-1/
    reference_type:
    reference_id: USN-7769-1
  - url: https://usn.ubuntu.com/7769-2/
    reference_type:
    reference_id: USN-7769-2
  - url: https://usn.ubuntu.com/7769-3/
    reference_type:
    reference_id: USN-7769-3
  - url: https://usn.ubuntu.com/7770-1/
    reference_type:
    reference_id: USN-7770-1
  - url: https://usn.ubuntu.com/7771-1/
    reference_type:
    reference_id: USN-7771-1
  - url: https://usn.ubuntu.com/7789-1/
    reference_type:
    reference_id: USN-7789-1
  - url: https://usn.ubuntu.com/7789-2/
    reference_type:
    reference_id: USN-7789-2
