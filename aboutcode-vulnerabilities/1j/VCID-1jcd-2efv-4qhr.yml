vulnerability_id: VCID-1jcd-2efv-4qhr
aliases:
  - CVE-2025-23138
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  watch_queue: fix pipe accounting mismatch

  Currently, watch_queue_set_size() modifies the pipe buffers charged to
  user->pipe_bufs without updating the pipe->nr_accounted on the pipe
  itself, due to the if (!pipe_has_watch_queue()) test in
  pipe_resize_ring(). This means that when the pipe is ultimately freed,
  we decrement user->pipe_bufs by something other than what than we had
  charged to it, potentially leading to an underflow. This in turn can
  cause subsequent too_many_pipe_buffers_soft() tests to fail with -EPERM.

  To remedy this, explicitly account for the pipe usage in
  watch_queue_set_size() to match the number set via account_pipe_buffers()

  (It's unclear why watch_queue_set_size() does not update nr_accounted;
  it may be due to intentional overprovisioning in watch_queue_set_size()?)
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-23138.json
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05064'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05038'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05028'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05076'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07685'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0768'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07616'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07701'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07683'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07679'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07674'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-23138.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-23138
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-23138
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/205028ebba838938d3b264dda1d0708fa7fe1ade
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2d680b988656bb556c863d8b46d9b9096842bf3d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/471c89b7d4f58bd6082f7c1fe14d4ca15c7f1284
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/56ec918e6c86c1536870e4373e91eddd0c44245f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6dafa27764183738dc5368b669b71e3d0d154f12
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8658c75343ed00e5e154ebbe24335f51ba8db547
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d40e3537265dea9e3c33021874437ff26dc18787
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f13abc1e8e1a3b7455511c4e122750127f6bc9b0
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2360211
    reference_type:
    reference_id: 2360211
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23138
    reference_type:
    reference_id: CVE-2025-23138
