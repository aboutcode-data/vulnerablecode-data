vulnerability_id: VCID-t4fh-2cd6-qucx
aliases:
  - CVE-2025-66469
  - GHSA-72qc-wxch-74mg
summary: "NiceGUI Reflected XSS in ui.add_css, ui.add_scss, and ui.add_sass via Style Injection\n\
  ### Summary\nA Cross-Site Scripting (XSS) vulnerability exists in `ui.add_css`, `ui.add_scss`,\
  \ and `ui.add_sass` functions in NiceGUI (v3.3.1 and earlier).\n\nThese functions allow developers\
  \ to inject styles dynamically. However, they lack proper sanitization or encoding for the\
  \ JavaScript context they generate. An attacker can break out of the intended `<style>` or\
  \ `<script>` tags by injecting closing tags (e.g., `</style>` or `</script>`), allowing for\
  \ the execution of arbitrary JavaScript.\n\n### Details\nThe vulnerability stems from how\
  \ these functions inject content into the DOM using `client.run_javascript` (or `add_head_html`\
  \ internally) without sufficient escaping for the transport layer.\n\n* **`ui.add_css`**:\
  \ Injects content into a `<style>` tag. Input containing `</style>` closes the tag prematurely,\
  \ allowing subsequent HTML/JS injection.\n* **`ui.add_scss` / `ui.add_sass`**: These rely\
  \ on client-side compilation within `<script>` tags. Input containing `</script>` breaks the\
  \ execution context, allowing XSS.\n\n### PoC\n**Scenario:** A developer allows users to customize\
  \ a theme color via a URL parameter.\n\n```python\nfrom nicegui import ui\n\n@ui.page('/')\n\
  def main(color: str = 'blue'):\n    # Vulnerable implementation of dynamic theming\n    ui.add_css(f'.q-btn\
  \ {{ background-color: {color} !important; }}')\n    ui.button('Click Me')\n\nui.run(port=8082)\n\
  ```\n**Attack Vector:**\nAccessing the following URL executes arbitrary JavaScript:\n`http://localhost:8082/?color=red;}</style><img\
  \ src=x onerror=alert(document.domain)><style>`\n\n### Impact\n* **Type:** Reflected XSS\n\
  * **Severity:** Moderate \n* **Affected Components:** Applications using `ui.add_css`, `ui.add_scss`,\
  \ or `ui.add_sass` with untrusted input (e.g., dynamic theming based on user input)."
severities:
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.11167'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66469
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12397'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66469
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-72qc-wxch-74mg
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/zauberzeug/nicegui
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zauberzeug/nicegui
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/zauberzeug/nicegui/commit/a8fd25b7d5e23afb1952d0f60a1940e18b5f1ca8
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zauberzeug/nicegui/commit/a8fd25b7d5e23afb1952d0f60a1940e18b5f1ca8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-09T14:18:04Z/
    published_at: None
    url: https://github.com/zauberzeug/nicegui/commit/a8fd25b7d5e23afb1952d0f60a1940e18b5f1ca8
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/zauberzeug/nicegui/security/advisories/GHSA-72qc-wxch-74mg
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/zauberzeug/nicegui/security/advisories/GHSA-72qc-wxch-74mg
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zauberzeug/nicegui/security/advisories/GHSA-72qc-wxch-74mg
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-09T14:18:04Z/
    published_at: None
    url: https://github.com/zauberzeug/nicegui/security/advisories/GHSA-72qc-wxch-74mg
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66469
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66469
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-66469
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui/commit/a8fd25b7d5e23afb1952d0f60a1940e18b5f1ca8
    reference_type:
    reference_id:
  - url: https://github.com/zauberzeug/nicegui/security/advisories/GHSA-72qc-wxch-74mg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66469
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-72qc-wxch-74mg
    reference_type:
    reference_id: GHSA-72qc-wxch-74mg
