vulnerability_id: VCID-2dyg-8rqs-aaag
aliases:
  - CVE-2022-48628
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ceph: drop messages from MDS when unmounting

  When unmounting all the dirty buffers will be flushed and after
  the last osd request is finished the last reference of the i_count
  will be released. Then it will flush the dirty cap/snap to MDSs,
  and the unmounting won't wait the possible acks, which will ihold
  the inodes when updating the metadata locally but makes no sense
  any more, of this. This will make the evict_inodes() to skip these
  inodes.

  If encrypt is enabled the kernel generate a warning when removing
  the encrypt keys when the skipped inodes still hold the keyring:

  WARNING: CPU: 4 PID: 168846 at fs/crypto/keyring.c:242 fscrypt_destroy_keyring+0x7e/0xd0
  CPU: 4 PID: 168846 Comm: umount Tainted: G S  6.1.0-rc5-ceph-g72ead199864c #1
  Hardware name: Supermicro SYS-5018R-WR/X10SRW-F, BIOS 2.0 12/17/2015
  RIP: 0010:fscrypt_destroy_keyring+0x7e/0xd0
  RSP: 0018:ffffc9000b277e28 EFLAGS: 00010202
  RAX: 0000000000000002 RBX: ffff88810d52ac00 RCX: ffff88810b56aa00
  RDX: 0000000080000000 RSI: ffffffff822f3a09 RDI: ffff888108f59000
  RBP: ffff8881d394fb88 R08: 0000000000000028 R09: 0000000000000000
  R10: 0000000000000001 R11: 11ff4fe6834fcd91 R12: ffff8881d394fc40
  R13: ffff888108f59000 R14: ffff8881d394f800 R15: 0000000000000000
  FS:  00007fd83f6f1080(0000) GS:ffff88885fd00000(0000) knlGS:0000000000000000
  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
  CR2: 00007f918d417000 CR3: 000000017f89a005 CR4: 00000000003706e0
  DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
  DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
  Call Trace:
  <TASK>
  generic_shutdown_super+0x47/0x120
  kill_anon_super+0x14/0x30
  ceph_kill_sb+0x36/0x90 [ceph]
  deactivate_locked_super+0x29/0x60
  cleanup_mnt+0xb8/0x140
  task_work_run+0x67/0xb0
  exit_to_user_mode_prepare+0x23d/0x240
  syscall_exit_to_user_mode+0x25/0x60
  do_syscall_64+0x40/0x80
  entry_SYSCALL_64_after_hwframe+0x63/0xcd
  RIP: 0033:0x7fd83dc39e9b

  Later the kernel will crash when iput() the inodes and dereferencing
  the "sb->s_master_keys", which has been released by the
  generic_shutdown_super().
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48628.json
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.0057'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08547'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08685'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08527'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08669'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08691'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08662'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08692'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08682'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08706'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.24527'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00629'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00631'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00635'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00419'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00423'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00421'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00627'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00628'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00624'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00626'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00622'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48628
weaknesses:
  - CWE-311
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48628.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-48628
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-48628
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/47f82395f04a976d4fa97de7f2acffa1c1096571
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/89744b64914426cbabceb3d8a149176b5dafdfb5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e3dfcab2080dc1f9a4b09cc1327361bc2845bfcd
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2267507
    reference_type:
    reference_id: 2267507
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48628
    reference_type:
    reference_id: CVE-2022-48628
