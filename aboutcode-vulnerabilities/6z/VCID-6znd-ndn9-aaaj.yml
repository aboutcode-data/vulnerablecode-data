vulnerability_id: VCID-6znd-ndn9-aaaj
aliases:
  - CVE-2024-35885
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mlxbf_gige: stop interface during shutdown

  The mlxbf_gige driver intermittantly encounters a NULL pointer
  exception while the system is shutting down via "reboot" command.
  The mlxbf_driver will experience an exception right after executing
  its shutdown() method.  One example of this exception is:

  Unable to handle kernel NULL pointer dereference at virtual address 0000000000000070
  Mem abort info:
    ESR = 0x0000000096000004
    EC = 0x25: DABT (current EL), IL = 32 bits
    SET = 0, FnV = 0
    EA = 0, S1PTW = 0
    FSC = 0x04: level 0 translation fault
  Data abort info:
    ISV = 0, ISS = 0x00000004
    CM = 0, WnR = 0
  user pgtable: 4k pages, 48-bit VAs, pgdp=000000011d373000
  [0000000000000070] pgd=0000000000000000, p4d=0000000000000000
  Internal error: Oops: 96000004 [#1] SMP
  CPU: 0 PID: 13 Comm: ksoftirqd/0 Tainted: G S         OE     5.15.0-bf.6.gef6992a #1
  Hardware name: https://www.mellanox.com BlueField SoC/BlueField SoC, BIOS 4.0.2.12669 Apr 21 2023
  pstate: 20400009 (nzCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)
  pc : mlxbf_gige_handle_tx_complete+0xc8/0x170 [mlxbf_gige]
  lr : mlxbf_gige_poll+0x54/0x160 [mlxbf_gige]
  sp : ffff8000080d3c10
  x29: ffff8000080d3c10 x28: ffffcce72cbb7000 x27: ffff8000080d3d58
  x26: ffff0000814e7340 x25: ffff331cd1a05000 x24: ffffcce72c4ea008
  x23: ffff0000814e4b40 x22: ffff0000814e4d10 x21: ffff0000814e4128
  x20: 0000000000000000 x19: ffff0000814e4a80 x18: ffffffffffffffff
  x17: 000000000000001c x16: ffffcce72b4553f4 x15: ffff80008805b8a7
  x14: 0000000000000000 x13: 0000000000000030 x12: 0101010101010101
  x11: 7f7f7f7f7f7f7f7f x10: c2ac898b17576267 x9 : ffffcce720fa5404
  x8 : ffff000080812138 x7 : 0000000000002e9a x6 : 0000000000000080
  x5 : ffff00008de3b000 x4 : 0000000000000000 x3 : 0000000000000001
  x2 : 0000000000000000 x1 : 0000000000000000 x0 : 0000000000000000
  Call trace:
   mlxbf_gige_handle_tx_complete+0xc8/0x170 [mlxbf_gige]
   mlxbf_gige_poll+0x54/0x160 [mlxbf_gige]
   __napi_poll+0x40/0x1c8
   net_rx_action+0x314/0x3a0
   __do_softirq+0x128/0x334
   run_ksoftirqd+0x54/0x6c
   smpboot_thread_fn+0x14c/0x190
   kthread+0x10c/0x110
   ret_from_fork+0x10/0x20
  Code: 8b070000 f9000ea0 f95056c0 f86178a1 (b9407002)
  ---[ end trace 7cc3941aa0d8e6a4 ]---
  Kernel panic - not syncing: Oops: Fatal exception in interrupt
  Kernel Offset: 0x4ce722520000 from 0xffff800008000000
  PHYS_OFFSET: 0x80000000
  CPU features: 0x000005c1,a3330e5a
  Memory Limit: none
  ---[ end Kernel panic - not syncing: Oops: Fatal exception in interrupt ]---

  During system shutdown, the mlxbf_gige driver's shutdown() is always executed.
  However, the driver's stop() method will only execute if networking interface
  configuration logic within the Linux distribution has been setup to do so.

  If shutdown() executes but stop() does not execute, NAPI remains enabled
  and this can lead to an exception if NAPI is scheduled while the hardware
  interface has only been partially deinitialized.

  The networking interface managed by the mlxbf_gige driver must be properly
  stopped during system shutdown so that IFF_UP is cleared, the hardware
  interface is put into a clean state, and NAPI is fully deinitialized.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-35885.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18064'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17842'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17915'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18011'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18086'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18075'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18059'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18029'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18022'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18035'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18044'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.1807'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18073'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18066'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23082'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23027'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.2301'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.22986'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23025'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23046'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23067'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23008'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.22939'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23083'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23102'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23108'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23098'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23045'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23009'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '0.00381'
    scoring_system: epss
    scoring_elements: '0.42492'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-35885
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-35885.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-35885
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/09ba28e1cd3cf715daab1fca6e1623e22fd754a6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/36a1cb0371aa6f0698910ee70cb4ed3c349f4fa4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/63a10b530e22cc923008b5925821c26872f37971
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/80247e0eca14ff177d565f58ecd3010f6b7910a4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9783b3b0e71d704949214a8f76468f591a31f3f5
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2281700
    reference_type:
    reference_id: 2281700
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35885
    reference_type:
    reference_id: CVE-2024-35885
  - url: https://access.redhat.com/errata/RHSA-2024:4928
    reference_type:
    reference_id: RHSA-2024:4928
  - url: https://access.redhat.com/errata/RHSA-2024:5066
    reference_type:
    reference_id: RHSA-2024:5066
  - url: https://access.redhat.com/errata/RHSA-2024:5067
    reference_type:
    reference_id: RHSA-2024:5067
  - url: https://usn.ubuntu.com/6893-1/
    reference_type:
    reference_id: USN-6893-1
  - url: https://usn.ubuntu.com/6893-2/
    reference_type:
    reference_id: USN-6893-2
  - url: https://usn.ubuntu.com/6893-3/
    reference_type:
    reference_id: USN-6893-3
  - url: https://usn.ubuntu.com/6898-1/
    reference_type:
    reference_id: USN-6898-1
  - url: https://usn.ubuntu.com/6898-2/
    reference_type:
    reference_id: USN-6898-2
  - url: https://usn.ubuntu.com/6898-3/
    reference_type:
    reference_id: USN-6898-3
  - url: https://usn.ubuntu.com/6898-4/
    reference_type:
    reference_id: USN-6898-4
  - url: https://usn.ubuntu.com/6917-1/
    reference_type:
    reference_id: USN-6917-1
  - url: https://usn.ubuntu.com/6918-1/
    reference_type:
    reference_id: USN-6918-1
  - url: https://usn.ubuntu.com/6919-1/
    reference_type:
    reference_id: USN-6919-1
  - url: https://usn.ubuntu.com/6927-1/
    reference_type:
    reference_id: USN-6927-1
  - url: https://usn.ubuntu.com/7019-1/
    reference_type:
    reference_id: USN-7019-1
