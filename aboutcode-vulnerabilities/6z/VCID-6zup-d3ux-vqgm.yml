vulnerability_id: VCID-6zup-d3ux-vqgm
aliases:
  - CVE-2022-49977
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ftrace: Fix NULL
  pointer dereference in is_ftrace_trampoline when ftrace is dead  ftrace_startup does not remove
  ops from ftrace_ops_list when ftrace_startup_enable fails:  register_ftrace_function   ftrace_startup     __register_ftrace_function       ...       add_ftrace_ops(&ftrace_ops_list,
  ops)       ...     ...     ftrace_startup_enable // if ftrace failed to modify, ftrace_disabled
  is set to 1     ...   return 0 // ops is in the ftrace_ops_list.  When ftrace_disabled = 1,
  unregister_ftrace_function simply returns without doing anything: unregister_ftrace_function   ftrace_shutdown     if
  (unlikely(ftrace_disabled))             return -ENODEV;  // return here, __unregister_ftrace_function
  is not executed,                              // as a result, ops is still in the ftrace_ops_list     __unregister_ftrace_function     ...  If
  ops is dynamically allocated, it will be free later, in this case, is_ftrace_trampoline accesses
  NULL pointer:  is_ftrace_trampoline   ftrace_ops_trampoline     do_for_each_ftrace_op(op,
  ftrace_ops_list) // OOPS! op may be NULL!  Syzkaller reports as follows: [ 1203.506103] BUG:
  kernel NULL pointer dereference, address: 000000000000010b [ 1203.508039] #PF: supervisor
  read access in kernel mode [ 1203.508798] #PF: error_code(0x0000) - not-present page [ 1203.509558]
  PGD 800000011660b067 P4D 800000011660b067 PUD 130fb8067 PMD 0 [ 1203.510560] Oops: 0000 [#1]
  SMP KASAN PTI [ 1203.511189] CPU: 6 PID: 29532 Comm: syz-executor.2 Tainted: G    B   W         5.10.0
  #8 [ 1203.512324] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qemu.org
  04/01/2014 [ 1203.513895] RIP: 0010:is_ftrace_trampoline+0x26/0xb0 [ 1203.514644] Code: ff
  eb d3 90 41 55 41 54 49 89 fc 55 53 e8 f2 00 fd ff 48 8b 1d 3b 35 5d 03 e8 e6 00 fd ff 48
  8d bb 90 00 00 00 e8 2a 81 26 00 <48> 8b ab 90 00 00 00 48 85 ed 74 1d e8 c9 00 fd ff 48 8d
  bb 98 00 [ 1203.518838] RSP: 0018:ffffc900012cf960 EFLAGS: 00010246 [ 1203.520092] RAX: 0000000000000000
  RBX: 000000000000007b RCX: ffffffff8a331866 [ 1203.521469] RDX: 0000000000000000 RSI: 0000000000000008
  RDI: 000000000000010b [ 1203.522583] RBP: 0000000000000000 R08: 0000000000000000 R09: ffffffff8df18b07
  [ 1203.523550] R10: fffffbfff1be3160 R11: 0000000000000001 R12: 0000000000478399 [ 1203.524596]
  R13: 0000000000000000 R14: ffff888145088000 R15: 0000000000000008 [ 1203.525634] FS:  00007f429f5f4700(0000)
  GS:ffff8881daf00000(0000) knlGS:0000000000000000 [ 1203.526801] CS:  0010 DS: 0000 ES: 0000
  CR0: 0000000080050033 [ 1203.527626] CR2: 000000000000010b CR3: 0000000170e1e001 CR4: 00000000003706e0
  [ 1203.528611] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 [ 1203.529605]
  DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400  Therefore, when ftrace_startup_enable
  fails, we need to rollback registration process and remove ops from ftrace_ops_list.'
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49977.json
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01881'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01903'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05026'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05031'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0749'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07522'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07439'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07393'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07416'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0738'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07395'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07512'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0758'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07535'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08257'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08287'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08296'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08329'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08389'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08369'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0841'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08384'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08228'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1032'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0966'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09654'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09672'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09772'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09751'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09861'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09926'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09979'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0992'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10024'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09997'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10155'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10134'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10135'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10279'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10267'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10299'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10271'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10242'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10287'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10284'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10333'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1031'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14246'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14174'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14282'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1429'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14255'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14253'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14259'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14375'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14327'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14266'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-763
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49977.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-49977
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-49977
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c34a2a6c9927c239dd2e295a03d49b37b618d2c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8569b4ada1e0b9bfaa125bd0c0967918b6560fa2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/934e49f7d696afdae9f979abe3f308408184e17b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c3b0f72e805f0801f05fa2aa52011c4bfc694c44
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d81bd6671f45fde4c3ac7fd7733c6e3082ae9d8e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dbd8c8fc60480e3faa3ae7e27ebe03371ecd1b77
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ddffe882d74ef43a3494f0ab0c24baf076c45f96
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e4ae97295984ff1b9b340ed18ae1b066f36b7835
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2373574
    reference_type:
    reference_id: 2373574
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49977
    reference_type:
    reference_id: CVE-2022-49977
  - url: https://access.redhat.com/errata/RHSA-2024:2394
    reference_type:
    reference_id: RHSA-2024:2394
  - url: https://access.redhat.com/errata/RHSA-2025:11850
    reference_type:
    reference_id: RHSA-2025:11850
  - url: https://access.redhat.com/errata/RHSA-2025:11851
    reference_type:
    reference_id: RHSA-2025:11851
  - url: https://access.redhat.com/errata/RHSA-2025:14511
    reference_type:
    reference_id: RHSA-2025:14511
  - url: https://access.redhat.com/errata/RHSA-2025:14691
    reference_type:
    reference_id: RHSA-2025:14691
  - url: https://access.redhat.com/errata/RHSA-2025:14692
    reference_type:
    reference_id: RHSA-2025:14692
  - url: https://access.redhat.com/errata/RHSA-2025:14696
    reference_type:
    reference_id: RHSA-2025:14696
  - url: https://access.redhat.com/errata/RHSA-2025:14742
    reference_type:
    reference_id: RHSA-2025:14742
  - url: https://access.redhat.com/errata/RHSA-2025:14744
    reference_type:
    reference_id: RHSA-2025:14744
  - url: https://access.redhat.com/errata/RHSA-2025:14749
    reference_type:
    reference_id: RHSA-2025:14749
  - url: https://access.redhat.com/errata/RHSA-2025:15035
    reference_type:
    reference_id: RHSA-2025:15035
