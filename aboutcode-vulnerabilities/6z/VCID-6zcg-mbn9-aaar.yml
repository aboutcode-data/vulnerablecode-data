vulnerability_id: VCID-6zcg-mbn9-aaar
aliases:
  - CVE-2021-38305
  - GHSA-435p-f82x-mxwm
  - PYSEC-2021-119
summary: 23andMe Yamale before 3.0.8 allows remote attackers to execute arbitrary code via a
  crafted schema file. The schema parser uses eval as part of its processing, and tries to protect
  from malicious expressions by limiting the builtins that are passed to the eval. When processing
  the schema, each line is run through Python's eval function to make the validator available.
  A well-constructed string within the schema rules can execute system commands; thus, by exploiting
  the vulnerability, an attacker can run arbitrary code on the image that invokes Yamale.
severities:
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56362'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56428'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56417'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56422'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56342'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56427'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56675'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56631'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56592'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56011'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56274'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.56450'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00518'
    scoring_system: epss
    scoring_elements: '0.76773'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00518'
    scoring_system: epss
    scoring_elements: '0.76632'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00518'
    scoring_system: epss
    scoring_elements: '0.76616'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00518'
    scoring_system: epss
    scoring_elements: '0.76599'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00586'
    scoring_system: epss
    scoring_elements: '0.52425'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69153'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69093'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69123'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69148'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69171'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69172'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69149'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69142'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.6915'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69154'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69161'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69173'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69174'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69169'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.6799'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.67972'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68073'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68079'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68095'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68114'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68101'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68096'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68103'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68119'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68126'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68135'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.6813'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68117'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.68097'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/23andMe/Yamale
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/23andMe/Yamale
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/23andMe/Yamale/pull/165
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/23andMe/Yamale/pull/165
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/23andMe/Yamale/releases/tag/3.0.8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/23andMe/Yamale/releases/tag/3.0.8
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-435p-f82x-mxwm
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/yamale/PYSEC-2021-119.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/yamale/PYSEC-2021-119.yaml
  - score: '9.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-38305
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-38305
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-38305
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-38305
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-434
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-38305
    reference_type:
    reference_id:
  - url: https://github.com/23andMe/Yamale
    reference_type:
    reference_id:
  - url: https://github.com/23andMe/Yamale/pull/165
    reference_type:
    reference_id:
  - url: https://github.com/23andMe/Yamale/releases/tag/3.0.8
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/yamale/PYSEC-2021-119.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:23andme:yamale:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:23andme:yamale:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-38305
    reference_type:
    reference_id: CVE-2021-38305
  - url: https://github.com/advisories/GHSA-435p-f82x-mxwm
    reference_type:
    reference_id: GHSA-435p-f82x-mxwm
