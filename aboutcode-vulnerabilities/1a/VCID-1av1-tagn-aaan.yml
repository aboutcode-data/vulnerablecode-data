vulnerability_id: VCID-1av1-tagn-aaan
aliases:
  - CVE-2024-0985
summary: Late privilege drop in REFRESH MATERIALIZED VIEW CONCURRENTLY in PostgreSQL allows
  an object creator to execute arbitrary SQL functions as the command issuer. The command intends
  to run SQL functions as the owner of the materialized view, enabling safe refresh of untrusted
  materialized views. The victim is a superuser or member of one of the attacker's roles. The
  attack requires luring the victim into running REFRESH MATERIALIZED VIEW CONCURRENTLY on the
  attacker's materialized view. Versions before PostgreSQL 16.2, 15.6, 14.11, 13.14, and 12.18
  are affected.
severities:
  - score: '8.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-0985.json
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27620'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27691'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.26898'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27169'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27242'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27269'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27328'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27313'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27323'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27384'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27335'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30989'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30978'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30991'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31342'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35503'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.47702'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.47839'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.47744'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.47742'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.47752'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.47772'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.47769'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.4778'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.47759'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.47733'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00251'
    scoring_system: epss
    scoring_elements: '0.48347'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00251'
    scoring_system: epss
    scoring_elements: '0.48401'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00251'
    scoring_system: epss
    scoring_elements: '0.48458'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00251'
    scoring_system: epss
    scoring_elements: '0.4848'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57705'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57721'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57733'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57723'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57713'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.577'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57673'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57672'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57659'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57675'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57603'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57552'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57645'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57651'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.00397'
    scoring_system: epss
    scoring_elements: '0.57693'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: '0.01256'
    scoring_system: epss
    scoring_elements: '0.66889'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
  - score: 8
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '8.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-0985
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-0985
  - score: '8.0'
    scoring_system: cvssv3
    scoring_elements: '[''AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H'']'
    published_at: None
    url: https://www.postgresql.org/support/security/CVE-2024-0985/
weaknesses:
  - CWE-271
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-0985.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-0985
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-0985
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/03/msg00017.html
    reference_type:
    reference_id:
  - url: https://saites.dev/projects/personal/postgres-cve-2024-0985/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20241220-0005/
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/about/news/postgresql-162-156-1411-1314-and-1218-released-2807/
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/support/security/CVE-2024-0985/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2263384
    reference_type:
    reference_id: 2263384
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-0985
    reference_type:
    reference_id: CVE-2024-0985
  - url: https://security.gentoo.org/glsa/202408-06
    reference_type:
    reference_id: GLSA-202408-06
  - url: https://access.redhat.com/errata/RHSA-2024:0950
    reference_type:
    reference_id: RHSA-2024:0950
  - url: https://access.redhat.com/errata/RHSA-2024:0951
    reference_type:
    reference_id: RHSA-2024:0951
  - url: https://access.redhat.com/errata/RHSA-2024:0956
    reference_type:
    reference_id: RHSA-2024:0956
  - url: https://access.redhat.com/errata/RHSA-2024:0973
    reference_type:
    reference_id: RHSA-2024:0973
  - url: https://access.redhat.com/errata/RHSA-2024:0974
    reference_type:
    reference_id: RHSA-2024:0974
  - url: https://access.redhat.com/errata/RHSA-2024:0975
    reference_type:
    reference_id: RHSA-2024:0975
  - url: https://access.redhat.com/errata/RHSA-2024:0988
    reference_type:
    reference_id: RHSA-2024:0988
  - url: https://access.redhat.com/errata/RHSA-2024:0990
    reference_type:
    reference_id: RHSA-2024:0990
  - url: https://access.redhat.com/errata/RHSA-2024:0992
    reference_type:
    reference_id: RHSA-2024:0992
  - url: https://access.redhat.com/errata/RHSA-2024:1017
    reference_type:
    reference_id: RHSA-2024:1017
  - url: https://access.redhat.com/errata/RHSA-2024:1069
    reference_type:
    reference_id: RHSA-2024:1069
  - url: https://access.redhat.com/errata/RHSA-2024:1070
    reference_type:
    reference_id: RHSA-2024:1070
  - url: https://access.redhat.com/errata/RHSA-2024:1071
    reference_type:
    reference_id: RHSA-2024:1071
  - url: https://access.redhat.com/errata/RHSA-2024:1195
    reference_type:
    reference_id: RHSA-2024:1195
  - url: https://access.redhat.com/errata/RHSA-2024:1240
    reference_type:
    reference_id: RHSA-2024:1240
  - url: https://access.redhat.com/errata/RHSA-2024:1241
    reference_type:
    reference_id: RHSA-2024:1241
  - url: https://access.redhat.com/errata/RHSA-2024:1314
    reference_type:
    reference_id: RHSA-2024:1314
  - url: https://access.redhat.com/errata/RHSA-2024:1315
    reference_type:
    reference_id: RHSA-2024:1315
  - url: https://access.redhat.com/errata/RHSA-2024:1348
    reference_type:
    reference_id: RHSA-2024:1348
  - url: https://access.redhat.com/errata/RHSA-2024:1422
    reference_type:
    reference_id: RHSA-2024:1422
  - url: https://access.redhat.com/errata/RHSA-2024:1426
    reference_type:
    reference_id: RHSA-2024:1426
  - url: https://access.redhat.com/errata/RHSA-2024:1428
    reference_type:
    reference_id: RHSA-2024:1428
  - url: https://access.redhat.com/errata/RHSA-2024:1429
    reference_type:
    reference_id: RHSA-2024:1429
  - url: https://access.redhat.com/errata/RHSA-2024:1437
    reference_type:
    reference_id: RHSA-2024:1437
  - url: https://usn.ubuntu.com/6656-1/
    reference_type:
    reference_id: USN-6656-1
  - url: https://usn.ubuntu.com/6656-2/
    reference_type:
    reference_id: USN-6656-2
