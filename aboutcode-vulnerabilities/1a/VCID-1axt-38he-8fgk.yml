vulnerability_id: VCID-1axt-38he-8fgk
aliases:
  - CVE-2025-47950
  - GHSA-cvx7-x8pj-x2gw
summary: |
  CoreDNS Vulnerable to DoQ Memory Exhaustion via Stream Amplification
  ### Summary

  A **Denial of Service (DoS)** vulnerability was discovered in the CoreDNS DNS-over-QUIC (DoQ) server implementation. The server previously created a new goroutine for every incoming QUIC stream without imposing any limits on the number of concurrent streams or goroutines. A remote, unauthenticated attacker could open a large number of streams, leading to uncontrolled memory consumption and eventually causing an Out Of Memory (OOM) crash â€” especially in containerized or memory-constrained environments.

  ### Impact

  - **Component**: `server_quic.go`
  - **Attack Vector**: Remote, network-based
  - **Attack Complexity**: Low
  - **Privileges Required**: None
  - **User Interaction**: None
  - **Impact**: High availability loss (OOM kill or unresponsiveness)

  This issue affects deployments with `quic://` enabled in the Corefile. A single attacker can cause the CoreDNS instance to become unresponsive using minimal bandwidth and CPU.

  ### Patches

  The patch introduces two key mitigation mechanisms:

  - **`max_streams`**: Caps the number of concurrent QUIC streams per connection. Default: `256`.
  - **`worker_pool_size`**: Introduces a server-wide, bounded worker pool to process incoming streams. Default: `1024`.

  This eliminates the 1:1 stream-to-goroutine model and ensures that CoreDNS remains resilient under high concurrency. The new configuration options are exposed through the `quic` Corefile block:

  ```
  quic {
      max_streams 256
      worker_pool_size 1024
  }
  ```

  These defaults are generous and aligned with typical DNS-over-QUIC client behavior.

  ### Workarounds

  If you're unable to upgrade immediately, you can:
  - Disable QUIC support by removing or commenting out the `quic://` block in your Corefile
  - Use container runtime resource limits to detect and isolate excessive memory usage
  - Monitor QUIC connection patterns and alert on anomalies

  ### References

  - [RFC 9250 - DNS over Dedicated QUIC Connections](https://datatracker.ietf.org/doc/html/rfc9250)
  - [quic-go GitHub project](https://github.com/quic-go/quic-go)
  - [QUIC stream exhaustion class of vulnerabilities (related)](https://www.usenix.org/conference/usenixsecurity23/presentation/botella)

  ### Credit

  Thanks to [@thevilledev](https://github.com/thevilledev) for disclovering this vulnerability and contributing a high-quality fix.

  ### For more information

  Please consult our [security guide](https://github.com/coredns/coredns/blob/master/.github/SECURITY.md) for more information regarding our security process.
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-47950.json
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19754'
    published_at: '2025-06-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19764'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24986'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.25045'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.25106'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.25041'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.25087'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.25183'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.2507'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.25003'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26517'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26575'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26594'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26567'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26499'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26495'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26486'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26424'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26461'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.26322'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.2712'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27172'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27151'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.3064'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30623'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30735'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30726'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30747'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.3053'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30611'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30668'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30493'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30616'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30518'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30522'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30497'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30608'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30591'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30557'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.305'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30529'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30536'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00113'
    scoring_system: epss
    scoring_elements: '0.30491'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.31163'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.0012'
    scoring_system: epss
    scoring_elements: '0.31919'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37652'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37701'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37677'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37685'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37649'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.377'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37711'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37708'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37683'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37634'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37706'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37707'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37695'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37696'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00162'
    scoring_system: epss
    scoring_elements: '0.37714'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.39801'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '0.00188'
    scoring_system: epss
    scoring_elements: '0.40858'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://datatracker.ietf.org/doc/html/rfc9250
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://datatracker.ietf.org/doc/html/rfc9250
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-06-06T18:40:34Z/
    published_at: None
    url: https://datatracker.ietf.org/doc/html/rfc9250
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/coredns/coredns
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coredns/coredns
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/coredns/coredns/commit/efaed02c6a480ec147b1f799aab7cf815b17dfe1
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coredns/coredns/commit/efaed02c6a480ec147b1f799aab7cf815b17dfe1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-06-06T18:40:34Z/
    published_at: None
    url: https://github.com/coredns/coredns/commit/efaed02c6a480ec147b1f799aab7cf815b17dfe1
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/coredns/coredns/security/advisories/GHSA-cvx7-x8pj-x2gw
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coredns/coredns/security/advisories/GHSA-cvx7-x8pj-x2gw
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-06-06T18:40:34Z/
    published_at: None
    url: https://github.com/coredns/coredns/security/advisories/GHSA-cvx7-x8pj-x2gw
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/quic-go/quic-go
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/quic-go/quic-go
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-06-06T18:40:34Z/
    published_at: None
    url: https://github.com/quic-go/quic-go
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-47950
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-47950
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://www.usenix.org/conference/usenixsecurity23/presentation/botella
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.usenix.org/conference/usenixsecurity23/presentation/botella
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-06-06T18:40:34Z/
    published_at: None
    url: https://www.usenix.org/conference/usenixsecurity23/presentation/botella
weaknesses:
  - CWE-770
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-47950.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-47950
    reference_type:
    reference_id:
  - url: https://datatracker.ietf.org/doc/html/rfc9250
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/coredns/coredns
    reference_type:
    reference_id:
  - url: https://github.com/coredns/coredns/commit/efaed02c6a480ec147b1f799aab7cf815b17dfe1
    reference_type:
    reference_id:
  - url: https://github.com/coredns/coredns/security/advisories/GHSA-cvx7-x8pj-x2gw
    reference_type:
    reference_id:
  - url: https://github.com/quic-go/quic-go
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-47950
    reference_type:
    reference_id:
  - url: https://www.usenix.org/conference/usenixsecurity23/presentation/botella
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2370860
    reference_type:
    reference_id: 2370860
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:coredns.io:coredns:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:coredns.io:coredns:*:*:*:*:*:*:*:*
  - url: https://access.redhat.com/errata/RHSA-2025:17128
    reference_type:
    reference_id: RHSA-2025:17128
  - url: https://access.redhat.com/errata/RHSA-2025:21892
    reference_type:
    reference_id: RHSA-2025:21892
