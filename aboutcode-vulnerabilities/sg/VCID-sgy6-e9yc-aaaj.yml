vulnerability_id: VCID-sgy6-e9yc-aaaj
aliases:
  - CVE-2020-8834
summary: 'KVM in the Linux kernel on Power8 processors has a conflicting use of HSTATE_HOST_R1
  to store r1 state in kvmppc_hv_entry plus in kvmppc_{save,restore}_tm, leading to a stack
  corruption. Because of this, an attacker with the ability run code in kernel space of a guest
  VM can cause the host kernel to panic. There were two commits that, according to the reporter,
  introduced the vulnerability: f024ee098476 ("KVM: PPC: Book3S HV: Pull out TM state save/restore
  into separate procedures") 87a11bb6a7f7 ("KVM: PPC: Book3S HV: Work around XER[SO] bug in
  fake suspend mode") The former landed in 4.8, the latter in 4.17. This was fixed without realizing
  the impact in 4.18 with the following three commits, though it''s believed the first is the
  only strictly necessary commit: 6f597c6b63b6 ("KVM: PPC: Book3S PR: Add guest MSR parameter
  for kvmppc_save_tm()/kvmppc_restore_tm()") 7b0e827c6970 ("KVM: PPC: Book3S HV: Factor fake-suspend
  handling out of kvmppc_save/restore_tm") 009c872a8bc4 ("KVM: PPC: Book3S PR: Move kvmppc_save_tm/kvmppc_restore_tm
  to separate file")'
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2020/CVE-2020-8834.html
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2020:2854
  - score: '6.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2020-8834.json
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24691'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24445'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24409'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24397'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23926'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24390'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24226'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24313'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24403'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24335'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24854'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24757'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19122'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15854'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18929'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19002'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19059'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19121'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19117'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19111'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19093'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19087'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.191'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.1911'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19131'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19139'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19132'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15742'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15698'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15866'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.1588'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15904'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15938'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15907'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15899'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15883'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15902'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15941'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15943'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15916'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.15894'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33231'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33599'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33222'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33240'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: '0.00254'
    scoring_system: epss
    scoring_elements: '0.33076'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1819615
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8834
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '4.9'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:N/I:N/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-8834
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-8834
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-8834
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-4318-1
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://usn.ubuntu.com/usn/usn-4318-1
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.openwall.com/lists/oss-security/2020/04/06/2
weaknesses:
  - CWE-121
  - CWE-362
references:
  - url: http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00035.html
    reference_type:
    reference_id:
  - url: http://people.canonical.com/~ubuntu-security/cve/2020/CVE-2020-8834.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2020-8834.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2020-8834
    reference_type:
    reference_id:
  - url: https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1867717
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8834
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4318-1
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/4318-1/
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/usn/usn-4318-1
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2020/04/06/2
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1819615
    reference_type:
    reference_id: 1819615
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-8834
    reference_type:
    reference_id: CVE-2020-8834
  - url: https://access.redhat.com/errata/RHSA-2020:2854
    reference_type:
    reference_id: RHSA-2020:2854
