vulnerability_id: VCID-8mwj-tbg2-aaab
aliases:
  - BIT-2021-37640
  - BIT-tensorflow-2021-37640
  - CVE-2021-37640
  - GHSA-95xm-g58g-3p88
  - PYSEC-2021-262
  - PYSEC-2021-553
  - PYSEC-2021-751
summary: TensorFlow is an end-to-end open source platform for machine learning. In affected
  versions the implementation of `tf.raw_ops.SparseReshape` can be made to trigger an integral
  division by 0 exception. The [implementation](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/reshape_util.cc#L176-L181)
  calls the reshaping functor whenever there is at least an index in the input but does not
  check that shape of the input or the target shape have both a non-zero number of elements.
  The [reshape functor](https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/reshape_util.cc#L40-L78)
  blindly divides by the dimensions of the target shape. Hence, if this is not checked, code
  will result in a division by 0. We have patched the issue in GitHub commit 4923de56ec94fff7770df259ab7f2288a74feb41.
  The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow
  2.5.1 as this is the other affected version.
severities:
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.04808'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09116'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09049'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06915'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08937'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08885'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06761'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06733'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06861'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06869'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0687'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06903'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06902'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0689'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.069'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06831'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06868'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06886'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.06906'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08947'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08954'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0894'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08944'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08952'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08879'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09015'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.091'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09077'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14320'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13628'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13940'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14025'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14048'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14115'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14109'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14123'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14178'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14262'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14551'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14606'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14698'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14307'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14380'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14719'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-95xm-g58g-3p88
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-553.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-553.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-751.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-751.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-262.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-262.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/4923de56ec94fff7770df259ab7f2288a74feb41
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/4923de56ec94fff7770df259ab7f2288a74feb41
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-95xm-g58g-3p88
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-95xm-g58g-3p88
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-95xm-g58g-3p88
  - score: '2.1'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37640
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37640
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37640
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37640
  - score: Critical
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2292
weaknesses:
  - CWE-369
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-37640
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-553.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-751.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-262.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/4923de56ec94fff7770df259ab7f2288a74feb41
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/AVG-2292
    reference_type:
    reference_id: AVG-2292
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37640
    reference_type:
    reference_id: CVE-2021-37640
  - url: https://github.com/advisories/GHSA-95xm-g58g-3p88
    reference_type:
    reference_id: GHSA-95xm-g58g-3p88
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-95xm-g58g-3p88
    reference_type:
    reference_id: GHSA-95xm-g58g-3p88
