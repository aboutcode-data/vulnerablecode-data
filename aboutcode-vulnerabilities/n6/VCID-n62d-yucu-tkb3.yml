vulnerability_id: VCID-n62d-yucu-tkb3
aliases:
  - CVE-2023-52978
summary: 'In the Linux kernel, the following vulnerability has been resolved:  riscv: kprobe:
  Fixup kernel panic when probing an illegal position  The kernel would panic when probed for
  an illegal position. eg:  (CONFIG_RISCV_ISA_C=n)  echo ''p:hello kernel_clone+0x16 a0=%a0''
  >> kprobe_events echo 1 > events/kprobes/hello/enable cat trace  Kernel panic - not syncing:
  stack-protector: Kernel stack is corrupted in: __do_sys_newfstatat+0xb8/0xb8 CPU: 0 PID: 111
  Comm: sh Not tainted 6.2.0-rc1-00027-g2d398fe49a4d #490 Hardware name: riscv-virtio,qemu (DT)
  Call Trace: [<ffffffff80007268>] dump_backtrace+0x38/0x48 [<ffffffff80c5e83c>] show_stack+0x50/0x68
  [<ffffffff80c6da28>] dump_stack_lvl+0x60/0x84 [<ffffffff80c6da6c>] dump_stack+0x20/0x30 [<ffffffff80c5ecf4>]
  panic+0x160/0x374 [<ffffffff80c6db94>] generic_handle_arch_irq+0x0/0xa8 [<ffffffff802deeb0>]
  sys_newstat+0x0/0x30 [<ffffffff800158c0>] sys_clone+0x20/0x30 [<ffffffff800039e8>] ret_from_syscall+0x0/0x4
  ---[ end Kernel panic - not syncing: stack-protector: Kernel stack is corrupted in: __do_sys_newfstatat+0xb8/0xb8
  ]---  That is because the kprobe''s ebreak instruction broke the kernel''s original code.
  The user should guarantee the correction of the probe position, but it couldn''t make the
  kernel panic.  This patch adds arch_check_kprobe in arch_prepare_kprobe to prevent an illegal
  position (Such as the middle of an instruction).'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52978.json
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01397'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01388'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01385'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01393'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01381'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01377'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01364'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01366'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01379'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01374'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01376'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01372'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01901'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02117'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02028'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.01727'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0343'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0339'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03378'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03377'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03381'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03384'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03393'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03428'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03436'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03442'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03435'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04273'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52978
weaknesses:
  - CWE-665
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52978.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52978
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/04a73558209554da17f46490ec4faaaf1b2bab68
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/12316538b1d193064109ce1a28fc9bacd43950de
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/87f48c7ccc73afc78630530d9af51f458f58cab8
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355475
    reference_type:
    reference_id: 2355475
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52978
    reference_type:
    reference_id: CVE-2023-52978
