vulnerability_id: VCID-y16u-6y27-aaaj
aliases:
  - CVE-2023-28631
  - GHSA-5r3x-p7xx-x6q5
summary: comrak is a CommonMark + GFM compatible Markdown parser and renderer written in rust.
  A Comrak AST can be constructed manually by a program instead of parsing a Markdown document
  with `parse_document`. This AST can then be converted to HTML via `html::format_document_with_plugins`.
  However, the HTML formatting code assumes that the AST is well-formed. For example, many AST
  notes contain `[u8]` fields which the formatting code assumes is valid UTF-8 data. Several
  bugs can be triggered if this is not the case. Version 0.17.0 contains adjustments to the
  AST, storing strings instead of unvalidated byte arrays. Users are advised to upgrade. Users
  unable to upgrade may manually validate UTF-8 correctness of all data when assigning to `&[u8]`
  and `Vec<u8>` fields in the AST. This issue is also tracked as `GHSL-2023-049`.
severities:
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.4802'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48021'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48051'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48076'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48098'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48088'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.4809'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.4807'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.4806'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48062'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48156'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48153'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48131'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.48072'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.71975'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00455'
    scoring_system: epss
    scoring_elements: '0.74928'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00455'
    scoring_system: epss
    scoring_elements: '0.75124'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00455'
    scoring_system: epss
    scoring_elements: '0.74914'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00455'
    scoring_system: epss
    scoring_elements: '0.74938'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76089'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76131'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76138'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76149'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76155'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76208'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76220'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76245'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76045'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.76079'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74368'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74283'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74278'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74371'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74391'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74403'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74383'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74381'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74384'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74405'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74413'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74416'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74412'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.74396'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.00949'
    scoring_system: epss
    scoring_elements: '0.7439'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: '0.01828'
    scoring_system: epss
    scoring_elements: '0.71778'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5r3x-p7xx-x6q5
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/kivikakk/comrak
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/kivikakk/comrak
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/kivikakk/comrak/commit/9ff5f8df0ac951f5742d22a72c39b89a15f56639
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/kivikakk/comrak/commit/9ff5f8df0ac951f5742d22a72c39b89a15f56639
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-02-18T20:06:34Z/
    published_at: None
    url: https://github.com/kivikakk/comrak/commit/9ff5f8df0ac951f5742d22a72c39b89a15f56639
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/kivikakk/comrak/releases/tag/0.17.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/kivikakk/comrak/releases/tag/0.17.0
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/kivikakk/comrak/security/advisories/GHSA-5r3x-p7xx-x6q5
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/kivikakk/comrak/security/advisories/GHSA-5r3x-p7xx-x6q5
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-02-18T20:06:34Z/
    published_at: None
    url: https://github.com/kivikakk/comrak/security/advisories/GHSA-5r3x-p7xx-x6q5
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OUYME2VA555X6567H7ORIJQFN4BVGT6N
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OUYME2VA555X6567H7ORIJQFN4BVGT6N
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OUYME2VA555X6567H7ORIJQFN4BVGT6N/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-02-18T20:06:34Z/
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OUYME2VA555X6567H7ORIJQFN4BVGT6N/
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PTWZWCT7KCX2KTXTLPUYZ3EHOONG4X46
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PTWZWCT7KCX2KTXTLPUYZ3EHOONG4X46
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PTWZWCT7KCX2KTXTLPUYZ3EHOONG4X46/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-02-18T20:06:34Z/
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PTWZWCT7KCX2KTXTLPUYZ3EHOONG4X46/
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VQ3UBC7LE4VPCMZBTADIBL353CH7CPVV
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VQ3UBC7LE4VPCMZBTADIBL353CH7CPVV
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VQ3UBC7LE4VPCMZBTADIBL353CH7CPVV/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-02-18T20:06:34Z/
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VQ3UBC7LE4VPCMZBTADIBL353CH7CPVV/
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-28631
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-28631
weaknesses:
  - CWE-755
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-28631
    reference_type:
    reference_id:
  - url: https://github.com/kivikakk/comrak
    reference_type:
    reference_id:
  - url: https://github.com/kivikakk/comrak/commit/9ff5f8df0ac951f5742d22a72c39b89a15f56639
    reference_type:
    reference_id:
  - url: https://github.com/kivikakk/comrak/releases/tag/0.17.0
    reference_type:
    reference_id:
  - url: https://github.com/kivikakk/comrak/security/advisories/GHSA-5r3x-p7xx-x6q5
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OUYME2VA555X6567H7ORIJQFN4BVGT6N
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OUYME2VA555X6567H7ORIJQFN4BVGT6N/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PTWZWCT7KCX2KTXTLPUYZ3EHOONG4X46
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PTWZWCT7KCX2KTXTLPUYZ3EHOONG4X46/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VQ3UBC7LE4VPCMZBTADIBL353CH7CPVV
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VQ3UBC7LE4VPCMZBTADIBL353CH7CPVV/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:comrak_project:comrak:*:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:comrak_project:comrak:*:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-28631
    reference_type:
    reference_id: CVE-2023-28631
  - url: https://github.com/advisories/GHSA-5r3x-p7xx-x6q5
    reference_type:
    reference_id: GHSA-5r3x-p7xx-x6q5
