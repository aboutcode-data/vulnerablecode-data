vulnerability_id: VCID-ya3r-xm3g-aaaj
aliases:
  - CVE-2024-38626
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  fuse: clear FR_SENT when re-adding requests into pending list

  The following warning was reported by lee bruce:

    ------------[ cut here ]------------
    WARNING: CPU: 0 PID: 8264 at fs/fuse/dev.c:300
    fuse_request_end+0x685/0x7e0 fs/fuse/dev.c:300
    Modules linked in:
    CPU: 0 PID: 8264 Comm: ab2 Not tainted 6.9.0-rc7
    Hardware name: QEMU Standard PC (i440FX + PIIX, 1996)
    RIP: 0010:fuse_request_end+0x685/0x7e0 fs/fuse/dev.c:300
    ......
    Call Trace:
    <TASK>
    fuse_dev_do_read.constprop.0+0xd36/0x1dd0 fs/fuse/dev.c:1334
    fuse_dev_read+0x166/0x200 fs/fuse/dev.c:1367
    call_read_iter include/linux/fs.h:2104 [inline]
    new_sync_read fs/read_write.c:395 [inline]
    vfs_read+0x85b/0xba0 fs/read_write.c:476
    ksys_read+0x12f/0x260 fs/read_write.c:619
    do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    do_syscall_64+0xce/0x260 arch/x86/entry/common.c:83
    entry_SYSCALL_64_after_hwframe+0x77/0x7f
    ......
    </TASK>

  The warning is due to the FUSE_NOTIFY_RESEND notify sent by the write()
  syscall in the reproducer program and it happens as follows:

  (1) calls fuse_dev_read() to read the INIT request
  The read succeeds. During the read, bit FR_SENT will be set on the
  request.
  (2) calls fuse_dev_write() to send an USE_NOTIFY_RESEND notify
  The resend notify will resend all processing requests, so the INIT
  request is moved from processing list to pending list again.
  (3) calls fuse_dev_read() with an invalid output address
  fuse_dev_read() will try to copy the same INIT request to the output
  address, but it will fail due to the invalid address, so the INIT
  request is ended and triggers the warning in fuse_request_end().

  Fix it by clearing FR_SENT when re-adding requests into pending list.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-38626.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22498'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22435'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23531'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23511'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23559'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23529'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.2352'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23516'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23523'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23546'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23541'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23532'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24822'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24778'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24763'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24736'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24787'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24816'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.2465'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24586'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24733'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24758'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24775'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24782'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24739'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.24744'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '0.00431'
    scoring_system: epss
    scoring_elements: '0.45573'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-20
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-38626.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-38626
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/246014876d782bbf2e652267482cd2e799fb5fcd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/533070db659a9589310a743e9de14cf9d651ffaf
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2293701
    reference_type:
    reference_id: 2293701
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-38626
    reference_type:
    reference_id: CVE-2024-38626
