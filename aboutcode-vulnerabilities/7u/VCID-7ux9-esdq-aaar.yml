vulnerability_id: VCID-7ux9-esdq-aaar
aliases:
  - CVE-2024-5187
  - GHSA-6rq9-53c3-f7vj
summary: A vulnerability in the `download_model_with_test_data` function of the onnx/onnx framework,
  version 1.16.0, allows for arbitrary file overwrite due to inadequate prevention of path traversal
  attacks in malicious tar files. This vulnerability enables attackers to overwrite any file
  on the system, potentially leading to remote code execution, deletion of system, personal,
  or application files, thus impacting the integrity and availability of the system. The issue
  arises from the function's handling of tar file extraction without performing security checks
  on the paths within the tar file, as demonstrated by the ability to overwrite the `/home/kali/.ssh/authorized_keys`
  file by specifying an absolute path in the malicious tar file.
severities:
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48358'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48825'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48072'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48750'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48712'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48557'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48546'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48530'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48528'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48529'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48449'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.48429'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.53763'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.53451'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.53472'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00164'
    scoring_system: epss
    scoring_elements: '0.53481'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71131'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71135'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71114'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.7111'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71123'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71122'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71128'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71137'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71136'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71132'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71116'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71112'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71083'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.00716'
    scoring_system: epss
    scoring_elements: '0.71058'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.01088'
    scoring_system: epss
    scoring_elements: '0.75921'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.01088'
    scoring_system: epss
    scoring_elements: '0.75922'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76674'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.7665'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76656'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.7666'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76679'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76628'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76632'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76675'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76677'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.7668'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76683'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76648'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.0115'
    scoring_system: epss
    scoring_elements: '0.76662'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '0.03627'
    scoring_system: epss
    scoring_elements: '0.79464'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-6rq9-53c3-f7vj
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/onnx/onnx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/onnx/onnx
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/onnx/onnx/commit/1b70f9b673259360b6a2339c4bd97db9ea6e552f
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/onnx/onnx/commit/1b70f9b673259360b6a2339c4bd97db9ea6e552f
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/onnx/onnx/commit/3fc3845edb048df559aa2a839e39e95503a0ee34
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/onnx/onnx/commit/3fc3845edb048df559aa2a839e39e95503a0ee34
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/onnx/onnx/issues/6215
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/onnx/onnx/issues/6215
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/onnx/onnx/pull/6145
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/onnx/onnx/pull/6145
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/onnx/onnx/pull/6222
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/onnx/onnx/pull/6222
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/onnx/onnx/releases/tag/v1.16.2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/onnx/onnx/releases/tag/v1.16.2
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/50235ebd-3410-4ada-b064-1a648e11237e
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://huntr.com/bounties/50235ebd-3410-4ada-b064-1a648e11237e
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-5187
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-5187
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-5187
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-5187
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-5187
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-5187
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/onnx/onnx
    reference_type:
    reference_id:
  - url: https://github.com/onnx/onnx/commit/1b70f9b673259360b6a2339c4bd97db9ea6e552f
    reference_type:
    reference_id:
  - url: https://github.com/onnx/onnx/commit/3fc3845edb048df559aa2a839e39e95503a0ee34
    reference_type:
    reference_id:
  - url: https://github.com/onnx/onnx/issues/6215
    reference_type:
    reference_id:
  - url: https://github.com/onnx/onnx/pull/6145
    reference_type:
    reference_id:
  - url: https://github.com/onnx/onnx/pull/6222
    reference_type:
    reference_id:
  - url: https://github.com/onnx/onnx/releases/tag/v1.16.2
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/50235ebd-3410-4ada-b064-1a648e11237e
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1075852
    reference_type:
    reference_id: 1075852
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:linuxfoundation:onnx:1.16.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:linuxfoundation:onnx:1.16.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-5187
    reference_type:
    reference_id: CVE-2024-5187
  - url: https://github.com/advisories/GHSA-6rq9-53c3-f7vj
    reference_type:
    reference_id: GHSA-6rq9-53c3-f7vj
