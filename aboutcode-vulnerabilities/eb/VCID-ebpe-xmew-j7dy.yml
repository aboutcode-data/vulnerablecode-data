vulnerability_id: VCID-ebpe-xmew-j7dy
aliases:
  - CVE-2022-48954
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  s390/qeth: fix use-after-free in hsci

  KASAN found that addr was dereferenced after br2dev_event_work was freed.

  ==================================================================
  BUG: KASAN: use-after-free in qeth_l2_br2dev_worker+0x5ba/0x6b0
  Read of size 1 at addr 00000000fdcea440 by task kworker/u760:4/540
  CPU: 17 PID: 540 Comm: kworker/u760:4 Tainted: G            E      6.1.0-20221128.rc7.git1.5aa3bed4ce83.300.fc36.s390x+kasan #1
  Hardware name: IBM 8561 T01 703 (LPAR)
  Workqueue: 0.0.8000_event qeth_l2_br2dev_worker
  Call Trace:
   [<000000016944d4ce>] dump_stack_lvl+0xc6/0xf8
   [<000000016942cd9c>] print_address_description.constprop.0+0x34/0x2a0
   [<000000016942d118>] print_report+0x110/0x1f8
   [<0000000167a7bd04>] kasan_report+0xfc/0x128
   [<000000016938d79a>] qeth_l2_br2dev_worker+0x5ba/0x6b0
   [<00000001673edd1e>] process_one_work+0x76e/0x1128
   [<00000001673ee85c>] worker_thread+0x184/0x1098
   [<000000016740718a>] kthread+0x26a/0x310
   [<00000001672c606a>] __ret_from_fork+0x8a/0xe8
   [<00000001694711da>] ret_from_fork+0xa/0x40
  Allocated by task 108338:
   kasan_save_stack+0x40/0x68
   kasan_set_track+0x36/0x48
   __kasan_kmalloc+0xa0/0xc0
   qeth_l2_switchdev_event+0x25a/0x738
   atomic_notifier_call_chain+0x9c/0xf8
   br_switchdev_fdb_notify+0xf4/0x110
   fdb_notify+0x122/0x180
   fdb_add_entry.constprop.0.isra.0+0x312/0x558
   br_fdb_add+0x59e/0x858
   rtnl_fdb_add+0x58a/0x928
   rtnetlink_rcv_msg+0x5f8/0x8d8
   netlink_rcv_skb+0x1f2/0x408
   netlink_unicast+0x570/0x790
   netlink_sendmsg+0x752/0xbe0
   sock_sendmsg+0xca/0x110
   ____sys_sendmsg+0x510/0x6a8
   ___sys_sendmsg+0x12a/0x180
   __sys_sendmsg+0xe6/0x168
   __do_sys_socketcall+0x3c8/0x468
   do_syscall+0x22c/0x328
   __do_syscall+0x94/0xf0
   system_call+0x82/0xb0
  Freed by task 540:
   kasan_save_stack+0x40/0x68
   kasan_set_track+0x36/0x48
   kasan_save_free_info+0x4c/0x68
   ____kasan_slab_free+0x14e/0x1a8
   __kasan_slab_free+0x24/0x30
   __kmem_cache_free+0x168/0x338
   qeth_l2_br2dev_worker+0x154/0x6b0
   process_one_work+0x76e/0x1128
   worker_thread+0x184/0x1098
   kthread+0x26a/0x310
   __ret_from_fork+0x8a/0xe8
   ret_from_fork+0xa/0x40
  Last potentially related work creation:
   kasan_save_stack+0x40/0x68
   __kasan_record_aux_stack+0xbe/0xd0
   insert_work+0x56/0x2e8
   __queue_work+0x4ce/0xd10
   queue_work_on+0xf4/0x100
   qeth_l2_switchdev_event+0x520/0x738
   atomic_notifier_call_chain+0x9c/0xf8
   br_switchdev_fdb_notify+0xf4/0x110
   fdb_notify+0x122/0x180
   fdb_add_entry.constprop.0.isra.0+0x312/0x558
   br_fdb_add+0x59e/0x858
   rtnl_fdb_add+0x58a/0x928
   rtnetlink_rcv_msg+0x5f8/0x8d8
   netlink_rcv_skb+0x1f2/0x408
   netlink_unicast+0x570/0x790
   netlink_sendmsg+0x752/0xbe0
   sock_sendmsg+0xca/0x110
   ____sys_sendmsg+0x510/0x6a8
   ___sys_sendmsg+0x12a/0x180
   __sys_sendmsg+0xe6/0x168
   __do_sys_socketcall+0x3c8/0x468
   do_syscall+0x22c/0x328
   __do_syscall+0x94/0xf0
   system_call+0x82/0xb0
  Second to last potentially related work creation:
   kasan_save_stack+0x40/0x68
   __kasan_record_aux_stack+0xbe/0xd0
   kvfree_call_rcu+0xb2/0x760
   kernfs_unlink_open_file+0x348/0x430
   kernfs_fop_release+0xc2/0x320
   __fput+0x1ae/0x768
   task_work_run+0x1bc/0x298
   exit_to_user_mode_prepare+0x1a0/0x1a8
   __do_syscall+0x94/0xf0
   system_call+0x82/0xb0
  The buggy address belongs to the object at 00000000fdcea400
   which belongs to the cache kmalloc-96 of size 96
  The buggy address is located 64 bytes inside of
   96-byte region [00000000fdcea400, 00000000fdcea460)
  The buggy address belongs to the physical page:
  page:000000005a9c26e8 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0xfdcea
  flags: 0x3ffff00000000200(slab|node=0|zone=1|lastcpupid=0x1ffff)
  raw: 3ffff00000000200 0000000000000000 0000000100000122 000000008008cc00
  raw: 0000000000000000 0020004100000000 ffffffff00000001 0000000000000000
  page dumped because: kasan: bad access detected
  Memory state around the buggy address:
   00000000fdcea300: fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
   00000000fdcea380: fb fb fb fb fb fb f
  ---truncated---
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48954.json
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48954.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02264'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.01614'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02335'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05363'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04237'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04235'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04225'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04207'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05412'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0543'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05476'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05466'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05464'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05439'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05423'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05384'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05375'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05388'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05391'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05405'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05398'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04167'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04166'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04158'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04172'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04188'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04186'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04215'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04245'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48954
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-48954
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-48954.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-48954
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bde0dfc7c4569406a6ddeec363d04a1df7b3073f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db6343a5b0d9661f2dd76f653c6d274d38234d2b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ebaaadc332cd21e9df4dcf9ce12552d9354bbbe4
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2320712
    reference_type:
    reference_id: 2320712
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.1:rc8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.1:rc8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-48954
    reference_type:
    reference_id: CVE-2022-48954
