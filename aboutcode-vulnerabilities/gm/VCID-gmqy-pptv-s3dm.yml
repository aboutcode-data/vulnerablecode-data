vulnerability_id: VCID-gmqy-pptv-s3dm
aliases:
  - CVE-2024-53097
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm: krealloc:
  Fix MTE false alarm in __do_krealloc  This patch addresses an issue introduced by commit 1a83a716ec233
  ("mm: krealloc: consider spare memory for __GFP_ZERO") which causes MTE (Memory Tagging Extension)
  to falsely report a slab-out-of-bounds error.  The problem occurs when zeroing out spare memory
  in __do_krealloc. The original code only considered software-based KASAN and did not account
  for MTE. It does not reset the KASAN tag before calling memset, leading to a mismatch between
  the pointer tag and the memory tag, resulting in a false positive.  Example of the error:
  ================================================================== swapper/0: BUG: KASAN:
  slab-out-of-bounds in __memset+0x84/0x188 swapper/0: Write at addr f4ffff8005f0fdf0 by task
  swapper/0/1 swapper/0: Pointer tag: [f4], memory tag: [fe] swapper/0: swapper/0: CPU: 4 UID:
  0 PID: 1 Comm: swapper/0 Not tainted 6.12. swapper/0: Hardware name: MT6991(ENG) (DT) swapper/0:
  Call trace: swapper/0:  dump_backtrace+0xfc/0x17c swapper/0:  show_stack+0x18/0x28 swapper/0:  dump_stack_lvl+0x40/0xa0
  swapper/0:  print_report+0x1b8/0x71c swapper/0:  kasan_report+0xec/0x14c swapper/0:  __do_kernel_fault+0x60/0x29c
  swapper/0:  do_bad_area+0x30/0xdc swapper/0:  do_tag_check_fault+0x20/0x34 swapper/0:  do_mem_abort+0x58/0x104
  swapper/0:  el1_abort+0x3c/0x5c swapper/0:  el1h_64_sync_handler+0x80/0xcc swapper/0:  el1h_64_sync+0x68/0x6c
  swapper/0:  __memset+0x84/0x188 swapper/0:  btf_populate_kfunc_set+0x280/0x3d8 swapper/0:  __register_btf_kfunc_id_set+0x43c/0x468
  swapper/0:  register_btf_kfunc_id_set+0x48/0x60 swapper/0:  register_nf_nat_bpf+0x1c/0x40
  swapper/0:  nf_nat_init+0xc0/0x128 swapper/0:  do_one_initcall+0x184/0x464 swapper/0:  do_initcall_level+0xdc/0x1b0
  swapper/0:  do_initcalls+0x70/0xc0 swapper/0:  do_basic_setup+0x1c/0x28 swapper/0:  kernel_init_freeable+0x144/0x1b8
  swapper/0:  kernel_init+0x20/0x1a8 swapper/0:  ret_from_fork+0x10/0x20 =================================================================='
severities:
  - score: '3.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53097.json
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03881'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04578'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04574'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04572'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04585'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04544'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08475'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08538'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08547'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.0849'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08431'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10711'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10758'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10861'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1094'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1092'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10891'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10879'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08371'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.06119'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08349'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08498'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08519'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08488'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08518'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08514'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08516'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11819'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11841'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12119'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11828'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11764'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11709'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12271'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12177'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-53097
weaknesses:
  - CWE-119
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53097.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-53097
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-53097
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3dfb40da84f26dd35dd9bbaf626a2424565b8406
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/486aeb5f1855c75dd810c25036134961bd2a6722
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/704573851b51808b45dae2d62059d1d8189138a2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/71548fada7ee0eb50cc6ccda82dff010c745f92c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8ebee7565effdeae6085458f8f8463363120a871
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d02492863023431c31f85d570f718433c22b9311
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d43f1430d47c22a0727c05b6f156ed25fecdfeb4
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2328792
    reference_type:
    reference_id: 2328792
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.10.14:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.10.14:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-53097
    reference_type:
    reference_id: CVE-2024-53097
  - url: https://usn.ubuntu.com/7288-1/
    reference_type:
    reference_id: USN-7288-1
  - url: https://usn.ubuntu.com/7288-2/
    reference_type:
    reference_id: USN-7288-2
  - url: https://usn.ubuntu.com/7289-1/
    reference_type:
    reference_id: USN-7289-1
  - url: https://usn.ubuntu.com/7289-2/
    reference_type:
    reference_id: USN-7289-2
  - url: https://usn.ubuntu.com/7289-3/
    reference_type:
    reference_id: USN-7289-3
  - url: https://usn.ubuntu.com/7289-4/
    reference_type:
    reference_id: USN-7289-4
  - url: https://usn.ubuntu.com/7291-1/
    reference_type:
    reference_id: USN-7291-1
  - url: https://usn.ubuntu.com/7305-1/
    reference_type:
    reference_id: USN-7305-1
  - url: https://usn.ubuntu.com/7308-1/
    reference_type:
    reference_id: USN-7308-1
  - url: https://usn.ubuntu.com/7331-1/
    reference_type:
    reference_id: USN-7331-1
  - url: https://usn.ubuntu.com/7388-1/
    reference_type:
    reference_id: USN-7388-1
  - url: https://usn.ubuntu.com/7389-1/
    reference_type:
    reference_id: USN-7389-1
  - url: https://usn.ubuntu.com/7390-1/
    reference_type:
    reference_id: USN-7390-1
  - url: https://usn.ubuntu.com/7458-1/
    reference_type:
    reference_id: USN-7458-1
