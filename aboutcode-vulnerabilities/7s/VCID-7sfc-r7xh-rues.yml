vulnerability_id: VCID-7sfc-r7xh-rues
aliases:
  - CVE-2025-38449
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/gem: Acquire references on GEM handles for framebuffers

  A GEM handle can be released while the GEM buffer object is attached
  to a DRM framebuffer. This leads to the release of the dma-buf backing
  the buffer object, if any. [1] Trying to use the framebuffer in further
  mode-setting operations leads to a segmentation fault. Most easily
  happens with driver that use shadow planes for vmap-ing the dma-buf
  during a page flip. An example is shown below.

  [  156.791968] ------------[ cut here ]------------
  [  156.796830] WARNING: CPU: 2 PID: 2255 at drivers/dma-buf/dma-buf.c:1527 dma_buf_vmap+0x224/0x430
  [...]
  [  156.942028] RIP: 0010:dma_buf_vmap+0x224/0x430
  [  157.043420] Call Trace:
  [  157.045898]  <TASK>
  [  157.048030]  ? show_trace_log_lvl+0x1af/0x2c0
  [  157.052436]  ? show_trace_log_lvl+0x1af/0x2c0
  [  157.056836]  ? show_trace_log_lvl+0x1af/0x2c0
  [  157.061253]  ? drm_gem_shmem_vmap+0x74/0x710
  [  157.065567]  ? dma_buf_vmap+0x224/0x430
  [  157.069446]  ? __warn.cold+0x58/0xe4
  [  157.073061]  ? dma_buf_vmap+0x224/0x430
  [  157.077111]  ? report_bug+0x1dd/0x390
  [  157.080842]  ? handle_bug+0x5e/0xa0
  [  157.084389]  ? exc_invalid_op+0x14/0x50
  [  157.088291]  ? asm_exc_invalid_op+0x16/0x20
  [  157.092548]  ? dma_buf_vmap+0x224/0x430
  [  157.096663]  ? dma_resv_get_singleton+0x6d/0x230
  [  157.101341]  ? __pfx_dma_buf_vmap+0x10/0x10
  [  157.105588]  ? __pfx_dma_resv_get_singleton+0x10/0x10
  [  157.110697]  drm_gem_shmem_vmap+0x74/0x710
  [  157.114866]  drm_gem_vmap+0xa9/0x1b0
  [  157.118763]  drm_gem_vmap_unlocked+0x46/0xa0
  [  157.123086]  drm_gem_fb_vmap+0xab/0x300
  [  157.126979]  drm_atomic_helper_prepare_planes.part.0+0x487/0xb10
  [  157.133032]  ? lockdep_init_map_type+0x19d/0x880
  [  157.137701]  drm_atomic_helper_commit+0x13d/0x2e0
  [  157.142671]  ? drm_atomic_nonblocking_commit+0xa0/0x180
  [  157.147988]  drm_mode_atomic_ioctl+0x766/0xe40
  [...]
  [  157.346424] ---[ end trace 0000000000000000 ]---

  Acquiring GEM handles for the framebuffer's GEM buffer objects prevents
  this from happening. The framebuffer's cleanup later puts the handle
  references.

  Commit 1a148af06000 ("drm/gem-shmem: Use dma_buf from GEM object
  instance") triggers the segmentation fault easily by using the dma-buf
  field more widely. The underlying issue with reference counting has
  been present before.

  v2:
  - acquire the handle instead of the BO (Christian)
  - fix comment style (Christian)
  - drop the Fixes tag (Christian)
  - rename err_ gotos
  - add missing Link tag
severities:
  - score: '7.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38449.json
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01685'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01665'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04397'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04427'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04381'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04352'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04461'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04389'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04398'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05364'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05454'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05453'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05451'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05406'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05351'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05361'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0534'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05353'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0545'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05467'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05507'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05394'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05968'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05955'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05993'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05947'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05927'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05961'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06028'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06049'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06065'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06056'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06016'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05996'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05985'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05995'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05979'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05975'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0596'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05962'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05981'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06087'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06061'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: 7
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38449.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38449
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38449
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/08480e285c6a82ce689008d643e4a51db0aaef8b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3cf520d9860d4ec9f7f32068825da31f18dd3f25
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5307dce878d4126e1b375587318955bd019c3741
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cb4c956a15f8b7f870649454771fc3761f504b5f
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2383519
    reference_type:
    reference_id: 2383519
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38449
    reference_type:
    reference_id: CVE-2025-38449
  - url: https://access.redhat.com/errata/RHSA-2025:15447
    reference_type:
    reference_id: RHSA-2025:15447
  - url: https://access.redhat.com/errata/RHSA-2025:15661
    reference_type:
    reference_id: RHSA-2025:15661
  - url: https://access.redhat.com/errata/RHSA-2025:15785
    reference_type:
    reference_id: RHSA-2025:15785
  - url: https://access.redhat.com/errata/RHSA-2025:15786
    reference_type:
    reference_id: RHSA-2025:15786
  - url: https://access.redhat.com/errata/RHSA-2025:17122
    reference_type:
    reference_id: RHSA-2025:17122
  - url: https://access.redhat.com/errata/RHSA-2025:17123
    reference_type:
    reference_id: RHSA-2025:17123
  - url: https://access.redhat.com/errata/RHSA-2025:17159
    reference_type:
    reference_id: RHSA-2025:17159
  - url: https://access.redhat.com/errata/RHSA-2025:17192
    reference_type:
    reference_id: RHSA-2025:17192
  - url: https://access.redhat.com/errata/RHSA-2025:17241
    reference_type:
    reference_id: RHSA-2025:17241
  - url: https://access.redhat.com/errata/RHSA-2025:17570
    reference_type:
    reference_id: RHSA-2025:17570
  - url: https://access.redhat.com/errata/RHSA-2025:18043
    reference_type:
    reference_id: RHSA-2025:18043
  - url: https://access.redhat.com/errata/RHSA-2025:21667
    reference_type:
    reference_id: RHSA-2025:21667
  - url: https://access.redhat.com/errata/RHSA-2025:22752
    reference_type:
    reference_id: RHSA-2025:22752
  - url: https://usn.ubuntu.com/7879-1/
    reference_type:
    reference_id: USN-7879-1
  - url: https://usn.ubuntu.com/7879-2/
    reference_type:
    reference_id: USN-7879-2
  - url: https://usn.ubuntu.com/7879-3/
    reference_type:
    reference_id: USN-7879-3
  - url: https://usn.ubuntu.com/7879-4/
    reference_type:
    reference_id: USN-7879-4
  - url: https://usn.ubuntu.com/7880-1/
    reference_type:
    reference_id: USN-7880-1
  - url: https://usn.ubuntu.com/7934-1/
    reference_type:
    reference_id: USN-7934-1
