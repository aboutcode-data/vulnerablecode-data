vulnerability_id: VCID-8gue-r95c-8yay
aliases:
  - CVE-2025-61780
  - GHSA-r657-rxjc-j557
summary: |
  Rack has a Possible Information Disclosure Vulnerability
  ## Summary

  A possible information disclosure vulnerability existed in
  `Rack::Sendfile` when running behind a proxy that supports
  `x-sendfile` headers (such as Nginx). Specially crafted headers
  could cause `Rack::Sendfile` to miscommunicate with the proxy and
  trigger unintended internal requests, potentially bypassing
  proxy-level access restrictions.

  ## Details

  When `Rack::Sendfile` received untrusted `x-sendfile-type` or
  `x-accel-mapping` headers from a client, it would interpret them
  as proxy configuration directives. This could cause the middleware
  to send a "redirect" response to the proxy, prompting it to reissue
  a new internal request that was
  **not subject to the proxy's access controls**.

  An attacker could exploit this by:
  1. Setting a crafted `x-sendfile-type: x-accel-redirect` header.
  2. Setting a crafted `x-accel-mapping` header.
  3. Requesting a path that qualifies for proxy-based acceleration.

  ## Impact

  Attackers could bypass proxy-enforced restrictions and access internal
  endpoints intended to be protected (such as administrative pages).
  The vulnerability did not allow arbitrary file reads but could
  expose sensitive application routes.

  This issue only affected systems meeting all of the following conditions:

  * The application used `Rack::Sendfile` with a proxy that supports
    `x-accel-redirect` (e.g., Nginx).
  * The proxy did **not** always set or remove the `x-sendfile-type`
    and `x-accel-mapping` headers.
  * The application exposed an endpoint that returned a body
    responding to `.to_path`.

  ## Mitigation

  * Upgrade to a fixed version of Rack which requires explicit
    configuration to enable `x-accel-redirect`:

    ```ruby
    use Rack::Sendfile, "x-accel-redirect"
    ```

  * Alternatively, configure the proxy to always set or strip
    the headers (you should be doing this!):

    ```nginx
    proxy_set_header x-sendfile-type x-accel-redirect;
    proxy_set_header x-accel-mapping /var/www/=/files/;
    ```

  * Or in Rails applications, disable sendfile completely:

    ```ruby
    config.action_dispatch.x_sendfile_header = nil
    ```
severities:
  - score: '5.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-61780.json
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.07418'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.07473'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11307'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11295'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11324'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11305'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11309'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11322'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11358'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11337'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1138'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1141'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11429'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11364'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13557'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13601'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-r657-rxjc-j557
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/rack/rack
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rack/rack
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/rack/rack/commit/57277b7741581fa827472c5c666f6e6a33abd784
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rack/rack/commit/57277b7741581fa827472c5c666f6e6a33abd784
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-10T20:34:55Z/
    published_at: None
    url: https://github.com/rack/rack/commit/57277b7741581fa827472c5c666f6e6a33abd784
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/rack/rack/commit/7e69f65eefe9cd2868df9f9f3b0977b86f93523a
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rack/rack/commit/7e69f65eefe9cd2868df9f9f3b0977b86f93523a
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-10T20:34:55Z/
    published_at: None
    url: https://github.com/rack/rack/commit/7e69f65eefe9cd2868df9f9f3b0977b86f93523a
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/rack/rack/commit/fba2c8bc63eb787ff4b19bc612d315fda6126d85
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rack/rack/commit/fba2c8bc63eb787ff4b19bc612d315fda6126d85
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-10T20:34:55Z/
    published_at: None
    url: https://github.com/rack/rack/commit/fba2c8bc63eb787ff4b19bc612d315fda6126d85
  - score: '5.8'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://github.com/rack/rack/security/advisories/GHSA-r657-rxjc-j557
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/rack/rack/security/advisories/GHSA-r657-rxjc-j557
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/rack/rack/security/advisories/GHSA-r657-rxjc-j557
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rack/rack/security/advisories/GHSA-r657-rxjc-j557
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-10T20:34:55Z/
    published_at: None
    url: https://github.com/rack/rack/security/advisories/GHSA-r657-rxjc-j557
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61780.yml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61780.yml
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61780
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61780
weaknesses:
  - CWE-200
  - CWE-1035
  - CWE-937
  - CWE-441
  - CWE-913
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-61780.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-61780
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-61780
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/57277b7741581fa827472c5c666f6e6a33abd784
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/7e69f65eefe9cd2868df9f9f3b0977b86f93523a
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/commit/fba2c8bc63eb787ff4b19bc612d315fda6126d85
    reference_type:
    reference_id:
  - url: https://github.com/rack/rack/security/advisories/GHSA-r657-rxjc-j557
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61780.yml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61780
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1117855
    reference_type:
    reference_id: 1117855
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2403126
    reference_type:
    reference_id: 2403126
  - url: https://github.com/advisories/GHSA-r657-rxjc-j557
    reference_type:
    reference_id: GHSA-r657-rxjc-j557
