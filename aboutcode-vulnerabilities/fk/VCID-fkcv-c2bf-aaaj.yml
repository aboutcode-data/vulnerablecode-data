vulnerability_id: VCID-fkcv-c2bf-aaaj
aliases:
  - CVE-2018-18021
summary: arch/arm64/kvm/guest.c in KVM in the Linux kernel before 4.18.12 on the arm64 platform
  mishandles the KVM_SET_ON_REG ioctl. This is exploitable by attackers who can create virtual
  machines. An attacker can arbitrarily redirect the hypervisor flow of control (with full register
  control). An attacker can also cause a denial of service (hypervisor panic) via an illegal
  exception return. This occurs because of insufficient restrictions on userspace access to
  the core register file, and because PSTATE.M validation does not prevent unintended execution
  modes.
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=2a3f93459d689d990b3ecfbe782fec89b97d3279
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=d26c25a9d19b5976b319af528886f89cf455692d
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-18021.html
  - score: '6.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2018-18021.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09979'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12669'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10002'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12494'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12435'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12577'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09926'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12586'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12592'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12587'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12567'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12565'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12584'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12597'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12639'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12664'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1259'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12668'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12707'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12684'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12673'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12686'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12702'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12726'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12713'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12458'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12483'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12625'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.1263'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32144'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.31397'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.31694'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.31774'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.31800'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.31909'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.31914'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.31934'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.31960'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32176'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32233'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32327'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32140'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32123'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32508'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.26805'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1635475
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.18.12
  - score: High
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15471
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18021
  - score: '3.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/torvalds/linux/commit/2a3f93459d689d990b3ecfbe782fec89b97d3279
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/torvalds/linux/commit/d26c25a9d19b5976b319af528886f89cf455692d
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://git.kernel.org/linus/2a3f93459d689d990b3ecfbe782fec89b97d3279
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://git.kernel.org/linus/d26c25a9d19b5976b319af528886f89cf455692d
  - score: '3.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:N/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-18021
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-18021
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-3821-1
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-3821-2
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-3931-1
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-3931-2
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.openwall.com/lists/oss-security/2018/10/02/2
weaknesses:
  - CWE-20
references:
  - url: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=2a3f93459d689d990b3ecfbe782fec89b97d3279
    reference_type:
    reference_id:
  - url: http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=d26c25a9d19b5976b319af528886f89cf455692d
    reference_type:
    reference_id:
  - url: http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-18021.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/errata/RHSA-2018:3656
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2018-18021.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2018-18021
    reference_type:
    reference_id:
  - url: https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.18.12
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15471
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18021
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/torvalds/linux/commit/2a3f93459d689d990b3ecfbe782fec89b97d3279
    reference_type:
    reference_id:
  - url: https://github.com/torvalds/linux/commit/d26c25a9d19b5976b319af528886f89cf455692d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/linus/2a3f93459d689d990b3ecfbe782fec89b97d3279
    reference_type:
    reference_id:
  - url: https://git.kernel.org/linus/d26c25a9d19b5976b319af528886f89cf455692d
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3821-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3821-2
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3931-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3931-2
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3821-1/
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3821-2/
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3931-1/
    reference_type:
    reference_id:
  - url: https://usn.ubuntu.com/3931-2/
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2018/dsa-4313
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2018/10/02/2
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/105550
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1635475
    reference_type:
    reference_id: 1635475
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-18021
    reference_type:
    reference_id: CVE-2018-18021
