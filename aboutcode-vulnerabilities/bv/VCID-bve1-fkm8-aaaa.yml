vulnerability_id: VCID-bve1-fkm8-aaaa
aliases:
  - GHSA-4q83-7cq4-p6wg
summary: |
  `tokio::io::ReadHalf<T>::unsplit` is Unsound
  `tokio::io::ReadHalf<T>::unsplit` can violate the `Pin` contract

  The soundness issue is described in the [tokio/issues#5372](https://github.com/tokio-rs/tokio/issues/5372)

  Specific set of conditions needed to trigger an issue (a !Unpin type in ReadHalf)
  is unusual, combined with the difficulty of making any arbitrary use-after-free
  exploitable in Rust without doing a lot of careful alignment of data types in
  the surrounding code.

  The `tokio` feature `io-util` is also required to be enabled to trigger this
  soundness issue.

  Thanks to zachs18 reporting the issue to Tokio team responsibly and taiki-e
  and carllerche appropriately responding and fixing the soundness bug.

  Tokio before 0.2.0 used `futures` 0.1 that did not have `Pin`, so it is not
  affected by this issue.
severities:
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-4q83-7cq4-p6wg
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/tokio-rs/tokio
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tokio-rs/tokio
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tokio-rs/tokio/issues/5372
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2023-0005.html
weaknesses: []
references:
  - url: https://github.com/tokio-rs/tokio
    reference_type:
    reference_id:
  - url: https://github.com/tokio-rs/tokio/issues/5372
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2023-0005.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-4q83-7cq4-p6wg
    reference_type:
    reference_id: GHSA-4q83-7cq4-p6wg
