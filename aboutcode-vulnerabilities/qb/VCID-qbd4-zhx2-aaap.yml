vulnerability_id: VCID-qbd4-zhx2-aaap
aliases:
  - CVE-2024-23652
  - GHSA-4v98-7qmw-rqr8
summary: BuildKit is a toolkit for converting source code to build artifacts in an efficient,
  expressive and repeatable manner. A malicious BuildKit frontend or Dockerfile using RUN --mount
  could trick the feature that removes empty files created for the mountpoints into removing
  a file outside the container, from the host system. The issue has been fixed in v0.12.5. Workarounds
  include avoiding using BuildKit frontends from an untrusted source or building an untrusted
  Dockerfile containing RUN --mount feature.
severities:
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-23652.json
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23338'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23343'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23765'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23768'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23788'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23816'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23716'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23394'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.22862'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23360'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23168'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23258'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23280'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.23347'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.30275'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82258'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82187'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82175'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82234'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.8224'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82255'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82268'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82262'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82263'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82275'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.8229'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.823'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82292'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82293'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.02027'
    scoring_system: epss
    scoring_elements: '0.82282'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88932'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88944'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88949'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88942'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88937'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88936'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88929'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88931'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.8893'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88926'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88922'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.88906'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.04855'
    scoring_system: epss
    scoring_elements: '0.8892'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '0.17155'
    scoring_system: epss
    scoring_elements: '0.91732'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/moby/buildkit
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/buildkit
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:H
    published_at: None
    url: https://github.com/moby/buildkit/pull/4603
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/buildkit/pull/4603
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/moby/buildkit/releases/tag/v0.12.5
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/buildkit/releases/tag/v0.12.5
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:H
    published_at: None
    url: https://github.com/moby/buildkit/security/advisories/GHSA-4v98-7qmw-rqr8
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/buildkit/security/advisories/GHSA-4v98-7qmw-rqr8
  - score: '9.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23652
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23652
weaknesses:
  - CWE-22
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-23652.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-23652
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/pull/4603
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/releases/tag/v0.12.5
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/security/advisories/GHSA-4v98-7qmw-rqr8
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2262225
    reference_type:
    reference_id: 2262225
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mobyproject:buildkit:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mobyproject:buildkit:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23652
    reference_type:
    reference_id: CVE-2024-23652
  - url: https://security.gentoo.org/glsa/202407-12
    reference_type:
    reference_id: GLSA-202407-12
  - url: https://security.gentoo.org/glsa/202407-25
    reference_type:
    reference_id: GLSA-202407-25
  - url: https://security.gentoo.org/glsa/202409-29
    reference_type:
    reference_id: GLSA-202409-29
