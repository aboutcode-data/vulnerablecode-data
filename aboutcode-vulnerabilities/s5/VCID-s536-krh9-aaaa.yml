vulnerability_id: VCID-s536-krh9-aaaa
aliases:
  - CVE-2024-28056
  - GHSA-846g-p7hm-f54r
summary: 'Amazon AWS Amplify CLI before 12.10.1 incorrectly configures the role trust policy
  of IAM roles associated with Amplify projects. When the Authentication component is removed
  from an Amplify project, a Condition property is removed but "Effect":"Allow" remains present,
  and consequently sts:AssumeRoleWithWebIdentity would be available to threat actors with no
  conditions. Thus, if Amplify CLI had been used to remove the Authentication component from
  a project built between August 2019 and January 2024, an "assume role" may have occurred,
  and may have been leveraged to obtain unauthorized access to an organization''s AWS resources.
  NOTE: the problem could only occur if an authorized AWS user removed an Authentication component.
  (The vulnerability did not give a threat actor the ability to remove an Authentication component.)
  However, in realistic situations, an authorized AWS user may have removed an Authentication
  component, e.g., if the objective were to stop using built-in Cognito resources, or move to
  a completely different identity provider.'
severities:
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.31889'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.31956'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.31981'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.3199'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.31979'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.3198'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.31977'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.31994'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.32065'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.3206'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.32014'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.31952'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.31937'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.6408'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.63987'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.63964'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64057'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64061'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64094'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64075'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64073'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64053'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64067'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64085'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64079'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.00516'
    scoring_system: epss
    scoring_elements: '0.64063'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '0.01627'
    scoring_system: epss
    scoring_elements: '0.70348'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://aws.amazon.com/security/security-bulletins/AWS-2024-003
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://aws.amazon.com/security/security-bulletins/AWS-2024-003
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-846g-p7hm-f54r
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws-amplify/amplify-cli
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws-amplify/amplify-cli
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws-amplify/amplify-cli/blob/8ad57bf99a404f3c92547c8a175458016f682fac/packages/amplify-provider-awscloudformation/resources/update-idp-roles-cfn.json
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws-amplify/amplify-cli/blob/8ad57bf99a404f3c92547c8a175458016f682fac/packages/amplify-provider-awscloudformation/resources/update-idp-roles-cfn.json
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws-amplify/amplify-cli/commit/73b08dc424db2fb60399c5343c314e02e849d4a1
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws-amplify/amplify-cli/commit/73b08dc424db2fb60399c5343c314e02e849d4a1
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws-amplify/amplify-cli/releases/tag/v12.10.1
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws-amplify/amplify-cli/releases/tag/v12.10.1
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-28056
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-28056
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://securitylabs.datadoghq.com/articles/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://securitylabs.datadoghq.com/articles/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-276
  - CWE-269
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-28056
    reference_type:
    reference_id:
  - url: https://aws.amazon.com/security/security-bulletins/AWS-2024-003
    reference_type:
    reference_id:
  - url: https://aws.amazon.com/security/security-bulletins/AWS-2024-003/
    reference_type:
    reference_id:
  - url: https://github.com/aws-amplify/amplify-cli
    reference_type:
    reference_id:
  - url: https://github.com/aws-amplify/amplify-cli/blob/8ad57bf99a404f3c92547c8a175458016f682fac/packages/amplify-provider-awscloudformation/resources/update-idp-roles-cfn.json
    reference_type:
    reference_id:
  - url: https://github.com/aws-amplify/amplify-cli/commit/73b08dc424db2fb60399c5343c314e02e849d4a1
    reference_type:
    reference_id:
  - url: https://github.com/aws-amplify/amplify-cli/releases/tag/v12.10.1
    reference_type:
    reference_id:
  - url: https://securitylabs.datadoghq.com/articles/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover
    reference_type:
    reference_id:
  - url: https://securitylabs.datadoghq.com/articles/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-28056
    reference_type:
    reference_id: CVE-2024-28056
  - url: https://github.com/advisories/GHSA-846g-p7hm-f54r
    reference_type:
    reference_id: GHSA-846g-p7hm-f54r
