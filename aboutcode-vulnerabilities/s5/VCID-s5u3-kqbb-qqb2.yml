vulnerability_id: VCID-s5u3-kqbb-qqb2
aliases:
  - CVE-2025-66457
  - GHSA-8vch-m3f4-q8jf
summary: "Elysia affected by arbitrary code injection through cookie config\nArbitrary code\
  \ execution from cookie config. If dynamic cookies are enabled (ie there exists a schema for\
  \ cookies), the cookie config is injected into the compiled route without first being sanitised.\n\
  \nAvailability of this exploit is generally low, as it requires write access to either the\
  \ Elysia app's source code (in which case the vulnerability is meaningless) or write access\
  \ to the cookie config (perhaps where it is assumed to be provisioned by the environment).\
  \ \n\nHowever when combined with GHSA-hxj9-33pp-j2cc, this vulnerability allows for a full\
  \ RCE chain.\n\n### Impact\n- aot enabled (default)\n- cookie schema passed to route\n- Cookie\
  \ config controllable eg. via env\n\nExample of vulnerable code\n```js\nnew Elysia({\n\tcookie:\
  \ {\n\t\tsecrets: `' + console.log('pwned from secrets') + '`\n\t},\n})\n\t.get(\"/\", ()\
  \ => \"hello world\", {\n\t\tcookie: t.Cookie({\n\t\t\tfoo: t.Any(),\n\t\t}),\n\t})\n```\n\
  \nPOC: https://github.com/sportshead/elysia-poc\n\n### Patches\nPatched by 1.4.17 (https://github.com/elysiajs/elysia/pull/1564)\n\
  \nReference commit:\n- https://github.com/elysiajs/elysia/pull/1564/commits/26935bf76ebc43b4a43d48b173fc853de43bb51e\n\
  - https://github.com/elysiajs/elysia/pull/1564/commits/3af978663e437dccc6c1a2a3aff4b74e1574849e\n\
  \n### Workarounds\nSanitize cookie-related env input\n\n```typescript\nconst overrideUnsafeQuote\
  \ = (value: string) =>\n\t// '`' + value + '`'\n\t'`' + value.replace(/'/g, '\\\\`').replace(/\\\
  ${/g, '$\\\\{') + '`'\n```"
severities:
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.18125'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66457
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.20666'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66457
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-8vch-m3f4-q8jf
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/elysiajs/elysia
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/elysiajs/elysia/commit/26935bf76ebc43b4a43d48b173fc853de43bb51e
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/elysiajs/elysia/commit/26935bf76ebc43b4a43d48b173fc853de43bb51e
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-12-12T19:37:53Z/
    published_at: None
    url: https://github.com/elysiajs/elysia/commit/26935bf76ebc43b4a43d48b173fc853de43bb51e
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/elysiajs/elysia/commit/3af978663e437dccc6c1a2a3aff4b74e1574849e
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/elysiajs/elysia/commit/3af978663e437dccc6c1a2a3aff4b74e1574849e
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-12-12T19:37:53Z/
    published_at: None
    url: https://github.com/elysiajs/elysia/commit/3af978663e437dccc6c1a2a3aff4b74e1574849e
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/elysiajs/elysia/pull/1564
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/elysiajs/elysia/pull/1564
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-12-12T19:37:53Z/
    published_at: None
    url: https://github.com/elysiajs/elysia/pull/1564
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/elysiajs/elysia/security/advisories/GHSA-8vch-m3f4-q8jf
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/elysiajs/elysia/security/advisories/GHSA-8vch-m3f4-q8jf
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/elysiajs/elysia/security/advisories/GHSA-8vch-m3f4-q8jf
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-12-12T19:37:53Z/
    published_at: None
    url: https://github.com/elysiajs/elysia/security/advisories/GHSA-8vch-m3f4-q8jf
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/elysiajs/elysia/security/advisories/GHSA-hxj9-33pp-j2cc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/elysiajs/elysia/security/advisories/GHSA-hxj9-33pp-j2cc
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-12-12T19:37:53Z/
    published_at: None
    url: https://github.com/elysiajs/elysia/security/advisories/GHSA-hxj9-33pp-j2cc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/sportshead/elysia-poc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66457
weaknesses:
  - CWE-94
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-66457
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/commit/26935bf76ebc43b4a43d48b173fc853de43bb51e
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/commit/3af978663e437dccc6c1a2a3aff4b74e1574849e
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/pull/1564
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/security/advisories/GHSA-8vch-m3f4-q8jf
    reference_type:
    reference_id:
  - url: https://github.com/elysiajs/elysia/security/advisories/GHSA-hxj9-33pp-j2cc
    reference_type:
    reference_id:
  - url: https://github.com/sportshead/elysia-poc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66457
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-8vch-m3f4-q8jf
    reference_type:
    reference_id: GHSA-8vch-m3f4-q8jf
