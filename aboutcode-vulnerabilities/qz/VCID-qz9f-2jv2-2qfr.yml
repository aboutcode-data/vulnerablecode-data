vulnerability_id: VCID-qz9f-2jv2-2qfr
aliases:
  - CVE-2025-59346
  - GHSA-g2rq-jv54-wcpr
summary: |
  Dragonfly vulnerable to server-side request forgery
  ### Impact
  There are multiple server-side request forgery (SSRF) vulnerabilities in the DragonFly2 system. The vulnerabilities enable users to force DragonFly2’s components to make requests to internal services, which otherwise are not accessible to the users.
  One SSRF attack vector is exposed by the Manager’s API. The API allows users to create jobs. When creating a Preheat type of a job, users provide a URL that the Manager connects to (see figures 2.1–2.3). The URL is weakly validated, and so users can trick the Manager into sending HTTP requests to services that are in the Manager’s local network.

  ```golang
  func (p *preheat) CreatePreheat(ctx context.Context, schedulers []models.Scheduler,
  json types.PreheatArgs) (*internaljob.GroupJobState, error) {
  [skipped]
         url := json.URL
  [skipped]
         // Generate download files
         var files []internaljob.PreheatRequest
         switch PreheatType(json.Type) {
         case PreheatImageType:
               // Parse image manifest url
  skipped, err := parseAccessURL(url) [skipped]
  [skipped]
  case PreheatFileType: [skipped]
  }
  ```

  A second attack vector is in peer-to-peer communication. A peer can ask another peer to make a request to an arbitrary URL by triggering the pieceManager.DownloadSource method (figure 2.4), which calls the httpSourceClient.GetMetadata method, which performs the request.

  Another attack vector is due to the fact that HTTP clients used by the DragonFly2’s components do not disable support for HTTP redirects. This configuration means that an HTTP request sent to a malicious server may be redirected by the server to a component’s internal service.

  ### Patches
  - Dragonfy v2.1.0 and above.

  ### Workarounds

  There are no effective workarounds, beyond upgrading.

  ### References

  A third party security audit was performed by Trail of Bits, you can see the [full report](https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf).

  If you have any questions or comments about this advisory, please email us at [dragonfly-maintainers@googlegroups.com](mailto:dragonfly-maintainers@googlegroups.com).
severities:
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06414'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06521'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10479'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10448'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10497'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10498'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10534'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10549'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10528'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10217'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.102'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10357'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10492'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10345'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10346'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10481'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10491'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10515'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11909'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11931'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11971'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.1189'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11881'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11878'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11893'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11896'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11915'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11847'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11764'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12796'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.12785'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:N/VA:N/SC:L/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-09-17T19:30:29Z/
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:L/VI:N/VA:N/SC:L/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-g2rq-jv54-wcpr
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-g2rq-jv54-wcpr
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-09-17T19:30:29Z/
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-g2rq-jv54-wcpr
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59346
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3968
weaknesses:
  - CWE-918
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-59346
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-g2rq-jv54-wcpr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59346
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3968
    reference_type:
    reference_id:
