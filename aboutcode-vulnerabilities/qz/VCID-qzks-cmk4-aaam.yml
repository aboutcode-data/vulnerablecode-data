vulnerability_id: VCID-qzks-cmk4-aaam
aliases:
  - CVE-2023-52506
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  LoongArch: Set all reserved memblocks on Node#0 at initialization

  After commit 61167ad5fecdea ("mm: pass nid to reserve_bootmem_region()")
  we get a panic if DEFERRED_STRUCT_PAGE_INIT is enabled:

  [    0.000000] CPU 0 Unable to handle kernel paging request at virtual address 0000000000002b82, era == 90000000040e3f28, ra == 90000000040e3f18
  [    0.000000] Oops[#1]:
  [    0.000000] CPU: 0 PID: 0 Comm: swapper Not tainted 6.5.0+ #733
  [    0.000000] pc 90000000040e3f28 ra 90000000040e3f18 tp 90000000046f4000 sp 90000000046f7c90
  [    0.000000] a0 0000000000000001 a1 0000000000200000 a2 0000000000000040 a3 90000000046f7ca0
  [    0.000000] a4 90000000046f7ca4 a5 0000000000000000 a6 90000000046f7c38 a7 0000000000000000
  [    0.000000] t0 0000000000000002 t1 9000000004b00ac8 t2 90000000040e3f18 t3 90000000040f0800
  [    0.000000] t4 00000000000f0000 t5 80000000ffffe07e t6 0000000000000003 t7 900000047fff5e20
  [    0.000000] t8 aaaaaaaaaaaaaaab u0 0000000000000018 s9 0000000000000000 s0 fffffefffe000000
  [    0.000000] s1 0000000000000000 s2 0000000000000080 s3 0000000000000040 s4 0000000000000000
  [    0.000000] s5 0000000000000000 s6 fffffefffe000000 s7 900000000470b740 s8 9000000004ad4000
  [    0.000000]    ra: 90000000040e3f18 reserve_bootmem_region+0xec/0x21c
  [    0.000000]   ERA: 90000000040e3f28 reserve_bootmem_region+0xfc/0x21c
  [    0.000000]  CRMD: 000000b0 (PLV0 -IE -DA +PG DACF=CC DACM=CC -WE)
  [    0.000000]  PRMD: 00000000 (PPLV0 -PIE -PWE)
  [    0.000000]  EUEN: 00000000 (-FPE -SXE -ASXE -BTE)
  [    0.000000]  ECFG: 00070800 (LIE=11 VS=7)
  [    0.000000] ESTAT: 00010800 [PIL] (IS=11 ECode=1 EsubCode=0)
  [    0.000000]  BADV: 0000000000002b82
  [    0.000000]  PRID: 0014d000 (Loongson-64bit, Loongson-3A6000)
  [    0.000000] Modules linked in:
  [    0.000000] Process swapper (pid: 0, threadinfo=(____ptrval____), task=(____ptrval____))
  [    0.000000] Stack : 0000000000000000 9000000002eb5430 0000003a00000020 90000000045ccd00
  [    0.000000]         900000000470e000 90000000002c1918 0000000000000000 9000000004110780
  [    0.000000]         00000000fe6c0000 0000000480000000 9000000004b4e368 9000000004110748
  [    0.000000]         0000000000000000 900000000421ca84 9000000004620000 9000000004564970
  [    0.000000]         90000000046f7d78 9000000002cc9f70 90000000002c1918 900000000470e000
  [    0.000000]         9000000004564970 90000000040bc0e0 90000000046f7d78 0000000000000000
  [    0.000000]         0000000000004000 90000000045ccd00 0000000000000000 90000000002c1918
  [    0.000000]         90000000002c1900 900000000470b700 9000000004b4df78 9000000004620000
  [    0.000000]         90000000046200a8 90000000046200a8 0000000000000000 9000000004218b2c
  [    0.000000]         9000000004270008 0000000000000001 0000000000000000 90000000045ccd00
  [    0.000000]         ...
  [    0.000000] Call Trace:
  [    0.000000] [<90000000040e3f28>] reserve_bootmem_region+0xfc/0x21c
  [    0.000000] [<900000000421ca84>] memblock_free_all+0x114/0x350
  [    0.000000] [<9000000004218b2c>] mm_core_init+0x138/0x3cc
  [    0.000000] [<9000000004200e38>] start_kernel+0x488/0x7a4
  [    0.000000] [<90000000040df0d8>] kernel_entry+0xd8/0xdc
  [    0.000000]
  [    0.000000] Code: 02eb21ad  00410f4c  380c31ac <262b818d> 6800b70d  02c1c196  0015001c  57fe4bb1  260002cd

  The reason is early memblock_reserve() in memblock_init() set node id to
  MAX_NUMNODES, making NODE_DATA(nid) a NULL dereference in the call chain
  reserve_bootmem_region() -> init_reserved_page(). After memblock_init(),
  those late calls of memblock_reserve() operate on subregions of memblock
  .memory regions. As a result, these reserved regions will be set to the
  correct node at the first iteration of memmap_init_reserved_pages().

  So set all reserved memblocks on Node#0 at initialization can avoid this
  panic.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52506.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03008'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03013'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03004'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03002'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02985'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02989'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03026'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03042'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03031'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03043'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03051'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03022'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.1936'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19508'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19475'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19422'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19485'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19471'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19456'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19466'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19504'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19506'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19489'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19473'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19313'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19519'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '0.0031'
    scoring_system: epss
    scoring_elements: '0.37801'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52506
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52506.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52506
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/19878758accf6b2788091a771d9f9fee7bab11ab
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b795fb9f5861ee256070d59e33130980a01fadd7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f105e893a8edd48bdf4bef9fef845a9ff402f737
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2267777
    reference_type:
    reference_id: 2267777
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.6:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.6:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.6:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.6:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52506
    reference_type:
    reference_id: CVE-2023-52506
