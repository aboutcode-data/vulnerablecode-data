vulnerability_id: VCID-m6tc-rfg3-aaak
aliases:
  - CVE-2024-40637
  - GHSA-p3f3-5ccg-83xq
  - PYSEC-2024-66
summary: 'dbt enables data analysts and engineers to transform their data using the same practices
  that software engineers use to build applications. When a user installs a package in dbt,
  it has the ability to override macros, materializations, and other core components of dbt.
  This is by design, as it allows packages to extend and customize dbt''s functionality. However,
  this also means that a malicious package could potentially override these components with
  harmful code. This issue has been fixed in versions 1.8.0, 1.6.14 and 1.7.14. Users are advised
  to upgrade. There are no kn own workarounds for this vulnerability. Users updating to either
  1.6.14 or 1.7.14 will need to set `flags.require_explicit_package_overrides_for_builtin_materializations:
  False` in their configuration in `dbt_project.yml`.'
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11200'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11755'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11661'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11608'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10712'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11010'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11305'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11251'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11101'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11126'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11194'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11190'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19281'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19000'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18998'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19021'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21868'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21823'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21759'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21918'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21924'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21891'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21933'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.2191'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.219'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21886'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21928'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21899'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21915'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.21925'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28471'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00124'
    scoring_system: epss
    scoring_elements: '0.28434'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29651'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29642'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29608'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29604'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29673'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29634'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29636'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29678'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29646'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.3193'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.31902'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.31884'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.31861'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.2717'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://docs.getdbt.com/docs/build/packages
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.getdbt.com/docs/build/packages
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.getdbt.com/docs/build/packages
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://docs.getdbt.com/reference/global-configs/legacy-behaviors#behavior-change-flags
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.getdbt.com/reference/global-configs/legacy-behaviors#behavior-change-flags
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.getdbt.com/reference/global-configs/legacy-behaviors#behavior-change-flags
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p3f3-5ccg-83xq
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p3f3-5ccg-83xq
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/dbt-labs/dbt-core
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dbt-labs/dbt-core
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dbt-labs/dbt-core
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/commit/3c82a0296d227cb1be295356df314c11716f4ff6
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/commit/3c82a0296d227cb1be295356df314c11716f4ff6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/commit/3c82a0296d227cb1be295356df314c11716f4ff6
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/commit/87ac4deb00cc9fe334706e42a365903a1d581624
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/commit/87ac4deb00cc9fe334706e42a365903a1d581624
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/commit/87ac4deb00cc9fe334706e42a365903a1d581624
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/security/advisories/GHSA-p3f3-5ccg-83xq
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/security/advisories/GHSA-p3f3-5ccg-83xq
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/security/advisories/GHSA-p3f3-5ccg-83xq
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dbt-labs/dbt-core/security/advisories/GHSA-p3f3-5ccg-83xq
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/dbt-core/PYSEC-2024-66.yaml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/dbt-core/PYSEC-2024-66.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/dbt-core/PYSEC-2024-66.yaml
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40637
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40637
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40637
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-40637
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://tempered.works/posts/2024/07/06/preventing-data-theft-with-gcp-service-controls
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://tempered.works/posts/2024/07/06/preventing-data-theft-with-gcp-service-controls
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://tempered.works/posts/2024/07/06/preventing-data-theft-with-gcp-service-controls
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://www.elementary-data.com/post/are-dbt-packages-secure-the-answer-lies-in-your-dwh-policies
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.elementary-data.com/post/are-dbt-packages-secure-the-answer-lies-in-your-dwh-policies
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.elementary-data.com/post/are-dbt-packages-secure-the-answer-lies-in-your-dwh-policies
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://www.equalexperts.com/blog/tech-focus/are-you-at-risk-from-this-critical-dbt-vulnerability
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.equalexperts.com/blog/tech-focus/are-you-at-risk-from-this-critical-dbt-vulnerability
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.equalexperts.com/blog/tech-focus/are-you-at-risk-from-this-critical-dbt-vulnerability
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-913
  - CWE-89
  - CWE-74
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-40637
    reference_type:
    reference_id:
  - url: https://docs.getdbt.com/docs/build/packages
    reference_type:
    reference_id:
  - url: https://docs.getdbt.com/reference/global-configs/legacy-behaviors#behavior-change-flags
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core/commit/3c82a0296d227cb1be295356df314c11716f4ff6
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core/commit/87ac4deb00cc9fe334706e42a365903a1d581624
    reference_type:
    reference_id:
  - url: https://github.com/dbt-labs/dbt-core/security/advisories/GHSA-p3f3-5ccg-83xq
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/dbt-core/PYSEC-2024-66.yaml
    reference_type:
    reference_id:
  - url: https://tempered.works/posts/2024/07/06/preventing-data-theft-with-gcp-service-controls
    reference_type:
    reference_id:
  - url: https://www.elementary-data.com/post/are-dbt-packages-secure-the-answer-lies-in-your-dwh-policies
    reference_type:
    reference_id:
  - url: https://www.equalexperts.com/blog/tech-focus/are-you-at-risk-from-this-critical-dbt-vulnerability
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:getdbt:dbt_core:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:getdbt:dbt_core:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-40637
    reference_type:
    reference_id: CVE-2024-40637
  - url: https://github.com/advisories/GHSA-p3f3-5ccg-83xq
    reference_type:
    reference_id: GHSA-p3f3-5ccg-83xq
