vulnerability_id: VCID-j3ra-g57a-2yfk
aliases:
  - CVE-2025-38388
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  firmware: arm_ffa: Replace mutex with rwlock to avoid sleep in atomic context

  The current use of a mutex to protect the notifier hashtable accesses
  can lead to issues in the atomic context. It results in the below
  kernel warnings:

    |  BUG: sleeping function called from invalid context at kernel/locking/mutex.c:258
    |  in_atomic(): 1, irqs_disabled(): 1, non_block: 0, pid: 9, name: kworker/0:0
    |  preempt_count: 1, expected: 0
    |  RCU nest depth: 0, expected: 0
    |  CPU: 0 UID: 0 PID: 9 Comm: kworker/0:0 Not tainted 6.14.0 #4
    |  Workqueue: ffa_pcpu_irq_notification notif_pcpu_irq_work_fn
    |  Call trace:
    |   show_stack+0x18/0x24 (C)
    |   dump_stack_lvl+0x78/0x90
    |   dump_stack+0x18/0x24
    |   __might_resched+0x114/0x170
    |   __might_sleep+0x48/0x98
    |   mutex_lock+0x24/0x80
    |   handle_notif_callbacks+0x54/0xe0
    |   notif_get_and_handle+0x40/0x88
    |   generic_exec_single+0x80/0xc0
    |   smp_call_function_single+0xfc/0x1a0
    |   notif_pcpu_irq_work_fn+0x2c/0x38
    |   process_one_work+0x14c/0x2b4
    |   worker_thread+0x2e4/0x3e0
    |   kthread+0x13c/0x210
    |   ret_from_fork+0x10/0x20

  To address this, replace the mutex with an rwlock to protect the notifier
  hashtable accesses. This ensures that read-side locking does not sleep and
  multiple readers can acquire the lock concurrently, avoiding unnecessary
  contention and potential deadlocks. Writer access remains exclusive,
  preserving correctness.

  This change resolves warnings from lockdep about potential sleep in
  atomic context.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38388.json
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00776'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00787'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03996'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03989'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04026'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0406'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03962'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0398'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0399'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04758'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04736'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04798'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04828'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04881'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04826'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0478'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04836'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04823'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04953'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04776'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0496'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04955'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04804'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05416'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05507'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05497'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05534'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05478'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0545'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0548'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05504'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05513'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05542'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05517'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05487'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05468'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05442'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05467'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05444'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05429'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05436'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05526'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05512'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38388.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38388
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/31405510a48dcf054abfa5b7b8d70ce1b27d1f13
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8986f8f61b482c0e6efd28f0b2423d9640c20eb1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ca7a421229bbdfbe2e1e628cff5cfa782720a10
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2383401
    reference_type:
    reference_id: 2383401
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38388
    reference_type:
    reference_id: CVE-2025-38388
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
