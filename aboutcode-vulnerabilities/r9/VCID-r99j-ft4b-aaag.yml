vulnerability_id: VCID-r99j-ft4b-aaag
aliases:
  - CVE-2021-47533
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/vc4: kms: Clear the HVS FIFO commit pointer once done

  Commit 9ec03d7f1ed3 ("drm/vc4: kms: Wait on previous FIFO users before a
  commit") introduced a wait on the previous commit done on a given HVS
  FIFO.

  However, we never cleared that pointer once done. Since
  drm_crtc_commit_put can free the drm_crtc_commit structure directly if
  we were the last user, this means that it can lead to a use-after free
  if we were to duplicate the state, and that stale pointer would even be
  copied to the new state.

  Set the pointer to NULL once we're done with the wait so that we don't
  carry over a pointer to a free'd structure.
severities:
  - score: '4.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47533.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21266'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17712'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21272'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21273'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17675'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.1782'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17842'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17873'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17887'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.1786'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17846'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17848'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17867'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.179'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17899'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17874'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17843'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17816'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21097'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21164'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21209'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21268'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21257'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21242'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21235'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21233'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21249'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21253'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '0.00293'
    scoring_system: epss
    scoring_elements: '0.36443'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47533.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47533
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2931db9a5ed219546cf2ae0546698faf78281b89
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d134c5ff71c7f2320fc7997f2fbbdedf0c76889a
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2283418
    reference_type:
    reference_id: 2283418
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47533
    reference_type:
    reference_id: CVE-2021-47533
