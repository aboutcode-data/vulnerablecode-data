vulnerability_id: VCID-d7zp-15rz-aaak
aliases:
  - CVE-2022-31104
  - GHSA-jqwc-c49r-4w2x
summary: Wasmtime is a standalone runtime for WebAssembly. In affected versions wasmtime's implementation
  of the SIMD proposal for WebAssembly on x86_64 contained two distinct bugs in the instruction
  lowerings implemented in Cranelift. The aarch64 implementation of the simd proposal is not
  affected. The bugs were presented in the `i8x16.swizzle` and `select` WebAssembly instructions.
  The `select` instruction is only affected when the inputs are of `v128` type. The correspondingly
  affected Cranelift instructions were `swizzle` and `select`. The `swizzle` instruction lowering
  in Cranelift erroneously overwrote the mask input register which could corrupt a constant
  value, for example. This means that future uses of the same constant may see a different value
  than the constant itself. The `select` instruction lowering in Cranelift wasn't correctly
  implemented for vector types that are 128-bits wide. When the condition was 0 the wrong instruction
  was used to move the correct input to the output of the instruction meaning that only the
  low 32 bits were moved and the upper 96 bits of the result were left as whatever the register
  previously contained (instead of the input being moved from). The `select` instruction worked
  correctly if the condition was nonzero, however. This bug in Wasmtime's implementation of
  these instructions on x86_64 represents an incorrect implementation of the specified semantics
  of these instructions according to the WebAssembly specification. The impact of this is benign
  for hosts running WebAssembly but represents possible vulnerabilities within the execution
  of a guest program. For example a WebAssembly program could take unintended branches or materialize
  incorrect values internally which runs the risk of exposing the program itself to other related
  vulnerabilities which can occur from miscompilations. We have released Wasmtime 0.38.1 and
  cranelift-codegen (and other associated cranelift crates) 0.85.1 which contain the corrected
  implementations of these two instructions in Cranelift. If upgrading is not an option for
  you at this time, you can avoid the vulnerability by disabling the Wasm simd proposal. Additionally
  the bug is only present on x86_64 hosts. Other aarch64 hosts are not affected. Note that s390x
  hosts don't yet implement the simd proposal and are not affected.
severities:
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.63920'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00248'
    scoring_system: epss
    scoring_elements: '0.63938'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.64028'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00297'
    scoring_system: epss
    scoring_elements: '0.69211'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70157'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70210'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.69958'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70102'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70142'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70202'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70319'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70288'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70273'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70211'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00299'
    scoring_system: epss
    scoring_elements: '0.70221'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00399'
    scoring_system: epss
    scoring_elements: '0.59552'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00399'
    scoring_system: epss
    scoring_elements: '0.59565'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00399'
    scoring_system: epss
    scoring_elements: '0.59564'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00399'
    scoring_system: epss
    scoring_elements: '0.59551'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00399'
    scoring_system: epss
    scoring_elements: '0.59555'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.65028'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63618'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63596'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.6369'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63693'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63713'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63727'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63706'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63704'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63703'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63682'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63697'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63716'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63714'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63708'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.63694'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.64962'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.64996'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.6503'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.65056'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.65059'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.6502'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '0.01254'
    scoring_system: epss
    scoring_elements: '0.66868'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
  - score: '2.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_simd
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_simd
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_simd
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:04:13Z/
    published_at: None
    url: https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_simd
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-jqwc-c49r-4w2x
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/4317
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/4317
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:04:13Z/
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/4317
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/4318
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/4318
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:04:13Z/
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/4318
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-jqwc-c49r-4w2x
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-jqwc-c49r-4w2x
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:04:13Z/
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-jqwc-c49r-4w2x
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/webassembly/simd
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/webassembly/simd
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/webassembly/simd
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:04:13Z/
    published_at: None
    url: https://github.com/webassembly/simd
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31104
  - score: '5.6'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31104
  - score: '5.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31104
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://webassembly.github.io/spec
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://webassembly.github.io/spec
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://webassembly.github.io/spec/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:04:13Z/
    published_at: None
    url: https://webassembly.github.io/spec/
weaknesses:
  - CWE-682
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-31104
    reference_type:
    reference_id:
  - url: https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_simd
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime/pull/4317
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime/pull/4318
    reference_type:
    reference_id:
  - url: https://github.com/webassembly/simd
    reference_type:
    reference_id:
  - url: https://webassembly.github.io/spec
    reference_type:
    reference_id:
  - url: https://webassembly.github.io/spec/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:bytecodealliance:cranelift-codegen:*:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:bytecodealliance:cranelift-codegen:*:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:bytecodealliance:wasmtime:*:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:bytecodealliance:wasmtime:*:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31104
    reference_type:
    reference_id: CVE-2022-31104
  - url: https://github.com/advisories/GHSA-jqwc-c49r-4w2x
    reference_type:
    reference_id: GHSA-jqwc-c49r-4w2x
  - url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-jqwc-c49r-4w2x
    reference_type:
    reference_id: GHSA-jqwc-c49r-4w2x
