vulnerability_id: VCID-jq6z-pun1-1bee
aliases:
  - CVE-2025-38117
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  Bluetooth: MGMT: Protect mgmt_pending list with its own lock

  This uses a mutex to protect from concurrent access of mgmt_pending
  list which can cause crashes like:

  ==================================================================
  BUG: KASAN: slab-use-after-free in hci_sock_get_channel+0x60/0x68 net/bluetooth/hci_sock.c:91
  Read of size 2 at addr ffff0000c48885b2 by task syz.4.334/7318

  CPU: 0 UID: 0 PID: 7318 Comm: syz.4.334 Not tainted 6.15.0-rc7-syzkaller-g187899f4124a #0 PREEMPT
  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 02/12/2025
  Call trace:
   show_stack+0x2c/0x3c arch/arm64/kernel/stacktrace.c:466 (C)
   __dump_stack+0x30/0x40 lib/dump_stack.c:94
   dump_stack_lvl+0xd8/0x12c lib/dump_stack.c:120
   print_address_description+0xa8/0x254 mm/kasan/report.c:408
   print_report+0x68/0x84 mm/kasan/report.c:521
   kasan_report+0xb0/0x110 mm/kasan/report.c:634
   __asan_report_load2_noabort+0x20/0x2c mm/kasan/report_generic.c:379
   hci_sock_get_channel+0x60/0x68 net/bluetooth/hci_sock.c:91
   mgmt_pending_find+0x7c/0x140 net/bluetooth/mgmt_util.c:223
   pending_find net/bluetooth/mgmt.c:947 [inline]
   remove_adv_monitor+0x44/0x1a4 net/bluetooth/mgmt.c:5445
   hci_mgmt_cmd+0x780/0xc00 net/bluetooth/hci_sock.c:1712
   hci_sock_sendmsg+0x544/0xbb0 net/bluetooth/hci_sock.c:1832
   sock_sendmsg_nosec net/socket.c:712 [inline]
   __sock_sendmsg net/socket.c:727 [inline]
   sock_write_iter+0x25c/0x378 net/socket.c:1131
   new_sync_write fs/read_write.c:591 [inline]
   vfs_write+0x62c/0x97c fs/read_write.c:684
   ksys_write+0x120/0x210 fs/read_write.c:736
   __do_sys_write fs/read_write.c:747 [inline]
   __se_sys_write fs/read_write.c:744 [inline]
   __arm64_sys_write+0x7c/0x90 fs/read_write.c:744
   __invoke_syscall arch/arm64/kernel/syscall.c:35 [inline]
   invoke_syscall+0x98/0x2b8 arch/arm64/kernel/syscall.c:49
   el0_svc_common+0x130/0x23c arch/arm64/kernel/syscall.c:132
   do_el0_svc+0x48/0x58 arch/arm64/kernel/syscall.c:151
   el0_svc+0x58/0x17c arch/arm64/kernel/entry-common.c:767
   el0t_64_sync_handler+0x78/0x108 arch/arm64/kernel/entry-common.c:786
   el0t_64_sync+0x198/0x19c arch/arm64/kernel/entry.S:600

  Allocated by task 7037:
   kasan_save_stack mm/kasan/common.c:47 [inline]
   kasan_save_track+0x40/0x78 mm/kasan/common.c:68
   kasan_save_alloc_info+0x44/0x54 mm/kasan/generic.c:562
   poison_kmalloc_redzone mm/kasan/common.c:377 [inline]
   __kasan_kmalloc+0x9c/0xb4 mm/kasan/common.c:394
   kasan_kmalloc include/linux/kasan.h:260 [inline]
   __do_kmalloc_node mm/slub.c:4327 [inline]
   __kmalloc_noprof+0x2fc/0x4c8 mm/slub.c:4339
   kmalloc_noprof include/linux/slab.h:909 [inline]
   sk_prot_alloc+0xc4/0x1f0 net/core/sock.c:2198
   sk_alloc+0x44/0x3ac net/core/sock.c:2254
   bt_sock_alloc+0x4c/0x300 net/bluetooth/af_bluetooth.c:148
   hci_sock_create+0xa8/0x194 net/bluetooth/hci_sock.c:2202
   bt_sock_create+0x14c/0x24c net/bluetooth/af_bluetooth.c:132
   __sock_create+0x43c/0x91c net/socket.c:1541
   sock_create net/socket.c:1599 [inline]
   __sys_socket_create net/socket.c:1636 [inline]
   __sys_socket+0xd4/0x1c0 net/socket.c:1683
   __do_sys_socket net/socket.c:1697 [inline]
   __se_sys_socket net/socket.c:1695 [inline]
   __arm64_sys_socket+0x7c/0x94 net/socket.c:1695
   __invoke_syscall arch/arm64/kernel/syscall.c:35 [inline]
   invoke_syscall+0x98/0x2b8 arch/arm64/kernel/syscall.c:49
   el0_svc_common+0x130/0x23c arch/arm64/kernel/syscall.c:132
   do_el0_svc+0x48/0x58 arch/arm64/kernel/syscall.c:151
   el0_svc+0x58/0x17c arch/arm64/kernel/entry-common.c:767
   el0t_64_sync_handler+0x78/0x108 arch/arm64/kernel/entry-common.c:786
   el0t_64_sync+0x198/0x19c arch/arm64/kernel/entry.S:600

  Freed by task 6607:
   kasan_save_stack mm/kasan/common.c:47 [inline]
   kasan_save_track+0x40/0x78 mm/kasan/common.c:68
   kasan_save_free_info+0x58/0x70 mm/kasan/generic.c:576
   poison_slab_object mm/kasan/common.c:247 [inline]
   __kasan_slab_free+0x68/0x88 mm/kasan/common.c:264
   kasan_slab_free include/linux/kasan.h:233 [inline
  ---truncated---
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38117.json
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02721'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02718'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02935'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04538'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04514'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0453'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04498'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04495'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04502'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0449'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04424'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04406'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05231'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05406'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05188'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05174'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05149'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05168'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0513'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05166'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06049'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06065'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06056'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06016'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05996'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05985'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05995'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05979'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0596'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05962'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05981'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05975'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05686'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05697'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05725'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05705'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05796'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05819'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05858'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05744'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05746'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05713'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05815'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0581'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05812'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05968'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05955'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05993'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05947'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05927'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05961'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06028'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09118'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09164'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38117.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38117
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38117
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4e83f2dbb2bf677e614109df24426c4dded472d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6fe26f694c824b8a4dbf50c635bee1302e3f099c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bdd56875c6926d8009914f427df71797693e90d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d7882db79135c829a922daf3571f33ea1e056ae3
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2376098
    reference_type:
    reference_id: 2376098
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38117
    reference_type:
    reference_id: CVE-2025-38117
  - url: https://usn.ubuntu.com/7769-1/
    reference_type:
    reference_id: USN-7769-1
  - url: https://usn.ubuntu.com/7769-2/
    reference_type:
    reference_id: USN-7769-2
  - url: https://usn.ubuntu.com/7769-3/
    reference_type:
    reference_id: USN-7769-3
  - url: https://usn.ubuntu.com/7770-1/
    reference_type:
    reference_id: USN-7770-1
  - url: https://usn.ubuntu.com/7771-1/
    reference_type:
    reference_id: USN-7771-1
  - url: https://usn.ubuntu.com/7789-1/
    reference_type:
    reference_id: USN-7789-1
  - url: https://usn.ubuntu.com/7789-2/
    reference_type:
    reference_id: USN-7789-2
