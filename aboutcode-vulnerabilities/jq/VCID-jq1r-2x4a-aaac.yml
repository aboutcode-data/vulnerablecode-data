vulnerability_id: VCID-jq1r-2x4a-aaac
aliases:
  - CVE-2021-21378
summary: Envoy is a cloud-native high-performance edge/middle/service proxy. In Envoy version
  1.17.0 an attacker can bypass authentication by presenting a JWT token with an issuer that
  is not in the provider list when Envoy's JWT Authentication filter is configured with the
  `allow_missing` requirement under `requires_any` due to a mistake in implementation. Envoy's
  JWT Authentication filter can be configured with the `allow_missing` requirement that will
  be satisfied if JWT is missing (JwtMissed error) and fail if JWT is presented or invalid.
  Due to a mistake in implementation, a JwtUnknownIssuer error was mistakenly converted to JwtMissed
  when `requires_any` was configured. So if `allow_missing` was configured under `requires_any`,
  an attacker can bypass authentication by presenting a JWT token with an issuer that is not
  in the provider list. Integrity may be impacted depending on configuration if the JWT token
  is used to protect against writes or modifications. This regression was introduced on 2020/11/12
  in PR 13839 which fixed handling `allow_missing` under RequiresAny in a JwtRequirement (see
  issue 13458). The AnyVerifier aggregates the children verifiers' results into a final status
  where JwtMissing is the default error. However, a JwtUnknownIssuer was mistakenly treated
  the same as a JwtMissing error and the resulting final aggregation was the default JwtMissing.
  As a result, `allow_missing` would allow a JWT token with an unknown issuer status. This is
  fixed in version 1.17.1 by PR 15194. The fix works by preferring JwtUnknownIssuer over a JwtMissing
  error, fixing the accidental conversion and bypass with `allow_missing`. A user could detect
  whether a bypass occurred if they have Envoy logs enabled with debug verbosity. Users can
  enable component level debug logs for JWT. The JWT filter logs will indicate that there is
  a request with a JWT token and a failure that the JWT token is missing.
severities:
  - score: '8.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-21378.json
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.48721'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.48688'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.48714'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49157'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49430'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49502'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49524'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49599'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49592'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49585'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49600'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49613'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49764'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49790'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00132'
    scoring_system: epss
    scoring_elements: '0.49866'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.52268'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46089'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46136'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46155'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46156'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46167'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46144'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43265'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43242'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43369'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43381'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43394'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43412'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43388'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43359'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43384'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43401'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43422'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.43428'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.4339'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.4337'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46079'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46133'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.4619'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46215'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46218'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46124'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00233'
    scoring_system: epss
    scoring_elements: '0.46122'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: '0.00797'
    scoring_system: epss
    scoring_elements: '0.59012'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1933681
  - score: '6.4'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21378
  - score: '8.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21378
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21378
weaknesses:
  - CWE-287
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-21378.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-21378
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/commit/ea39e3cba652bcc4b11bb0d5c62b017e584d2e5a
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/pull/15194
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-4996-m8hf-hj27
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1933681
    reference_type:
    reference_id: '1933681'
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:1.17.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:1.17.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21378
    reference_type:
    reference_id: CVE-2021-21378
  - url: https://istio.io/latest/news/security/ISTIO-SECURITY-2021-001/
    reference_type:
    reference_id: ISTIO-SECURITY-2021-001
