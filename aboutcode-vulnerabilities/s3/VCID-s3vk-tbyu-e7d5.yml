vulnerability_id: VCID-s3vk-tbyu-e7d5
aliases:
  - CVE-2025-38152
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  remoteproc: core: Clear table_sz when rproc_shutdown

  There is case as below could trigger kernel dump:
  Use U-Boot to start remote processor(rproc) with resource table
  published to a fixed address by rproc. After Kernel boots up,
  stop the rproc, load a new firmware which doesn't have resource table
  ,and start rproc.

  When starting rproc with a firmware not have resource table,
  `memcpy(loaded_table, rproc->cached_table, rproc->table_sz)` will
  trigger dump, because rproc->cache_table is set to NULL during the last
  stop operation, but rproc->table_sz is still valid.

  This issue is found on i.MX8MP and i.MX9.

  Dump as below:
  Unable to handle kernel NULL pointer dereference at virtual address 0000000000000000
  Mem abort info:
    ESR = 0x0000000096000004
    EC = 0x25: DABT (current EL), IL = 32 bits
    SET = 0, FnV = 0
    EA = 0, S1PTW = 0
    FSC = 0x04: level 0 translation fault
  Data abort info:
    ISV = 0, ISS = 0x00000004, ISS2 = 0x00000000
    CM = 0, WnR = 0, TnD = 0, TagAccess = 0
    GCS = 0, Overlay = 0, DirtyBit = 0, Xs = 0
  user pgtable: 4k pages, 48-bit VAs, pgdp=000000010af63000
  [0000000000000000] pgd=0000000000000000, p4d=0000000000000000
  Internal error: Oops: 0000000096000004 [#1] PREEMPT SMP
  Modules linked in:
  CPU: 2 UID: 0 PID: 1060 Comm: sh Not tainted 6.14.0-rc7-next-20250317-dirty #38
  Hardware name: NXP i.MX8MPlus EVK board (DT)
  pstate: a0000005 (NzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
  pc : __pi_memcpy_generic+0x110/0x22c
  lr : rproc_start+0x88/0x1e0
  Call trace:
   __pi_memcpy_generic+0x110/0x22c (P)
   rproc_boot+0x198/0x57c
   state_store+0x40/0x104
   dev_attr_store+0x18/0x2c
   sysfs_kf_write+0x7c/0x94
   kernfs_fop_write_iter+0x120/0x1cc
   vfs_write+0x240/0x378
   ksys_write+0x70/0x108
   __arm64_sys_write+0x1c/0x28
   invoke_syscall+0x48/0x10c
   el0_svc_common.constprop.0+0xc0/0xe0
   do_el0_svc+0x1c/0x28
   el0_svc+0x30/0xcc
   el0t_64_sync_handler+0x10c/0x138
   el0t_64_sync+0x198/0x19c

  Clear rproc->table_sz to address the issue.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38152.json
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04985'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05064'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05038'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05028'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04989'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07616'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07679'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07674'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07685'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0768'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38152.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38152
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/068f6648ff5b0c7adeb6c363fae7fb188aa178fa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2df19f5f6f72da6f6ebab7cdb3a3b9f7686bb476
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6e66bca8cd51ebedd5d32426906a38e4a3c69c5f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7c6bb82a6f3da6ab2d3fbea03901482231708b98
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8e0fd2a3b9852ac3cf540edb06ccc0153b38b5af
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e6015ca453b82ec54aec9682dcc38773948fcc48
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/efdde3d73ab25cef4ff2d06783b0aad8b093c0e4
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2360928
    reference_type:
    reference_id: 2360928
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38152
    reference_type:
    reference_id: CVE-2025-38152
