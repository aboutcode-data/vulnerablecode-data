vulnerability_id: VCID-pxxy-9cew-2qgc
aliases:
  - CVE-2025-39756
summary: 'In the Linux kernel, the following vulnerability has been resolved:  fs: Prevent file
  descriptor table allocations exceeding INT_MAX  When sysctl_nr_open is set to a very high
  value (for example, 1073741816 as set by systemd), processes attempting to use file descriptors
  near the limit can trigger massive memory allocation attempts that exceed INT_MAX, resulting
  in a WARNING in mm/slub.c:    WARNING: CPU: 0 PID: 44 at mm/slub.c:5027 __kvmalloc_node_noprof+0x21a/0x288  This
  happens because kvmalloc_array() and kvmalloc() check if the requested size exceeds INT_MAX
  and emit a warning when the allocation is not flagged with __GFP_NOWARN.  Specifically, when
  nr_open is set to 1073741816 (0x3ffffff8) and a process calls dup2(oldfd, 1073741880), the
  kernel attempts to allocate: - File descriptor array: 1073741880 * 8 bytes = 8,589,935,040
  bytes - Multiple bitmaps: ~400MB - Total allocation size: > 8GB (exceeding INT_MAX = 2,147,483,647)  Reproducer:
  1. Set /proc/sys/fs/nr_open to 1073741816:    # echo 1073741816 > /proc/sys/fs/nr_open  2.
  Run a program that uses a high file descriptor:    #include <unistd.h>    #include <sys/resource.h>     int
  main() {        struct rlimit rlim = {1073741824, 1073741824};        setrlimit(RLIMIT_NOFILE,
  &rlim);        dup2(2, 1073741880);  // Triggers the warning        return 0;    }  3. Observe
  WARNING in dmesg at mm/slub.c:5027  systemd commit a8b627a introduced automatic bumping of
  fs.nr_open to the maximum possible value. The rationale was that systems with memory control
  groups (memcg) no longer need separate file descriptor limits since memory is properly accounted.
  However, this change overlooked that:  1. The kernel''s allocation functions still enforce
  INT_MAX as a maximum    size regardless of memcg accounting 2. Programs and tests that legitimately
  test file descriptor limits can    inadvertently trigger massive allocations 3. The resulting
  allocations (>8GB) are impractical and will always fail  systemd''s algorithm starts with
  INT_MAX and keeps halving the value until the kernel accepts it. On most systems, this results
  in nr_open being set to 1073741816 (0x3ffffff8), which is just under 1GB of file descriptors.  While
  processes rarely use file descriptors near this limit in normal operation, certain selftests
  (like tools/testing/selftests/core/unshare_test.c) and programs that test file descriptor
  limits can trigger this issue.  Fix this by adding a check in alloc_fdtable() to ensure the
  requested allocation size does not exceed INT_MAX. This causes the operation to fail with
  -EMFILE instead of triggering a kernel warning and avoids the impractical >8GB memory allocation
  request.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39756.json
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39756.json
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.11355'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17855'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.1792'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22195'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.2339'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23458'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23409'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23391'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23468'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23451'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23455'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23303'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23266'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23285'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23282'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23352'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23383'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23299'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23393'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24903'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.2489'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24885'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24841'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.2481'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24894'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24881'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24873'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24871'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24874'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24878'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24912'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24845'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24899'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.2484'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39756.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-39756
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-39756
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2394600
    reference_type:
    reference_id: 2394600
  - url: https://usn.ubuntu.com/7909-1/
    reference_type:
    reference_id: USN-7909-1
  - url: https://usn.ubuntu.com/7909-2/
    reference_type:
    reference_id: USN-7909-2
  - url: https://usn.ubuntu.com/7909-3/
    reference_type:
    reference_id: USN-7909-3
  - url: https://usn.ubuntu.com/7909-4/
    reference_type:
    reference_id: USN-7909-4
  - url: https://usn.ubuntu.com/7909-5/
    reference_type:
    reference_id: USN-7909-5
  - url: https://usn.ubuntu.com/7910-1/
    reference_type:
    reference_id: USN-7910-1
  - url: https://usn.ubuntu.com/7910-2/
    reference_type:
    reference_id: USN-7910-2
  - url: https://usn.ubuntu.com/7933-1/
    reference_type:
    reference_id: USN-7933-1
  - url: https://usn.ubuntu.com/7938-1/
    reference_type:
    reference_id: USN-7938-1
