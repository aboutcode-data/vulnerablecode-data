vulnerability_id: VCID-pxbv-qegj-aaar
aliases:
  - CVE-2023-41893
  - GHSA-qhhj-7hrc-gqj5
  - PYSEC-2023-214
summary: Home assistant is an open source home automation. The audit team’s analyses confirmed
  that the `redirect_uri` and `client_id` are alterable when logging in. Consequently, the code
  parameter utilized to fetch the `access_token` post-authentication will be sent to the URL
  specified in the aforementioned parameters. Since an arbitrary URL is permitted and `homeassistant.local`
  represents the preferred, default domain likely used and trusted by many users, an attacker
  could leverage this weakness to manipulate a user and retrieve account access. Notably, this
  attack strategy is plausible if the victim has exposed their Home Assistant to the Internet,
  since after acquiring the victim’s `access_token` the adversary would need to utilize it directly
  towards the instance to achieve any pertinent malicious actions. To achieve this compromise
  attempt, the attacker must send a link with a `redirect_uri` that they control to the victim’s
  own Home Assistant instance. In the eventuality the victim authenticates via said link, the
  attacker would obtain code sent to the specified URL in `redirect_uri`, which can then be
  leveraged to fetch an `access_token`. Pertinently, an attacker could increase the efficacy
  of this strategy by registering a near identical domain to `homeassistant.local`, which at
  first glance may appear legitimate and thereby obfuscate any malicious intentions. This issue
  has been addressed in version 2023.9.0 and all users are advised to upgrade. There are no
  known workarounds for this vulnerability.
severities:
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28392'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28656'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31599'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31623'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31844'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31902'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31995'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31806'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31811'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31793'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.32181'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31441'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31577'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31466'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31583'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.5602'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.56034'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.56043'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.56035'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.56031'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.56024'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.56015'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.55932'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.5599'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.56069'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.56053'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.56029'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.55974'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59162'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59102'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59048'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.5914'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59145'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59172'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59191'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.5917'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59175'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59201'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.5922'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.5924'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59232'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.5923'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.0042'
    scoring_system: epss
    scoring_elements: '0.59212'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: '0.00497'
    scoring_system: epss
    scoring_elements: '0.48696'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-qhhj-7hrc-gqj5
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/home-assistant/core
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/home-assistant/core
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/home-assistant/core/security/advisories/GHSA-qhhj-7hrc-gqj5
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/home-assistant/core/security/advisories/GHSA-qhhj-7hrc-gqj5
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/homeassistant/PYSEC-2023-214.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/homeassistant/PYSEC-2023-214.yaml
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-41893
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-41893
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://www.home-assistant.io/blog/2023/10/19/security-audits-of-home-assistant
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.home-assistant.io/blog/2023/10/19/security-audits-of-home-assistant
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://www.home-assistant.io/blog/2023/10/19/security-audits-of-home-assistant/
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-41893
    reference_type:
    reference_id:
  - url: https://github.com/home-assistant/core
    reference_type:
    reference_id:
  - url: https://github.com/home-assistant/core/security/advisories/GHSA-qhhj-7hrc-gqj5
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/homeassistant/PYSEC-2023-214.yaml
    reference_type:
    reference_id:
  - url: https://www.home-assistant.io/blog/2023/10/19/security-audits-of-home-assistant
    reference_type:
    reference_id:
  - url: https://www.home-assistant.io/blog/2023/10/19/security-audits-of-home-assistant/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:home-assistant:home-assistant:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:home-assistant:home-assistant:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41893
    reference_type:
    reference_id: CVE-2023-41893
  - url: https://github.com/advisories/GHSA-qhhj-7hrc-gqj5
    reference_type:
    reference_id: GHSA-qhhj-7hrc-gqj5
