vulnerability_id: VCID-xhtk-kssv-aaad
aliases:
  - CVE-2021-3583
  - GHSA-2pfh-q76x-gwvm
  - PYSEC-2021-358
summary: A flaw was found in Ansible, where a user's controller is vulnerable to template injection.
  This issue can occur through facts used in the template if the user is trying to put templates
  in multi-line YAML strings and the facts being handled do not routinely include special template
  characters. This flaw allows attackers to perform command injection, which discloses sensitive
  information. The highest threat from this vulnerability is to confidentiality and integrity.
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:2663
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:2664
  - score: '6.6'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-3583.json
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14320'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14307'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14698'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14606'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14551'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14262'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14178'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14123'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14109'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14115'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14048'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14025'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13628'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13940'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14719'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14380'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58852'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.5711'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57113'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57135'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.5715'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57132'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.5712'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57159'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57172'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57183'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57171'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57157'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57145'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58766'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58804'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58847'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58873'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58887'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.5884'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58837'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58843'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58846'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58859'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58856'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.58848'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57062'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.00388'
    scoring_system: epss
    scoring_elements: '0.57011'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: '0.009'
    scoring_system: epss
    scoring_elements: '0.61309'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1968412
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-2pfh-q76x-gwvm
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/ansible/ansible
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ansible/ansible
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/ansible/ansible/commit/03aff644cc1c00e1f7551195c68fbd0d13a39e6e
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ansible/ansible/commit/03aff644cc1c00e1f7551195c68fbd0d13a39e6e
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/ansible/ansible/commit/8aa850e3573e48c9a2f12aef84e8a3a6f5ba4847
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ansible/ansible/commit/8aa850e3573e48c9a2f12aef84e8a3a6f5ba4847
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/ansible/ansible/commit/8b17e5b9229ffaecfe10a4881bc3f87dd2c184e1
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ansible/ansible/commit/8b17e5b9229ffaecfe10a4881bc3f87dd2c184e1
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/ansible/ansible/pull/74960
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ansible/ansible/pull/74960
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2021-358.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2021-358.yaml
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2023/12/msg00018.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2023/12/msg00018.html
  - score: '3.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3583
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3583
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3583
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://pypi.org/project/ansible/4.2.0
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pypi.org/project/ansible/4.2.0
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2260
weaknesses:
  - CWE-20
  - CWE-94
  - CWE-937
  - CWE-1035
  - CWE-77
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-3583.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-3583
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3583
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/03aff644cc1c00e1f7551195c68fbd0d13a39e6e
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/8aa850e3573e48c9a2f12aef84e8a3a6f5ba4847
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/commit/8b17e5b9229ffaecfe10a4881bc3f87dd2c184e1
    reference_type:
    reference_id:
  - url: https://github.com/ansible/ansible/pull/74960
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2021-358.yaml
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/12/msg00018.html
    reference_type:
    reference_id:
  - url: https://pypi.org/project/ansible/4.2.0
    reference_type:
    reference_id:
  - url: https://pypi.org/project/ansible/4.2.0/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1968412
    reference_type:
    reference_id: '1968412'
  - url: https://security.archlinux.org/AVG-2260
    reference_type:
    reference_id: AVG-2260
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:redhat:ansible_automation_platform:1.2:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:redhat:ansible_automation_platform:1.2:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:redhat:ansible_engine:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:redhat:ansible_engine:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:redhat:ansible_tower:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:redhat:ansible_tower:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3583
    reference_type:
    reference_id: CVE-2021-3583
  - url: https://github.com/advisories/GHSA-2pfh-q76x-gwvm
    reference_type:
    reference_id: GHSA-2pfh-q76x-gwvm
  - url: https://access.redhat.com/errata/RHSA-2021:2663
    reference_type:
    reference_id: RHSA-2021:2663
  - url: https://access.redhat.com/errata/RHSA-2021:2664
    reference_type:
    reference_id: RHSA-2021:2664
  - url: https://usn.ubuntu.com/USN-5315-1/
    reference_type:
    reference_id: USN-USN-5315-1
