vulnerability_id: VCID-wyp6-p6qc-jfcc
aliases:
  - CVE-2023-53022
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: enetc: avoid
  deadlock in enetc_tx_onestep_tstamp()  This lockdep splat says it better than I could:  ================================
  WARNING: inconsistent lock state 6.2.0-rc2-07010-ga9b9500ffaac-dirty #967 Not tainted --------------------------------
  inconsistent {IN-SOFTIRQ-W} -> {SOFTIRQ-ON-W} usage. kworker/1:3/179 [HC0[0]:SC0[0]:HE1:SE1]
  takes: ffff3ec4036ce098 (_xmit_ETHER#2){+.?.}-{3:3}, at: netif_freeze_queues+0x5c/0xc0 {IN-SOFTIRQ-W}
  state was registered at:   _raw_spin_lock+0x5c/0xc0   sch_direct_xmit+0x148/0x37c   __dev_queue_xmit+0x528/0x111c   ip6_finish_output2+0x5ec/0xb7c   ip6_finish_output+0x240/0x3f0   ip6_output+0x78/0x360   ndisc_send_skb+0x33c/0x85c   ndisc_send_rs+0x54/0x12c   addrconf_rs_timer+0x154/0x260   call_timer_fn+0xb8/0x3a0   __run_timers.part.0+0x214/0x26c   run_timer_softirq+0x3c/0x74   __do_softirq+0x14c/0x5d8   ____do_softirq+0x10/0x20   call_on_irq_stack+0x2c/0x5c   do_softirq_own_stack+0x1c/0x30   __irq_exit_rcu+0x168/0x1a0   irq_exit_rcu+0x10/0x40   el1_interrupt+0x38/0x64
  irq event stamp: 7825 hardirqs last  enabled at (7825): [<ffffdf1f7200cae4>] exit_to_kernel_mode+0x34/0x130
  hardirqs last disabled at (7823): [<ffffdf1f708105f0>] __do_softirq+0x550/0x5d8 softirqs last  enabled
  at (7824): [<ffffdf1f7081050c>] __do_softirq+0x46c/0x5d8 softirqs last disabled at (7811):
  [<ffffdf1f708166e0>] ____do_softirq+0x10/0x20  other info that might help us debug this:  Possible
  unsafe locking scenario:         CPU0        ----   lock(_xmit_ETHER#2);   <Interrupt>     lock(_xmit_ETHER#2);   ***
  DEADLOCK ***  3 locks held by kworker/1:3/179:  #0: ffff3ec400004748 ((wq_completion)events){+.+.}-{0:0},
  at: process_one_work+0x1f4/0x6c0  #1: ffff80000a0bbdc8 ((work_completion)(&priv->tx_onestep_tstamp)){+.+.}-{0:0},
  at: process_one_work+0x1f4/0x6c0  #2: ffff3ec4036cd438 (&dev->tx_global_lock){+.+.}-{3:3},
  at: netif_tx_lock+0x1c/0x34  Workqueue: events enetc_tx_onestep_tstamp Call trace:  print_usage_bug.part.0+0x208/0x22c  mark_lock+0x7f0/0x8b0  __lock_acquire+0x7c4/0x1ce0  lock_acquire.part.0+0xe0/0x220  lock_acquire+0x68/0x84  _raw_spin_lock+0x5c/0xc0  netif_freeze_queues+0x5c/0xc0  netif_tx_lock+0x24/0x34  enetc_tx_onestep_tstamp+0x20/0x100  process_one_work+0x28c/0x6c0  worker_thread+0x74/0x450  kthread+0x118/0x11c  but
  I''ll say it anyway: the enetc_tx_onestep_tstamp() work item runs in process context, therefore
  with softirqs enabled (i.o.w., it can be interrupted by a softirq). If we hold the netif_tx_lock()
  when there is an interrupt, and the NET_TX softirq then gets scheduled, this will take the
  netif_tx_lock() a second time and deadlock the kernel.  To solve this, use netif_tx_lock_bh(),
  which blocks softirqs from running.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53022.json
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00783'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00778'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00781'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00792'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00796'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00798'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00791'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00788'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00789'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00782'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01101'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.0175'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01837'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.0185'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03195'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03163'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03148'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03149'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03146'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03147'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03139'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03137'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.0318'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03198'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03204'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03188'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03937'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-53022
weaknesses:
  - CWE-667
  - CWE-833
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53022.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53022
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c463721a73bdb57a913e0d3124677a3758886fc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8232e5a84d25a84a5cbda0f241a00793fb6eb608
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e893dced1a18e77b1262f5c10169413f0ece0da7
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355501
    reference_type:
    reference_id: 2355501
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53022
    reference_type:
    reference_id: CVE-2023-53022
