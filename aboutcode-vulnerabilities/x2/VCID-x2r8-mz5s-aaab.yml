vulnerability_id: VCID-x2r8-mz5s-aaab
aliases:
  - CVE-2021-47582
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  USB: core: Make do_proc_control() and do_proc_bulk() killable

  The USBDEVFS_CONTROL and USBDEVFS_BULK ioctls invoke
  usb_start_wait_urb(), which contains an uninterruptible wait with a
  user-specified timeout value.  If timeout value is very large and the
  device being accessed does not respond in a reasonable amount of time,
  the kernel will complain about "Task X blocked for more than N
  seconds", as found in testing by syzbot:

  INFO: task syz-executor.0:8700 blocked for more than 143 seconds.
        Not tainted 5.14.0-rc7-syzkaller #0
  "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.
  task:syz-executor.0  state:D stack:23192 pid: 8700 ppid:  8455 flags:0x00004004
  Call Trace:
   context_switch kernel/sched/core.c:4681 [inline]
   __schedule+0xc07/0x11f0 kernel/sched/core.c:5938
   schedule+0x14b/0x210 kernel/sched/core.c:6017
   schedule_timeout+0x98/0x2f0 kernel/time/timer.c:1857
   do_wait_for_common+0x2da/0x480 kernel/sched/completion.c:85
   __wait_for_common kernel/sched/completion.c:106 [inline]
   wait_for_common kernel/sched/completion.c:117 [inline]
   wait_for_completion_timeout+0x46/0x60 kernel/sched/completion.c:157
   usb_start_wait_urb+0x167/0x550 drivers/usb/core/message.c:63
   do_proc_bulk+0x978/0x1080 drivers/usb/core/devio.c:1236
   proc_bulk drivers/usb/core/devio.c:1273 [inline]
   usbdev_do_ioctl drivers/usb/core/devio.c:2547 [inline]
   usbdev_ioctl+0x3441/0x6b10 drivers/usb/core/devio.c:2713
  ...

  To fix this problem, this patch replaces usbfs's calls to
  usb_control_msg() and usb_bulk_msg() with special-purpose code that
  does essentially the same thing (as recommended in the comment for
  usb_start_wait_urb()), except that it always uses a killable wait and
  it uses GFP_KERNEL rather than GFP_NOIO.
severities:
  - score: '3.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47582.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.1903'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18898'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18858'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.19015'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.19044'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19082'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19044'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19032'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19047'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19068'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.191'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19091'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19058'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.19001'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23523'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23546'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23532'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23531'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.234'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23459'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23511'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23559'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23529'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.2352'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23516'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23541'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '0.00312'
    scoring_system: epss
    scoring_elements: '0.3797'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-667
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47582.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47582
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47582
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/403716741c6c2c510dce44e88f085a740f535de6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ae8709b296d80c7f45aa1f35c0e7659ad69edce1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2293247
    reference_type:
    reference_id: 2293247
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47582
    reference_type:
    reference_id: CVE-2021-47582
  - url: https://access.redhat.com/errata/RHSA-2024:7000
    reference_type:
    reference_id: RHSA-2024:7000
  - url: https://access.redhat.com/errata/RHSA-2024:7001
    reference_type:
    reference_id: RHSA-2024:7001
