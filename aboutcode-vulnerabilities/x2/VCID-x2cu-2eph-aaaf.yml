vulnerability_id: VCID-x2cu-2eph-aaaf
aliases:
  - CVE-2023-33246
  - GHSA-x3cq-8f32-5f63
summary: |
  For RocketMQ versions 5.1.0 and below, under certain conditions, there is a risk of remote command execution. 

  Several components of RocketMQ, including NameServer, Broker, and Controller, are leaked on the extranet and lack permission verification, an attacker can exploit this vulnerability by using the update configuration function to execute commands as the system users that RocketMQ is running as. Additionally, an attacker can achieve the same effect by forging the RocketMQ protocol content. 

  To prevent these attacks, users are recommended to upgrade to version 5.1.1 or above for using RocketMQ 5.x or 4.9.6 or above for using RocketMQ 4.x .











severities:
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html
  - score: Act
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:Y/T:T/P:M/B:A/M:M/D:C/2025-01-29T20:30:17Z/
    published_at: None
    url: http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-33246.json
  - score: '0.94222'
    scoring_system: epss
    scoring_elements: '0.9992'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.94222'
    scoring_system: epss
    scoring_elements: '0.99919'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.94222'
    scoring_system: epss
    scoring_elements: '0.99917'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.94222'
    scoring_system: epss
    scoring_elements: '0.99911'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.94222'
    scoring_system: epss
    scoring_elements: '0.99918'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.94222'
    scoring_system: epss
    scoring_elements: '0.99916'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.94426'
    scoring_system: epss
    scoring_elements: '0.99978'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.94426'
    scoring_system: epss
    scoring_elements: '0.99977'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97159'
    scoring_system: epss
    scoring_elements: '0.99848'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97304'
    scoring_system: epss
    scoring_elements: '0.99903'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97304'
    scoring_system: epss
    scoring_elements: '0.99902'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97306'
    scoring_system: epss
    scoring_elements: '0.99905'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97315'
    scoring_system: epss
    scoring_elements: '0.99910'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97315'
    scoring_system: epss
    scoring_elements: '0.99909'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97315'
    scoring_system: epss
    scoring_elements: '0.99908'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97320'
    scoring_system: epss
    scoring_elements: '0.99947'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97338'
    scoring_system: epss
    scoring_elements: '0.99951'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: '0.97338'
    scoring_system: epss
    scoring_elements: '0.99950'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-x3cq-8f32-5f63
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/apache/rocketmq
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/rocketmq
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/rocketmq
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/rocketmq
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/rocketmq/commit/9d411cf04a695e7a3f41036e8377b0aa544d754d
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/rocketmq/commit/9d411cf04a695e7a3f41036e8377b0aa544d754d
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/rocketmq/commit/c3ada731405c5990c36bf58d50b3e61965300703
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/rocketmq/commit/c3ada731405c5990c36bf58d50b3e61965300703
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp
  - score: Act
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:Y/T:T/P:M/B:A/M:M/D:C/2025-01-29T20:30:17Z/
    published_at: None
    url: https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-33246
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-33246
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-33246
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.vicarius.io/vsociety/posts/rocketmq-rce-cve-2023-33246-33247
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.vicarius.io/vsociety/posts/rocketmq-rce-cve-2023-33246-33247
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/07/12/1
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/07/12/1
  - score: Act
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:Y/T:T/P:M/B:A/M:M/D:C/2025-01-29T20:30:17Z/
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/07/12/1
weaknesses:
  - CWE-94
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: http://packetstormsecurity.com/files/173339/Apache-RocketMQ-5.1.0-Arbitrary-Code-Injection.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-33246.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-33246
    reference_type:
    reference_id:
  - url: https://github.com/apache/rocketmq
    reference_type:
    reference_id:
  - url: https://github.com/apache/rocketmq/commit/9d411cf04a695e7a3f41036e8377b0aa544d754d
    reference_type:
    reference_id:
  - url: https://github.com/apache/rocketmq/commit/c3ada731405c5990c36bf58d50b3e61965300703
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/1s8j2c8kogthtpv3060yddk03zq0pxyp
    reference_type:
    reference_id:
  - url: https://www.vicarius.io/vsociety/posts/rocketmq-rce-cve-2023-33246-33247
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/07/12/1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2317265
    reference_type:
    reference_id: 2317265
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:rocketmq:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:rocketmq:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-33246
    reference_type:
    reference_id: CVE-2023-33246
  - url: https://github.com/jakabakos/CVE-2023-33246_Apache_RocketMQ_RCE
    reference_type:
    reference_id: CVE-2023-33246_APACHE_ROCKETMQ_RCE
  - url: https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT
    reference_type:
    reference_id: CVE-2023-33246_ROCKETMQ_RCE_EXPLOIT
  - url: https://github.com/advisories/GHSA-x3cq-8f32-5f63
    reference_type:
    reference_id: GHSA-x3cq-8f32-5f63
