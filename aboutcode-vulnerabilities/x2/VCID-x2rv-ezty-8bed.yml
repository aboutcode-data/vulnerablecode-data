vulnerability_id: VCID-x2rv-ezty-8bed
aliases:
  - CVE-2022-50171
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  crypto: hisilicon/sec - don't sleep when in softirq

  When kunpeng920 encryption driver is used to deencrypt and decrypt
  packets during the softirq, it is not allowed to use mutex lock. The
  kernel will report the following error:

  BUG: scheduling while atomic: swapper/57/0/0x00000300
  Call trace:
  dump_backtrace+0x0/0x1e4
  show_stack+0x20/0x2c
  dump_stack+0xd8/0x140
  __schedule_bug+0x68/0x80
  __schedule+0x728/0x840
  schedule+0x50/0xe0
  schedule_preempt_disabled+0x18/0x24
  __mutex_lock.constprop.0+0x594/0x5dc
  __mutex_lock_slowpath+0x1c/0x30
  mutex_lock+0x50/0x60
  sec_request_init+0x8c/0x1a0 [hisi_sec2]
  sec_process+0x28/0x1ac [hisi_sec2]
  sec_skcipher_crypto+0xf4/0x1d4 [hisi_sec2]
  sec_skcipher_encrypt+0x1c/0x30 [hisi_sec2]
  crypto_skcipher_encrypt+0x2c/0x40
  crypto_authenc_encrypt+0xc8/0xfc [authenc]
  crypto_aead_encrypt+0x2c/0x40
  echainiv_encrypt+0x144/0x1a0 [echainiv]
  crypto_aead_encrypt+0x2c/0x40
  esp_output_tail+0x348/0x5c0 [esp4]
  esp_output+0x120/0x19c [esp4]
  xfrm_output_one+0x25c/0x4d4
  xfrm_output_resume+0x6c/0x1fc
  xfrm_output+0xac/0x3c0
  xfrm4_output+0x64/0x130
  ip_build_and_send_pkt+0x158/0x20c
  tcp_v4_send_synack+0xdc/0x1f0
  tcp_conn_request+0x7d0/0x994
  tcp_v4_conn_request+0x58/0x6c
  tcp_v6_conn_request+0xf0/0x100
  tcp_rcv_state_process+0x1cc/0xd60
  tcp_v4_do_rcv+0x10c/0x250
  tcp_v4_rcv+0xfc4/0x10a4
  ip_protocol_deliver_rcu+0xf4/0x200
  ip_local_deliver_finish+0x58/0x70
  ip_local_deliver+0x68/0x120
  ip_sublist_rcv_finish+0x70/0x94
  ip_list_rcv_finish.constprop.0+0x17c/0x1d0
  ip_sublist_rcv+0x40/0xb0
  ip_list_rcv+0x140/0x1dc
  __netif_receive_skb_list_core+0x154/0x28c
  __netif_receive_skb_list+0x120/0x1a0
  netif_receive_skb_list_internal+0xe4/0x1f0
  napi_complete_done+0x70/0x1f0
  gro_cell_poll+0x9c/0xb0
  napi_poll+0xcc/0x264
  net_rx_action+0xd4/0x21c
  __do_softirq+0x130/0x358
  irq_exit+0x11c/0x13c
  __handle_domain_irq+0x88/0xf0
  gic_handle_irq+0x78/0x2c0
  el1_irq+0xb8/0x140
  arch_cpu_idle+0x18/0x40
  default_idle_call+0x5c/0x1c0
  cpuidle_idle_call+0x174/0x1b0
  do_idle+0xc8/0x160
  cpu_startup_entry+0x30/0x11c
  secondary_start_kernel+0x158/0x1e4
  softirq: huh, entered softirq 3 NET_RX 0000000093774ee4 with
  preempt_count 00000100, exited with fffffe00?
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50171.json
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00812'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00808'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.0093'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00943'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01509'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0151'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01524'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01488'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01483'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0153'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01603'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01534'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01512'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02206'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02227'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02239'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0223'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0224'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02237'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.023'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02267'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02274'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02363'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02362'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02386'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02297'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02299'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02309'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02359'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02348'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02338'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02353'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01813'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01821'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01822'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01839'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01847'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0183'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0185'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01881'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02242'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02224'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0222'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02208'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02198'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03868'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0386'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03875'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03856'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03852'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0385'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03869'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.04001'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03972'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03874'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50171.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50171
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-50171
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/02884a4f12de11f54d4ca67a07dd1f111d96fdbd
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/16e18a8ac7c9748cf35a8d2f0ba2c6e8850e7568
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4a461ba5b9753352f438824fdd915cba675b1733
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa495dfe71229b9034b59d8072ff0b2325ddd5ee
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c9be45e4c69fde36522274f04d1aa0d097ae3958
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2373579
    reference_type:
    reference_id: 2373579
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-50171
    reference_type:
    reference_id: CVE-2022-50171
