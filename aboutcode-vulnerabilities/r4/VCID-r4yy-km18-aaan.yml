vulnerability_id: VCID-r4yy-km18-aaan
aliases:
  - CVE-2023-52699
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  sysv: don't call sb_bread() with pointers_lock held

  syzbot is reporting sleep in atomic context in SysV filesystem [1], for
  sb_bread() is called with rw_spinlock held.

  A "write_lock(&pointers_lock) => read_lock(&pointers_lock) deadlock" bug
  and a "sb_bread() with write_lock(&pointers_lock)" bug were introduced by
  "Replace BKL for chain locking with sysvfs-private rwlock" in Linux 2.5.12.

  Then, "[PATCH] err1-40: sysvfs locking fix" in Linux 2.6.8 fixed the
  former bug by moving pointers_lock lock to the callers, but instead
  introduced a "sb_bread() with read_lock(&pointers_lock)" bug (which made
  this problem easier to hit).

  Al Viro suggested that why not to do like get_branch()/get_block()/
  find_shared() in Minix filesystem does. And doing like that is almost a
  revert of "[PATCH] err1-40: sysvfs locking fix" except that get_branch()
   from with find_shared() is called without write_lock(&pointers_lock).
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52699.json
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14083'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14371'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15080'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14767'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14726'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14714'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15128'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15033'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14976'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14691'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14611'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14556'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14541'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14548'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14461'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14482'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52772'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.527'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52745'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52802'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52831'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52836'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52754'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52771'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52777'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52787'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52793'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52818'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52805'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.52794'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01438'
    scoring_system: epss
    scoring_elements: '0.78919'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01438'
    scoring_system: epss
    scoring_elements: '0.79004'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01438'
    scoring_system: epss
    scoring_elements: '0.78986'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01438'
    scoring_system: epss
    scoring_elements: '0.78928'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01438'
    scoring_system: epss
    scoring_elements: '0.7898'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01783'
    scoring_system: epss
    scoring_elements: '0.81173'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01783'
    scoring_system: epss
    scoring_elements: '0.8118'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01783'
    scoring_system: epss
    scoring_elements: '0.8119'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01783'
    scoring_system: epss
    scoring_elements: '0.81183'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01783'
    scoring_system: epss
    scoring_elements: '0.81182'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01783'
    scoring_system: epss
    scoring_elements: '0.81153'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01783'
    scoring_system: epss
    scoring_elements: '0.81148'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01783'
    scoring_system: epss
    scoring_elements: '0.81151'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.01783'
    scoring_system: epss
    scoring_elements: '0.81167'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '0.02308'
    scoring_system: epss
    scoring_elements: '0.74565'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://git.kernel.org/stable/c/13b33feb2ebddc2b1aa607f553566b18a4af1d76
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T15:05:59Z/
    published_at: None
    url: https://git.kernel.org/stable/c/13b33feb2ebddc2b1aa607f553566b18a4af1d76
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://git.kernel.org/stable/c/1b4fe801b5bedec2b622ddb18e5c9bf26c63d79f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T15:05:59Z/
    published_at: None
    url: https://git.kernel.org/stable/c/1b4fe801b5bedec2b622ddb18e5c9bf26c63d79f
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://git.kernel.org/stable/c/53cb1e52c9db618c08335984d1ca80db220ccf09
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T15:05:59Z/
    published_at: None
    url: https://git.kernel.org/stable/c/53cb1e52c9db618c08335984d1ca80db220ccf09
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://git.kernel.org/stable/c/674c1c4229e743070e09db63a23442950ff000d1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T15:05:59Z/
    published_at: None
    url: https://git.kernel.org/stable/c/674c1c4229e743070e09db63a23442950ff000d1
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://git.kernel.org/stable/c/89e8524135a3902e7563a5a59b7b5ec1bf4904ac
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T15:05:59Z/
    published_at: None
    url: https://git.kernel.org/stable/c/89e8524135a3902e7563a5a59b7b5ec1bf4904ac
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://git.kernel.org/stable/c/a69224223746ab96d43e5db9d22d136827b7e2d3
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T15:05:59Z/
    published_at: None
    url: https://git.kernel.org/stable/c/a69224223746ab96d43e5db9d22d136827b7e2d3
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://git.kernel.org/stable/c/f123dc86388cb669c3d6322702dc441abc35c31e
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T15:05:59Z/
    published_at: None
    url: https://git.kernel.org/stable/c/f123dc86388cb669c3d6322702dc441abc35c31e
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://git.kernel.org/stable/c/fd203d2c671bdee9ab77090ff394d3b71b627927
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-21T15:05:59Z/
    published_at: None
    url: https://git.kernel.org/stable/c/fd203d2c671bdee9ab77090ff394d3b71b627927
weaknesses:
  - CWE-667
  - CWE-833
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52699.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52699
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52699
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/13b33feb2ebddc2b1aa607f553566b18a4af1d76
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1b4fe801b5bedec2b622ddb18e5c9bf26c63d79f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/53cb1e52c9db618c08335984d1ca80db220ccf09
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/674c1c4229e743070e09db63a23442950ff000d1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/89e8524135a3902e7563a5a59b7b5ec1bf4904ac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a69224223746ab96d43e5db9d22d136827b7e2d3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f123dc86388cb669c3d6322702dc441abc35c31e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd203d2c671bdee9ab77090ff394d3b71b627927
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2281512
    reference_type:
    reference_id: 2281512
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52699
    reference_type:
    reference_id: CVE-2023-52699
  - url: https://usn.ubuntu.com/6893-1/
    reference_type:
    reference_id: USN-6893-1
  - url: https://usn.ubuntu.com/6893-2/
    reference_type:
    reference_id: USN-6893-2
  - url: https://usn.ubuntu.com/6893-3/
    reference_type:
    reference_id: USN-6893-3
  - url: https://usn.ubuntu.com/6896-1/
    reference_type:
    reference_id: USN-6896-1
  - url: https://usn.ubuntu.com/6896-2/
    reference_type:
    reference_id: USN-6896-2
  - url: https://usn.ubuntu.com/6896-3/
    reference_type:
    reference_id: USN-6896-3
  - url: https://usn.ubuntu.com/6896-4/
    reference_type:
    reference_id: USN-6896-4
  - url: https://usn.ubuntu.com/6896-5/
    reference_type:
    reference_id: USN-6896-5
  - url: https://usn.ubuntu.com/6898-1/
    reference_type:
    reference_id: USN-6898-1
  - url: https://usn.ubuntu.com/6898-2/
    reference_type:
    reference_id: USN-6898-2
  - url: https://usn.ubuntu.com/6898-3/
    reference_type:
    reference_id: USN-6898-3
  - url: https://usn.ubuntu.com/6898-4/
    reference_type:
    reference_id: USN-6898-4
  - url: https://usn.ubuntu.com/6917-1/
    reference_type:
    reference_id: USN-6917-1
  - url: https://usn.ubuntu.com/6918-1/
    reference_type:
    reference_id: USN-6918-1
  - url: https://usn.ubuntu.com/6919-1/
    reference_type:
    reference_id: USN-6919-1
  - url: https://usn.ubuntu.com/6927-1/
    reference_type:
    reference_id: USN-6927-1
  - url: https://usn.ubuntu.com/7019-1/
    reference_type:
    reference_id: USN-7019-1
