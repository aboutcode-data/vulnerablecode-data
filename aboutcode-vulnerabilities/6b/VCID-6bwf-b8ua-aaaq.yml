vulnerability_id: VCID-6bwf-b8ua-aaaq
aliases:
  - CVE-2023-35169
  - GHSA-47p7-xfcc-4pv9
summary: |
  PHP-IMAP is a wrapper for common IMAP communication without the need to have the php-imap module installed / enabled. Prior to version 5.3.0, an unsanitized attachment filename allows any unauthenticated user to leverage a directory traversal vulnerability, which results in a remote code execution vulnerability. Every application that stores attachments with `Attachment::save()` without providing a `$filename` or passing unsanitized user input is affected by this attack.

  An attacker can send an email with a malicious attachment to the inbox, which gets crawled with `webklex/php-imap` or `webklex/laravel-imap`. Prerequisite for the vulnerability is that the script stores the attachments without providing a `$filename`, or providing an unsanitized `$filename`, in `src/Attachment::save(string $path, string $filename = null)`. In this case, where no `$filename` gets passed into the `Attachment::save()` method, the package would use a series of unsanitized and insecure input values from the mail as fallback. Even if a developer passes a `$filename` into the `Attachment::save()` method, e.g. by passing the name or filename of the mail attachment itself (from email headers), the input values never get sanitized by the package. There is also no restriction about the file extension (e.g. ".php") or the contents of a file. This allows an attacker to upload malicious code of any type and content at any location where the underlying user has write permissions. The attacker can also overwrite existing files and inject malicious code into files that, e.g. get executed by the system via cron or requests.

  Version 5.3.0 contains a patch for this issue.
severities:
  - score: '0.01243'
    scoring_system: epss
    scoring_elements: '0.85914'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01243'
    scoring_system: epss
    scoring_elements: '0.86072'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01243'
    scoring_system: epss
    scoring_elements: '0.86063'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01243'
    scoring_system: epss
    scoring_elements: '0.86062'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01243'
    scoring_system: epss
    scoring_elements: '0.86035'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01243'
    scoring_system: epss
    scoring_elements: '0.86031'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01243'
    scoring_system: epss
    scoring_elements: '0.86012'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01294'
    scoring_system: epss
    scoring_elements: '0.86435'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01294'
    scoring_system: epss
    scoring_elements: '0.86412'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01294'
    scoring_system: epss
    scoring_elements: '0.86403'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.01294'
    scoring_system: epss
    scoring_elements: '0.86369'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.02183'
    scoring_system: epss
    scoring_elements: '0.89039'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.02183'
    scoring_system: epss
    scoring_elements: '0.89040'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.02183'
    scoring_system: epss
    scoring_elements: '0.89048'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.02404'
    scoring_system: epss
    scoring_elements: '0.89654'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88771'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88781'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88786'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88778'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88774'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88766'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88765'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88763'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88761'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88755'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88743'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.04725'
    scoring_system: epss
    scoring_elements: '0.88757'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88801'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88757'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.8881'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88812'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88809'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88802'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88794'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88789'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88799'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88784'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88774'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.8878'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.05026'
    scoring_system: epss
    scoring_elements: '0.88746'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: '0.15665'
    scoring_system: epss
    scoring_elements: '0.91208'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-47p7-xfcc-4pv9
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Webklex/php-imap
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L251-L255
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L251-L255
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L251-L255
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-11-27T20:22:04Z/
    published_at: None
    url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L251-L255
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L252
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L252
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L252
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-11-27T20:22:04Z/
    published_at: None
    url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L252
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/pull/414
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/pull/414
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Webklex/php-imap/pull/414
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-11-27T20:22:04Z/
    published_at: None
    url: https://github.com/Webklex/php-imap/pull/414
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/releases/tag/5.3.0
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/releases/tag/5.3.0
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Webklex/php-imap/releases/tag/5.3.0
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-11-27T20:22:04Z/
    published_at: None
    url: https://github.com/Webklex/php-imap/releases/tag/5.3.0
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/security/advisories/GHSA-47p7-xfcc-4pv9
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Webklex/php-imap/security/advisories/GHSA-47p7-xfcc-4pv9
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Webklex/php-imap/security/advisories/GHSA-47p7-xfcc-4pv9
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2024-11-27T20:22:04Z/
    published_at: None
    url: https://github.com/Webklex/php-imap/security/advisories/GHSA-47p7-xfcc-4pv9
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-35169
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-35169
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-35169
    reference_type:
    reference_id:
  - url: https://github.com/Webklex/php-imap
    reference_type:
    reference_id:
  - url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L251-L255
    reference_type:
    reference_id:
  - url: https://github.com/Webklex/php-imap/blob/5.2.0/src/Attachment.php#L252
    reference_type:
    reference_id:
  - url: https://github.com/Webklex/php-imap/pull/414
    reference_type:
    reference_id:
  - url: https://github.com/Webklex/php-imap/releases/tag/5.3.0
    reference_type:
    reference_id:
  - url: https://github.com/Webklex/php-imap/security/advisories/GHSA-47p7-xfcc-4pv9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:webklex:php-imap:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:webklex:php-imap:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-35169
    reference_type:
    reference_id: CVE-2023-35169
  - url: https://github.com/advisories/GHSA-47p7-xfcc-4pv9
    reference_type:
    reference_id: GHSA-47p7-xfcc-4pv9
