vulnerability_id: VCID-bx37-hde8-aaap
aliases:
  - CVE-2023-39532
  - GHSA-9c4h-3f7h-322r
summary: |
  SES is a JavaScript environment that allows safe execution of arbitrary programs in Compartments. In version 0.18.0 prior to 0.18.7, 0.17.0 prior to 0.17.1, 0.16.0 prior to 0.16.1, 0.15.0 prior to 0.15.24, 0.14.0 prior to 0.14.5, an 0.13.0 prior to 0.13.5, there is a hole in the confinement of guest applications under SES that may manifest as either the ability to exfiltrate information or execute arbitrary code depending on the configuration and implementation of the surrounding host.

  Guest program running inside a Compartment with as few as no endowments can gain access to the surrounding host’s dynamic import by using dynamic import after the spread operator, like `{...import(arbitraryModuleSpecifier)}`.

  On the web or in web extensions, a Content-Security-Policy following ordinary best practices likely mitigates both the risk of exfiltration and execution of arbitrary code, at least limiting the modules that the attacker can import to those that are already part of the application. However, without a Content-Security-Policy, dynamic import can be used to issue HTTP requests for either communication through the URL or for the execution of code reachable from that origin.

  Within an XS worker, an attacker can use the host’s module system to the extent that the host has been configured. This typically only allows access to module code on the host’s file system and is of limited use to an attacker.

  Within Node.js, the attacker gains access to Node.js’s module system. Importing the powerful builtins is not useful except insofar as there are side-effects and tempered because dynamic import returns a promise. Spreading a promise into an object renders the promises useless. However, Node.js allows importing data URLs, so this is a clear path to arbitrary execution.

  Versions 0.18.7, 0.17.1, 0.16.1, 0.15.24, 0.14.5, and 0.13.5 contain a patch for this issue. Some workarounds are available. On the web, providing a suitably constrained Content-Security-Policy mitigates most of the threat. With XS, building a binary that lacks the ability to load modules at runtime mitigates the entirety of the threat. That will look like an implementation of `fxFindModule` in a file like `xsPlatform.c` that calls `fxRejectModuleFile`.
severities:
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69554'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69636'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69668'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69533'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69309'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69541'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69555'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69621'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69431'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69473'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69488'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.69534'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00317'
    scoring_system: epss
    scoring_elements: '0.69991'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00317'
    scoring_system: epss
    scoring_elements: '0.70009'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00317'
    scoring_system: epss
    scoring_elements: '0.70004'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.00317'
    scoring_system: epss
    scoring_elements: '0.70181'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01125'
    scoring_system: epss
    scoring_elements: '0.76433'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79052'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79034'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79045'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79042'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79051'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79004'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79026'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79064'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79041'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79059'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.7905'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.01355'
    scoring_system: epss
    scoring_elements: '0.79044'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82898'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82828'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82822'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82876'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82878'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82895'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82901'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82905'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82916'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.8293'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82938'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82931'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82936'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02173'
    scoring_system: epss
    scoring_elements: '0.82927'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: '0.02484'
    scoring_system: epss
    scoring_elements: '0.7547'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-9c4h-3f7h-322r
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/endojs/endo
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/endojs/endo
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/endojs/endo/commit/fc90c6429604dc79ce8e3355e236ccce2bada041
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/endojs/endo/commit/fc90c6429604dc79ce8e3355e236ccce2bada041
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/endojs/endo/security/advisories/GHSA-9c4h-3f7h-322r
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/endojs/endo/security/advisories/GHSA-9c4h-3f7h-322r
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-39532
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-39532
weaknesses:
  - CWE-20
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-39532
    reference_type:
    reference_id:
  - url: https://github.com/endojs/endo
    reference_type:
    reference_id:
  - url: https://github.com/endojs/endo/commit/fc90c6429604dc79ce8e3355e236ccce2bada041
    reference_type:
    reference_id:
  - url: https://github.com/endojs/endo/security/advisories/GHSA-9c4h-3f7h-322r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:agoric:ses:0.16.0:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:agoric:ses:0.16.0:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:agoric:ses:0.17.0:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:agoric:ses:0.17.0:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:agoric:ses:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:agoric:ses:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-39532
    reference_type:
    reference_id: CVE-2023-39532
  - url: https://github.com/advisories/GHSA-9c4h-3f7h-322r
    reference_type:
    reference_id: GHSA-9c4h-3f7h-322r
