vulnerability_id: VCID-c5sj-vjtc-9kbu
aliases:
  - GHSA-5pm7-cp8f-p2c2
summary: |
  wallabag/wallabag Has Multiple Cross-Site Request Forgery (CSRF) Vulnerabilities
  ## Impact

  wallabag versions prior to 2.6.11 were discovered to contain multiple Cross-Site Request Forgery (CSRF) vulnerabilities across several endpoints. An attacker could craft a malicious link or page that, if visited by a logged-in wallabag user, could trick the user's browser into performing unintended actions within their wallabag account without their consent. Additionally, one endpoint affects the login page locale setting.

  The affected endpoints allow attackers to potentially perform actions such as:

  * **Manage API Tokens:**
      * `/generate-token`
      * `/revoke-token`
  * **Manage User Rules:**
      * `/tagging-rule/delete/{taggingRule}`
      * `/ignore-origin-user-rule/delete/{ignoreOriginUserRule}`
  * **Modify User Configuration:**
      * `/config/view-mode`
  * **Manage Individual Entries:**
      * `/reload/{id}`
      * `/archive/{id}`
      * `/star/{id}`
      * `/delete/{id}`
      * `/share/{id}`
      * `/share/delete/{id}`
  * **Manage Tags:**
      * `/remove-tag/{entry}/{tag}`
      * `/tag/search/{filter}`
      * `/tag/delete/{slug}`
  * **Perform Bulk Actions:**
      * `/mass`
  * **Change Interface Language (Login Page):**
      * `/locale/{language}`

  Successfully exploiting these vulnerabilities could lead to unauthorized modification or deletion of user data, configuration changes, token manipulation, or interface changes, depending on the specific endpoint targeted.

  This set of vulnerabilities has an aggregated CVSS v3.1 score of 4.3 (Medium).

  **Users are strongly advised to upgrade their wallabag instance to version 2.6.11 or later to mitigate these vulnerabilities.**

  ## Resolution

  These vulnerabilities have been addressed in wallabag version **2.6.11**. The affected endpoints have been modified to require the HTTP POST method along with a valid CSRF token for state-changing actions, preventing attackers from forcing users' browsers to perform these actions unintentionally.

  ## Credits

  Found, reported and fixed by @yguedidi
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5pm7-cp8f-p2c2
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/00d0e6f951927434039465b4d3ae3dd661911172
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/00d0e6f951927434039465b4d3ae3dd661911172
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/0d8429dfc77b84f50060b253fd84f1c09b892226
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/0d8429dfc77b84f50060b253fd84f1c09b892226
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/264f91126e2c42188b80848c881264da743b4dc1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/264f91126e2c42188b80848c881264da743b4dc1
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/27f0d94db72fb2a54b5965e4e9908a0f418f44b5
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/27f0d94db72fb2a54b5965e4e9908a0f418f44b5
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/3817010e29ed368df271cdd11ec71a46a341c673
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/3817010e29ed368df271cdd11ec71a46a341c673
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/5ea5115a721651f2af349e8451be8947dad9c814
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/5ea5115a721651f2af349e8451be8947dad9c814
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/677b2986bc78df4c7ecfed87a24593fa0553fd3c
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/677b2986bc78df4c7ecfed87a24593fa0553fd3c
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/6fa61c0f9c48d37625c92a8913b487230761fb47
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/6fa61c0f9c48d37625c92a8913b487230761fb47
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/99c8a06594d6ee7480ce4d041ccff3025b353656
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/99c8a06594d6ee7480ce4d041ccff3025b353656
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/ac5b5fb379233d6e96ea14ae21b7f88761d5fa3f
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/ac5b5fb379233d6e96ea14ae21b7f88761d5fa3f
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/cf49be694089667bbab9f10d52862fbdba9a89de
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/cf49be694089667bbab9f10d52862fbdba9a89de
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/d1e128900acc0cb8c88eb7a085c9ef5420cf0c43
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/d1e128900acc0cb8c88eb7a085c9ef5420cf0c43
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/d703fa6a3a75f7c3b433e8caf618bfb0a9a0ba63
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/d703fa6a3a75f7c3b433e8caf618bfb0a9a0ba63
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/ddf2e808422e41ea55cebf2aa12eb1823c5c340a
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/ddf2e808422e41ea55cebf2aa12eb1823c5c340a
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/e162408139ac9bb12e69f4d49de45ade49369c21
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/e162408139ac9bb12e69f4d49de45ade49369c21
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/eb8408b22fbaa6b3d78047d6203b23b7f52bbf03
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/eb8408b22fbaa6b3d78047d6203b23b7f52bbf03
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/ed1acf59e166a2a6bb81c52baaeabd6196feae98
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/ed1acf59e166a2a6bb81c52baaeabd6196feae98
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/edffef837598355c9bec433c469f1e04c35b27cb
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/commit/edffef837598355c9bec433c469f1e04c35b27cb
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/wallabag/wallabag/security/advisories/GHSA-5pm7-cp8f-p2c2
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/security/advisories/GHSA-5pm7-cp8f-p2c2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wallabag/wallabag/security/advisories/GHSA-5pm7-cp8f-p2c2
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-352
references:
  - url: https://github.com/wallabag/wallabag
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/00d0e6f951927434039465b4d3ae3dd661911172
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/0d8429dfc77b84f50060b253fd84f1c09b892226
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/264f91126e2c42188b80848c881264da743b4dc1
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/27f0d94db72fb2a54b5965e4e9908a0f418f44b5
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/3817010e29ed368df271cdd11ec71a46a341c673
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/5ea5115a721651f2af349e8451be8947dad9c814
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/677b2986bc78df4c7ecfed87a24593fa0553fd3c
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/6fa61c0f9c48d37625c92a8913b487230761fb47
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/99c8a06594d6ee7480ce4d041ccff3025b353656
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/ac5b5fb379233d6e96ea14ae21b7f88761d5fa3f
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/cf49be694089667bbab9f10d52862fbdba9a89de
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/d1e128900acc0cb8c88eb7a085c9ef5420cf0c43
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/d703fa6a3a75f7c3b433e8caf618bfb0a9a0ba63
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/ddf2e808422e41ea55cebf2aa12eb1823c5c340a
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/e162408139ac9bb12e69f4d49de45ade49369c21
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/eb8408b22fbaa6b3d78047d6203b23b7f52bbf03
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/ed1acf59e166a2a6bb81c52baaeabd6196feae98
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/commit/edffef837598355c9bec433c469f1e04c35b27cb
    reference_type:
    reference_id:
  - url: https://github.com/wallabag/wallabag/security/advisories/GHSA-5pm7-cp8f-p2c2
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5pm7-cp8f-p2c2
    reference_type:
    reference_id: GHSA-5pm7-cp8f-p2c2
