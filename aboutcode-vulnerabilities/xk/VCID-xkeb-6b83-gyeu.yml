vulnerability_id: VCID-xkeb-6b83-gyeu
aliases:
  - CVE-2023-53235
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drm/tests: helpers:
  Avoid a driver uaf  when using __drm_kunit_helper_alloc_drm_device() the driver may be dereferenced
  by device-managed resources up until the device is freed, which is typically later than the
  kunit-managed resource code frees it. Fix this by simply make the driver device-managed as
  well.  In short, the sequence leading to the UAF is as follows:  INIT: Code allocates a struct
  device as a kunit-managed resource. Code allocates a drm driver as a kunit-managed resource.
  Code allocates a drm device as a device-managed resource.  EXIT: Kunit resource cleanup frees
  the drm driver Kunit resource cleanup puts the struct device, which starts a       device-managed
  resource cleanup device-managed cleanup calls drm_dev_put() drm_dev_put() dereferences the
  (now freed) drm driver -> Boom.  Related KASAN message: [55272.551542] ==================================================================
  [55272.551551] BUG: KASAN: slab-use-after-free in drm_dev_put.part.0+0xd4/0xe0 [drm] [55272.551603]
  Read of size 8 at addr ffff888127502828 by task kunit_try_catch/10353  [55272.551612] CPU:
  4 PID: 10353 Comm: kunit_try_catch Tainted: G     U           N 6.5.0-rc7+ #155 [55272.551620]
  Hardware name: ASUS System Product Name/PRIME B560M-A AC, BIOS 0403 01/26/2021 [55272.551626]
  Call Trace: [55272.551629]  <TASK> [55272.551633]  dump_stack_lvl+0x57/0x90 [55272.551639]  print_report+0xcf/0x630
  [55272.551645]  ? _raw_spin_lock_irqsave+0x5f/0x70 [55272.551652]  ? drm_dev_put.part.0+0xd4/0xe0
  [drm] [55272.551694]  kasan_report+0xd7/0x110 [55272.551699]  ? drm_dev_put.part.0+0xd4/0xe0
  [drm] [55272.551742]  drm_dev_put.part.0+0xd4/0xe0 [drm] [55272.551783]  devres_release_all+0x15d/0x1f0
  [55272.551790]  ? __pfx_devres_release_all+0x10/0x10 [55272.551797]  device_unbind_cleanup+0x16/0x1a0
  [55272.551802]  device_release_driver_internal+0x3e5/0x540 [55272.551808]  ? kobject_put+0x5d/0x4b0
  [55272.551814]  bus_remove_device+0x1f1/0x3f0 [55272.551819]  device_del+0x342/0x910 [55272.551826]  ?
  __pfx_device_del+0x10/0x10 [55272.551830]  ? lock_release+0x339/0x5e0 [55272.551836]  ? kunit_remove_resource+0x128/0x290
  [kunit] [55272.551845]  ? __pfx_lock_release+0x10/0x10 [55272.551851]  platform_device_del.part.0+0x1f/0x1e0
  [55272.551856]  ? _raw_spin_unlock_irqrestore+0x30/0x60 [55272.551863]  kunit_remove_resource+0x195/0x290
  [kunit] [55272.551871]  ? _raw_spin_unlock_irqrestore+0x30/0x60 [55272.551877]  kunit_cleanup+0x78/0x120
  [kunit] [55272.551885]  ? __kthread_parkme+0xc1/0x1f0 [55272.551891]  ? __pfx_kunit_try_run_case_cleanup+0x10/0x10
  [kunit] [55272.551900]  ? __pfx_kunit_generic_run_threadfn_adapter+0x10/0x10 [kunit] [55272.551909]  kunit_generic_run_threadfn_adapter+0x4a/0x90
  [kunit] [55272.551919]  kthread+0x2e7/0x3c0 [55272.551924]  ? __pfx_kthread+0x10/0x10 [55272.551929]  ret_from_fork+0x2d/0x70
  [55272.551935]  ? __pfx_kthread+0x10/0x10 [55272.551940]  ret_from_fork_asm+0x1b/0x30 [55272.551948]  </TASK>  [55272.551953]
  Allocated by task 10351: [55272.551956]  kasan_save_stack+0x1c/0x40 [55272.551962]  kasan_set_track+0x21/0x30
  [55272.551966]  __kasan_kmalloc+0x8b/0x90 [55272.551970]  __kmalloc+0x5e/0x160 [55272.551976]  kunit_kmalloc_array+0x1c/0x50
  [kunit] [55272.551984]  drm_exec_test_init+0xfa/0x2c0 [drm_exec_test] [55272.551991]  kunit_try_run_case+0xdd/0x250
  [kunit] [55272.551999]  kunit_generic_run_threadfn_adapter+0x4a/0x90 [kunit] [55272.552008]  kthread+0x2e7/0x3c0
  [55272.552012]  ret_from_fork+0x2d/0x70 [55272.552017]  ret_from_fork_asm+0x1b/0x30  [55272.552024]
  Freed by task 10353: [55272.552027]  kasan_save_stack+0x1c/0x40 [55272.552032]  kasan_set_track+0x21/0x30
  [55272.552036]  kasan_save_free_info+0x27/0x40 [55272.552041]  __kasan_slab_free+0x106/0x180
  [55272.552046]  slab_free_freelist_hook+0xb3/0x160 [55272.552051]  __kmem_cache_free+0xb2/0x290
  [55272.552056]  kunit_remove_resource+0x195/0x290 [kunit] [55272.552064]  kunit_cleanup+0x7
  ---truncated---'
severities:
  - score: '6.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53235.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53235.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03233'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03261'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03304'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04336'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04347'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05268'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05271'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05307'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05221'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05228'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05277'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05283'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05297'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05206'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04968'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04977'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04965'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05098'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05107'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05978'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05958'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05946'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05952'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05934'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0593'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05912'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0604'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06016'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05996'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53235.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53235
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2395384
    reference_type:
    reference_id: 2395384
  - url: https://access.redhat.com/errata/RHSA-2024:2394
    reference_type:
    reference_id: RHSA-2024:2394
