vulnerability_id: VCID-154y-gahf-6kh8
aliases:
  - CVE-2025-66578
  - GHSA-c4cc-x928-vjw9
summary: |
  robrichards/xmlseclibs has an Libxml2 Canonicalization error which can bypass Digest/Signature validation
  ### Summary
  An authentication bypass vulnerability exists due to a flaw in the libxml2 canonicalization process, which is used by [xmlseclibs](https://github.com/robrichards/xmlseclibs) during document transformation. This weakness allows an attacker to generate a valid signature once and reuse it indefinitely. In practice, a signature created during a previous interaction - or through a misconfigured authentication flow - can be replayed to bypass authentication checks.

  ### Details
  When libxml2â€™s canonicalization is invoked on an invalid XML input, it may return an empty string rather than a canonicalized node. [xmlseclibs](https://github.com/robrichards/xmlseclibs) then proceeds to compute the DigestValue over this empty string, treating it as if canonicalization succeeded.

  https://github.com/robrichards/xmlseclibs/blob/f4131320c6dcd460f1b0c67f16f8bf24ce4b5c3e/src/XMLSecurityDSig.php#L296

  ### Impact
  Digest bypass: By crafting input that causes canonicalization to yield an empty string, the attacker can manipulate validation to pass incorrectly.

  Signature replay on empty canonical form: If an empty string has been signed once (e.g., in a prior interaction or via a misconfigured flow), that signature can potentially be replayed to bypass authentication.

  ### Suggested remediation
  Treat canonicalization failures (exceptions or nil/empty outputs) as fatal and abort validation.
  Add explicit checks: reject when canonicalize returns nil/empty or raise
severities:
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.22641'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66578
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.24023'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66578
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-c4cc-x928-vjw9
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/robrichards/xmlseclibs
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/robrichards/xmlseclibs
  - score: 6
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/blob/f4131320c6dcd460f1b0c67f16f8bf24ce4b5c3e/src/XMLSecurityDSig.php#L296
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/blob/f4131320c6dcd460f1b0c67f16f8bf24ce4b5c3e/src/XMLSecurityDSig.php#L296
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/blob/f4131320c6dcd460f1b0c67f16f8bf24ce4b5c3e/src/XMLSecurityDSig.php#L296
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-09T15:24:31Z/
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/blob/f4131320c6dcd460f1b0c67f16f8bf24ce4b5c3e/src/XMLSecurityDSig.php#L296
  - score: 6
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/commit/69fd63080bc47a8d51bc101c30b7cb756862d1d6
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/commit/69fd63080bc47a8d51bc101c30b7cb756862d1d6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/commit/69fd63080bc47a8d51bc101c30b7cb756862d1d6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-09T15:24:31Z/
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/commit/69fd63080bc47a8d51bc101c30b7cb756862d1d6
  - score: 6
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/security/advisories/GHSA-c4cc-x928-vjw9
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/security/advisories/GHSA-c4cc-x928-vjw9
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/security/advisories/GHSA-c4cc-x928-vjw9
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/security/advisories/GHSA-c4cc-x928-vjw9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-09T15:24:31Z/
    published_at: None
    url: https://github.com/robrichards/xmlseclibs/security/advisories/GHSA-c4cc-x928-vjw9
  - score: '6.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66578
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66578
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-248
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-66578
    reference_type:
    reference_id:
  - url: https://github.com/robrichards/xmlseclibs
    reference_type:
    reference_id:
  - url: https://github.com/robrichards/xmlseclibs/blob/f4131320c6dcd460f1b0c67f16f8bf24ce4b5c3e/src/XMLSecurityDSig.php#L296
    reference_type:
    reference_id:
  - url: https://github.com/robrichards/xmlseclibs/commit/69fd63080bc47a8d51bc101c30b7cb756862d1d6
    reference_type:
    reference_id:
  - url: https://github.com/robrichards/xmlseclibs/security/advisories/GHSA-c4cc-x928-vjw9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66578
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-c4cc-x928-vjw9
    reference_type:
    reference_id: GHSA-c4cc-x928-vjw9
