vulnerability_id: VCID-s8aw-28q1-2ugf
aliases:
  - GHSA-qq4c-hm99-979m
summary: |
  IdMap from_iter may lead to uninitialized memory being freed on drop
  Due to a flaw in the constructor `id_map::IdMap::from_iter`, ill-formed objects may be created in which the amount of actually initialized memory is less than what is expected by the fields of `IdMap`. Specifically, the field `ids` is initialized based on the capacity of the vector `values`, which is constructed from the provided iterator. However, the length of this vector may be smaller than its capacity.

  In such cases, when the resulting `IdMap` is dropped, its destructor incorrectly assumes that `values` contains `ids.len() == values.capacity()` initialized elements and attempts to iterate over and drop them. This leads to dereferencing and attempting to free uninitialized memory, resulting in undefined behavior and potential segmentation faults.

  The bug was fixed in commit `fab6922`, and all unsafe code was removed from the crate.

  Note that the maintainer recommends using the following alternatives:
  - [slab](https://crates.io/crates/slab)
  - [slotmap](https://crates.io/crates/slotmap)
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-qq4c-hm99-979m
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/andrewhickman/id-map
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/andrewhickman/id-map/commit/fab6922b955b5a2986dfff2ccb341628faec30ed
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/andrewhickman/id-map/issues/4
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2025-0050.html
weaknesses:
  - CWE-665
references:
  - url: https://github.com/andrewhickman/id-map
    reference_type:
    reference_id:
  - url: https://github.com/andrewhickman/id-map/commit/fab6922b955b5a2986dfff2ccb341628faec30ed
    reference_type:
    reference_id:
  - url: https://github.com/andrewhickman/id-map/issues/4
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2025-0050.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-qq4c-hm99-979m
    reference_type:
    reference_id: GHSA-qq4c-hm99-979m
