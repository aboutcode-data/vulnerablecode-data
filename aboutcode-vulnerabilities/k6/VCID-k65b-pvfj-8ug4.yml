vulnerability_id: VCID-k65b-pvfj-8ug4
aliases:
  - CVE-2022-49741
summary: 'In the Linux kernel, the following vulnerability has been resolved:  fbdev: smscufx:
  fix error handling code in ufx_usb_probe  The current error handling code in ufx_usb_probe
  have many unmatching issues, e.g., missing ufx_free_usb_list, destroy_modedb label should
  only include framebuffer_release, fb_dealloc_cmap only matches fb_alloc_cmap.  My local syzkaller
  reports a memory leak bug:  memory leak in ufx_usb_probe  BUG: memory leak unreferenced object
  0xffff88802f879580 (size 128):   comm "kworker/0:7", pid 17416, jiffies 4295067474 (age 46.710s)   hex
  dump (first 32 bytes):     80 21 7c 2e 80 88 ff ff 18 d0 d0 0c 80 88 ff ff  .!|.............     00
  d0 d0 0c 80 88 ff ff e0 ff ff ff 0f 00 00 00  ................   backtrace:     [<ffffffff814c99a0>]
  kmalloc_trace+0x20/0x90 mm/slab_common.c:1045     [<ffffffff824d219c>] kmalloc include/linux/slab.h:553
  [inline]     [<ffffffff824d219c>] kzalloc include/linux/slab.h:689 [inline]     [<ffffffff824d219c>]
  ufx_alloc_urb_list drivers/video/fbdev/smscufx.c:1873 [inline]     [<ffffffff824d219c>] ufx_usb_probe+0x11c/0x15a0
  drivers/video/fbdev/smscufx.c:1655     [<ffffffff82d17927>] usb_probe_interface+0x177/0x370
  drivers/usb/core/driver.c:396     [<ffffffff82712f0d>] call_driver_probe drivers/base/dd.c:560
  [inline]     [<ffffffff82712f0d>] really_probe+0x12d/0x390 drivers/base/dd.c:639     [<ffffffff8271322f>]
  __driver_probe_device+0xbf/0x140 drivers/base/dd.c:778     [<ffffffff827132da>] driver_probe_device+0x2a/0x120
  drivers/base/dd.c:808     [<ffffffff82713c27>] __device_attach_driver+0xf7/0x150 drivers/base/dd.c:936     [<ffffffff82710137>]
  bus_for_each_drv+0xb7/0x100 drivers/base/bus.c:427     [<ffffffff827136b5>] __device_attach+0x105/0x2d0
  drivers/base/dd.c:1008     [<ffffffff82711d36>] bus_probe_device+0xc6/0xe0 drivers/base/bus.c:487     [<ffffffff8270e242>]
  device_add+0x642/0xdc0 drivers/base/core.c:3517     [<ffffffff82d14d5f>] usb_set_configuration+0x8ef/0xb80
  drivers/usb/core/message.c:2170     [<ffffffff82d2576c>] usb_generic_driver_probe+0x8c/0xc0
  drivers/usb/core/generic.c:238     [<ffffffff82d16ffc>] usb_probe_device+0x5c/0x140 drivers/usb/core/driver.c:293     [<ffffffff82712f0d>]
  call_driver_probe drivers/base/dd.c:560 [inline]     [<ffffffff82712f0d>] really_probe+0x12d/0x390
  drivers/base/dd.c:639     [<ffffffff8271322f>] __driver_probe_device+0xbf/0x140 drivers/base/dd.c:778  Fix
  this bug by rewriting the error handling code in ufx_usb_probe.'
severities:
  - score: '3.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49741.json
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49741.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01028'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01039'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01034'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01032'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01036'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01024'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01021'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01016'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01031'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01027'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01013'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01033'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01399'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02289'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02211'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.02095'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03557'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03491'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03482'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0348'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03484'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03493'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03494'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03495'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0351'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03543'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03552'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03547'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03537'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-49741
weaknesses:
  - CWE-772
  - CWE-401
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49741.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-49741
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-49741
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1b4c08844628dfc8d72d3f51b657f2a5e63b7b4b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3931014367ef31d26af65386a4ca496f50f0cfdf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3b3d3127f5b4291ae4caaf50f7b66089ad600480
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/64fa364ad3245508d393e16ed4886f92d7eb423c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b76449ee75e21acfe9fa4c653d8598f191ed7d68
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355503
    reference_type:
    reference_id: 2355503
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49741
    reference_type:
    reference_id: CVE-2022-49741
