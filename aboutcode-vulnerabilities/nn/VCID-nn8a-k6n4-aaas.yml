vulnerability_id: VCID-nn8a-k6n4-aaas
aliases:
  - CVE-2024-41800
  - GHSA-wmx7-pw49-88jx
summary: |
  Craft CMS Allows TOTP Token To Stay Valid After Use
  Craft CMS 5 allows reuse of TOTP tokens multiple times within the validity period.

  ### Impact

  An attacker is able to re-submit a valid TOTP token to establish an authenticated session. This requires that the attacker has knowledge of the victim's credentials.

  A TOTP token can be used multiple times to establish an authenticated session.
  [RFC 6238](https://www.rfc-editor.org/rfc/rfc6238) insists that an OTP must not be used more than once.

  > The verifier MUST NOT accept the second attempt of the OTP after the successful validation has been issued for the first OTP, which ensures one-time only use of an OTP.

  The OWASP Application Security Verification Standard v4.0.3 (ASVS) [reiterates
  this property with requirement 2.8.4](https://github.com/OWASP/ASVS/blob/v4.0.3/4.0/en/0x11-V2-Authentication.md#v28-one-time-verifier).

  > Verify that time-based OTP can be used only once within the validity period.

  It should also be noted that the validity period of an TOTP token is 2 minutes. This makes a successful brute force attack more likely, since the four tokens are valid at the same time.

  ### Patches

  This has been patched in Craft 5.2.3.

  References:

  https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV 2024061701_CraftCMS_TOTP_Valid_After_Use

  https://github.com/craftcms/cms/releases/tag/5.2.3
severities:
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15389'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15633'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15627'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.1555'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15456'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16072'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16054'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16053'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16061'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16081'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16083'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16092'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16105'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16097'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26241'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26264'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26326'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26305'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26316'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26317'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26365'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26590'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26657'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26745'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26352'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26331'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26307'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26698'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.25893'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.26163'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.34878'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.41961'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.42084'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.42099'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.42107'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.42124'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.42094'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.42071'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.42093'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00223'
    scoring_system: epss
    scoring_elements: '0.42108'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00259'
    scoring_system: epss
    scoring_elements: '0.46581'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00259'
    scoring_system: epss
    scoring_elements: '0.46598'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00259'
    scoring_system: epss
    scoring_elements: '0.46568'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00259'
    scoring_system: epss
    scoring_elements: '0.46559'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.00259'
    scoring_system: epss
    scoring_elements: '0.46541'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: '0.0033'
    scoring_system: epss
    scoring_elements: '0.39228'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-wmx7-pw49-88jx
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/craftcms/cms
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/craftcms/cms
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/craftcms/cms/commit/7c790fa5ad5a8cb8016cb6793ec3554c4c079e38
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/craftcms/cms/commit/7c790fa5ad5a8cb8016cb6793ec3554c4c079e38
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/craftcms/cms/releases/tag/5.2.3
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/craftcms/cms/releases/tag/5.2.3
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/craftcms/cms/security/advisories/GHSA-wmx7-pw49-88jx
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/craftcms/cms/security/advisories/GHSA-wmx7-pw49-88jx
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV-20240617-01_CraftCMS_TOTP_Valid_After_Use
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV-20240617-01_CraftCMS_TOTP_Valid_After_Use
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41800
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41800
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-287
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-41800
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/commit/7c790fa5ad5a8cb8016cb6793ec3554c4c079e38
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/releases/tag/5.2.3
    reference_type:
    reference_id:
  - url: https://github.com/craftcms/cms/security/advisories/GHSA-wmx7-pw49-88jx
    reference_type:
    reference_id:
  - url: https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV-20240617-01_CraftCMS_TOTP_Valid_After_Use
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta10:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta10:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta11:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta11:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta8:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta8:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:beta9:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:beta9:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:craftcms:craft_cms:5.0.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:craftcms:craft_cms:5.0.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41800
    reference_type:
    reference_id: CVE-2024-41800
  - url: https://github.com/advisories/GHSA-wmx7-pw49-88jx
    reference_type:
    reference_id: GHSA-wmx7-pw49-88jx
