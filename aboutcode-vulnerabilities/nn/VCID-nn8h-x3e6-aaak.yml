vulnerability_id: VCID-nn8h-x3e6-aaak
aliases:
  - GHSA-6r8p-hpg7-825g
summary: |
  Uncontrolled Recursion in SurrealQL Parsing
  In some specific instances, the SurrealQL parser will attempt to recursively parse nested statements or idioms (i.e. nested `IF` and `RELATE` statements, nested basic idioms and nested access to attributes) without checking if the depth limit established by default or in the `SURREAL_MAX_COMPUTATION_DEPTH` environment variable is exceeded. This can lead to the stack overflowing when the nesting surpasses certain levels of depth.

  ### Impact

  An attacker that is authorized to run queries on a SurrealDB server may be able to run a query using the affected statements and idioms with very deep nesting in order to crash the server, leading to denial of service.

  ### Patches

  - Version 1.1.0 and later are not affected by this issue.

  ### Workarounds

  Concerned users unable to update may want to limit the ability of untrusted users to run arbitrary SurrealQL queries in the affected versions of SurrealDB. To limit the impact of the denial of service, SurrealDB administrators may also want to ensure that the SurrealDB process is running so that it can be automatically re-started after a crash.

  ### References

  - https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62410
  - https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62652
  - https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=63797
  - https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64445
  - https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64731
  - https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=65277
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62410
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62410
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62652
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62652
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=63797
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=63797
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64445
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64445
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64731
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64731
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=65277
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=65277
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-6r8p-hpg7-825g
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/surrealdb/surrealdb
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/surrealdb/surrealdb/commit/f838da248e3854e4250e5187a3a67507cb7efaaa
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb/commit/f838da248e3854e4250e5187a3a67507cb7efaaa
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/surrealdb/surrealdb/pull/3232
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb/pull/3232
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-6r8p-hpg7-825g
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-6r8p-hpg7-825g
weaknesses:
  - CWE-674
references:
  - url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62410
    reference_type:
    reference_id:
  - url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62652
    reference_type:
    reference_id:
  - url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=63797
    reference_type:
    reference_id:
  - url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64445
    reference_type:
    reference_id:
  - url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64731
    reference_type:
    reference_id:
  - url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=65277
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/commit/f838da248e3854e4250e5187a3a67507cb7efaaa
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/pull/3232
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-6r8p-hpg7-825g
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6r8p-hpg7-825g
    reference_type:
    reference_id: GHSA-6r8p-hpg7-825g
