vulnerability_id: VCID-pzrx-mp8v-aaas
aliases:
  - CVE-2023-40581
  - GHSA-42h4-v29r-42qg
summary: 'yt-dlp is a youtube-dl fork with additional features and fixes. yt-dlp allows the
  user to provide shell command lines to be executed at various stages in its download steps
  through the `--exec` flag. This flag allows output template expansion in its argument, so
  that metadata values may be used in the shell commands. The metadata fields can be combined
  with the `%q` conversion, which is intended to quote/escape these values so they can be safely
  passed to the shell. However, the escaping used for `cmd` (the shell used by Python''s `subprocess`
  on Windows) does not properly escape special characters, which can allow for remote code execution
  if `--exec` is used directly with maliciously crafted remote data. This vulnerability only
  impacts `yt-dlp` on Windows, and the vulnerability is present regardless of whether `yt-dlp`
  is run from `cmd` or from `PowerShell`. Support for output template expansion in `--exec`,
  along with this vulnerable behavior, was added to `yt-dlp` in version 2021.04.11. yt-dlp version
  2023.09.24 fixes this issue by properly escaping each special character. `\n` will be replaced
  by `\r` as no way of escaping it has been found. It is recommended to upgrade yt-dlp to version
  2023.09.24 as soon as possible. Also, always be careful when using --exec, because while this
  specific vulnerability has been patched, using unvalidated input in shell commands is inherently
  dangerous. For Windows users who are not able to upgrade: 1. Avoid using any output template
  expansion in --exec other than {} (filepath). 2. If expansion in --exec is needed, verify
  the fields you are using do not contain ", | or &. 3. Instead of using --exec, write the info
  json and load the fields from it instead.'
severities:
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.81923'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82045'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82071'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82081'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82110'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82117'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82127'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82136'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82180'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82184'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00788'
    scoring_system: epss
    scoring_elements: '0.82206'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00854'
    scoring_system: epss
    scoring_elements: '0.82014'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00854'
    scoring_system: epss
    scoring_elements: '0.82024'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00854'
    scoring_system: epss
    scoring_elements: '0.82010'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.00945'
    scoring_system: epss
    scoring_elements: '0.83059'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79154'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79283'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79291'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79284'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79292'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79282'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79273'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79258'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79254'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79252'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79256'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79238'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.7922'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79215'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.01472'
    scoring_system: epss
    scoring_elements: '0.79165'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.02489'
    scoring_system: epss
    scoring_elements: '0.75501'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92663'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92637'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92644'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92656'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92659'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92669'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92662'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92661'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92666'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: '0.10199'
    scoring_system: epss
    scoring_elements: '0.92668'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-42h4-v29r-42qg
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp-nightly-builds/releases/tag/2023.09.24.003044
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp-nightly-builds/releases/tag/2023.09.24.003044
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp/releases/tag/2021.04.11
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp/releases/tag/2021.04.11
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp/releases/tag/2023.09.24
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp/releases/tag/2023.09.24
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-04-10T19:34:51Z/
    published_at: None
    url: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40581
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40581
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-40581
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/commit/de015e930747165dbb8fcd360f8775fd973b7d6e
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp-nightly-builds/releases/tag/2023.09.24.003044
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/releases/tag/2021.04.11
    reference_type:
    reference_id:
  - url: https://github.com/yt-dlp/yt-dlp/releases/tag/2023.09.24
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-40581
    reference_type:
    reference_id: CVE-2023-40581
  - url: https://github.com/advisories/GHSA-42h4-v29r-42qg
    reference_type:
    reference_id: GHSA-42h4-v29r-42qg
  - url: https://github.com/yt-dlp/yt-dlp/security/advisories/GHSA-42h4-v29r-42qg
    reference_type:
    reference_id: GHSA-42h4-v29r-42qg
