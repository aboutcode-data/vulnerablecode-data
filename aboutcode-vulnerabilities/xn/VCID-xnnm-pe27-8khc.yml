vulnerability_id: VCID-xnnm-pe27-8khc
aliases:
  - CVE-2025-66311
  - GHSA-mpjj-4688-3fxg
summary: "Grav vulnerable to Cross-Site Scripting (XSS) Stored endpoint `/admin/pages/[page]`\
  \ in Multiples parameters\n## Summary\n\nA Stored Cross-Site Scripting (XSS) vulnerability\
  \ was identified in the `/admin/pages/[page]` endpoint of the _Grav_ application. This vulnerability\
  \ allows attackers to inject malicious scripts into the `data[header][metadata]`, `data[header][taxonomy][category]`,\
  \ and `data[header][taxonomy][tag]` parameters. These scripts are stored in the page frontmatter\
  \ and executed automatically whenever the affected page is accessed or rendered in the administrative\
  \ interface.\n\n---\n\n## Details\n\n**Vulnerable Endpoint:** `POST /admin/pages/[page]` \
  \ \n**Parameters:**\n\n- `data[header][metadata]`\n    \n- `data[header][taxonomy][category]`\n\
  \    \n- `data[header][taxonomy][tag]`\n    \n\nThe application fails to properly sanitize\
  \ user input when saving page metadata or taxonomy fields via the Admin Panel. As a result,\
  \ an attacker with access to the admin interface can inject a malicious script using these\
  \ parameters, and the script will be stored in the page's YAML frontmatter. When the page\
  \ or metadata is rendered (especially in the Admin Panel), the payload is executed in the\
  \ browser of any user with access.\n\n---\n\n## PoC\n\n**Payload:**\n\n`<script>alert('PoC-XXS51')</script>`\n\
  \n### Steps to Reproduce:\n\n1. Log into the _Grav_ Admin Panel and navigate to **Pages**.\n\
  \    \n2. Create or edit a page.\n    \n3. Inject the payload above into any of the following\
  \ fields in the Options tab:\n    \n    - **Metadata** key name\n        \n    - **Category**\
  \ under Taxonomy\n        \n    - **Tag** under Taxonomy\n![image](https://github.com/user-attachments/assets/b66f3d4d-8f9d-40a9-83a8-5a365814c00b)\n\
  \n![image](https://github.com/user-attachments/assets/a1164198-2e25-4746-acb5-71f4874aebbe)\n\
  \n4. Save the page.\n![image](https://github.com/user-attachments/assets/6c9c0ba4-bce3-4a72-a10f-39b0b886a10c)\n\
  \nWhen the page is loaded again in the Admin Panel or potentially on the frontend (depending\
  \ on how the metadata is used), the script is executed, confirming the **Stored XSS** vulnerability.\n\
  \n---\n\n## Impact\n\nStored XSS vulnerabilities can result in serious consequences, including:\n\
  \n- **Session hijacking:** Attackers can steal authentication cookies or tokens\n    \n- **Malware\
  \ delivery:** Injected scripts can download malicious software\n    \n- **Credential theft:**\
  \ Fake input fields can capture usernames and passwords\n    \n- **Sensitive data exposure:**\
  \ Access to internal metadata and browser data\n    \n- **Administrative access compromise:**\
  \ Especially dangerous in admin-facing interfaces\n    \n- **Phishing attacks:** Users can\
  \ be redirected to external malicious sites\n    \n- **Reputation damage:** Executing arbitrary\
  \ scripts in trusted systems undermines credibility\n\nbyÂ [CVE-Hunters](https://github.com/Sec-Dojo-Cyber-House/cve-hunters)"
severities:
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08959'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66311
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08919'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66311
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-mpjj-4688-3fxg
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav
  - score: '6.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:L/VI:L/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-02T15:53:27Z/
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-mpjj-4688-3fxg
  - score: '6.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:L/VI:L/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-mpjj-4688-3fxg
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-mpjj-4688-3fxg
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-02T15:53:27Z/
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-mpjj-4688-3fxg
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66311
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-66311
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-mpjj-4688-3fxg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66311
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-mpjj-4688-3fxg
    reference_type:
    reference_id: GHSA-mpjj-4688-3fxg
