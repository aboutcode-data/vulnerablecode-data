vulnerability_id: VCID-dbeg-7ry4-aaam
aliases:
  - GHSA-hmm9-r2m2-qg9w
summary: |
  Nil dereference in NATS JWT causing DoS of nats-server
  (This advisory is canonically <https://advisories.nats.io/CVE/CVE-2020-26521.txt>)

  ## Problem Description

  The NATS account system has an Operator trusted by the servers, which signs Accounts, and each Account can then create and sign Users within their account.  The Operator should be able to safely issue Accounts to other entities which it does not fully trust.

  A malicious Account could create and sign a User JWT with a state not created by the normal tooling, such that decoding by the NATS JWT library (written in Go) would attempt a nil dereference, aborting execution.

  The NATS Server is known to be impacted by this.


  ## Affected versions

  #### JWT library

   * all versions prior to 1.1.0

  #### NATS Server

   * Version 2 prior to 2.1.9


  ## Impact

  #### JWT library

   * Programs would nil dereference and panic, aborting execution by default.

  #### NATS server

   * Denial of Service caused by process termination


  ## Workaround

  If your NATS servers do not trust any accounts which are managed by untrusted entities, then malformed User credentials are unlikely to be encountered.


  ## Solution

  Upgrade the JWT dependency in any application using it.

  Upgrade the NATS server if using NATS Accounts.
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://advisories.nats.io/CVE/CVE-2020-26521.txt
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://advisories.nats.io/CVE/CVE-2020-26521.txt
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/nats-io/jwt/pull/107
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nats-io/jwt/pull/107
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/nats-io/nats-server/security/advisories/GHSA-hmm9-r2m2-qg9w
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nats-io/nats-server/security/advisories/GHSA-hmm9-r2m2-qg9w
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VT67XCLIIBYRT762SVFBYFFTQFVSM3SI
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VT67XCLIIBYRT762SVFBYFFTQFVSM3SI
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.openwall.com/lists/oss-security/2020/11/02/2
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.openwall.com/lists/oss-security/2020/11/02/2
weaknesses:
  - CWE-476
references:
  - url: https://advisories.nats.io/CVE/CVE-2020-26521.txt
    reference_type:
    reference_id:
  - url: https://github.com/nats-io/jwt/pull/107
    reference_type:
    reference_id:
  - url: https://github.com/nats-io/nats-server/security/advisories/GHSA-hmm9-r2m2-qg9w
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VT67XCLIIBYRT762SVFBYFFTQFVSM3SI
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2020/11/02/2
    reference_type:
    reference_id:
