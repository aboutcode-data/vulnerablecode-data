vulnerability_id: VCID-zpad-py61-aaah
aliases:
  - CVE-2022-1884
  - GHSA-958j-443g-7mm7
summary: |
  OS Command Injection in gogs
  ### Impact

  The malicious user is able to upload a crafted `config` file into repository's `.git` directory with to gain SSH access to the server. All Windows installations with [repository upload enabled (default)](https://github.com/gogs/gogs/blob/f36eeedbf89328ee70cc3a2e239f6314f9021f58/conf/app.ini#L127-L129) are affected.

  ### Patches

  Repository file uploads are prohibited to its `.git` directory. Users should upgrade to 0.12.8 or the latest 0.13.0+dev.

  ### Workarounds

  [Disable repository files upload](https://github.com/gogs/gogs/blob/f36eeedbf89328ee70cc3a2e239f6314f9021f58/conf/app.ini#L128-L129).

  ### References

  https://www.huntr.dev/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b/

  ### For more information

  If you have any questions or comments about this advisory, please post on #6968.
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10865'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.45503'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.44929'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.44906'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.45904'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.45829'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.45803'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.45631'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.45602'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.45579'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.45585'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00110'
    scoring_system: epss
    scoring_elements: '0.45484'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00156'
    scoring_system: epss
    scoring_elements: '0.52495'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.00156'
    scoring_system: epss
    scoring_elements: '0.52790'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90821'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90813'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90812'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90802'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90803'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90811'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90804'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90791'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90797'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90775'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90762'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.07238'
    scoring_system: epss
    scoring_elements: '0.90824'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.92208'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.91943'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.91942'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.92181'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.9219'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.922'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.92203'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.9221'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.92206'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.92202'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.09176'
    scoring_system: epss
    scoring_elements: '0.92209'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '0.1881'
    scoring_system: epss
    scoring_elements: '0.92256'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/gogs/gogs
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/gogs/gogs
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/gogs/gogs
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/gogs/gogs
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/gogs/gogs/blob/f36eeedbf89328ee70cc3a2e239f6314f9021f58/conf/app.ini#L127-L129
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/gogs/gogs/blob/f36eeedbf89328ee70cc3a2e239f6314f9021f58/conf/app.ini#L127-L129
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/gogs/gogs/blob/f36eeedbf89328ee70cc3a2e239f6314f9021f58/conf/app.ini#L127-L129
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/gogs/gogs/issues/6968
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/gogs/gogs/issues/6968
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/gogs/gogs/pull/6970
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/gogs/gogs/pull/6970
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/gogs/gogs/releases/tag/v0.12.8
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/gogs/gogs/releases/tag/v0.12.8
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/gogs/gogs/security/advisories/GHSA-958j-443g-7mm7
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/gogs/gogs/security/advisories/GHSA-958j-443g-7mm7
  - score: 10
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b
  - score: 10
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://huntr.com/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-11-15T19:13:14Z/
    published_at: None
    url: https://huntr.com/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-1884
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-1884
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-1884
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-1884
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://www.huntr.dev/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.huntr.dev/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b
weaknesses:
  - CWE-77
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-1884
    reference_type:
    reference_id:
  - url: https://github.com/gogs/gogs
    reference_type:
    reference_id:
  - url: https://github.com/gogs/gogs/blob/f36eeedbf89328ee70cc3a2e239f6314f9021f58/conf/app.ini#L127-L129
    reference_type:
    reference_id:
  - url: https://github.com/gogs/gogs/issues/6968
    reference_type:
    reference_id:
  - url: https://github.com/gogs/gogs/pull/6970
    reference_type:
    reference_id:
  - url: https://github.com/gogs/gogs/releases/tag/v0.12.8
    reference_type:
    reference_id:
  - url: https://github.com/gogs/gogs/security/advisories/GHSA-958j-443g-7mm7
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-1884
    reference_type:
    reference_id:
  - url: https://www.huntr.dev/bounties/9cd4e7b7-0979-4e5e-9a1c-388b58dea76b
    reference_type:
    reference_id:
