vulnerability_id: VCID-57my-2gva-aaan
aliases:
  - CVE-2024-0243
  - GHSA-h9j7-5xvc-qhg5
  - PYSEC-2024-235
summary: |
  With the following crawler configuration:

  ```python
  from bs4 import BeautifulSoup as Soup

  url = "https://example.com"
  loader = RecursiveUrlLoader(
      url=url, max_depth=2, extractor=lambda x: Soup(x, "html.parser").text
  )
  docs = loader.load()
  ```

  An attacker in control of the contents of `https://example.com` could place a malicious HTML file in there with links like "https://example.completely.different/my_file.html" and the crawler would proceed to download that file as well even though `prevent_outside=True`.

  https://github.com/langchain-ai/langchain/blob/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22/libs/community/langchain_community/document_loaders/recursive_url_loader.py#L51-L51

  Resolved in https://github.com/langchain-ai/langchain/pull/15559
severities:
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16526'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16372'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16377'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16399'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16423'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16547'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16559'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16573'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16567'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16543'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16173'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16245'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16421'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16346'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.28251'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.28223'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.28645'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.27459'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.27731'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.27805'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.27833'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.27890'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.27876'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.27885'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.27899'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.27941'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.28175'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.28242'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.28330'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.28259'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.29996'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.30104'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.30085'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.29951'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.30108'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.3012'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.30127'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.30155'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.3015'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.30086'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.30081'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.30114'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00135'
    scoring_system: epss
    scoring_elements: '0.30146'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: '0.00317'
    scoring_system: epss
    scoring_elements: '0.38403'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-h9j7-5xvc-qhg5
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/langchain-ai/langchain
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/langchain-ai/langchain
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/langchain-ai/langchain
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/langchain-ai/langchain/blob/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22/libs/community/langchain_community/document_loaders/recursive_url_loader.py#L51-L51
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/langchain-ai/langchain/blob/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22/libs/community/langchain_community/document_loaders/recursive_url_loader.py#L51-L51
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/langchain-ai/langchain/commit/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/langchain-ai/langchain/commit/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/langchain-ai/langchain/commit/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/langchain-ai/langchain/pull/15559
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/langchain-ai/langchain/pull/15559
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/langchain-ai/langchain/pull/15559
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/langchain-exa/PYSEC-2024-235.yaml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/langchain-exa/PYSEC-2024-235.yaml
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://huntr.com/bounties/370904e7-10ac-40a4-a8d4-e2d16e1ca861
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/370904e7-10ac-40a4-a8d4-e2d16e1ca861
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://huntr.com/bounties/370904e7-10ac-40a4-a8d4-e2d16e1ca861
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-0243
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-0243
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-0243
weaknesses:
  - CWE-918
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-0243
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain/blob/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22/libs/community/langchain_community/document_loaders/recursive_url_loader.py#L51-L51
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain/commit/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22
    reference_type:
    reference_id:
  - url: https://github.com/langchain-ai/langchain/pull/15559
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/langchain-exa/PYSEC-2024-235.yaml
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/370904e7-10ac-40a4-a8d4-e2d16e1ca861
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:langchain:langchain:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:langchain:langchain:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-0243
    reference_type:
    reference_id: CVE-2024-0243
  - url: https://github.com/advisories/GHSA-h9j7-5xvc-qhg5
    reference_type:
    reference_id: GHSA-h9j7-5xvc-qhg5
