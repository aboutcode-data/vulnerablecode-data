vulnerability_id: VCID-9bkm-xrjb-aaae
aliases:
  - GHSA-9mrq-cjgh-32g2
  - GMS-2019-56
summary: |
  Low severity vulnerability that affects smartbanner.js
  ## rel noopener vulnerability

  ### Impact
  Clicking on smartbanner _View_ link and navigating to 3rd party page leaves `window.opener` exposed. It may allow hostile 3rd parties to abuse `window.opener`, e.g. by redirection or injection on the original page with smartbanner.

  ### Patches
  `rel="noopener"` is automatically populated to links as of `v1.14.1` which is a recommended upgrade to resolve the vulnerability.

  ### Workarounds
  If you can not upgrade to `v1.14.1`:
  1. Ensure _View_ link is only taking users to App Store or Google Play Store where security is guarded by respective app store security teams
  2. If _View_ link is going to a 3rd party page, limit smartbanner.js to be used on iOS that decreases the scope of the vulnerability since as of Safari, `rel="noopener"` is imposed on all `target="_blank"` links.

   Following combination of smartbanner meta tags can be used to achieve the above:

   ```html
   <meta name="smartbanner:enabled-platforms" content="none">
   <meta name="smartbanner:include-user-agent-regex" content="Mobile.*Safari">
   ```

  ### References
  * [About rel=noopener](https://mathiasbynens.github.io/rel-noopener/)
  * [Safari Release Notes](https://developer.apple.com/documentation/safari_release_notes/safari_12_1_release_notes#3130296)

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [smartbanner.js](https://github.com/ain/smartbanner.js/issues/new)
severities:
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-9mrq-cjgh-32g2
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ain/smartbanner.js
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/ain/smartbanner.js/security/advisories/GHSA-9mrq-cjgh-32g2
weaknesses:
  - CWE-937
  - CWE-1035
references:
  - url: https://github.com/ain/smartbanner.js
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-9mrq-cjgh-32g2
    reference_type:
    reference_id: GHSA-9mrq-cjgh-32g2
  - url: https://github.com/ain/smartbanner.js/security/advisories/GHSA-9mrq-cjgh-32g2
    reference_type:
    reference_id: GHSA-9mrq-cjgh-32g2
