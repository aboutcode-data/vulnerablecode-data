vulnerability_id: VCID-yg7p-hxa7-aaah
aliases:
  - CVE-2024-32970
  - GHSA-9p57-h987-4vgx
summary: 'Phlex is a framework for building object-oriented views in Ruby. In affected versions
  there is a potential cross-site scripting (XSS) vulnerability that can be exploited via maliciously
  crafted user data. Since the last two vulnerabilities https://github.com/phlex-ruby/phlex/security/advisories/GHSA-242p-4v39-2v8g
  and https://github.com/phlex-ruby/phlex/security/advisories/GHSA-g7xq-xv8c-h98c, we have invested
  in extensive browser tests. It was these new tests that helped us uncover these issues. As
  of now the project exercises every possible attack vector the developers can think of â€” including
  enumerating every ASCII character, and we run these tests in Chrome, Firefox and Safari. Additionally,
  we test against a list of 6613 known XSS payloads (see: payloadbox/xss-payload-list). The
  reason these issues were not detected before is the escapes were working as designed. However,
  their design didn''t take into account just how recklessly permissive browsers are when it
  comes to executing unsafe JavaScript via HTML attributes. If you render an `<a>` tag with
  an `href` attribute set to a user-provided link, that link could potentially execute JavaScript
  when clicked by another user. If you splat user-provided attributes when rendering any HTML
  or SVG tag, malicious event attributes could be included in the output, executing JavaScript
  when the events are triggered by another user. Patches are available on RubyGems for all minor
  versions released in the last year. Users are advised to upgrade. Users unable to upgrade
  should configure a Content Security Policy that does not allow `unsafe-inline` which would
  effectively prevent this vulnerability from being exploited. Users who upgrade are also advised
  to configure a Content Security Policy header that does not allow `unsafe-inline`.'
severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11214'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12225'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11891'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11841'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11828'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12271'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12177'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12119'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11819'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11764'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11709'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11696'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11700'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11632'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11609'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11518'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19411'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16191'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16213'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16241'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16211'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16198'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16175'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16194'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.1623'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16229'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16201'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16176'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16134'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19198'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19273'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19328'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.1939'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19386'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19374'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19359'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19358'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19372'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19383'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19401'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19409'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00544'
    scoring_system: epss
    scoring_elements: '0.65209'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00544'
    scoring_system: epss
    scoring_elements: '0.65119'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.00544'
    scoring_system: epss
    scoring_elements: '0.65142'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '0.01408'
    scoring_system: epss
    scoring_elements: '0.68479'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-9p57-h987-4vgx
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/payloadbox/xss-payload-list
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/payloadbox/xss-payload-list
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/phlex-ruby/phlex
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/phlex-ruby/phlex
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://github.com/phlex-ruby/phlex/security/advisories/GHSA-9p57-h987-4vgx
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/phlex-ruby/phlex/security/advisories/GHSA-9p57-h987-4vgx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/phlex-ruby/phlex/security/advisories/GHSA-9p57-h987-4vgx
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://rubygems.org/gems/phlex
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rubygems.org/gems/phlex
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://rubygems.org/gems/phlex/versions/1.10.2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rubygems.org/gems/phlex/versions/1.10.2
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://rubygems.org/gems/phlex/versions/1.9.3
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rubygems.org/gems/phlex/versions/1.9.3
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-32970
    reference_type:
    reference_id:
  - url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy
    reference_type:
    reference_id:
  - url: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline
    reference_type:
    reference_id:
  - url: https://github.com/payloadbox/xss-payload-list
    reference_type:
    reference_id:
  - url: https://github.com/phlex-ruby/phlex
    reference_type:
    reference_id:
  - url: https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2
    reference_type:
    reference_id:
  - url: https://github.com/phlex-ruby/phlex/security/advisories/GHSA-9p57-h987-4vgx
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/phlex
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/phlex/versions/1.10.2
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/phlex/versions/1.9.3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32970
    reference_type:
    reference_id: CVE-2024-32970
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/phlex/CVE-2024-32970.yml
    reference_type:
    reference_id: CVE-2024-32970.YML
  - url: https://github.com/advisories/GHSA-9p57-h987-4vgx
    reference_type:
    reference_id: GHSA-9p57-h987-4vgx
