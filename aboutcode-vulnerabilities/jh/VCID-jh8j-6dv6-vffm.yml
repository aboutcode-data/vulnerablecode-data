vulnerability_id: VCID-jh8j-6dv6-vffm
aliases:
  - CVE-2022-50335
summary: 'In the Linux kernel, the following vulnerability has been resolved:  9p: set req refcount
  to zero to avoid uninitialized usage  When a new request is allocated, the refcount will be
  zero if it is reused, but if the request is newly allocated from slab, it is not fully initialized
  before being added to idr.  If the p9_read_work got a response before the refcount initiated.
  It will use a uninitialized req, which will result in a bad request data struct.  Here is
  the logs from syzbot.  Corrupted memory at 0xffff88807eade00b [ 0xff 0x07 0x00 0x00 0x00 0x00
  0x00 0x00 . . . . . . . . ] (in kfence-#110):  p9_fcall_fini net/9p/client.c:248 [inline]  p9_req_put
  net/9p/client.c:396 [inline]  p9_req_put+0x208/0x250 net/9p/client.c:390  p9_client_walk+0x247/0x540
  net/9p/client.c:1165  clone_fid fs/9p/fid.h:21 [inline]  v9fs_fid_xattr_set+0xe4/0x2b0 fs/9p/xattr.c:118  v9fs_xattr_set
  fs/9p/xattr.c:100 [inline]  v9fs_xattr_handler_set+0x6f/0x120 fs/9p/xattr.c:159  __vfs_setxattr+0x119/0x180
  fs/xattr.c:182  __vfs_setxattr_noperm+0x129/0x5f0 fs/xattr.c:216  __vfs_setxattr_locked+0x1d3/0x260
  fs/xattr.c:277  vfs_setxattr+0x143/0x340 fs/xattr.c:309  setxattr+0x146/0x160 fs/xattr.c:617  path_setxattr+0x197/0x1c0
  fs/xattr.c:636  __do_sys_setxattr fs/xattr.c:652 [inline]  __se_sys_setxattr fs/xattr.c:648
  [inline]  __ia32_sys_setxattr+0xc0/0x160 fs/xattr.c:648  do_syscall_32_irqs_on arch/x86/entry/common.c:112
  [inline]  __do_fast_syscall_32+0x65/0xf0 arch/x86/entry/common.c:178  do_fast_syscall_32+0x33/0x70
  arch/x86/entry/common.c:203  entry_SYSENTER_compat_after_hwframe+0x70/0x82  Below is a similar
  scenario, the scenario in the syzbot log looks more complicated than this one, but this patch
  can fix it.       T21124                   p9_read_work ======================== second trans
  ================================= p9_client_walk   p9_client_rpc     p9_client_prepare_req       p9_tag_alloc         req
  = kmem_cache_alloc(p9_req_cache, GFP_NOFS);         tag = idr_alloc         << preempted >>         req->tc.tag
  = tag;                             /* req->[refcount/tag] == uninitialized */                             m->rreq
  = p9_tag_lookup(m->client, m->rc.tag);                               /* increments uninitalized
  refcount */          refcount_set(&req->refcount, 2);                             /* cb drops
  one ref */                             p9_client_cb(req)                             /* reader
  thread drops its ref:                                request is incorrectly freed */                             p9_req_put(req)     /*
  use after free and ref underflow */     p9_req_put(req)  To fix it, we can initialize the
  refcount to zero before add to idr.'
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50335.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.0337'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03371'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0299'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03025'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02964'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04756'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04919'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04922'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04954'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04863'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04836'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04862'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0489'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.049'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04881'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04642'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04647'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04629'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0476'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04766'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05618'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05599'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05584'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05604'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05587'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05578'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05552'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05561'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05583'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05678'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05662'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05644'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50335.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50335
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-50335
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2395395
    reference_type:
    reference_id: 2395395
