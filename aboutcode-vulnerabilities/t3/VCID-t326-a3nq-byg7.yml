vulnerability_id: VCID-t326-a3nq-byg7
aliases:
  - CVE-2025-38051
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  smb: client: Fix use-after-free in cifs_fill_dirent

  There is a race condition in the readdir concurrency process, which may
  access the rsp buffer after it has been released, triggering the
  following KASAN warning.

   ==================================================================
   BUG: KASAN: slab-use-after-free in cifs_fill_dirent+0xb03/0xb60 [cifs]
   Read of size 4 at addr ffff8880099b819c by task a.out/342975

   CPU: 2 UID: 0 PID: 342975 Comm: a.out Not tainted 6.15.0-rc6+ #240 PREEMPT(full)
   Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.1-2.fc37 04/01/2014
   Call Trace:
    <TASK>
    dump_stack_lvl+0x53/0x70
    print_report+0xce/0x640
    kasan_report+0xb8/0xf0
    cifs_fill_dirent+0xb03/0xb60 [cifs]
    cifs_readdir+0x12cb/0x3190 [cifs]
    iterate_dir+0x1a1/0x520
    __x64_sys_getdents+0x134/0x220
    do_syscall_64+0x4b/0x110
    entry_SYSCALL_64_after_hwframe+0x76/0x7e
   RIP: 0033:0x7f996f64b9f9
   Code: ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 48 89 f8 48 89
   f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01
   f0 ff ff  0d f7 c3 0c 00 f7 d8 64 89 8
   RSP: 002b:00007f996f53de78 EFLAGS: 00000207 ORIG_RAX: 000000000000004e
   RAX: ffffffffffffffda RBX: 00007f996f53ecdc RCX: 00007f996f64b9f9
   RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000003
   RBP: 00007f996f53dea0 R08: 0000000000000000 R09: 0000000000000000
   R10: 0000000000000000 R11: 0000000000000207 R12: ffffffffffffff88
   R13: 0000000000000000 R14: 00007ffc8cd9a500 R15: 00007f996f51e000
    </TASK>

   Allocated by task 408:
    kasan_save_stack+0x20/0x40
    kasan_save_track+0x14/0x30
    __kasan_slab_alloc+0x6e/0x70
    kmem_cache_alloc_noprof+0x117/0x3d0
    mempool_alloc_noprof+0xf2/0x2c0
    cifs_buf_get+0x36/0x80 [cifs]
    allocate_buffers+0x1d2/0x330 [cifs]
    cifs_demultiplex_thread+0x22b/0x2690 [cifs]
    kthread+0x394/0x720
    ret_from_fork+0x34/0x70
    ret_from_fork_asm+0x1a/0x30

   Freed by task 342979:
    kasan_save_stack+0x20/0x40
    kasan_save_track+0x14/0x30
    kasan_save_free_info+0x3b/0x60
    __kasan_slab_free+0x37/0x50
    kmem_cache_free+0x2b8/0x500
    cifs_buf_release+0x3c/0x70 [cifs]
    cifs_readdir+0x1c97/0x3190 [cifs]
    iterate_dir+0x1a1/0x520
    __x64_sys_getdents64+0x134/0x220
    do_syscall_64+0x4b/0x110
    entry_SYSCALL_64_after_hwframe+0x76/0x7e

   The buggy address belongs to the object at ffff8880099b8000
    which belongs to the cache cifs_request of size 16588
   The buggy address is located 412 bytes inside of
    freed 16588-byte region [ffff8880099b8000, ffff8880099bc0cc)

   The buggy address belongs to the physical page:
   page: refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x99b8
   head: order:3 mapcount:0 entire_mapcount:0 nr_pages_mapped:0 pincount:0
   anon flags: 0x80000000000040(head|node=0|zone=1)
   page_type: f5(slab)
   raw: 0080000000000040 ffff888001e03400 0000000000000000 dead000000000001
   raw: 0000000000000000 0000000000010001 00000000f5000000 0000000000000000
   head: 0080000000000040 ffff888001e03400 0000000000000000 dead000000000001
   head: 0000000000000000 0000000000010001 00000000f5000000 0000000000000000
   head: 0080000000000003 ffffea0000266e01 00000000ffffffff 00000000ffffffff
   head: ffffffffffffffff 0000000000000000 00000000ffffffff 0000000000000008
   page dumped because: kasan: bad access detected

   Memory state around the buggy address:
    ffff8880099b8080: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    ffff8880099b8100: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
   >ffff8880099b8180: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                               ^
    ffff8880099b8200: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    ffff8880099b8280: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
   ==================================================================

  POC is available in the link [1].

  The problem triggering process is as follows:

  Process 1                       Process 2
  -----------------------------------
  ---truncated---
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38051.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05257'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0524'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05026'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05031'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0749'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07522'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07439'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07393'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07416'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0738'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07395'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0758'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07512'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07535'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08257'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08287'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08296'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08329'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08389'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0841'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08384'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08369'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08228'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1032'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0966'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09654'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09672'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09772'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09751'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09861'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09926'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09979'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0992'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10024'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09997'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10155'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10134'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10135'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10279'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10267'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10299'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10271'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10242'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10287'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10284'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10333'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00053'
    scoring_system: epss
    scoring_elements: '0.16455'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21368'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21319'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21413'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.214'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21404'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21391'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21387'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21384'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21432'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21414'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-825
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38051.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38051
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38051
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1b197931fbc821bc7e9e91bf619400db563e3338
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/73cadde98f67f76c5eba00ac0b72c453383cec8b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9bea368648ac46f8593a780760362e40291d22a9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9c9aafbacc183598f064902365e107b5e856531f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a24c2f05ac3c5b0aaa539d9d913826d2643dfd0e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a7a8fe56e932a36f43e031b398aef92341bf5ea0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aee067e88d61eb72e966f094e4749c6b14e7008f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c8623231e0edfcccb7cc6add0288fa0f0594282f
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2373329
    reference_type:
    reference_id: 2373329
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38051
    reference_type:
    reference_id: CVE-2025-38051
  - url: https://usn.ubuntu.com/7704-1/
    reference_type:
    reference_id: USN-7704-1
  - url: https://usn.ubuntu.com/7704-2/
    reference_type:
    reference_id: USN-7704-2
  - url: https://usn.ubuntu.com/7704-3/
    reference_type:
    reference_id: USN-7704-3
  - url: https://usn.ubuntu.com/7704-4/
    reference_type:
    reference_id: USN-7704-4
  - url: https://usn.ubuntu.com/7704-5/
    reference_type:
    reference_id: USN-7704-5
  - url: https://usn.ubuntu.com/7711-1/
    reference_type:
    reference_id: USN-7711-1
  - url: https://usn.ubuntu.com/7712-1/
    reference_type:
    reference_id: USN-7712-1
  - url: https://usn.ubuntu.com/7712-2/
    reference_type:
    reference_id: USN-7712-2
  - url: https://usn.ubuntu.com/7769-1/
    reference_type:
    reference_id: USN-7769-1
  - url: https://usn.ubuntu.com/7769-2/
    reference_type:
    reference_id: USN-7769-2
  - url: https://usn.ubuntu.com/7769-3/
    reference_type:
    reference_id: USN-7769-3
  - url: https://usn.ubuntu.com/7770-1/
    reference_type:
    reference_id: USN-7770-1
  - url: https://usn.ubuntu.com/7771-1/
    reference_type:
    reference_id: USN-7771-1
  - url: https://usn.ubuntu.com/7789-1/
    reference_type:
    reference_id: USN-7789-1
  - url: https://usn.ubuntu.com/7789-2/
    reference_type:
    reference_id: USN-7789-2
