vulnerability_id: VCID-t3bp-2kf3-r3dg
aliases:
  - CVE-2026-21892
  - GHSA-f2mf-q878-gh58
summary: "Parsl Monitoring Visualization Vulnerable to SQL Injection\n**Affected Product:**\
  \ Parsl (Python Parallel Scripting Library)\n\n**Component:** parsl.monitoring.visualization\n\
  \n**Vulnerability Type:** SQL Injection (CWE-89)\n\n**Severity:** High (CVSS Rating Recommended:\
  \ 7.5 - 8.6)\n\n**URL:** [https://github.com/Parsl/parsl/blob/master/parsl/monitoring/visualization/views.py](\
  \ https://github.com/Parsl/parsl/blob/master/parsl/monitoring/visualization/views.py)\n\n\
  **Summary**\n\nA SQL Injection vulnerability exists in the parsl-visualize component of the\
  \ Parsl library. The application constructs SQL queries using unsafe string formatting (Python\
  \ % operator) with user-supplied input (workflow_id) directly from URL routes. This allows\
  \ an unauthenticated attacker with access to the visualization dashboard to inject arbitrary\
  \ SQL commands, potentially leading to data exfiltration or denial of service against the\
  \ monitoring database.\n\n**Root Cause Analysis**\n\nThe vulnerability is located in parsl/monitoring/visualization/views.py.\
  \ Multiple route handlers take the workflow_id parameter from the URL and inject it directly\
  \ into a raw SQL query string without sanitization or parameterization.\n\nVulnerable Code\
  \ Snippet 1 \n\n```\n   query = \"\"\"SELECT task.task_id, task.task_func_name, task.task_depends,\
  \ status.task_status_name\n               FROM task LEFT JOIN status\n               ON task.task_id\
  \ = status.task_id\n               AND task.run_id = status.run_id\n               AND status.timestamp\
  \ = (SELECT MAX(status.timestamp)\n                                       FROM status\n  \
  \                                     WHERE status.task_id = task.task_id and status.run_id\
  \ = task.run_id\n                                      )\n               WHERE task.run_id='%s'\"\
  \"\" % (workflow_id)\n```\n\nVulnerable Code Snippet 2\n```\ndf_task_tries = pd.read_sql_query(\"\
  \"\"SELECT ...\n                                     WHERE task.task_id = try.task_id AND\
  \ task.run_id='%s' and try.run_id='%s'\"\"\"\n                                     % (workflow_id,\
  \ workflow_id), db.engine) # <--- Vulnerable \n```\n\n**Impact**\n\n**Data Exfiltration:**\
  \ An attacker can use UNION based injection to dump the entire contents of the monitoring\
  \ database, including potentially sensitive environment variables, task parameters, or host\
  \ information logged by the monitoring system.\n\n**Access Control Bypass:** By injecting\
  \ boolean logic (e.g., ' OR '1'='1), an attacker could bypass specific workflow filters to\
  \ view data they are not authorized to see.\n\n**Denial of Service:** Time-based attacks or\
  \ resource-intensive queries (e.g., randomblob) could crash the visualization server or the\
  \ database.\n\n**Proof of Concept (PoC)**\n\n**Prerequisites:**\n\nParsl installed with monitoring\
  \ enabled (pip install 'parsl[monitoring,visualization]').\n\nA running parsl-visualize server\
  \ serving a database with at least one recorded workflow.\n\n**Reproduction Steps:**\n\nIdentify\
  \ a valid workflow ID (or use a known ID like default-run or a UUID).\n\nNavigate to the dag_group_by_states\
  \ endpoint using the following manipulated URLs to confirm SQL logic control (Boolean-based\
  \ Blind SQLi).\n\nTest 1: Boolean FALSE (Graph Disappears)\nInjecting a false condition (1=0)\
  \ causes the query to return zero rows, resulting in an empty visualization.\n\n`http://<server>:8080/workflow/<VALID_ID>'%20AND%20'1'='0/dag_group_by_states\n\
  `\n\nTest 2: Boolean TRUE (Graph Reappears)\nInjecting a true condition (1=1) restores the\
  \ query logic, causing the graph to render correctly.\n\n`http://<server>:8080/workflow/<VALID_ID>'%20AND%20'1'='1/dag_group_by_states\n\
  `"
severities:
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.11225'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2026-21892
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-f2mf-q878-gh58
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/Parsl/parsl
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Parsl/parsl
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/Parsl/parsl/commit/013a928461e70f38a33258bd525a351ed828e974
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Parsl/parsl/commit/013a928461e70f38a33258bd525a351ed828e974
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-08T14:52:19Z/
    published_at: None
    url: https://github.com/Parsl/parsl/commit/013a928461e70f38a33258bd525a351ed828e974
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/Parsl/parsl/security/advisories/GHSA-f2mf-q878-gh58
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/Parsl/parsl/security/advisories/GHSA-f2mf-q878-gh58
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Parsl/parsl/security/advisories/GHSA-f2mf-q878-gh58
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-08T14:52:19Z/
    published_at: None
    url: https://github.com/Parsl/parsl/security/advisories/GHSA-f2mf-q878-gh58
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21892
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21892
weaknesses:
  - CWE-89
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2026-21892
    reference_type:
    reference_id:
  - url: https://github.com/Parsl/parsl
    reference_type:
    reference_id:
  - url: https://github.com/Parsl/parsl/commit/013a928461e70f38a33258bd525a351ed828e974
    reference_type:
    reference_id:
  - url: https://github.com/Parsl/parsl/security/advisories/GHSA-f2mf-q878-gh58
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1125085
    reference_type:
    reference_id: 1125085
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-21892
    reference_type:
    reference_id: CVE-2026-21892
  - url: https://github.com/advisories/GHSA-f2mf-q878-gh58
    reference_type:
    reference_id: GHSA-f2mf-q878-gh58
