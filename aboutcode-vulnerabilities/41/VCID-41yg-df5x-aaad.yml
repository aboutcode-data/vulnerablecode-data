vulnerability_id: VCID-41yg-df5x-aaad
aliases:
  - GHSA-52cw-pvq9-9m5v
summary: |
  Silverstripe uses TinyMCE which allows svg files linked in object tags
  ### Impact
  TinyMCE v6 has a configuration value `convert_unsafe_embeds` set to `false` which allows svg files containing javascript to be used in `<object>` or `<embed>` tags, which can be used as a vector for XSS attacks.

  Note that `<embed>` tags are not allowed by default.

  After patching the default value of `convert_unsafe_embeds` will be set to `true`. This means that `<object>` tags will be converted to iframes instead the next time the page is saved, which may break any pages that rely upon previously saved `<object>` tags. Developers can override this configuration if desired to revert to the original behaviour.

  We reviewed the potential impact of this vulnerability within the context of Silverstripe CMS. We concluded this is a medium impact vulnerability given how TinyMCE is used by Silverstripe CMS.

  ### References:
  - https://www.silverstripe.org/download/security-releases/ss-2024-001
  - https://github.com/advisories/GHSA-5359-pvf2-pw78
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-52cw-pvq9-9m5v
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5359-pvf2-pw78
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2024-001.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2024-001.yaml
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/silverstripe/silverstripe-framework
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/silverstripe/silverstripe-framework
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/silverstripe/silverstripe-framework/security/advisories/GHSA-52cw-pvq9-9m5v
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/silverstripe/silverstripe-framework/security/advisories/GHSA-52cw-pvq9-9m5v
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://www.silverstripe.org/download/security-releases/ss-2024-001
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.silverstripe.org/download/security-releases/ss-2024-001
weaknesses:
  - CWE-1395
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/silverstripe/framework/SS-2024-001.yaml
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework
    reference_type:
    reference_id:
  - url: https://github.com/silverstripe/silverstripe-framework/security/advisories/GHSA-52cw-pvq9-9m5v
    reference_type:
    reference_id:
  - url: https://www.silverstripe.org/download/security-releases/ss-2024-001
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-52cw-pvq9-9m5v
    reference_type:
    reference_id: GHSA-52cw-pvq9-9m5v
  - url: https://github.com/advisories/GHSA-5359-pvf2-pw78
    reference_type:
    reference_id: GHSA-5359-pvf2-pw78
