vulnerability_id: VCID-kz7x-9spe-aaar
aliases:
  - CVE-2023-38545
summary: |
  This flaw makes curl overflow a heap based buffer in the SOCKS5 proxy
  handshake.

  When curl is asked to pass along the host name to the SOCKS5 proxy to allow
  that to resolve the address instead of it getting done by curl itself, the
  maximum length that host name can be is 255 bytes.

  If the host name is detected to be longer, curl switches to local name
  resolving and instead passes on the resolved address only. Due to this bug,
  the local variable that means "let the host resolve the name" could get the
  wrong value during a slow SOCKS5 handshake, and contrary to the intention,
  copy the too long host name to the target buffer instead of copying just the
  resolved address there.

  The target buffer being a heap based buffer, and the host name coming from the
  URL that curl has been told to operate with.
severities:
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-38545.json
  - score: '0.00456'
    scoring_system: epss
    scoring_elements: '0.75763'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00456'
    scoring_system: epss
    scoring_elements: '0.75905'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.78097'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.78019'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.78026'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.78082'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.78113'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.77953'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.77964'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.78003'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.78001'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00542'
    scoring_system: epss
    scoring_elements: '0.78004'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00821'
    scoring_system: epss
    scoring_elements: '0.81670'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00821'
    scoring_system: epss
    scoring_elements: '0.81662'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00821'
    scoring_system: epss
    scoring_elements: '0.81663'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.00821'
    scoring_system: epss
    scoring_elements: '0.81816'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94769'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94742'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94752'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94757'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94764'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94766'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94761'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94762'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94763'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94765'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.18014'
    scoring_system: epss
    scoring_elements: '0.94767'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.89294'
    scoring_system: epss
    scoring_elements: '0.99447'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.90104'
    scoring_system: epss
    scoring_elements: '0.99574'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.90104'
    scoring_system: epss
    scoring_elements: '0.99575'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.90104'
    scoring_system: epss
    scoring_elements: '0.99573'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.90104'
    scoring_system: epss
    scoring_elements: '0.99568'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.90104'
    scoring_system: epss
    scoring_elements: '0.99569'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.90104'
    scoring_system: epss
    scoring_elements: '0.99572'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: '0.90104'
    scoring_system: epss
    scoring_elements: '0.99571'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
  - score: High
    scoring_system: cvssv3.1
    scoring_elements:
    published_at: None
    url: https://curl.se/docs/CVE-2023-38545.html
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38545
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38545
  - score: High
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2845
  - score: High
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2846
weaknesses:
  - CWE-119
  - CWE-937
  - CWE-1035
  - CWE-787
  - CWE-122
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-38545.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-38545
    reference_type:
    reference_id:
  - url: https://curl.se/docs/CVE-2023-38545.html
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38545
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38546
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2024/Jan/34
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2024/Jan/37
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2024/Jan/38
    reference_type:
    reference_id:
  - url: https://forum.vmssoftware.com/viewtopic.php?f=8&t=8868
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/bcdannyboy/CVE-2023-38545
    reference_type:
    reference_id:
  - url: https://github.com/dbrugman/CVE-2023-38545-POC
    reference_type:
    reference_id:
  - url: https://github.com/UTsweetyfish/CVE-2023-38545
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/2187833
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OGMXNRNSJ4ETDK6FRNU3J7SABXPWCHSQ/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20231027-0009/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20240201-0005/
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT214036
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT214057
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT214058
    reference_type:
    reference_id:
  - url: https://support.apple.com/kb/HT214063
    reference_type:
    reference_id:
  - url: https://www.secpod.com/blog/high-severity-heap-buffer-overflow-vulnerability/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2241933
    reference_type:
    reference_id: 2241933
  - url: https://security.archlinux.org/AVG-2845
    reference_type:
    reference_id: AVG-2845
  - url: https://security.archlinux.org/AVG-2846
    reference_type:
    reference_id: AVG-2846
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:haxx:libcurl:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:haxx:libcurl:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:netapp:active_iq_unified_manager:-:*:*:*:*:vmware_vsphere:*:*
    reference_type:
    reference_id: cpe:2.3:a:netapp:active_iq_unified_manager:-:*:*:*:*:vmware_vsphere:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:netapp:active_iq_unified_manager:-:*:*:*:*:windows:*:*
    reference_type:
    reference_id: cpe:2.3:a:netapp:active_iq_unified_manager:-:*:*:*:*:windows:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:netapp:oncommand_insight:-:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:netapp:oncommand_insight:-:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:netapp:oncommand_workflow_automation:-:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:netapp:oncommand_workflow_automation:-:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38545
    reference_type:
    reference_id: CVE-2023-38545
  - url: https://security.gentoo.org/glsa/202310-12
    reference_type:
    reference_id: GLSA-202310-12
  - url: https://access.redhat.com/errata/RHSA-2023:5700
    reference_type:
    reference_id: RHSA-2023:5700
  - url: https://access.redhat.com/errata/RHSA-2023:5763
    reference_type:
    reference_id: RHSA-2023:5763
  - url: https://access.redhat.com/errata/RHSA-2023:6745
    reference_type:
    reference_id: RHSA-2023:6745
  - url: https://access.redhat.com/errata/RHSA-2023:7625
    reference_type:
    reference_id: RHSA-2023:7625
  - url: https://access.redhat.com/errata/RHSA-2023:7626
    reference_type:
    reference_id: RHSA-2023:7626
  - url: https://access.redhat.com/errata/RHSA-2024:0797
    reference_type:
    reference_id: RHSA-2024:0797
  - url: https://access.redhat.com/errata/RHSA-2024:2011
    reference_type:
    reference_id: RHSA-2024:2011
  - url: https://usn.ubuntu.com/6429-1/
    reference_type:
    reference_id: USN-6429-1
  - url: https://usn.ubuntu.com/6429-3/
    reference_type:
    reference_id: USN-6429-3
