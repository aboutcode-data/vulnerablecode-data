vulnerability_id: VCID-d1xs-6zqm-nfdq
aliases:
  - CVE-2025-59353
  - GHSA-255v-qv84-29p5
summary: |
  DragonFly's manager generates mTLS certificates for arbitrary IP addresses
  ### Impact
  A peer can obtain a valid TLS certificate for arbitrary IP addresses, effectively rendering the mTLS authentication useless. The issue is that the Manager’s Certificate gRPC service does not validate if the requested IP addresses “belong to” the peer requesting the certificate—that is, if the peer connects from the same IP address as the one provided in the certificate request.

  ```golang
  if addr, ok := p.Addr.(*net.TCPAddr); ok {
         ip = addr.IP.String()
  } else {
         ip, _, err = net.SplitHostPort(p.Addr.String())
         if err != nil {
               return nil, err
         }
  }
  // Parse csr.
  [skipped]
  // Check csr signature.
  // TODO check csr common name and so on.
  if err = csr.CheckSignature(); err != nil {
         return nil, err
  }
  [skipped]
  // TODO only valid for peer ip
  // BTW we need support both of ipv4 and ipv6.
  ips := csr.IPAddresses
  if len(ips) == 0 {
         // Add default connected ip.
         ips = []net.IP{net.ParseIP(ip)}
  }
  ```
  ### Patches

  - Dragonfy v2.1.0 and above.

  ### Workarounds

  There are no effective workarounds, beyond upgrading.

  ### References

  A third party security audit was performed by Trail of Bits, you can see the [full report](https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf).

  If you have any questions or comments about this advisory, please email us at [dragonfly-maintainers@googlegroups.com](mailto:dragonfly-maintainers@googlegroups.com).
severities:
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03908'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03988'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05378'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05408'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05427'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05407'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05216'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05184'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05264'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05269'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05438'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05464'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07881'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08393'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08448'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08449'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08406'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08464'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09522'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09562'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09559'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0955'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09612'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09504'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14686'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14808'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14761'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14678'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.16119'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.16131'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly
  - score: '7.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-09-18T17:44:07Z/
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: '7.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-255v-qv84-29p5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-255v-qv84-29p5
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-09-18T17:44:07Z/
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-255v-qv84-29p5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59353
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3969
weaknesses:
  - CWE-295
  - CWE-862
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-59353
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-255v-qv84-29p5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59353
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3969
    reference_type:
    reference_id:
