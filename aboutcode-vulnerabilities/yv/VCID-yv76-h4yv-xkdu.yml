vulnerability_id: VCID-yv76-h4yv-xkdu
aliases:
  - CVE-2025-64174
  - GHSA-qv78-c8hc-438r
summary: "OpenMage vulnerable to XSS in Admin Notifications\n### Summary\nOpenMage versions\
  \ v20.15.0 and earlier are affected by a stored Cross-Site Scripting (XSS) vulnerability that\
  \ could be abused by an admin with direct database access or the admin notification feed source\
  \ to inject malicious scripts into vulnerable fields. Malicious JavaScript may be executed\
  \ in a victim’s browser when they browse to the page containing the vulnerable field.\n\n\
  ### Details\nUnescaped translation strings and URLs are printed into contexts inside `app/code/core/Mage/Adminhtml/Block/Notification/Grid/Renderer/Actions.php`.\
  \ A malicious translation or polluted data can inject script. \n- Link labels use __() without\
  \ escaping.\n- ’deleteConfirm()’ embeds a message without escaping.\n\n### PoC\n1. Add XSS\
  \ to admin locale (e.g. app/locale/en_US/local.csv):\n    ```\n    \"Read Details\",\"<img\
  \ src=x onerror=alert(123)>\"\n    \"Mark as Read\",\"<script>alert(123)</script>\"\n    ```\n\
  2. Flush Cache. Make sure locale is set to en_US.\n3. Add any admin notification (e.g. via\
  \ test.php)\n     ```\n    <?php\n    require 'app/Mage.php';\n    Mage::app('admin');\n \
  \   Mage::getModel('adminnotification/inbox')->setData([\n        'severity'  => Mage_AdminNotification_Model_Inbox::SEVERITY_NOTICE,\n\
  \        'date_added' => now(),\n        'title' => 'XSS renderer test',\n        'description'\
  \ => 'Testing actions renderer',\n        'url' => 'https://example.com', // makes the \"\
  Read Details\" link appear\n        'is_read' => 0, // makes the \"Mark as Read\" link appear\n\
  \        'is_remove' => 0,\n    ])->save();\n    ```\n4. Open Admin → System → Notifications\
  \ → Inbox.\n5. Profit.\n\n### Impact\nThe vulnerability is only exploitable by an attacker\
  \ with administrative or translation privileges. Malicious JavaScript may be executed in a\
  \ victim’s browser when they browse to the admin page containing the vulnerable fields."
severities:
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19619'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64174
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19599'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64174
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-qv78-c8hc-438r
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/OpenMage/magento-lts
  - score: '4.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/OpenMage/magento-lts/commit/9d604f5489851c54a96fca31b0e13c414b0fb20a
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/OpenMage/magento-lts/commit/9d604f5489851c54a96fca31b0e13c414b0fb20a
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-11-06T21:19:51Z/
    published_at: None
    url: https://github.com/OpenMage/magento-lts/commit/9d604f5489851c54a96fca31b0e13c414b0fb20a
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/OpenMage/magento-lts/security/advisories/GHSA-qv78-c8hc-438r
  - score: '4.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/OpenMage/magento-lts/security/advisories/GHSA-qv78-c8hc-438r
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/OpenMage/magento-lts/security/advisories/GHSA-qv78-c8hc-438r
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-11-06T21:19:51Z/
    published_at: None
    url: https://github.com/OpenMage/magento-lts/security/advisories/GHSA-qv78-c8hc-438r
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-64174
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-64174
    reference_type:
    reference_id:
  - url: https://github.com/OpenMage/magento-lts
    reference_type:
    reference_id:
  - url: https://github.com/OpenMage/magento-lts/commit/9d604f5489851c54a96fca31b0e13c414b0fb20a
    reference_type:
    reference_id:
  - url: https://github.com/OpenMage/magento-lts/security/advisories/GHSA-qv78-c8hc-438r
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64174
    reference_type:
    reference_id: CVE-2025-64174
  - url: https://github.com/advisories/GHSA-qv78-c8hc-438r
    reference_type:
    reference_id: GHSA-qv78-c8hc-438r
