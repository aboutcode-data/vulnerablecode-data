vulnerability_id: VCID-5spv-2y7a-3qaa
aliases:
  - CVE-2024-50221
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  drm/amd/pm: Vangogh: Fix kernel memory out of bounds write

  KASAN reports that the GPU metrics table allocated in
  vangogh_tables_init() is not large enough for the memset done in
  smu_cmn_init_soft_gpu_metrics(). Condensed report follows:

  [   33.861314] BUG: KASAN: slab-out-of-bounds in smu_cmn_init_soft_gpu_metrics+0x73/0x200 [amdgpu]
  [   33.861799] Write of size 168 at addr ffff888129f59500 by task mangoapp/1067
  ...
  [   33.861808] CPU: 6 UID: 1000 PID: 1067 Comm: mangoapp Tainted: G        W          6.12.0-rc4 #356 1a56f59a8b5182eeaf67eb7cb8b13594dd23b544
  [   33.861816] Tainted: [W]=WARN
  [   33.861818] Hardware name: Valve Galileo/Galileo, BIOS F7G0107 12/01/2023
  [   33.861822] Call Trace:
  [   33.861826]  <TASK>
  [   33.861829]  dump_stack_lvl+0x66/0x90
  [   33.861838]  print_report+0xce/0x620
  [   33.861853]  kasan_report+0xda/0x110
  [   33.862794]  kasan_check_range+0xfd/0x1a0
  [   33.862799]  __asan_memset+0x23/0x40
  [   33.862803]  smu_cmn_init_soft_gpu_metrics+0x73/0x200 [amdgpu 13b1bc364ec578808f676eba412c20eaab792779]
  [   33.863306]  vangogh_get_gpu_metrics_v2_4+0x123/0xad0 [amdgpu 13b1bc364ec578808f676eba412c20eaab792779]
  [   33.864257]  vangogh_common_get_gpu_metrics+0xb0c/0xbc0 [amdgpu 13b1bc364ec578808f676eba412c20eaab792779]
  [   33.865682]  amdgpu_dpm_get_gpu_metrics+0xcc/0x110 [amdgpu 13b1bc364ec578808f676eba412c20eaab792779]
  [   33.866160]  amdgpu_get_gpu_metrics+0x154/0x2d0 [amdgpu 13b1bc364ec578808f676eba412c20eaab792779]
  [   33.867135]  dev_attr_show+0x43/0xc0
  [   33.867147]  sysfs_kf_seq_show+0x1f1/0x3b0
  [   33.867155]  seq_read_iter+0x3f8/0x1140
  [   33.867173]  vfs_read+0x76c/0xc50
  [   33.867198]  ksys_read+0xfb/0x1d0
  [   33.867214]  do_syscall_64+0x90/0x160
  ...
  [   33.867353] Allocated by task 378 on cpu 7 at 22.794876s:
  [   33.867358]  kasan_save_stack+0x33/0x50
  [   33.867364]  kasan_save_track+0x17/0x60
  [   33.867367]  __kasan_kmalloc+0x87/0x90
  [   33.867371]  vangogh_init_smc_tables+0x3f9/0x840 [amdgpu]
  [   33.867835]  smu_sw_init+0xa32/0x1850 [amdgpu]
  [   33.868299]  amdgpu_device_init+0x467b/0x8d90 [amdgpu]
  [   33.868733]  amdgpu_driver_load_kms+0x19/0xf0 [amdgpu]
  [   33.869167]  amdgpu_pci_probe+0x2d6/0xcd0 [amdgpu]
  [   33.869608]  local_pci_probe+0xda/0x180
  [   33.869614]  pci_device_probe+0x43f/0x6b0

  Empirically we can confirm that the former allocates 152 bytes for the
  table, while the latter memsets the 168 large block.

  Root cause appears that when GPU metrics tables for v2_4 parts were added
  it was not considered to enlarge the table to fit.

  The fix in this patch is rather "brute force" and perhaps later should be
  done in a smarter way, by extracting and consolidating the part version to
  size logic to a common helper, instead of brute forcing the largest
  possible allocation. Nevertheless, for now this works and fixes the out of
  bounds write.

  v2:
   * Drop impossible v3_0 case. (Mario)

  (cherry picked from commit 0880f58f9609f0200483a49429af0f050d281703)
severities:
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-50221.json
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.05904'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08246'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08403'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08424'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08425'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08423'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08393'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08426'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08266'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09974'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.0986'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09915'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09938'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09969'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09961'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09995'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14394'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14476'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14239'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14299'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.1897'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18962'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18957'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18936'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18926'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18938'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18947'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18967'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18977'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/4aa923a6e6406b43566ef6ac35a3d9a3197fa3e8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-11T15:09:21Z/
    published_at: None
    url: https://git.kernel.org/stable/c/4aa923a6e6406b43566ef6ac35a3d9a3197fa3e8
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/f111de0f010308949254ee1cc45df8e6b8e1d7d4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-11T15:09:21Z/
    published_at: None
    url: https://git.kernel.org/stable/c/f111de0f010308949254ee1cc45df8e6b8e1d7d4
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/f8fd9f0d57af4f8f48b383ec28287af85b47cb9f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-11T15:09:21Z/
    published_at: None
    url: https://git.kernel.org/stable/c/f8fd9f0d57af4f8f48b383ec28287af85b47cb9f
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50221
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-50221
weaknesses:
  - CWE-787
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-50221.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-50221
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4aa923a6e6406b43566ef6ac35a3d9a3197fa3e8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f111de0f010308949254ee1cc45df8e6b8e1d7d4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f8fd9f0d57af4f8f48b383ec28287af85b47cb9f
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2324895
    reference_type:
    reference_id: 2324895
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-50221
    reference_type:
    reference_id: CVE-2024-50221
  - url: https://usn.ubuntu.com/7276-1/
    reference_type:
    reference_id: USN-7276-1
  - url: https://usn.ubuntu.com/7277-1/
    reference_type:
    reference_id: USN-7277-1
  - url: https://usn.ubuntu.com/7310-1/
    reference_type:
    reference_id: USN-7310-1
  - url: https://usn.ubuntu.com/7449-1/
    reference_type:
    reference_id: USN-7449-1
  - url: https://usn.ubuntu.com/7449-2/
    reference_type:
    reference_id: USN-7449-2
  - url: https://usn.ubuntu.com/7450-1/
    reference_type:
    reference_id: USN-7450-1
  - url: https://usn.ubuntu.com/7451-1/
    reference_type:
    reference_id: USN-7451-1
  - url: https://usn.ubuntu.com/7452-1/
    reference_type:
    reference_id: USN-7452-1
  - url: https://usn.ubuntu.com/7453-1/
    reference_type:
    reference_id: USN-7453-1
  - url: https://usn.ubuntu.com/7468-1/
    reference_type:
    reference_id: USN-7468-1
