vulnerability_id: VCID-5srq-www5-zbav
aliases:
  - CVE-2025-24964
  - GHSA-9crc-q9x8-hgqq
summary: Vitest is a testing framework powered by Vite. Affected versions are subject to arbitrary
  remote Code Execution when accessing a malicious website while Vitest API server is listening
  by Cross-site WebSocket hijacking (CSWSH) attacks. When `api` option is enabled (Vitest UI
  enables it), Vitest starts a WebSocket server. This WebSocket server did not check Origin
  header and did not have any authorization mechanism and was vulnerable to CSWSH attacks. This
  WebSocket server has `saveTestFile` API that can edit a test file and `rerun` API that can
  rerun the tests. An attacker can execute arbitrary code by injecting a code in a test file
  by the `saveTestFile` API and then running that file by calling the `rerun` API. This vulnerability
  can result in remote code execution for users that are using Vitest serve API. This issue
  has been patched in versions 1.6.1, 2.1.9 and 3.0.5. Users are advised to upgrade. There are
  no known workarounds for this vulnerability.
severities:
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04974'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05033'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04981'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04966'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04954'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04958'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04985'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04995'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0502'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05019'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04967'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04937'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.07888'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.1824'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18206'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.1836'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.1838'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18404'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18419'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18387'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18377'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18384'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18401'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18435'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18431'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.18403'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20847'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.20821'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-9crc-q9x8-hgqq
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vitest-dev/vitest
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L32-L46
  - score: '9.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L32-L46
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L32-L46
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-04T19:45:47Z/
    published_at: None
    url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L32-L46
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L66-L76
  - score: '9.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L66-L76
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L66-L76
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-04T19:45:47Z/
    published_at: None
    url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L66-L76
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest/commit/191ef9e34c867d0efd04f49b3d38193a68e825dc
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vitest-dev/vitest/commit/191ef9e34c867d0efd04f49b3d38193a68e825dc
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest/commit/7ce9fbb4972d45c6fd34c843645ef6f549bbb241
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vitest-dev/vitest/commit/7ce9fbb4972d45c6fd34c843645ef6f549bbb241
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest/commit/e0fe1d81e2d4bcddb1c6ca3c5c3970d8ba697383
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vitest-dev/vitest/commit/e0fe1d81e2d4bcddb1c6ca3c5c3970d8ba697383
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq
  - score: '9.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-04T19:45:47Z/
    published_at: None
    url: https://github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-24964
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-24964
  - score: '9.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://vitest.dev/config/#api
  - score: '9.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://vitest.dev/config/#api
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://vitest.dev/config/#api
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-02-04T19:45:47Z/
    published_at: None
    url: https://vitest.dev/config/#api
weaknesses:
  - CWE-1385
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-24964
    reference_type:
    reference_id:
  - url: https://github.com/vitest-dev/vitest
    reference_type:
    reference_id:
  - url: https://github.com/vitest-dev/vitest/commit/191ef9e34c867d0efd04f49b3d38193a68e825dc
    reference_type:
    reference_id:
  - url: https://github.com/vitest-dev/vitest/commit/7ce9fbb4972d45c6fd34c843645ef6f549bbb241
    reference_type:
    reference_id:
  - url: https://github.com/vitest-dev/vitest/commit/e0fe1d81e2d4bcddb1c6ca3c5c3970d8ba697383
    reference_type:
    reference_id:
  - url: https://vitest.dev/config/#api
    reference_type:
    reference_id: '#api'
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-24964
    reference_type:
    reference_id: CVE-2025-24964
  - url: https://github.com/advisories/GHSA-9crc-q9x8-hgqq
    reference_type:
    reference_id: GHSA-9crc-q9x8-hgqq
  - url: https://github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq
    reference_type:
    reference_id: GHSA-9crc-q9x8-hgqq
  - url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L32-L46
    reference_type:
    reference_id: setup.ts#L32-L46
  - url: https://github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L66-L76
    reference_type:
    reference_id: setup.ts#L66-L76
