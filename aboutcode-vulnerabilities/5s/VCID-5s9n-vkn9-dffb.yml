vulnerability_id: VCID-5s9n-vkn9-dffb
aliases:
  - CVE-2024-43910
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  bpf: add missing check_func_arg_reg_off() to prevent out-of-bounds memory accesses

  Currently, it's possible to pass in a modified CONST_PTR_TO_DYNPTR to
  a global function as an argument. The adverse effects of this is that
  BPF helpers can continue to make use of this modified
  CONST_PTR_TO_DYNPTR from within the context of the global function,
  which can unintentionally result in out-of-bounds memory accesses and
  therefore compromise overall system stability i.e.

  [  244.157771] BUG: KASAN: slab-out-of-bounds in bpf_dynptr_data+0x137/0x140
  [  244.161345] Read of size 8 at addr ffff88810914be68 by task test_progs/302
  [  244.167151] CPU: 0 PID: 302 Comm: test_progs Tainted: G O E 6.10.0-rc3-00131-g66b586715063 #533
  [  244.174318] Call Trace:
  [  244.175787]  <TASK>
  [  244.177356]  dump_stack_lvl+0x66/0xa0
  [  244.179531]  print_report+0xce/0x670
  [  244.182314]  ? __virt_addr_valid+0x200/0x3e0
  [  244.184908]  kasan_report+0xd7/0x110
  [  244.187408]  ? bpf_dynptr_data+0x137/0x140
  [  244.189714]  ? bpf_dynptr_data+0x137/0x140
  [  244.192020]  bpf_dynptr_data+0x137/0x140
  [  244.194264]  bpf_prog_b02a02fdd2bdc5fa_global_call_bpf_dynptr_data+0x22/0x26
  [  244.198044]  bpf_prog_b0fe7b9d7dc3abde_callback_adjust_bpf_dynptr_reg_off+0x1f/0x23
  [  244.202136]  bpf_user_ringbuf_drain+0x2c7/0x570
  [  244.204744]  ? 0xffffffffc0009e58
  [  244.206593]  ? __pfx_bpf_user_ringbuf_drain+0x10/0x10
  [  244.209795]  bpf_prog_33ab33f6a804ba2d_user_ringbuf_callback_const_ptr_to_dynptr_reg_off+0x47/0x4b
  [  244.215922]  bpf_trampoline_6442502480+0x43/0xe3
  [  244.218691]  __x64_sys_prlimit64+0x9/0xf0
  [  244.220912]  do_syscall_64+0xc1/0x1d0
  [  244.223043]  entry_SYSCALL_64_after_hwframe+0x77/0x7f
  [  244.226458] RIP: 0033:0x7ffa3eb8f059
  [  244.228582] Code: 08 89 e8 5b 5d c3 66 2e 0f 1f 84 00 00 00 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d 8f 1d 0d 00 f7 d8 64 89 01 48
  [  244.241307] RSP: 002b:00007ffa3e9c6eb8 EFLAGS: 00000206 ORIG_RAX: 000000000000012e
  [  244.246474] RAX: ffffffffffffffda RBX: 00007ffa3e9c7cdc RCX: 00007ffa3eb8f059
  [  244.250478] RDX: 00007ffa3eb162b4 RSI: 0000000000000000 RDI: 00007ffa3e9c7fb0
  [  244.255396] RBP: 00007ffa3e9c6ed0 R08: 00007ffa3e9c76c0 R09: 0000000000000000
  [  244.260195] R10: 0000000000000000 R11: 0000000000000206 R12: ffffffffffffff80
  [  244.264201] R13: 000000000000001c R14: 00007ffc5d6b4260 R15: 00007ffa3e1c7000
  [  244.268303]  </TASK>

  Add a check_func_arg_reg_off() to the path in which the BPF verifier
  verifies the arguments of global function arguments, specifically
  those which take an argument of type ARG_PTR_TO_DYNPTR |
  MEM_RDONLY. Also, process_dynptr_func() doesn't appear to perform any
  explicit and strict type matching on the supplied register type, so
  let's also enforce that a register either type PTR_TO_STACK or
  CONST_PTR_TO_DYNPTR is by the caller.
severities:
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-43910.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12937'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.1275'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12718'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12881'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12887'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12926'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12961'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12922'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12953'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.1298'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12969'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.12858'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17107'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17124'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17146'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17141'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16905'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17151'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17135'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17106'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17097'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.1698'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17079'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17154'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '0.00222'
    scoring_system: epss
    scoring_elements: '0.30507'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-43910
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-43910
weaknesses:
  - CWE-787
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-43910.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-43910
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/13663a7c644bf1dedaf461d07252db5d76c8759a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ec2b9a5e11e51fea1bb04c1e7e471952e887e874
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2307883
    reference_type:
    reference_id: 2307883
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43910
    reference_type:
    reference_id: CVE-2024-43910
  - url: https://usn.ubuntu.com/7154-1/
    reference_type:
    reference_id: USN-7154-1
  - url: https://usn.ubuntu.com/7154-2/
    reference_type:
    reference_id: USN-7154-2
  - url: https://usn.ubuntu.com/7155-1/
    reference_type:
    reference_id: USN-7155-1
  - url: https://usn.ubuntu.com/7156-1/
    reference_type:
    reference_id: USN-7156-1
  - url: https://usn.ubuntu.com/7196-1/
    reference_type:
    reference_id: USN-7196-1
