vulnerability_id: VCID-stwt-3c6b-8uey
aliases:
  - CVE-2024-53089
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  LoongArch: KVM: Mark hrtimer to expire in hard interrupt context

  Like commit 2c0d278f3293f ("KVM: LAPIC: Mark hrtimer to expire in hard
  interrupt context") and commit 9090825fa9974 ("KVM: arm/arm64: Let the
  timer expire in hardirq context on RT"), On PREEMPT_RT enabled kernels
  unmarked hrtimers are moved into soft interrupt expiry mode by default.
  Then the timers are canceled from an preempt-notifier which is invoked
  with disabled preemption which is not allowed on PREEMPT_RT.

  The timer callback is short so in could be invoked in hard-IRQ context.
  So let the timer expire on hard-IRQ context even on -RT.

  This fix a "scheduling while atomic" bug for PREEMPT_RT enabled kernels:

   BUG: scheduling while atomic: qemu-system-loo/1011/0x00000002
   Modules linked in: amdgpu rfkill nft_fib_inet nft_fib_ipv4 nft_fib_ipv6 nft_fib nft_reject_inet nf_reject_ipv4 nf_reject_ipv6 nft_reject nft_ct nft_chain_nat ns
   CPU: 1 UID: 0 PID: 1011 Comm: qemu-system-loo Tainted: G        W          6.12.0-rc2+ #1774
   Tainted: [W]=WARN
   Hardware name: Loongson Loongson-3A5000-7A1000-1w-CRB/Loongson-LS3A5000-7A1000-1w-CRB, BIOS vUDK2018-LoongArch-V2.0.0-prebeta9 10/21/2022
   Stack : ffffffffffffffff 0000000000000000 9000000004e3ea38 9000000116744000
           90000001167475a0 0000000000000000 90000001167475a8 9000000005644830
           90000000058dc000 90000000058dbff8 9000000116747420 0000000000000001
           0000000000000001 6a613fc938313980 000000000790c000 90000001001c1140
           00000000000003fe 0000000000000001 000000000000000d 0000000000000003
           0000000000000030 00000000000003f3 000000000790c000 9000000116747830
           90000000057ef000 0000000000000000 9000000005644830 0000000000000004
           0000000000000000 90000000057f4b58 0000000000000001 9000000116747868
           900000000451b600 9000000005644830 9000000003a13998 0000000010000020
           00000000000000b0 0000000000000004 0000000000000000 0000000000071c1d
           ...
   Call Trace:
   [<9000000003a13998>] show_stack+0x38/0x180
   [<9000000004e3ea34>] dump_stack_lvl+0x84/0xc0
   [<9000000003a71708>] __schedule_bug+0x48/0x60
   [<9000000004e45734>] __schedule+0x1114/0x1660
   [<9000000004e46040>] schedule_rtlock+0x20/0x60
   [<9000000004e4e330>] rtlock_slowlock_locked+0x3f0/0x10a0
   [<9000000004e4f038>] rt_spin_lock+0x58/0x80
   [<9000000003b02d68>] hrtimer_cancel_wait_running+0x68/0xc0
   [<9000000003b02e30>] hrtimer_cancel+0x70/0x80
   [<ffff80000235eb70>] kvm_restore_timer+0x50/0x1a0 [kvm]
   [<ffff8000023616c8>] kvm_arch_vcpu_load+0x68/0x2a0 [kvm]
   [<ffff80000234c2d4>] kvm_sched_in+0x34/0x60 [kvm]
   [<9000000003a749a0>] finish_task_switch.isra.0+0x140/0x2e0
   [<9000000004e44a70>] __schedule+0x450/0x1660
   [<9000000004e45cb0>] schedule+0x30/0x180
   [<ffff800002354c70>] kvm_vcpu_block+0x70/0x120 [kvm]
   [<ffff800002354d80>] kvm_vcpu_halt+0x60/0x3e0 [kvm]
   [<ffff80000235b194>] kvm_handle_gspr+0x3f4/0x4e0 [kvm]
   [<ffff80000235f548>] kvm_handle_exit+0x1c8/0x260 [kvm]
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53089.json
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03451'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0449'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05154'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05161'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05116'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05132'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05139'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05177'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05188'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05635'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05618'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05615'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05626'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05645'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05628'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05633'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05636'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05647'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05614'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05574'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07293'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07325'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0742'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07429'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05606'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.04471'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.05578'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-53089
weaknesses:
  - CWE-664
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53089.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-53089
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-53089
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1e4c384a4be9ed1e069e24f388ab2ee9951b77b5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/73adbd92f3223dc0c3506822b71c6b259d5d537b
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2327892
    reference_type:
    reference_id: 2327892
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-53089
    reference_type:
    reference_id: CVE-2024-53089
  - url: https://usn.ubuntu.com/7276-1/
    reference_type:
    reference_id: USN-7276-1
  - url: https://usn.ubuntu.com/7277-1/
    reference_type:
    reference_id: USN-7277-1
  - url: https://usn.ubuntu.com/7310-1/
    reference_type:
    reference_id: USN-7310-1
  - url: https://usn.ubuntu.com/7449-1/
    reference_type:
    reference_id: USN-7449-1
  - url: https://usn.ubuntu.com/7449-2/
    reference_type:
    reference_id: USN-7449-2
  - url: https://usn.ubuntu.com/7450-1/
    reference_type:
    reference_id: USN-7450-1
  - url: https://usn.ubuntu.com/7451-1/
    reference_type:
    reference_id: USN-7451-1
  - url: https://usn.ubuntu.com/7452-1/
    reference_type:
    reference_id: USN-7452-1
  - url: https://usn.ubuntu.com/7453-1/
    reference_type:
    reference_id: USN-7453-1
  - url: https://usn.ubuntu.com/7468-1/
    reference_type:
    reference_id: USN-7468-1
