vulnerability_id: VCID-stxs-6xe6-s7ba
aliases:
  - CVE-2025-23135
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  RISC-V: KVM: Teardown riscv specific bits after kvm_exit

  During a module removal, kvm_exit invokes arch specific disable
  call which disables AIA. However, we invoke aia_exit before kvm_exit
  resulting in the following warning. KVM kernel module can't be inserted
  afterwards due to inconsistent state of IRQ.

  [25469.031389] percpu IRQ 31 still enabled on CPU0!
  [25469.031732] WARNING: CPU: 3 PID: 943 at kernel/irq/manage.c:2476 __free_percpu_irq+0xa2/0x150
  [25469.031804] Modules linked in: kvm(-)
  [25469.031848] CPU: 3 UID: 0 PID: 943 Comm: rmmod Not tainted 6.14.0-rc5-06947-g91c763118f47-dirty #2
  [25469.031905] Hardware name: riscv-virtio,qemu (DT)
  [25469.031928] epc : __free_percpu_irq+0xa2/0x150
  [25469.031976]  ra : __free_percpu_irq+0xa2/0x150
  [25469.032197] epc : ffffffff8007db1e ra : ffffffff8007db1e sp : ff2000000088bd50
  [25469.032241]  gp : ffffffff8131cef8 tp : ff60000080b96400 t0 : ff2000000088baf8
  [25469.032285]  t1 : fffffffffffffffc t2 : 5249207570637265 s0 : ff2000000088bd90
  [25469.032329]  s1 : ff60000098b21080 a0 : 037d527a15eb4f00 a1 : 037d527a15eb4f00
  [25469.032372]  a2 : 0000000000000023 a3 : 0000000000000001 a4 : ffffffff8122dbf8
  [25469.032410]  a5 : 0000000000000fff a6 : 0000000000000000 a7 : ffffffff8122dc10
  [25469.032448]  s2 : ff60000080c22eb0 s3 : 0000000200000022 s4 : 000000000000001f
  [25469.032488]  s5 : ff60000080c22e00 s6 : ffffffff80c351c0 s7 : 0000000000000000
  [25469.032582]  s8 : 0000000000000003 s9 : 000055556b7fb490 s10: 00007ffff0e12fa0
  [25469.032621]  s11: 00007ffff0e13e9a t3 : ffffffff81354ac7 t4 : ffffffff81354ac7
  [25469.032664]  t5 : ffffffff81354ac8 t6 : ffffffff81354ac7
  [25469.032698] status: 0000000200000100 badaddr: ffffffff8007db1e cause: 0000000000000003
  [25469.032738] [<ffffffff8007db1e>] __free_percpu_irq+0xa2/0x150
  [25469.032797] [<ffffffff8007dbfc>] free_percpu_irq+0x30/0x5e
  [25469.032856] [<ffffffff013a57dc>] kvm_riscv_aia_exit+0x40/0x42 [kvm]
  [25469.033947] [<ffffffff013b4e82>] cleanup_module+0x10/0x32 [kvm]
  [25469.035300] [<ffffffff8009b150>] __riscv_sys_delete_module+0x18e/0x1fc
  [25469.035374] [<ffffffff8000c1ca>] syscall_handler+0x3a/0x46
  [25469.035456] [<ffffffff809ec9a4>] do_trap_ecall_u+0x72/0x134
  [25469.035536] [<ffffffff809f5e18>] handle_exception+0x148/0x156

  Invoke aia_exit and other arch specific cleanup functions after kvm_exit
  so that disable gets a chance to be called first before exit.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-23135.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02545'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02531'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02537'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.0253'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04294'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04283'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04247'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04275'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04273'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04281'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04282'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-23135.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-23135
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1521cc04f0b6e737ff30105aa57fa9dde8493231
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1edb2de48616b11ee05e9a65d74c70abcb6d9939
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2d117e67f318303f6ab699a5511d1fac3f170545
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2360267
    reference_type:
    reference_id: 2360267
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-23135
    reference_type:
    reference_id: CVE-2025-23135
