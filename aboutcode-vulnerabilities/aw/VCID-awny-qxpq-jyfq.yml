vulnerability_id: VCID-awny-qxpq-jyfq
aliases:
  - CVE-2025-54418
  - GHSA-9952-gv64-x94c
summary: CodeIgniter is a PHP full-stack web framework. A command injection vulnerability present
  in versions prior to 4.6.2 affects applications that use the ImageMagick handler for image
  processing (`imagick` as the image library) and either allow file uploads with user-controlled
  filenames and process uploaded images using the `resize()` method or use the `text()` method
  with user-controlled text content or options. An attacker can upload a file with a malicious
  filename containing shell metacharacters that get executed when the image is processed or
  provide malicious text content or options that get executed when adding text to images Users
  should upgrade to v4.6.2 or later to receive a patch. As a workaround, switch to the GD image
  handler (`gd`, the default handler), which is not affected by either vulnerability. For file
  upload scenarios, instead of using user-provided filenames, generate random names to eliminate
  the attack vector with `getRandomName()` when using the `move()` method, or use the `store()`
  method, which automatically generates safe filenames. For text operations, if one must use
  ImageMagick with user-controlled text, sanitize the input to only allow safe characters and
  validate/restrict text options.
severities:
  - score: '0.00357'
    scoring_system: epss
    scoring_elements: '0.57413'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00357'
    scoring_system: epss
    scoring_elements: '0.57427'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59632'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59679'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59727'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59718'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59699'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59652'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.5966'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59667'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59844'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59832'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59836'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59705'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59715'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59724'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59711'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00396'
    scoring_system: epss
    scoring_elements: '0.59716'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00407'
    scoring_system: epss
    scoring_elements: '0.60253'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00407'
    scoring_system: epss
    scoring_elements: '0.60299'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00407'
    scoring_system: epss
    scoring_elements: '0.60298'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00407'
    scoring_system: epss
    scoring_elements: '0.60286'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00407'
    scoring_system: epss
    scoring_elements: '0.60276'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00407'
    scoring_system: epss
    scoring_elements: '0.60297'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00407'
    scoring_system: epss
    scoring_elements: '0.60312'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.6085'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.6081'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60785'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60787'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60824'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60834'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60826'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60819'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60802'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60838'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60844'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60852'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60853'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.60866'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.61012'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.61008'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://cwe.mitre.org/data/definitions/78.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cwe.mitre.org/data/definitions/78.html
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-07-28T17:19:03Z/
    published_at: None
    url: https://cwe.mitre.org/data/definitions/78.html
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-9952-gv64-x94c
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/codeigniter4/CodeIgniter4
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/codeigniter4/CodeIgniter4
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/codeigniter4/CodeIgniter4/commit/e18120bff1da691e1d15ffc1bf553ae7411762c0
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/codeigniter4/CodeIgniter4/commit/e18120bff1da691e1d15ffc1bf553ae7411762c0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-07-28T17:19:03Z/
    published_at: None
    url: https://github.com/codeigniter4/CodeIgniter4/commit/e18120bff1da691e1d15ffc1bf553ae7411762c0
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/codeigniter4/CodeIgniter4/security/advisories/GHSA-9952-gv64-x94c
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/codeigniter4/CodeIgniter4/security/advisories/GHSA-9952-gv64-x94c
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/codeigniter4/CodeIgniter4/security/advisories/GHSA-9952-gv64-x94c
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-07-28T17:19:03Z/
    published_at: None
    url: https://github.com/codeigniter4/CodeIgniter4/security/advisories/GHSA-9952-gv64-x94c
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-54418
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-54418
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://owasp.org/www-community/attacks/Command_Injection
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://owasp.org/www-community/attacks/Command_Injection
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-07-28T17:19:03Z/
    published_at: None
    url: https://owasp.org/www-community/attacks/Command_Injection
weaknesses:
  - CWE-78
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-54418
    reference_type:
    reference_id:
  - url: https://cwe.mitre.org/data/definitions/78.html
    reference_type:
    reference_id:
  - url: https://github.com/codeigniter4/CodeIgniter4
    reference_type:
    reference_id:
  - url: https://github.com/codeigniter4/CodeIgniter4/commit/e18120bff1da691e1d15ffc1bf553ae7411762c0
    reference_type:
    reference_id:
  - url: https://owasp.org/www-community/attacks/Command_Injection
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:codeigniter:codeigniter:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:codeigniter:codeigniter:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54418
    reference_type:
    reference_id: CVE-2025-54418
  - url: https://github.com/advisories/GHSA-9952-gv64-x94c
    reference_type:
    reference_id: GHSA-9952-gv64-x94c
  - url: https://github.com/codeigniter4/CodeIgniter4/security/advisories/GHSA-9952-gv64-x94c
    reference_type:
    reference_id: GHSA-9952-gv64-x94c
