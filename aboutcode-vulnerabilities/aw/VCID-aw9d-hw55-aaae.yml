vulnerability_id: VCID-aw9d-hw55-aaae
aliases:
  - CVE-2021-47350
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  powerpc/mm: Fix lockup on kernel exec fault

  The powerpc kernel is not prepared to handle exec faults from kernel.
  Especially, the function is_exec_fault() will return 'false' when an
  exec fault is taken by kernel, because the check is based on reading
  current->thread.regs->trap which contains the trap from user.

  For instance, when provoking a LKDTM EXEC_USERSPACE test,
  current->thread.regs->trap is set to SYSCALL trap (0xc00), and
  the fault taken by the kernel is not seen as an exec fault by
  set_access_flags_filter().

  Commit d7df2443cd5f ("powerpc/mm: Fix spurious segfaults on radix
  with autonuma") made it clear and handled it properly. But later on
  commit d3ca587404b3 ("powerpc/mm: Fix reporting of kernel execute
  faults") removed that handling, introducing test based on error_code.
  And here is the problem, because on the 603 all upper bits of SRR1
  get cleared when the TLB instruction miss handler bails out to ISI.

  Until commit cbd7e6ca0210 ("powerpc/fault: Avoid heavy
  search_exception_tables() verification"), an exec fault from kernel
  at a userspace address was indirectly caught by the lack of entry for
  that address in the exception tables. But after that commit the
  kernel mainly relies on KUAP or on core mm handling to catch wrong
  user accesses. Here the access is not wrong, so mm handles it.
  It is a minor fault because PAGE_EXEC is not set,
  set_access_flags_filter() should set PAGE_EXEC and voila.
  But as is_exec_fault() returns false as explained in the beginning,
  set_access_flags_filter() bails out without setting PAGE_EXEC flag,
  which leads to a forever minor exec fault.

  As the kernel is not prepared to handle such exec faults, the thing to
  do is to fire in bad_kernel_fault() for any exec fault taken by the
  kernel, as it was prior to commit d3ca587404b3.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47350.json
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06375'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06282'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06257'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04783'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04796'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.048'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04816'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.0481'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04818'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04811'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04823'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04847'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.0483'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04822'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.04809'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06268'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06258'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06262'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06248'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06253'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06295'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06315'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06332'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06327'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06259'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06219'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.12012'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11853'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11891'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '0.00204'
    scoring_system: epss
    scoring_elements: '0.28496'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/500f81cec9f1bfa5210aa9dd5ba9a06e22f62a35
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:09:38Z/
    published_at: None
    url: https://git.kernel.org/stable/c/500f81cec9f1bfa5210aa9dd5ba9a06e22f62a35
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/8a96ec5ebf96ad8e2ba7b1b34103a0be5140fc70
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:09:38Z/
    published_at: None
    url: https://git.kernel.org/stable/c/8a96ec5ebf96ad8e2ba7b1b34103a0be5140fc70
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/a82471a14aad90f79d1608d2bcbb019f0ffb53f0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:09:38Z/
    published_at: None
    url: https://git.kernel.org/stable/c/a82471a14aad90f79d1608d2bcbb019f0ffb53f0
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/cd5d5e602f502895e47e18cd46804d6d7014e65c
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:09:38Z/
    published_at: None
    url: https://git.kernel.org/stable/c/cd5d5e602f502895e47e18cd46804d6d7014e65c
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/d2e52d4664097a6c1f591d869ec594bd7a0d4925
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:09:38Z/
    published_at: None
    url: https://git.kernel.org/stable/c/d2e52d4664097a6c1f591d869ec594bd7a0d4925
weaknesses:
  - CWE-667
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47350.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47350
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47350
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/500f81cec9f1bfa5210aa9dd5ba9a06e22f62a35
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8a96ec5ebf96ad8e2ba7b1b34103a0be5140fc70
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a82471a14aad90f79d1608d2bcbb019f0ffb53f0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cd5d5e602f502895e47e18cd46804d6d7014e65c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d2e52d4664097a6c1f591d869ec594bd7a0d4925
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2282403
    reference_type:
    reference_id: 2282403
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47350
    reference_type:
    reference_id: CVE-2021-47350
