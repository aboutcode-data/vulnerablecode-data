vulnerability_id: VCID-ttnd-r7cx-aaaf
aliases:
  - CVE-2023-41039
  - GHSA-xjw2-6jm9-rf67
  - PYSEC-0000-CVE-2023-41039
  - PYSEC-2023-159
summary: |
  RestrictedPython is a restricted execution environment for Python to run untrusted code. Python's "format" functionality allows someone controlling the format string to "read" all objects accessible through recursive attribute lookup and subscription from objects he can access. This can lead to critical information disclosure. With `RestrictedPython`, the format functionality is available via the `format` and `format_map` methods of `str` (and `unicode`) (accessed either via the class or its instances) and via `string.Formatter`. All known versions of `RestrictedPython` are vulnerable. This issue has been addressed in commit `4134aedcff1` which has been included in the 5.4 and 6.2 releases. Users are advised to upgrade. There are no known workarounds for this vulnerability.

severities:
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33179'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33343'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33353'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33333'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32244'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33709'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32541'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32626'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32651'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32761'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32763'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32764'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32785'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32810'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33035'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33092'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.3673'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36733'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36704'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36726'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.32319'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.32352'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.32363'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.32333'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.32318'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.32294'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36638'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36725'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36824'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36819'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36678'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36772'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36699'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.36737'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.0015'
    scoring_system: epss
    scoring_elements: '0.3672'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.32852'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.32791'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.3274'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.3289'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.32906'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.329'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.32921'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.32884'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.32862'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: '0.00367'
    scoring_system: epss
    scoring_elements: '0.4165'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xjw2-6jm9-rf67
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/commit/4134aedcff17c977da7717693ed89ce56d54c120
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/commit/4134aedcff17c977da7717693ed89ce56d54c120
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/commit/4134aedcff17c977da7717693ed89ce56d54c120
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-xjw2-6jm9-rf67
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-xjw2-6jm9-rf67
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-xjw2-6jm9-rf67
  - score: '7.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-41039
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-41039
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-74
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-41039
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41039
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/RestrictedPython
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/RestrictedPython/commit/4134aedcff17c977da7717693ed89ce56d54c120
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-xjw2-6jm9-rf67
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:zope:restrictedpython:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:zope:restrictedpython:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41039
    reference_type:
    reference_id: CVE-2023-41039
  - url: https://github.com/advisories/GHSA-xjw2-6jm9-rf67
    reference_type:
    reference_id: GHSA-xjw2-6jm9-rf67
  - url: https://usn.ubuntu.com/7355-1/
    reference_type:
    reference_id: USN-7355-1
