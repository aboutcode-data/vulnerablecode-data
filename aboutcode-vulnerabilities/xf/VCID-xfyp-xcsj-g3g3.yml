vulnerability_id: VCID-xfyp-xcsj-g3g3
aliases:
  - CVE-2025-66310
  - GHSA-7g78-5g5g-mvfj
summary: "Grav vulnerable to Cross-Site Scripting (XSS) Stored endpoint `/admin/pages/[page]`\
  \ parameter `data[header][template]` in Advanced Tab\n## Summary\n\nA Stored Cross-Site Scripting\
  \ (XSS) vulnerability was identified in the `/admin/pages/[page]` endpoint of the _Grav_ application.\
  \ This vulnerability allows attackers to inject malicious scripts into the `data[header][template]`\
  \ parameter. The script is saved within the page's frontmatter and executed automatically\
  \ whenever the affected content is rendered in the administrative interface or frontend view.\n\
  \n---\n\n## Details\n\n**Vulnerable Endpoint:** `POST /admin/pages/[page]`  \n**Parameter:**\
  \ `data[header][template]`\n\nThe application fails to properly sanitize user input in the\
  \ `data[header][template]` field, which is stored in the YAML frontmatter of the page. An\
  \ attacker can inject JavaScript code using this field, and the payload is rendered and executed\
  \ when the page is accessed, especially within the Admin Panel interface.\n\n---\n\n## PoC\n\
  \n**Payload:**\n\n`<script>alert('PoC-XXS73')</script>`\n\n### Steps to Reproduce:\n\n1. Log\
  \ in to the _Grav_ Admin Panel and navigate to **Pages**.\n    \n2. Create a new page or edit\
  \ an existing one.\n    \n3. In the **Advanced > Template** field (which maps to `data[header][template]`),\
  \ insert the payload:\n![image](https://github.com/user-attachments/assets/fc92aa09-e363-4422-b577-63aa27097886)\n\
  \n4. Save the page.\n    \n5. Return to the **Pages** section and click on the **three-dot\
  \ menu** of the affected page: \n![image](https://github.com/user-attachments/assets/ea6a023b-f838-4700-b2a8-8dcfbca37f00)\n\
  \n6. The stored XSS payload is triggered, and the script is executed in the browser:\n![image](https://github.com/user-attachments/assets/8cf1cca5-ce8f-4b09-a57c-0848090918ac)\n\
  ---\n\n## Impact\n\nStored XSS vulnerabilities can have serious consequences, including:\n\
  \n- **Session hijacking:** Capturing admin session cookies or tokens\n    \n- **Malware delivery:**\
  \ Executing scripts that load malicious resources\n    \n- **Credential theft:** Creating\
  \ fake login prompts to steal usernames/passwords\n    \n- **Data exposure:** Reading sensitive\
  \ metadata or page contents\n    \n- **Privilege escalation:** Performing actions as an authenticated\
  \ user\n    \n- **Website defacement:** Altering visual or functional elements of the site\n\
  \    \n- **Reputation damage:** Undermining user trust in the application\n\nbyÂ [CVE-Hunters](https://github.com/Sec-Dojo-Cyber-House/cve-hunters)"
severities:
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08959'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66310
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08919'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66310
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-7g78-5g5g-mvfj
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav
  - score: '6.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:L/VI:L/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-02T16:03:09Z/
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-7g78-5g5g-mvfj
  - score: '6.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:L/VI:L/VA:N/SC:H/SI:H/SA:H
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-7g78-5g5g-mvfj
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-7g78-5g5g-mvfj
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-02T16:03:09Z/
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-7g78-5g5g-mvfj
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66310
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-66310
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-7g78-5g5g-mvfj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66310
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-7g78-5g5g-mvfj
    reference_type:
    reference_id: GHSA-7g78-5g5g-mvfj
