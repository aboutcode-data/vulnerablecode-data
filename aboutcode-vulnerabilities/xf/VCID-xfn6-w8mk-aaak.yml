vulnerability_id: VCID-xfn6-w8mk-aaak
aliases:
  - CVE-2023-37271
  - GHSA-wqc8-x2pr-7jqh
  - PYSEC-2023-118
summary: RestrictedPython is a tool that helps to define a subset of the Python language which
  allows users to provide a program input into a trusted environment. RestrictedPython does
  not check access to stack frames and their attributes. Stack frames are accessible within
  at least generators and generator expressions, which are allowed inside RestrictedPython.
  Prior to versions 6.1 and 5.3, an attacker with access to a RestrictedPython environment can
  write code that gets the current stack frame in a generator and then walk the stack all the
  way beyond the RestrictedPython invocation boundary, thus breaking out of the restricted sandbox
  and potentially allowing arbitrary code execution in the Python interpreter. All RestrictedPython
  deployments that allow untrusted users to write Python code in the RestrictedPython environment
  are at risk. In terms of Zope and Plone, this would mean deployments where the administrator
  allows untrusted users to create and/or edit objects of type `Script (Python)`, `DTML Method`,
  `DTML Document` or `Zope Page Template`. This is a non-default configuration and likely to
  be extremely rare. The problem has been fixed in versions 6.1 and 5.3.
severities:
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.52116'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.52263'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.52287'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.52345'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.51252'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.51274'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.52076'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.52094'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.51646'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.51925'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.51996'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.52016'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.52085'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00148'
    scoring_system: epss
    scoring_elements: '0.52079'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.52292'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00155'
    scoring_system: epss
    scoring_elements: '0.52577'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48893'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48919'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48942'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48933'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48932'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.46297'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48915'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48903'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.46312'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.46335'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.46354'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.46327'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.46316'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.489'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48987'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48986'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48967'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48906'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48864'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48857'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00263'
    scoring_system: epss
    scoring_elements: '0.46987'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00263'
    scoring_system: epss
    scoring_elements: '0.4687'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00263'
    scoring_system: epss
    scoring_elements: '0.46841'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00263'
    scoring_system: epss
    scoring_elements: '0.46976'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00263'
    scoring_system: epss
    scoring_elements: '0.46981'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00263'
    scoring_system: epss
    scoring_elements: '0.46995'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00263'
    scoring_system: epss
    scoring_elements: '0.47007'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00263'
    scoring_system: epss
    scoring_elements: '0.46954'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00263'
    scoring_system: epss
    scoring_elements: '0.46979'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: '0.00756'
    scoring_system: epss
    scoring_elements: '0.5792'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-wqc8-x2pr-7jqh
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/restrictedpython/PYSEC-2023-118.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/restrictedpython/PYSEC-2023-118.yaml
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/commit/c8eca66ae49081f0016d2e1f094c3d72095ef531
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/commit/c8eca66ae49081f0016d2e1f094c3d72095ef531
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-11-07T17:09:29Z/
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/commit/c8eca66ae49081f0016d2e1f094c3d72095ef531
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-wqc8-x2pr-7jqh
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-wqc8-x2pr-7jqh
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-wqc8-x2pr-7jqh
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-11-07T17:09:29Z/
    published_at: None
    url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-wqc8-x2pr-7jqh
  - score: '9.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-37271
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-37271
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-913
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-37271
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-37271
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/restrictedpython/PYSEC-2023-118.yaml
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/RestrictedPython
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/RestrictedPython/commit/c8eca66ae49081f0016d2e1f094c3d72095ef531
    reference_type:
    reference_id:
  - url: https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-wqc8-x2pr-7jqh
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1041429
    reference_type:
    reference_id: 1041429
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:zope:restrictedpython:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:zope:restrictedpython:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:zope:restrictedpython:6.0:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:zope:restrictedpython:6.0:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:zope:restrictedpython:6.0:a1.dev0:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:zope:restrictedpython:6.0:a1.dev0:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-37271
    reference_type:
    reference_id: CVE-2023-37271
  - url: https://github.com/advisories/GHSA-wqc8-x2pr-7jqh
    reference_type:
    reference_id: GHSA-wqc8-x2pr-7jqh
  - url: https://usn.ubuntu.com/7355-1/
    reference_type:
    reference_id: USN-7355-1
