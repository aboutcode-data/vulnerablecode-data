vulnerability_id: VCID-n3q3-xsf3-m3e9
aliases:
  - CVE-2025-43864
  - GHSA-f46r-rw29-r322
summary: "React Router allows a DoS via cache poisoning by forcing SPA mode\n## Summary\nAfter\
  \ some research, it turns out that it is possible to force an application to switch to SPA\
  \ mode by adding a header to the request. If the application uses SSR and is forced to switch\
  \ to SPA, this causes an error that completely corrupts the page. If a cache system is in\
  \ place, this allows the response containing the error to be cached, resulting in a cache\
  \ poisoning that strongly impacts the availability of the application.\n\n## Details\nThe\
  \ vulnerable header is `X-React-Router-SPA-Mode`; adding it to a request sent to a page/endpoint\
  \ using a loader throws an error. Here is [the vulnerable code](https://github.com/remix-run/react-router/blob/e6c53a0130559b4a9bd47f9cf76ea5b08a69868a/packages/react-router/lib/server-runtime/server.ts#L407)\
  \ :\n\n<img width=\"672\" alt=\"Capture d’écran 2025-04-07 à 08 28 20\" src=\"https://github.com/user-attachments/assets/0a0e9c41-70fd-4dba-9061-892dd6797291\"\
  \ />\n\nTo use the header, React-router must be used in Framework mode, and for the attack\
  \ to be possible the target page must use a loader.\n\n## Steps to reproduce \nVersions used\
  \ for our PoC: \n- \"@react-router/node\": \"^7.5.0\",\n- \"@react-router/serve\": \"^7.5.0\"\
  ,\n- \"react\": \"^19.0.0\"\n- \"react-dom\": \"^19.0.0\"\n- \"react-router\": \"^7.5.0\"\n\
  \n1. Install React-Router with its default configuration in Framework mode (https://reactrouter.com/start/framework/installation)\n\
  2. Add a simple page using a loader (example: `routes/ssr`)\n\n![image](https://github.com/user-attachments/assets/d7d04e86-c549-4f4a-9200-2d1b6ac96aad)\n\
  \n3. Send a request to the endpoint using the loader (`/ssr` in our case) adding the following\
  \ header:\n```\nX-React-Router-SPA-Mode: yes\n```\n\nNotice the difference between a request\
  \ with and without the header;\n\n**Normal request**\n![Capture d’écran 2025-04-07 à 08\
  \ 36 27](https://github.com/user-attachments/assets/da372b70-7c68-41c1-aac1-e5be94f22526)\n\
  \n**With the header**\n![Capture d’écran 2025-04-07 à 08 37 01](https://github.com/user-attachments/assets/98101720-cb5b-44e9-bff5-463c0b4dab2a)\n\
  ![image](https://github.com/user-attachments/assets/c16a101e-688c-4757-9e05-61308ed8a2de)\n\
  \n## Impact\nIf a system cache is in place, it is possible to poison the response by completely\
  \ altering its content (*by an error message*), strongly impacting its availability, making\
  \ the latter impractical via a cache-poisoning attack.\n\n## Credits\n- Rachid Allam (zhero;)\n\
  - Yasser Allam (inzo_)"
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-43864.json
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10545'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-43864
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10477'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-43864
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10531'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-43864
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10553'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-43864
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-f46r-rw29-r322
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/remix-run/react-router
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/remix-run/react-router
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/remix-run/react-router/blob/e6c53a0130559b4a9bd47f9cf76ea5b08a69868a/packages/react-router/lib/server-runtime/server.ts#L407
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/remix-run/react-router/blob/e6c53a0130559b4a9bd47f9cf76ea5b08a69868a/packages/react-router/lib/server-runtime/server.ts#L407
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-25T15:17:49Z/
    published_at: None
    url: https://github.com/remix-run/react-router/blob/e6c53a0130559b4a9bd47f9cf76ea5b08a69868a/packages/react-router/lib/server-runtime/server.ts#L407
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/remix-run/react-router/commit/c84302972a152d851cf5dd859ff332b354b70111
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/remix-run/react-router/commit/c84302972a152d851cf5dd859ff332b354b70111
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-25T15:17:49Z/
    published_at: None
    url: https://github.com/remix-run/react-router/commit/c84302972a152d851cf5dd859ff332b354b70111
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/remix-run/react-router/security/advisories/GHSA-f46r-rw29-r322
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/remix-run/react-router/security/advisories/GHSA-f46r-rw29-r322
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/remix-run/react-router/security/advisories/GHSA-f46r-rw29-r322
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-04-25T15:17:49Z/
    published_at: None
    url: https://github.com/remix-run/react-router/security/advisories/GHSA-f46r-rw29-r322
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-43864
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-43864
weaknesses:
  - CWE-755
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-43864.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-43864
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/remix-run/react-router
    reference_type:
    reference_id:
  - url: https://github.com/remix-run/react-router/blob/e6c53a0130559b4a9bd47f9cf76ea5b08a69868a/packages/react-router/lib/server-runtime/server.ts#L407
    reference_type:
    reference_id:
  - url: https://github.com/remix-run/react-router/commit/c84302972a152d851cf5dd859ff332b354b70111
    reference_type:
    reference_id:
  - url: https://github.com/remix-run/react-router/security/advisories/GHSA-f46r-rw29-r322
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2362232
    reference_type:
    reference_id: 2362232
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-43864
    reference_type:
    reference_id: CVE-2025-43864
  - url: https://github.com/advisories/GHSA-f46r-rw29-r322
    reference_type:
    reference_id: GHSA-f46r-rw29-r322
