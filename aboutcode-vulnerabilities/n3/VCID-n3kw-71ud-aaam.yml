vulnerability_id: VCID-n3kw-71ud-aaam
aliases:
  - CVE-2023-52630
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  blk-iocost: Fix an UBSAN shift-out-of-bounds warning

  When iocg_kick_delay() is called from a CPU different than the one which set
  the delay, @now may be in the past of @iocg->delay_at leading to the
  following warning:

    UBSAN: shift-out-of-bounds in block/blk-iocost.c:1359:23
    shift exponent 18446744073709 is too large for 64-bit type 'u64' (aka 'unsigned long long')
    ...
    Call Trace:
     <TASK>
     dump_stack_lvl+0x79/0xc0
     __ubsan_handle_shift_out_of_bounds+0x2ab/0x300
     iocg_kick_delay+0x222/0x230
     ioc_rqos_merge+0x1d7/0x2c0
     __rq_qos_merge+0x2c/0x80
     bio_attempt_back_merge+0x83/0x190
     blk_attempt_plug_merge+0x101/0x150
     blk_mq_submit_bio+0x2b1/0x720
     submit_bio_noacct_nocheck+0x320/0x3e0
     __swap_writepage+0x2ab/0x9d0

  The underflow itself doesn't really affect the behavior in any meaningful
  way; however, the past timestamp may exaggerate the delay amount calculated
  later in the code, which shouldn't be a material problem given the nature of
  the delay mechanism.

  If @now is in the past, this CPU is racing another CPU which recently set up
  the delay and there's nothing this CPU can contribute w.r.t. the delay.
  Let's bail early from iocg_kick_delay() in such cases.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52630.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-191
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52630.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52630
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52630
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1e4d3f8bd880e02932a9ea179f90bfa74fd2e899
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/27b216130e64651e76ed583742a1b4e4d08a67c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2a427b49d02995ea4a6ff93a1432c40fa4d36821
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9f56f38331171c9a19754004f0664686d67ee48d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cd33b330cb21675189e747953845f5c3689e4912
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e5dc63f01e027721c29f82069f7e97e2149fa131
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2272771
    reference_type:
    reference_id: 2272771
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52630
    reference_type:
    reference_id: CVE-2023-52630
