vulnerability_id: VCID-fdq2-tzng-aaak
aliases:
  - CVE-2024-26738
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  powerpc/pseries/iommu: DLPAR add doesn't completely initialize pci_controller

  When a PCI device is dynamically added, the kernel oopses with a NULL
  pointer dereference:

    BUG: Kernel NULL pointer dereference on read at 0x00000030
    Faulting instruction address: 0xc0000000006bbe5c
    Oops: Kernel access of bad area, sig: 11 [#1]
    LE PAGE_SIZE=64K MMU=Radix SMP NR_CPUS=2048 NUMA pSeries
    Modules linked in: rpadlpar_io rpaphp rpcsec_gss_krb5 auth_rpcgss nfsv4 dns_resolver nfs lockd grace fscache netfs xsk_diag bonding nft_compat nf_tables nfnetlink rfkill binfmt_misc dm_multipath rpcrdma sunrpc rdma_ucm ib_srpt ib_isert iscsi_target_mod target_core_mod ib_umad ib_iser libiscsi scsi_transport_iscsi ib_ipoib rdma_cm iw_cm ib_cm mlx5_ib ib_uverbs ib_core pseries_rng drm drm_panel_orientation_quirks xfs libcrc32c mlx5_core mlxfw sd_mod t10_pi sg tls ibmvscsi ibmveth scsi_transport_srp vmx_crypto pseries_wdt psample dm_mirror dm_region_hash dm_log dm_mod fuse
    CPU: 17 PID: 2685 Comm: drmgr Not tainted 6.7.0-203405+ #66
    Hardware name: IBM,9080-HEX POWER10 (raw) 0x800200 0xf000006 of:IBM,FW1060.00 (NH1060_008) hv:phyp pSeries
    NIP:  c0000000006bbe5c LR: c000000000a13e68 CTR: c0000000000579f8
    REGS: c00000009924f240 TRAP: 0300   Not tainted  (6.7.0-203405+)
    MSR:  8000000000009033 <SF,EE,ME,IR,DR,RI,LE>  CR: 24002220  XER: 20040006
    CFAR: c000000000a13e64 DAR: 0000000000000030 DSISR: 40000000 IRQMASK: 0
    ...
    NIP sysfs_add_link_to_group+0x34/0x94
    LR  iommu_device_link+0x5c/0x118
    Call Trace:
     iommu_init_device+0x26c/0x318 (unreliable)
     iommu_device_link+0x5c/0x118
     iommu_init_device+0xa8/0x318
     iommu_probe_device+0xc0/0x134
     iommu_bus_notifier+0x44/0x104
     notifier_call_chain+0xb8/0x19c
     blocking_notifier_call_chain+0x64/0x98
     bus_notify+0x50/0x7c
     device_add+0x640/0x918
     pci_device_add+0x23c/0x298
     of_create_pci_dev+0x400/0x884
     of_scan_pci_dev+0x124/0x1b0
     __of_scan_bus+0x78/0x18c
     pcibios_scan_phb+0x2a4/0x3b0
     init_phb_dynamic+0xb8/0x110
     dlpar_add_slot+0x170/0x3b8 [rpadlpar_io]
     add_slot_store.part.0+0xb4/0x130 [rpadlpar_io]
     kobj_attr_store+0x2c/0x48
     sysfs_kf_write+0x64/0x78
     kernfs_fop_write_iter+0x1b0/0x290
     vfs_write+0x350/0x4a0
     ksys_write+0x84/0x140
     system_call_exception+0x124/0x330
     system_call_vectored_common+0x15c/0x2ec

  Commit a940904443e4 ("powerpc/iommu: Add iommu_ops to report capabilities
  and allow blocking domains") broke DLPAR add of PCI devices.

  The above added iommu_device structure to pci_controller. During
  system boot, PCI devices are discovered and this newly added iommu_device
  structure is initialized by a call to iommu_device_register().

  During DLPAR add of a PCI device, a new pci_controller structure is
  allocated but there are no calls made to iommu_device_register()
  interface.

  Fix is to register the iommu device during DLPAR add as well.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26738.json
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11079'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11104'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11098'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11088'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11089'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11102'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1112'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11153'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11168'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1116'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11087'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10982'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1093'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11059'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19508'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19475'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19422'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19519'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19485'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19471'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19456'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19466'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19504'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19506'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19473'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19313'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.1936'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.19489'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '0.0031'
    scoring_system: epss
    scoring_elements: '0.37801'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26738
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26738.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-26738
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/46e36ebd5e00a148b67ed77c1d31675996f77c25
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a5c57fd2e9bd1c8ea8613a8f94fd0be5eccbf321
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b8315b2e25b4e68e42fcb74630f824b9a5067765
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2273272
    reference_type:
    reference_id: 2273272
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26738
    reference_type:
    reference_id: CVE-2024-26738
