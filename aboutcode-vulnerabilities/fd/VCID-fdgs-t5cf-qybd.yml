vulnerability_id: VCID-fdgs-t5cf-qybd
aliases:
  - CVE-2025-61920
  - GHSA-pq5p-34cr-23v9
summary: "Authlib is vulnerable to Denial of Service via Oversized JOSE Segments\n**Summary**\n\
  Authlib’s JOSE implementation accepts unbounded JWS/JWT header and signature segments. A remote\
  \ attacker can craft a token whose base64url‑encoded header or signature spans hundreds of\
  \ megabytes. During verification, Authlib decodes and parses the full input before it is rejected,\
  \ driving CPU and memory consumption to hostile levels and enabling denial of service.\n\n\
  **Impact**\n\n- Attack vector: unauthenticated network attacker submits a malicious JWS/JWT.\n\
  \n- Effect: base64 decode + JSON/crypto processing of huge buffers pegs CPU and allocates\
  \ large amounts of RAM; a single request can exhaust service capacity.\n\n- Observed behaviour:\
  \ on a test host, the legacy code verified a 500 MB header, consuming ~4 GB RSS and ~9 s CPU\
  \ before failing.\n\n- Severity: High. CVSS v3.1: AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H (7.5).\n\
  \nAffected Versions\nAuthlib ≤ 1.6.3 (and earlier) when verifying JWS/JWT tokens. Later snapshots\
  \ with 256 KB header/signature limits are not affected.\n\n**Proof of concept**\n\nLocal demo\
  \ (do not run against third-party systems):\nDownload [jws_segment_dos_demo.py](https://github.com/user-attachments/files/22450820/jws_segment_dos_demo.py)\
  \ the PoC in direcotry authlib/\nRun following Command\n```\npython3 jws_segment_dos_demo.py\
  \ --variant both --sizes \"500MB\" --fork-per-case\n\n```\nEnvironment: Python 3.13.6, Authlib\
  \ 1.6.4, Linux x86_64, CPUs=8 \nSample output: Refined\n<img width=\"1295\" height=\"306\"\
  \ alt=\"image\" src=\"https://github.com/user-attachments/assets/6dd8410f-bc36-4717-8cee-649bac9bf291\"\
  \ />\n\n\n\n\nThe compilation script prints separate “[ATTACKER]” (token construction) and\
  \ “[SERVER]” (Authlib verification) RSS deltas so defenders can distinguish client-side preparation\
  \ from server-side amplification. Regression tests authlib/tests/dos/test_jose_dos.py further\
  \ capture the issue; the saved original_util.py/original_jws.py reproductions still accept\
  \ the malicious payload.\n\n**Remediation**\n\n- Apply the upstream patch that introduces\
  \ decoded size limits:\n\n- MAX_HEADER_SEGMENT_BYTES = 256 KB\n\n- MAX_SIGNATURE_SEGMENT_BYTES\
  \ = 256 KB\n\n- Enforce Limits in authlib/jose/util.extract_segment and _extract_signature.\n\
  \n- Deploy the patched release immediately.\n\n- For additional defence in depth, reject JWS/JWT\
  \ inputs above a few kilobytes at the proxy or WAF layer, and rate-limit verification endpoints.\n\
  \n**Workarounds (temporary)**\n\n- Enforce input size limits before handing tokens to Authlib.\n\
  \n- Use application-level throttling to reduce amplification risk.\n\n**Resources**\n\n- Demo\
  \ script: jws_segment_dos_demo.py\n\n- Tests: authlib/tests/dos/test_jose_dos.py\n\n- OWASP\
  \ JWT Cheat Sheet (DoS guidance)"
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-61920.json
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.2927'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29206'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00149'
    scoring_system: epss
    scoring_elements: '0.36058'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00149'
    scoring_system: epss
    scoring_elements: '0.36003'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00149'
    scoring_system: epss
    scoring_elements: '0.36082'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00149'
    scoring_system: epss
    scoring_elements: '0.36084'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00149'
    scoring_system: epss
    scoring_elements: '0.3602'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.40694'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.40624'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.40718'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.40608'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.40614'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.40615'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00185'
    scoring_system: epss
    scoring_elements: '0.40607'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00403'
    scoring_system: epss
    scoring_elements: '0.60353'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '0.00403'
    scoring_system: epss
    scoring_elements: '0.60373'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-pq5p-34cr-23v9
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/authlib/authlib
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authlib/authlib
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/authlib/authlib/commit/867e3f87b072347a1ae9cf6983cc8bbf88447e5e
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authlib/authlib/commit/867e3f87b072347a1ae9cf6983cc8bbf88447e5e
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-10T20:46:55Z/
    published_at: None
    url: https://github.com/authlib/authlib/commit/867e3f87b072347a1ae9cf6983cc8bbf88447e5e
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/authlib/authlib/security/advisories/GHSA-pq5p-34cr-23v9
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/authlib/authlib/security/advisories/GHSA-pq5p-34cr-23v9
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/authlib/authlib/security/advisories/GHSA-pq5p-34cr-23v9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-10T20:46:55Z/
    published_at: None
    url: https://github.com/authlib/authlib/security/advisories/GHSA-pq5p-34cr-23v9
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2025/10/msg00032.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2025/10/msg00032.html
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61920
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61920
weaknesses:
  - CWE-770
  - CWE-400
  - CWE-1035
  - CWE-937
  - CWE-20
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-61920.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-61920
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-61920
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/authlib/authlib
    reference_type:
    reference_id:
  - url: https://github.com/authlib/authlib/commit/867e3f87b072347a1ae9cf6983cc8bbf88447e5e
    reference_type:
    reference_id:
  - url: https://github.com/authlib/authlib/security/advisories/GHSA-pq5p-34cr-23v9
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2025/10/msg00032.html
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61920
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2403179
    reference_type:
    reference_id: 2403179
  - url: https://github.com/advisories/GHSA-pq5p-34cr-23v9
    reference_type:
    reference_id: GHSA-pq5p-34cr-23v9
  - url: https://access.redhat.com/errata/RHSA-2025:22182
    reference_type:
    reference_id: RHSA-2025:22182
  - url: https://access.redhat.com/errata/RHSA-2025:22287
    reference_type:
    reference_id: RHSA-2025:22287
  - url: https://access.redhat.com/errata/RHSA-2025:23028
    reference_type:
    reference_id: RHSA-2025:23028
  - url: https://access.redhat.com/errata/RHSA-2025:23059
    reference_type:
    reference_id: RHSA-2025:23059
  - url: https://access.redhat.com/errata/RHSA-2025:23060
    reference_type:
    reference_id: RHSA-2025:23060
  - url: https://access.redhat.com/errata/RHSA-2025:23061
    reference_type:
    reference_id: RHSA-2025:23061
  - url: https://access.redhat.com/errata/RHSA-2025:23064
    reference_type:
    reference_id: RHSA-2025:23064
  - url: https://access.redhat.com/errata/RHSA-2025:23176
    reference_type:
    reference_id: RHSA-2025:23176
