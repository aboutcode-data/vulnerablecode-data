vulnerability_id: VCID-n4qu-u7jx-x3gd
aliases:
  - CVE-2025-58457
  - GHSA-2hmj-97jw-28jh
summary: |
  Apache ZooKeeper: Insufficient Permission Check in AdminServer Snapshot/Restore Commands
  Improper permission check in ZooKeeper AdminServer lets authorized clients to run snapshot and restore command with insufficient permissions.

  This issue affects Apache ZooKeeper: from 3.9.0 before 3.9.4.

  Users are recommended to upgrade to version 3.9.4, which fixes the issue.

  The issue can be mitigated by disabling both commands (via admin.snapshot.enabled and admin.restore.enabled), disabling the whole AdminServer interface (via admin.enableServer), or ensuring that the root ACL does not provide open permissions. (Note that ZooKeeper ACLs are not recursive, so this does not impact operations on child nodes besides notifications from recursive watches.)
severities:
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: http://github.com/apache/zookeeper/commit/71e173fcbcc9deb784081cf867bd045df3c32635
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://github.com/apache/zookeeper/commit/71e173fcbcc9deb784081cf867bd045df3c32635
  - score: '4.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-58457.json
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01674'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03926'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.0393'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.03919'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0481'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04807'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21257'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21313'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21218'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.2131'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21172'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21263'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21243'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21322'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.2129'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21321'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21249'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21251'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21463'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21288'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.24541'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.24485'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.24496'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.24501'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.24478'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.26663'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.26599'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-2hmj-97jw-28jh
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/apache/zookeeper
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/zookeeper
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://lists.apache.org/thread/r5yol0kkhx2fzw22pxk1ozwm3oc6yxrx
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/r5yol0kkhx2fzw22pxk1ozwm3oc6yxrx
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-24T13:47:31Z/
    published_at: None
    url: https://lists.apache.org/thread/r5yol0kkhx2fzw22pxk1ozwm3oc6yxrx
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-58457
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-58457
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://zookeeper.apache.org/doc/current/zookeeperSnapshotAndRestore.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://zookeeper.apache.org/doc/current/zookeeperSnapshotAndRestore.html
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://zookeeper.apache.org/doc/r3.9.4/releasenotes.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://zookeeper.apache.org/doc/r3.9.4/releasenotes.html
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://zookeeper.apache.org/security.html#CVE-2025-58457
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://zookeeper.apache.org/security.html#CVE-2025-58457
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2025/09/24/10
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2025/09/24/10
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-280
references:
  - url: http://github.com/apache/zookeeper/commit/71e173fcbcc9deb784081cf867bd045df3c32635
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-58457.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-58457
    reference_type:
    reference_id:
  - url: https://github.com/apache/zookeeper
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/r5yol0kkhx2fzw22pxk1ozwm3oc6yxrx
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-58457
    reference_type:
    reference_id:
  - url: https://zookeeper.apache.org/doc/current/zookeeperSnapshotAndRestore.html
    reference_type:
    reference_id:
  - url: https://zookeeper.apache.org/doc/r3.9.4/releasenotes.html
    reference_type:
    reference_id:
  - url: https://zookeeper.apache.org/security.html#CVE-2025-58457
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2025/09/24/10
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1116339
    reference_type:
    reference_id: 1116339
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2397773
    reference_type:
    reference_id: 2397773
  - url: https://github.com/advisories/GHSA-2hmj-97jw-28jh
    reference_type:
    reference_id: GHSA-2hmj-97jw-28jh
