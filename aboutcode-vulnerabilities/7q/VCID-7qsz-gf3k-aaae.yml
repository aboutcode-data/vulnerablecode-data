vulnerability_id: VCID-7qsz-gf3k-aaae
aliases:
  - GHSA-w2j5-3rcx-vx7x
summary: |
  Sysctls applied to containers with host IPC or host network namespaces can affect the host
  ### Impact
  Before setting the sysctls for a pod, the pods namespaces must be unshared (created). However, in cases where the pod is using a host network or IPC namespace, a bug in CRI-O caused the namespace creating tool [pinns](https://github.com/cri-o/cri-o/tree/main/pinns/) to configure the sysctls of the host. This allows a malicious user to set sysctls on the host, assuming they have access to hostNetwork and hostIPC.

  Any CRI-O cluster after CRI-O 1.18 that drops the infra container
  1.22 and 1.23 clusters drop infra container by default, and are thus vulnerable by default.

  ### Patches
  CRI-O versions 1.24.0, 1.23.1, 1.22.2, 1.21.5, 1.20.6, 1.19.5 all have the patches.

  ### Workarounds
  Users can set `manage_ns_lifecycle` to false, which causes the sysctls to be configured by the OCI runtime, which typically filter these cases. This option is available in 1.20 and 1.19. Newer versions don't have this option.
  An admission webhook could also be created to deny pods that use host IPC or network namespaces and also attempt to configure sysctls related to that namespace.

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in [the CRI-O repo](http://github.com/cri-o/cri-o/issues)
  * To make a report, email your vulnerability to the private
  [cncf-crio-security@lists.cncf.io](mailto:cncf-crio-security@lists.cncf.io) list
  with the security details and the details expected for [all CRI-O bug
  reports](https://github.com/cri-o/cri-o/blob/main/.github/ISSUE_TEMPLATE/bug-report.yml).
severities:
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/cri-o/cri-o
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cri-o/cri-o
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cri-o/cri-o/security/advisories/GHSA-w2j5-3rcx-vx7x
weaknesses: []
references:
  - url: https://github.com/cri-o/cri-o
    reference_type:
    reference_id:
  - url: https://github.com/cri-o/cri-o/security/advisories/GHSA-w2j5-3rcx-vx7x
    reference_type:
    reference_id:
