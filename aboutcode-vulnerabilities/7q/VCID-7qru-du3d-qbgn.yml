vulnerability_id: VCID-7qru-du3d-qbgn
aliases:
  - CVE-2025-59043
  - GHSA-g46h-2rq9-gw5m
summary: "OpenBao has potential Denial of Service vulnerability when processing malicious unauthenticated\
  \ JSON requests\n### Summary\n\nJSON objects after decoding might use more memory than their\
  \ serialized version. It is possible to tune a JSON to maximize the factor between serialized\
  \ memory usage and deserialized memory usage (similar to a zip bomb). While reproducing the\
  \ issue, we could reach a factor of about 35. This can be used to circumvent the [`max_request_size`\
  \ (https://openbao.org/docs/configuration/listener/tcp/) configuration parameter, which is\
  \ meant to protect against Denial of Service attacks, and also makes Denial of Service attacks\
  \ easier in general, as the attacker needs much less resources.\n\n### Details\n\nThe request\
  \ body is parsed into a `map[string]interface{}` https://github.com/openbao/openbao/blob/788536bd3e10818a7b4fb00aac6affc23388e5a9/http/logical.go#L50\
  \ very early in the request handling chain (before authentication), which means an attacker\
  \ can send a specifically crafted JSON object and cause an OOM crash. Additionally, for simpler\
  \ requests with large numbers of strings, the audit subsystem can consume large quantities\
  \ of CPU. \n\nTo remediate, set `max_request_json_memory` and `max_request_json_strings`.\n\
  \n### Impact\n\n- Unauthenticated Denial of Service\n\n### Resources\n\nThis issue was disclosed\
  \ directly to HashiCorp and is the OpenBao equivalent of the following tickets:\n\n- https://discuss.hashicorp.com/t/hcsec-2025-24-vault-denial-of-service-though-complex-json-payloads/76393\n\
  - https://nvd.nist.gov/vuln/detail/CVE-2025-6203\n\nHashiCorp attributes the problem to the\
  \ audit subsystem. For OpenBao, it was noted the problem was additionally in the requests\
  \ handling logic."
severities:
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.2605'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26019'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26017'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26016'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26025'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.25985'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26081'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26052'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.26127'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29259'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.2925'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.33634'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.33608'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://discuss.hashicorp.com/t/hcsec-2025-24-vault-denial-of-service-though-complex-json-payloads/76393
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://discuss.hashicorp.com/t/hcsec-2025-24-vault-denial-of-service-though-complex-json-payloads/76393
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/openbao/openbao
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/openbao/openbao
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/openbao/openbao/blob/788536bd3e10818a7b4fb00aac6affc23388e5a9/http/logical.go#L50
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/openbao/openbao/blob/788536bd3e10818a7b4fb00aac6affc23388e5a9/http/logical.go#L50
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-17T17:22:38Z/
    published_at: None
    url: https://github.com/openbao/openbao/blob/788536bd3e10818a7b4fb00aac6affc23388e5a9/http/logical.go#L50
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/openbao/openbao/commit/d418f238bc99adc72c73109faf574cc2b672880c
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/openbao/openbao/commit/d418f238bc99adc72c73109faf574cc2b672880c
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-17T17:22:38Z/
    published_at: None
    url: https://github.com/openbao/openbao/commit/d418f238bc99adc72c73109faf574cc2b672880c
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/openbao/openbao/pull/1756
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/openbao/openbao/pull/1756
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-17T17:22:38Z/
    published_at: None
    url: https://github.com/openbao/openbao/pull/1756
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/openbao/openbao/security/advisories/GHSA-g46h-2rq9-gw5m
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/openbao/openbao/security/advisories/GHSA-g46h-2rq9-gw5m
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-17T17:22:38Z/
    published_at: None
    url: https://github.com/openbao/openbao/security/advisories/GHSA-g46h-2rq9-gw5m
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59043
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59043
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-6203
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-6203
weaknesses:
  - CWE-400
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-59043
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao/blob/788536bd3e10818a7b4fb00aac6affc23388e5a9/http/logical.go#L50
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao/commit/d418f238bc99adc72c73109faf574cc2b672880c
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao/pull/1756
    reference_type:
    reference_id:
  - url: https://github.com/openbao/openbao/security/advisories/GHSA-g46h-2rq9-gw5m
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59043
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-6203
    reference_type:
    reference_id:
