vulnerability_id: VCID-7qvh-a7vv-aaab
aliases:
  - CVE-2021-32779
summary: Envoy is an open source L7 proxy and communication bus designed for large modern service
  oriented architectures. In affected versions envoy incorrectly handled a URI '#fragment' element
  as part of the path element. Envoy is configured with an RBAC filter for authorization or
  similar mechanism with an explicit case of a final "/admin" path element, or is using a negative
  assertion with final path element of "/admin". The client sends request to "/app1/admin#foo".
  In Envoy prior to 1.18.0, or 1.18.0+ configured with path_normalization=false. Envoy treats
  fragment as a suffix of the query string when present, or as a suffix of the path when query
  string is absent, so it evaluates the final path element as "/admin#foo" and mismatches with
  the configured "/admin" path element. In Envoy 1.18.0+ configured with path_normalization=true.
  Envoy transforms this to /app1/admin%23foo and mismatches with the configured /admin prefix.
  The resulting URI is sent to the next server-agent with the offending "#foo" fragment which
  violates RFC3986 or with the nonsensical "%23foo" text appended. A specifically constructed
  request with URI containing '#fragment' element delivered by an untrusted client in the presence
  of path based request authorization resulting in escalation of Privileges when path based
  request authorization extensions. Envoy versions 1.19.1, 1.18.4, 1.17.4, 1.16.5 contain fixes
  that removes fragment from URI path in incoming requests.
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:3272
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:3273
  - score: '8.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-32779.json
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.05237'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43700'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43361'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43616'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43723'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43807'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43797'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43823'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43840'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44005'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44038'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44099'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.43887'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.43911'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.43890'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44223'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00551'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00555'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00554'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00549'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00394'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00396'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00397'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00547'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00548'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00556'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00391'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00388'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00386'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00385'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00393'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00395'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1996934
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-r222-74fw-jqr9
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-r222-74fw-jqr9
  - score: '7.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32779
  - score: '8.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32779
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32779
weaknesses:
  - CWE-697
  - CWE-863
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-32779.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-32779
    reference_type:
    reference_id:
  - url: https://github.com/envoyproxy/envoy/security/advisories/GHSA-r222-74fw-jqr9
    reference_type:
    reference_id:
  - url: https://www.envoyproxy.io/docs/envoy/v1.19.0/version_history/version_history
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1996934
    reference_type:
    reference_id: '1996934'
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:envoyproxy:envoy:1.19.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:envoyproxy:envoy:1.19.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32779
    reference_type:
    reference_id: CVE-2021-32779
  - url: https://access.redhat.com/errata/RHSA-2021:3272
    reference_type:
    reference_id: RHSA-2021:3272
  - url: https://access.redhat.com/errata/RHSA-2021:3273
    reference_type:
    reference_id: RHSA-2021:3273
