vulnerability_id: VCID-81q5-4mbc-4khk
aliases:
  - CVE-2024-51999
  - GHSA-pj86-cfqh-vqx6
summary: "Withdrawn Advisory: express improperly controls modification of query properties\n\
  ## Withdrawn Advisory\nThis advisory has been withdrawn because it describes a correctness\
  \ bug, not a vulnerability with real security impact. This link is maintained to preserve\
  \ external references.\n\n## Original Description\n### Impact\n\nwhen using the extended query\
  \ parser in express (`'query parser': 'extended'`), the `request.query` object inherits all\
  \ object prototype properties, but these properties can be overwritten by query string parameter\
  \ keys that match the property names\n\n> [!IMPORTANT]  \n> the extended query parser is the\
  \ default in express 4; this was changed in express 5 which by default uses the simple query\
  \ parser\n\n### Patches\n\nthe issue has been patched to ensure `request.query` is a plain\
  \ object so `request.query` no longer has object prototype properties. this brings the default\
  \ behavior of extended query parsing in line with express's default simple query parser\n\n\
  ### Workaround\n\nthis only impacts users using extended query parsing (`'query parser': 'extended'`),\
  \ which is the default in express 4, but not express 5.  all users are encouraged to upgrade\
  \ to the patched versions, but can otherwise work around this issue:\n\n#### provide `qs`\
  \ directly and specify `plainObjects: true`\n\n```js\napp.set('query parser',\n  function\
  \ (str) {\n    return qs.parse(str, {\n      plainObjects: true\n  });\n});\n```"
severities:
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-pj86-cfqh-vqx6
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/expressjs/express
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/expressjs/express/commit/2f64f68c37c64ae333e41ff38032d21860f22255
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/expressjs/express/releases/tag/4.22.0
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/expressjs/express/releases/tag/v5.2.0
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/expressjs/express/security/advisories/GHSA-pj86-cfqh-vqx6
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/expressjs/express/security/advisories/GHSA-pj86-cfqh-vqx6
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-51999
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-915
references:
  - url: https://github.com/expressjs/express
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/commit/2f64f68c37c64ae333e41ff38032d21860f22255
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/releases/tag/4.22.0
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/releases/tag/v5.2.0
    reference_type:
    reference_id:
  - url: https://github.com/expressjs/express/security/advisories/GHSA-pj86-cfqh-vqx6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-51999
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-pj86-cfqh-vqx6
    reference_type:
    reference_id: GHSA-pj86-cfqh-vqx6
