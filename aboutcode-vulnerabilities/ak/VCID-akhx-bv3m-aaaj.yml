vulnerability_id: VCID-akhx-bv3m-aaaj
aliases:
  - CVE-2018-12029
  - GHSA-jjcj-fgfm-9g9r
summary: |
  Concurrent Execution using Shared Resource with Improper Synchronization (Race Condition)
  A race condition in the nginx module in Phusion Passenger allows local escalation of privileges when a non-standard `passenger_instance_registry_dir` with insufficiently strict permissions is configured. Replacing a file with a symlink after the file was created, but before it was chowned, leads to the target of the link being chowned via the path. Targeting sensitive files such as root's crontab file allows privilege escalation.
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12029.html
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2018-12029.json
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29468'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25464'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25418'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25392'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25404'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25433'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25465'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25452'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25419'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25409'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25385'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29435'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29497'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29565'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29612'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29611'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29547'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29529'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29492'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29493'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29501'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29518'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29498'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.29469'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25424'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25447'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00103'
    scoring_system: epss
    scoring_elements: '0.25456'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25559'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25611'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '0.00119'
    scoring_system: epss
    scoring_elements: '0.19217'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes/
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes/
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://blog.phusion.nl/passenger-5-3-2
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://blog.phusion.nl/passenger-5-3-2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://blog.phusion.nl/passenger-5-3-2
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1592612
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12029
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-jjcj-fgfm-9g9r
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/phusion/passenger/commit/207870f5b7f5cc240587ab0977d6046782ae1d86
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2018/06/msg00007.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2018/06/msg00007.html
  - score: '4.4'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-12029
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-12029
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://pulsesecurity.co.nz/advisories/phusion-passenger-priv-esc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pulsesecurity.co.nz/advisories/phusion-passenger-priv-esc
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://security.gentoo.org/glsa/201807-02
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.gentoo.org/glsa/201807-02
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-362
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12029.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2018-12029.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2018-12029
    reference_type:
    reference_id:
  - url: https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes
    reference_type:
    reference_id:
  - url: https://blog.phusion.nl/2018/06/12/passenger-5-3-2-various-security-fixes/
    reference_type:
    reference_id:
  - url: https://blog.phusion.nl/passenger-5-3-2
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12029
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/phusion/passenger/commit/207870f5b7f5cc240587ab0977d6046782ae1d86
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2018/06/msg00007.html
    reference_type:
    reference_id:
  - url: https://pulsesecurity.co.nz/advisories/phusion-passenger-priv-esc
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/201807-02
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1592612
    reference_type:
    reference_id: 1592612
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=921767
    reference_type:
    reference_id: 921767
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:phusion:passenger:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:phusion:passenger:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2018-12029
    reference_type:
    reference_id: CVE-2018-12029
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/passenger/CVE-2018-12029.yml
    reference_type:
    reference_id: CVE-2018-12029.YML
  - url: https://github.com/advisories/GHSA-jjcj-fgfm-9g9r
    reference_type:
    reference_id: GHSA-jjcj-fgfm-9g9r
  - url: https://usn.ubuntu.com/USN-5261-1/
    reference_type:
    reference_id: USN-USN-5261-1
