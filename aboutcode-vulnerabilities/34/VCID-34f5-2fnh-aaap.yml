vulnerability_id: VCID-34f5-2fnh-aaap
aliases:
  - GHSA-528j-9r78-wffx
summary: |
  etcd user credentials are stored in WAL logs in plaintext
  ### Vulnerability type
  Data Exposure

  ### Workarounds
  The etcd assumes that the on disk files are secure. The possible fixes have been provided, however, it is the responsibility of the etcd users to make sure that the etcd server WAL log files are secure. The [etcd doesn't encrypt key/value data stored on disk drives](https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/security.md#does-etcd-encrypt-data-stored-on-disk-drives).

  ### Detail
  User credentials (login and password) are stored in WAL entries on each user authentication. If the WAL log files are not secure, it can potentially expose sensitive information.

  ### References
  Find out more on this vulnerability in the [security audit report](https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf)

  ### For more information
  If you have any questions or comments about this advisory:
  * Contact the [etcd security committee](https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md#product-security-committee-psc)
severities:
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/etcd-io/etcd
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/etcd-io/etcd
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/security.md#does-etcd-encrypt-data-stored-on-disk-drives
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/etcd-io/etcd/commit/585814082b8c8b7db272b30b365b81d27df4a4cb
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/etcd-io/etcd/issues/10132
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/etcd-io/etcd/pull/11818
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/etcd-io/etcd/security/advisories/GHSA-528j-9r78-wffx
weaknesses:
  - CWE-256
references:
  - url: https://github.com/etcd-io/etcd
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/security.md#does-etcd-encrypt-data-stored-on-disk-drives
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/commit/585814082b8c8b7db272b30b365b81d27df4a4cb
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/issues/10132
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/pull/11818
    reference_type:
    reference_id:
  - url: https://github.com/etcd-io/etcd/security/advisories/GHSA-528j-9r78-wffx
    reference_type:
    reference_id:
