vulnerability_id: VCID-34bc-hpez-aaan
aliases:
  - CVE-2023-40027
  - GHSA-9cvc-v7wm-992c
summary: Keystone is an open source headless CMS for Node.js â€” built with GraphQL and React.
  When `ui.isAccessAllowed` is set as `undefined`, the `adminMeta` GraphQL query is publicly
  accessible (no session required). This is different to the behaviour of the default AdminUI
  middleware, which by default will only be publicly accessible (no session required) if a `session`
  strategy is not defined. This vulnerability does not affect developers using the `@keystone-6/auth`
  package, or any users that have written their own `ui.isAccessAllowed` (that is to say, `isAccessAllowed`
  is not `undefined`). This vulnerability does affect users who believed that their `session`
  strategy will, by default, enforce that `adminMeta` is inaccessible by the public in accordance
  with that strategy; akin to the behaviour of the AdminUI middleware. This vulnerability has
  been patched in `@keystone-6/core` version `5.5.1`. Users are advised to upgrade. Users unable
  to upgrade may opt to write their own `isAccessAllowed` functionality to work-around this
  vulnerability.
severities:
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31538'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30939'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30965'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31077'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31073'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31079'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31095'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31129'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31354'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31409'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31510'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31163'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31167'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31154'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30573'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30874'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44996'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45013'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45056'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45049'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45007'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44982'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45019'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45038'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45025'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45014'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.45006'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44901'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.44874'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48865'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48858'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48907'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48968'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48988'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48901'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48904'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48916'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48934'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48933'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48943'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.4892'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.48895'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: '0.00292'
    scoring_system: epss
    scoring_elements: '0.36341'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-9cvc-v7wm-992c
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/keystonejs/keystone
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/keystonejs/keystone
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/keystonejs/keystone/commit/650e27e6e9b42abfb94c340c8470faf61f0ff284
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/keystonejs/keystone/commit/650e27e6e9b42abfb94c340c8470faf61f0ff284
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/keystonejs/keystone/pull/8771
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/keystonejs/keystone/pull/8771
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/keystonejs/keystone/releases/tag/2023-08-15
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/keystonejs/keystone/releases/tag/2023-08-15
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/keystonejs/keystone/security/advisories/GHSA-9cvc-v7wm-992c
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/keystonejs/keystone/security/advisories/GHSA-9cvc-v7wm-992c
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40027
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40027
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-862
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-40027
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/commit/650e27e6e9b42abfb94c340c8470faf61f0ff284
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/pull/8771
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/releases/tag/2023-08-15
    reference_type:
    reference_id:
  - url: https://github.com/keystonejs/keystone/security/advisories/GHSA-9cvc-v7wm-992c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:keystonejs:keystone:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:keystonejs:keystone:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-40027
    reference_type:
    reference_id: CVE-2023-40027
  - url: https://github.com/advisories/GHSA-9cvc-v7wm-992c
    reference_type:
    reference_id: GHSA-9cvc-v7wm-992c
