vulnerability_id: VCID-cwr8-c9fh-aaac
aliases:
  - GHSA-cgw6-f3mj-h742
summary: "RustEmbed generated `get` method allows for directory traversal when reading files\
  \ from disk\nWhen running in debug mode and the `debug-embed` (off by default) feature is\n\
  not enabled, the generated `get` method does not check that the input path is\na child of\
  \ the folder given. \n\nThis allows attackers to read arbitrary files in the file system if\
  \ they have\ncontrol over the filename given. The following code will print the contents of\n\
  your `/etc/passwd` if adjusted with a correct number of `../`s depending on\nwhere it is run\
  \ from.\n\n```rust\n#[derive(rust_embed::RustEmbed)]\n#[folder = \"src/\"]\npub struct Asset;\n\
  \nfn main() {\n    let d = Asset::get(\"../../../etc/passwd\").unwrap().data;\n    println!(\"\
  {}\", String::from_utf8_lossy(&d));\n}\n```\n\nThe flaw was corrected by canonicalizing the\
  \ input filename and ensuring that\nit starts with the canonicalized folder path."
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-cgw6-f3mj-h742
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/pyros2097/rust-embed
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pyros2097/rust-embed
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/pyros2097/rust-embed/issues/159
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pyros2097/rust-embed/issues/159
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2021-0126.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2021-0126.html
weaknesses:
  - CWE-22
references:
  - url: https://github.com/pyros2097/rust-embed
    reference_type:
    reference_id:
  - url: https://github.com/pyros2097/rust-embed/issues/159
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2021-0126.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-cgw6-f3mj-h742
    reference_type:
    reference_id: GHSA-cgw6-f3mj-h742
