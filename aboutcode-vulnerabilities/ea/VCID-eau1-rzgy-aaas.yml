vulnerability_id: VCID-eau1-rzgy-aaas
aliases:
  - CVE-2024-42354
  - GHSA-hhcq-ph6w-494g
summary: "Shopware vulnerable to Improper Access Control with ManyToMany associations in store-api\n\
  ### Impact\n\nThe store-API works with regular entities and not expose all fields for the\
  \ public API; fields need to be marked as ApiAware in the EntityDefinition. So only ApiAware\
  \ fields of the EntityDefinition will be encoded to the final JSON. \n\nThe processing of\
  \ the Criteria did not considered ManyToMany associations and so they were not considered\
  \ properly and the protections didn't get used.\n\nThis issue cannot be reproduced with the\
  \ default entities by Shopware, but can be triggered with extensions.\n\n### Patches\nUpdate\
  \ to Shopware 6.6.5.1 or 6.5.8.13\n\n### Workarounds\nFor older versions of 6.2, 6.3,  and\
  \ 6.4, corresponding security measures are also available via a plugin. For the full range\
  \ of functions, we recommend updating to the latest Shopware version."
severities:
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27298'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27205'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27304'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27363'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27349'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27358'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27370'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27417'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27653'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27725'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27815'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27347'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27331'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.27698'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00060'
    scoring_system: epss
    scoring_elements: '0.26932'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00134'
    scoring_system: epss
    scoring_elements: '0.34351'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00134'
    scoring_system: epss
    scoring_elements: '0.34446'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00134'
    scoring_system: epss
    scoring_elements: '0.34535'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00134'
    scoring_system: epss
    scoring_elements: '0.34528'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00134'
    scoring_system: epss
    scoring_elements: '0.34487'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00134'
    scoring_system: epss
    scoring_elements: '0.34417'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00134'
    scoring_system: epss
    scoring_elements: '0.34438'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00134'
    scoring_system: epss
    scoring_elements: '0.34437'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00134'
    scoring_system: epss
    scoring_elements: '0.34434'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00156'
    scoring_system: epss
    scoring_elements: '0.37412'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00156'
    scoring_system: epss
    scoring_elements: '0.37444'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00156'
    scoring_system: epss
    scoring_elements: '0.37454'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00156'
    scoring_system: epss
    scoring_elements: '0.37437'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00156'
    scoring_system: epss
    scoring_elements: '0.37388'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.41041'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.40949'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.40916'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.41034'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.41046'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.41061'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.41032'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.41009'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.41028'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.41074'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00213'
    scoring_system: epss
    scoring_elements: '0.41069'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00231'
    scoring_system: epss
    scoring_elements: '0.4319'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00231'
    scoring_system: epss
    scoring_elements: '0.43169'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: '0.00414'
    scoring_system: epss
    scoring_elements: '0.44636'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-hhcq-ph6w-494g
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/shopware/core/commit/a784aa1cec0624e36e0ee4d41aeebaed40e0442f
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/core/commit/a784aa1cec0624e36e0ee4d41aeebaed40e0442f
  - score: '8.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/shopware/core/commit/d35ee2eda5c995faeb08b3dad127eab65c64e2a2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/core/commit/d35ee2eda5c995faeb08b3dad127eab65c64e2a2
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/shopware/shopware
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/shopware/shopware/commit/8504ba7e56e53add6a1d5b9d45015e3d899cd0ac
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/commit/8504ba7e56e53add6a1d5b9d45015e3d899cd0ac
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/shopware/shopware/commit/ad83d38809df457efef21c37ce0996430334bf01
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/commit/ad83d38809df457efef21c37ce0996430334bf01
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-hhcq-ph6w-494g
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-hhcq-ph6w-494g
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42354
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42354
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-42354
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-284
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-42354
    reference_type:
    reference_id:
  - url: https://github.com/shopware/core/commit/a784aa1cec0624e36e0ee4d41aeebaed40e0442f
    reference_type:
    reference_id:
  - url: https://github.com/shopware/core/commit/d35ee2eda5c995faeb08b3dad127eab65c64e2a2
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/8504ba7e56e53add6a1d5b9d45015e3d899cd0ac
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/ad83d38809df457efef21c37ce0996430334bf01
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/security/advisories/GHSA-hhcq-ph6w-494g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-42354
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:shopware:shopware:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:shopware:shopware:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-hhcq-ph6w-494g
    reference_type:
    reference_id: GHSA-hhcq-ph6w-494g
