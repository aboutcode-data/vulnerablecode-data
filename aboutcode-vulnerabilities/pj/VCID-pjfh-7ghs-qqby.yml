vulnerability_id: VCID-pjfh-7ghs-qqby
aliases:
  - CVE-2025-39735
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\njfs: fix slab-out-of-bounds\
  \ read in ea_get()\n\nDuring the \"size_check\" label in ea_get(), the code checks if the\
  \ extended\nattribute list (xattr) size matches ea_size. If not, it logs\n\"ea_get: invalid\
  \ extended attribute\" and calls print_hex_dump().\n\nHere, EALIST_SIZE(ea_buf->xattr) returns\
  \ 4110417968, which exceeds\nINT_MAX (2,147,483,647). Then ea_size is clamped:\n\n\tint size\
  \ = clamp_t(int, ea_size, 0, EALIST_SIZE(ea_buf->xattr));\n\nAlthough clamp_t aims to bound\
  \ ea_size between 0 and 4110417968, the upper\nlimit is treated as an int, causing an overflow\
  \ above 2^31 - 1. This leads\n\"size\" to wrap around and become negative (-184549328).\n\n\
  The \"size\" is then passed to print_hex_dump() (called \"len\" in\nprint_hex_dump()), it\
  \ is passed as type size_t (an unsigned\ntype), this is then stored inside a variable called\n\
  \"int remaining\", which is then assigned to \"int linelen\" which\nis then passed to hex_dump_to_buffer().\
  \ In print_hex_dump()\nthe for loop, iterates through 0 to len-1, where len is\n18446744073525002176,\
  \ calling hex_dump_to_buffer()\non each iteration:\n\n\tfor (i = 0; i < len; i += rowsize)\
  \ {\n\t\tlinelen = min(remaining, rowsize);\n\t\tremaining -= rowsize;\n\n\t\thex_dump_to_buffer(ptr\
  \ + i, linelen, rowsize, groupsize,\n\t\t\t\t   linebuf, sizeof(linebuf), ascii);\n\n\t\t\
  ...\n\t}\n\nThe expected stopping condition (i < len) is effectively broken\nsince len is\
  \ corrupted and very large. This eventually leads to\nthe \"ptr+i\" being passed to hex_dump_to_buffer()\
  \ to get closer\nto the end of the actual bounds of \"ptr\", eventually an out of\nbounds\
  \ access is done in hex_dump_to_buffer() in the following\nfor loop:\n\n\tfor (j = 0; j <\
  \ len; j++) {\n\t\t\tif (linebuflen < lx + 2)\n\t\t\t\tgoto overflow2;\n\t\t\tch = ptr[j];\n\
  \t\t...\n\t}\n\nTo fix this we should validate \"EALIST_SIZE(ea_buf->xattr)\"\nbefore it is\
  \ utilised."
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39735.json
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39735.json
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08101'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08023'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07983'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07953'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07968'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08118'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12771'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12744'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12764'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12753'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-39735
weaknesses:
  - CWE-125
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39735.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-39735
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-39735
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0beddc2a3f9b9cf7d8887973041e36c2d0fa3652
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/16d3d36436492aa248b2d8045e75585ebcc2f34d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3d6fd5b9c6acbc005e53d0211c7381f566babec1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/46e2c031aa59ea65128991cbca474bd5c0c2ecdb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/50afcee7011155933d8d5e8832f52eeee018cfd3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5263822558a8a7c0d0248d5679c2dcf4d5cda61f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/78c9cbde8880ec02d864c166bcb4fe989ce1d95f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a8c31808925b11393a6601f534bb63bac5366bab
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fdf480da5837c23b146c4743c18de97202fcab37
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2360930
    reference_type:
    reference_id: 2360930
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-39735
    reference_type:
    reference_id: CVE-2025-39735
