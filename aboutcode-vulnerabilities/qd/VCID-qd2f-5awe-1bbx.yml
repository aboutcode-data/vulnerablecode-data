vulnerability_id: VCID-qd2f-5awe-1bbx
aliases:
  - CVE-2024-58267
  - GHSA-v3vj-5868-2ch2
summary: "Rancher CLI SAML authentication is vulnerable to phishing attacks\n### Impact\n\n\
  A vulnerability has been identified within Rancher Manager whereby the SAML authentication\
  \ from the Rancher CLI  tool is vulnerable to phishing attacks. The custom authentication\
  \ protocol for SAML-based providers can be abused to steal Rancher’s authentication tokens.\n\
  \nRancher Manager deployments without SAML authentication enabled are not affected by this\
  \ vulnerability.\n\nAn attacker can generate a phishing SAML login URL which contains a `publicKey`\
  \ and `requestId` controlled by the attacker. The attacker can then give the link to another\
  \ user (eg: admin) and if the victim goes to the link unsuspectingly, they might not notice\
  \ the bad parameters in the URL. The user will be prompted to login and might believe that\
  \ its session has ended so they need to re-login. By clicking on the link, they will be logged\
  \ in and an encrypted token will be created with the attacker's public key. The attacker can\
  \ then decrypt the victim’s Rancher token, enabling the attack\n\nPlease consult the associated\
  \ [MITRE ATTACK Techniques - Privilege Escalation](https://attack.mitre.org/tactics/TA0004/)\
  \ for further information about this category of attack.\n\n### Patches\n\nThis vulnerability\
  \ is addressed by changes in both Rancher Manager and the CLI. The fixed versions:\n\n1. The\
  \ Rancher CLI now reports the `requestId` that is relevant to the authentication session in\
  \ process as a separate message to the terminal, making it easier for the user to identify\
  \ and compare.\n2. The Rancher login page for SAML authentication will display a suitable\
  \ warning to ensure that the user seeing the login page is aware of the login process with\
  \ the related `requestId`, enabling users to verify whether the request was intended or not.\n\
  \nPatched versions of Rancher include releases v2.12.2, v2.11.6, v2.10.10, and v2.9.12.\n\n\
  ### Workarounds\n\nIf you cannot update to one of the fixed versions, make sure to check the\
  \ URL printed by the Rancher CLI when performing a SAML authentication flow, especially the\
  \ `requestId` parameter. The URL and the `requestId` printed by the CLI must be the same URL\
  \ that you access and see when finalizing the SAML authentication flow in your browser for\
  \ the Rancher UI. The URL has the format:\n\n-  `<rancher_ui_address>/dashboard/auth/login?requestId=<requestid>&publicKey=<pubkey>&responseType=<responsetype>`\
  \ \n\nIf the URL presented in the browser is different from the one logged by the CLI, the\
  \ user must not proceed with the login, as they might be under a phishing attack.\n\n### References\n\
  \nIf you have any questions or comments about this advisory:\n\n- Reach out to the [SUSE Rancher\
  \ Security team](https://github.com/rancher/rancher/security/policy) for security related\
  \ inquiries.\n- Open an issue in the [Rancher](https://github.com/rancher/rancher/issues/new/choose)\
  \ repository.\n- Verify with our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/)\
  \ and [product support lifecycle](https://www.suse.com/lifecycle/)."
severities:
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.0086'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00876'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00258'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00277'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.0026'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00268'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00264'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00265'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00263'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00438'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00439'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.0044'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00436'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00571'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
  - score: 8
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-58267
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-58267
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-58267
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-10-02T15:16:01Z/
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-58267
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/rancher/rancher
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher
  - score: 8
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-v3vj-5868-2ch2
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-v3vj-5868-2ch2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-v3vj-5868-2ch2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-10-02T15:16:01Z/
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-v3vj-5868-2ch2
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-58267
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-58267
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3984
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3984
weaknesses:
  - CWE-345
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-58267
    reference_type:
    reference_id:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-58267
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/security/advisories/GHSA-v3vj-5868-2ch2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-58267
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3984
    reference_type:
    reference_id:
