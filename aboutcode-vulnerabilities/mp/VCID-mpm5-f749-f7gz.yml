vulnerability_id: VCID-mpm5-f749-f7gz
aliases:
  - CVE-2023-54089
summary: 'In the Linux kernel, the following vulnerability has been resolved:  virtio_pmem:
  add the missing REQ_OP_WRITE for flush bio  When doing mkfs.xfs on a pmem device, the following
  warning was   ------------[ cut here ]------------  WARNING: CPU: 2 PID: 384 at block/blk-core.c:751
  submit_bio_noacct  Modules linked in:  CPU: 2 PID: 384 Comm: mkfs.xfs Not tainted 6.4.0-rc7+
  #154  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996)  RIP: 0010:submit_bio_noacct+0x340/0x520  ......  Call
  Trace:   <TASK>   ? submit_bio_noacct+0xd5/0x520   submit_bio+0x37/0x60   async_pmem_flush+0x79/0xa0   nvdimm_flush+0x17/0x40   pmem_submit_bio+0x370/0x390   __submit_bio+0xbc/0x190   submit_bio_noacct_nocheck+0x14d/0x370   submit_bio_noacct+0x1ef/0x520   submit_bio+0x55/0x60   submit_bio_wait+0x5a/0xc0   blkdev_issue_flush+0x44/0x60  The
  root cause is that submit_bio_noacct() needs bio_op() is either WRITE or ZONE_APPEND for flush
  bio and async_pmem_flush() doesn''t assign REQ_OP_WRITE when allocating flush bio, so submit_bio_noacct
  just fail the flush bio.  Simply fix it by adding the missing REQ_OP_WRITE for flush bio.
  And we could fix the flush order issue and do flush optimization later.'
severities:
  - score: '6.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54089.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0513'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54089
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05111'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54089
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-672
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54089.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-54089
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2425125
    reference_type:
    reference_id: 2425125
  - url: https://access.redhat.com/errata/RHSA-2025:6966
    reference_type:
    reference_id: RHSA-2025:6966
