vulnerability_id: VCID-71ah-yp8u-aaaj
aliases:
  - CVE-2024-28848
  - GHSA-5xv3-fm7g-865r
summary: OpenMetadata is a unified platform for discovery, observability, and governance powered
  by a central metadata repository, in-depth lineage, and seamless team collaboration. The `?CompiledRule::validateExpression`
  method evaluates an SpEL expression using an `StandardEvaluationContext`, allowing the expression
  to reach and interact with Java classes such as `java.lang.Runtime`, leading to Remote Code
  Execution. The `/api/v1/policies/validation/condition/<expression>` endpoint passes user-controlled
  data `CompiledRule::validateExpession` allowing authenticated (non-admin) users to execute
  arbitrary system commands on the underlaying operating system. In addition, there is a missing
  authorization check since `Authorizer.authorize()` is never called in the affected path and
  therefore any authenticated non-admin user is able to trigger this endpoint and evaluate arbitrary
  SpEL expressions leading to arbitrary command execution. This vulnerability was discovered
  with the help of CodeQL's Expression language injection (Spring) query and is also tracked
  as `GHSL-2023-236`. This issue may lead to Remote Code Execution and has been resolved in
  version 1.2.4. Users are advised to upgrade. There are no known workarounds for this vulnerability.
severities:
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70255'
    scoring_system: epss
    scoring_elements: '0.98558'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70255'
    scoring_system: epss
    scoring_elements: '0.98557'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70255'
    scoring_system: epss
    scoring_elements: '0.98554'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70255'
    scoring_system: epss
    scoring_elements: '0.9856'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70255'
    scoring_system: epss
    scoring_elements: '0.98559'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98598'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.9861'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98608'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98609'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98607'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98606'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98603'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98605'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98594'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98604'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98596'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.986'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.70809'
    scoring_system: epss
    scoring_elements: '0.98601'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73328'
    scoring_system: epss
    scoring_elements: '0.98698'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98709'
    published_at: '2025-05-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.9871'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98711'
    published_at: '2025-05-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98712'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98722'
    published_at: '2025-06-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98713'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98716'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98714'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98715'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.9873'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.9872'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98721'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98719'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98707'
    published_at: '2025-05-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98703'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98702'
    published_at: '2025-04-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98704'
    published_at: '2025-04-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98717'
    published_at: '2025-05-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98718'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.73381'
    scoring_system: epss
    scoring_elements: '0.98708'
    published_at: '2025-05-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98883'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98889'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.9889'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98891'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98892'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98893'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98882'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98874'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98873'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98875'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98872'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98871'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.9887'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.76241'
    scoring_system: epss
    scoring_elements: '0.98884'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.77239'
    scoring_system: epss
    scoring_elements: '0.98924'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.77239'
    scoring_system: epss
    scoring_elements: '0.98927'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.77239'
    scoring_system: epss
    scoring_elements: '0.98928'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.77239'
    scoring_system: epss
    scoring_elements: '0.98932'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '0.81729'
    scoring_system: epss
    scoring_elements: '0.98967'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://codeql.github.com/codeql-query-help/java/java-spel-expression-injection
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://codeql.github.com/codeql-query-help/java/java-spel-expression-injection
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5xv3-fm7g-865r
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/open-metadata/OpenMetadata
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-metadata/OpenMetadata
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L51
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L51
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L57
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L57
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-5xv3-fm7g-865r
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-5xv3-fm7g-865r
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://securitylab.github.com/advisories/GHSL-2023-235_GHSL-2023-237_Open_Metadata
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://securitylab.github.com/advisories/GHSL-2023-235_GHSL-2023-237_Open_Metadata
weaknesses:
  - CWE-94
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-28848
    reference_type:
    reference_id:
  - url: https://codeql.github.com/codeql-query-help/java/java-spel-expression-injection
    reference_type:
    reference_id:
  - url: https://github.com/open-metadata/OpenMetadata
    reference_type:
    reference_id:
  - url: https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L51
    reference_type:
    reference_id:
  - url: https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L57
    reference_type:
    reference_id:
  - url: https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-5xv3-fm7g-865r
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2023-235_GHSL-2023-237_Open_Metadata
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-28848
    reference_type:
    reference_id: CVE-2024-28848
  - url: https://github.com/advisories/GHSA-5xv3-fm7g-865r
    reference_type:
    reference_id: GHSA-5xv3-fm7g-865r
