vulnerability_id: VCID-y9z8-9bpj-aaad
aliases:
  - BIT-2021-37678
  - BIT-tensorflow-2021-37678
  - CVE-2021-37678
  - GHSA-r6jx-9g48-2r5r
  - PYSEC-2021-300
  - PYSEC-2021-591
  - PYSEC-2021-789
summary: TensorFlow is an end-to-end open source platform for machine learning. In affected
  versions TensorFlow and Keras can be tricked to perform arbitrary code execution when deserializing
  a Keras model from YAML format. The [implementation](https://github.com/tensorflow/tensorflow/blob/460e000de3a83278fb00b61a16d161b1964f15f4/tensorflow/python/keras/saving/model_config.py#L66-L104)
  uses `yaml.unsafe_load` which can perform arbitrary code execution on the input. Given that
  YAML format support requires a significant amount of work, we have removed it for now. We
  have patched the issue in GitHub commit 23d6383eb6c14084a8fc3bdf164043b974818012. The fix
  will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1,
  TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported
  range.
severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13628'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14115'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14048'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14025'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13940'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14698'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14606'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14551'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14262'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14178'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14123'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14109'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39737'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39406'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39430'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39413'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80723'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80085'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80079'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80133'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80139'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80156'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80169'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80163'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.8016'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80164'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80179'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80189'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.802'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80193'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80196'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80188'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80678'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80701'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80722'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80738'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80745'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.8073'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80725'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80729'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80726'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80732'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80742'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80739'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.0161'
    scoring_system: epss
    scoring_elements: '0.80737'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: '0.04064'
    scoring_system: epss
    scoring_elements: '0.80582'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-r6jx-9g48-2r5r
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-r6jx-9g48-2r5r
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-591.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-591.yaml
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-789.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-789.yaml
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-300.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-300.yaml
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/1df5a69e9f1a18a937e7907223066e606bf466b9
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/1df5a69e9f1a18a937e7907223066e606bf466b9
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/1df5a69e9f1a18a937e7907223066e606bf466b9
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/23d6383eb6c14084a8fc3bdf164043b974818012
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/23d6383eb6c14084a8fc3bdf164043b974818012
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/23d6383eb6c14084a8fc3bdf164043b974818012
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/8e47a685785bef8f81bcb996048921dfde08a9ab
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/8e47a685785bef8f81bcb996048921dfde08a9ab
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/8e47a685785bef8f81bcb996048921dfde08a9ab
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/a09ab4e77afdcc6e1e045c9d41d5edab63aafc1a
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/a09ab4e77afdcc6e1e045c9d41d5edab63aafc1a
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/a09ab4e77afdcc6e1e045c9d41d5edab63aafc1a
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-r6jx-9g48-2r5r
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-r6jx-9g48-2r5r
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-r6jx-9g48-2r5r
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-r6jx-9g48-2r5r
  - score: '4.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37678
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37678
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37678
  - score: '9.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37678
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37678
  - score: Critical
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2292
weaknesses:
  - CWE-502
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-37678
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-591.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-789.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-300.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/1df5a69e9f1a18a937e7907223066e606bf466b9
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/23d6383eb6c14084a8fc3bdf164043b974818012
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/8e47a685785bef8f81bcb996048921dfde08a9ab
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/a09ab4e77afdcc6e1e045c9d41d5edab63aafc1a
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/AVG-2292
    reference_type:
    reference_id: AVG-2292
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37678
    reference_type:
    reference_id: CVE-2021-37678
  - url: https://github.com/advisories/GHSA-r6jx-9g48-2r5r
    reference_type:
    reference_id: GHSA-r6jx-9g48-2r5r
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-r6jx-9g48-2r5r
    reference_type:
    reference_id: GHSA-r6jx-9g48-2r5r
