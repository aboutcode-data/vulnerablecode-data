vulnerability_id: VCID-vagd-ynmn-aaab
aliases:
  - CVE-2024-37153
  - GHSA-xgr7-jgq3-mhmc
summary: "Contract balance not updating correctly after interchain transaction\n### Summary\n\
  _Short summary of the problem. Make the impact and severity as clear as possible. For example:\
  \ An unsafe deserialization vulnerability allows any unauthenticated user to execute arbitrary\
  \ code on the server._\n\n### Details\nWe discovered a bug walking through how to liquid stake\
  \ using Safe which itself is a contract. The bug only appears when there is a local state\
  \ change together with an ICS20 transfer in the same function and uses the contract's balance,\
  \ that is using the contract address as the `sender` parameter in an ICS20 transfer using\
  \ the ICS20 precompile\n\n### Proof of Concept\n```solidity\n// This function does not reduce\
  \ the contract balance correctly but liquid stakes correctly \nfunction transfer(\n      \
  \  string memory sourcePort,\n        string memory sourceChannel,\n        string memory\
  \ denom,\n        uint256 amount,\n        string memory receiver,\n        string memory\
  \ evmosReceiver\n    ) external returns (uint64 nextSequence) {\n        counter += 1; # Only\
  \ happens when there is a local state update together with an ICS20 Transfer\n        Height\
  \ memory timeoutHeight =  Height(100, 100);\n        string memory memo = buildLiquidStakeMemo(receiver,\
  \ evmosReceiver);\n        return ICS20_CONTRACT.transfer(\n            sourcePort, \n   \
  \         sourceChannel,\n            denom,\n            amount,\n            address(this),\
  \ # this is the sender address which is the contract\n            receiver,\n            timeoutHeight,\n\
  \            0,\n            memo\n        );\n    }\n```\n\n### Impact\nThis is in essence\
  \ the \"infinite money glitch\" allowing contracts to double the supply of Evmos after each\
  \ transaction.\n\n### Severity\n\nBased on [ImmuneFi Severity Classification System](https://immunefisupport.zendesk.com/hc/en-us/articles/13332717597585-Severity-Classification-System)\
  \ the severity was evaluated to `Critical` since the attack could have lead to create new\
  \ supply of EVMOS and therefore lead to Direct loss of funds's value.\n\n### Patches\n\nThe\
  \ issue has been patched in versions >=V18.1.0. \n\n## For more information\nIf you have any\
  \ questions or comments about this advisory:\n\nReach out to the Core Team in [Discord](https://discord.gg/evmos)\n\
  Open a discussion in [evmos/evmos](https://github.com/evmos/evmos/discussions)\nEmail us at\
  \ [security@evmos.org](mailto:security@evmos.org) for security questions"
severities:
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03518'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03521'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0353'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03522'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0352'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03505'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03506'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03561'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03562'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03575'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03564'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03585'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03555'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19269'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19347'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19337'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19885'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19352'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19388'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19426'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19713'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19787'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19887'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19623'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19621'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19604'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.18871'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19128'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19232'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.37955'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.37916'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42269'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42282'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42298'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42267'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42244'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42266'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.4228'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42306'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42308'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42283'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.4224'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00224'
    scoring_system: epss
    scoring_elements: '0.42255'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '0.00651'
    scoring_system: epss
    scoring_elements: '0.54759'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/evmos/evmos
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/evmos/evmos
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/evmos/evmos/commit/478b7a62e7af57a70cf3a01126c7f5a89bee69d7
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/evmos/evmos/commit/478b7a62e7af57a70cf3a01126c7f5a89bee69d7
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/evmos/evmos/security/advisories/GHSA-xgr7-jgq3-mhmc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/evmos/evmos/security/advisories/GHSA-xgr7-jgq3-mhmc
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37153
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37153
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37153
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2024-2903
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2024-2903
weaknesses:
  - CWE-670
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-37153
    reference_type:
    reference_id:
  - url: https://github.com/evmos/evmos
    reference_type:
    reference_id:
  - url: https://github.com/evmos/evmos/commit/478b7a62e7af57a70cf3a01126c7f5a89bee69d7
    reference_type:
    reference_id:
  - url: https://github.com/evmos/evmos/security/advisories/GHSA-xgr7-jgq3-mhmc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37153
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-2903
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:evmos:evmos:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:evmos:evmos:*:*:*:*:*:*:*:*
