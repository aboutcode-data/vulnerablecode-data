vulnerability_id: VCID-vade-7dx4-c3bw
aliases:
  - CVE-2025-38158
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  hisi_acc_vfio_pci: fix XQE dma address error

  The dma addresses of EQE and AEQE are wrong after migration and
  results in guest kernel-mode encryption services  failure.
  Comparing the definition of hardware registers, we found that
  there was an error when the data read from the register was
  combined into an address. Therefore, the address combination
  sequence needs to be corrected.

  Even after fixing the above problem, we still have an issue
  where the Guest from an old kernel can get migrated to
  new kernel and may result in wrong data.

  In order to ensure that the address is correct after migration,
  if an old magic number is detected, the dma address needs to be
  updated.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38158.json
  - score: '0.0001'
    scoring_system: epss
    scoring_elements: '0.00896'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0153'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01524'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0151'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01509'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01499'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01512'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01534'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01847'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01822'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01839'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0223'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0224'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02237'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.023'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02267'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02274'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02363'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02362'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02386'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02297'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02299'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02309'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02359'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02353'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02348'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0183'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0185'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01881'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02012'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02224'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.0222'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02208'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02198'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02206'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02227'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.02239'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.04408'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.04419'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04542'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04548'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04526'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04518'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04494'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04499'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04516'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04572'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04561'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04579'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06949'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.0692'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38158.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38158
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38158
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7710c883eb8cb5cf510ca47ec0e26c6cb7e94a4f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/809a9c10274e1bcf6d05f1c0341459a425a4f05f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/884a76e813178778d271fea59783763d32bb7e72
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8bb7170c5a055ea17c6857c256ee73c10ff872eb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f0423873e7aeb69cb68f4e8fa3827832e7b037ba
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2376050
    reference_type:
    reference_id: 2376050
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38158
    reference_type:
    reference_id: CVE-2025-38158
  - url: https://usn.ubuntu.com/7769-1/
    reference_type:
    reference_id: USN-7769-1
  - url: https://usn.ubuntu.com/7769-2/
    reference_type:
    reference_id: USN-7769-2
  - url: https://usn.ubuntu.com/7769-3/
    reference_type:
    reference_id: USN-7769-3
  - url: https://usn.ubuntu.com/7770-1/
    reference_type:
    reference_id: USN-7770-1
  - url: https://usn.ubuntu.com/7771-1/
    reference_type:
    reference_id: USN-7771-1
  - url: https://usn.ubuntu.com/7789-1/
    reference_type:
    reference_id: USN-7789-1
  - url: https://usn.ubuntu.com/7789-2/
    reference_type:
    reference_id: USN-7789-2
