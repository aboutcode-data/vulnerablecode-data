vulnerability_id: VCID-va8x-wxkg-vufh
aliases:
  - CVE-2025-38049
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  x86/resctrl: Fix allocation of cleanest CLOSID on platforms with no monitors

  Commit

    6eac36bb9eb0 ("x86/resctrl: Allocate the cleanest CLOSID by searching closid_num_dirty_rmid")

  added logic that causes resctrl to search for the CLOSID with the fewest dirty
  cache lines when creating a new control group, if requested by the arch code.
  This depends on the values read from the llc_occupancy counters. The logic is
  applicable to architectures where the CLOSID effectively forms part of the
  monitoring identifier and so do not allow complete freedom to choose an unused
  monitoring identifier for a given CLOSID.

  This support missed that some platforms may not have these counters.  This
  causes a NULL pointer dereference when creating a new control group as the
  array was not allocated by dom_data_init().

  As this feature isn't necessary on platforms that don't have cache occupancy
  monitors, add this to the check that occurs when a new control group is
  allocated.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38049.json
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38049.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02912'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02911'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02874'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02921'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02872'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02932'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04605'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04636'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04637'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0465'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04642'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-20
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38049.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38049
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/93a418fc61da13d1ee4047d4d1327990f7a2816a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a121798ae669351ec0697c94f71c3a692b2a755b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a8a1bcc27d4607227088d80483164289b5348293
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ed5addb55e403ad6598102bcf546e068ae01fef6
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2360917
    reference_type:
    reference_id: 2360917
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38049
    reference_type:
    reference_id: CVE-2025-38049
