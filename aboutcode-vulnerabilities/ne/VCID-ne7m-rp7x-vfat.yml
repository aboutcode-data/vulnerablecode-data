vulnerability_id: VCID-ne7m-rp7x-vfat
aliases:
  - CVE-2025-54881
  - GHSA-7rqq-prvp-x9jh
summary: "Mermaid improperly sanitizes sequence diagram labels leading to XSS\n### Summary\n\
  In the default configuration of mermaid 11.9.0, user supplied input for sequence diagram labels\
  \ is passed to `innerHTML` during calculation of element size, causing XSS.\n\n### Details\n\
  Sequence diagram node labels with KaTeX delimiters are passed through `calculateMathMLDimensions`.\
  \ This method passes the full label to `innerHTML` which allows allows malicious users to\
  \ inject arbitrary HTML and cause XSS when mermaid-js is used in it's default configuration\
  \ (with KaTeX support enabled). \n\nThe vulnerability lies here:\n\n```ts\nexport const calculateMathMLDimensions\
  \ = async (text: string, config: MermaidConfig) => {\n  text = await renderKatex(text, config);\n\
  \  const divElem = document.createElement('div');\n  divElem.innerHTML = text; // XSS sink,\
  \ text has not been sanitized.\n  divElem.id = 'katex-temp';\n  divElem.style.visibility =\
  \ 'hidden';\n  divElem.style.position = 'absolute';\n  divElem.style.top = '0';\n  const body\
  \ = document.querySelector('body');\n  body?.insertAdjacentElement('beforeend', divElem);\n\
  \  const dim = { width: divElem.clientWidth, height: divElem.clientHeight };\n  divElem.remove();\n\
  \  return dim;\n};\n```\n\nThe `calculateMathMLDimensions` method was introduced in 5c69e5fdb004a6d0a2abe97e23d26e223a059832\
  \ two years ago, which was released in [Mermaid 10.9.0](https://github.com/mermaid-js/mermaid/releases/tag/v10.9.0).\n\
  \n### PoC\nRender the following diagram and observe the modified DOM.\n\n```\nsequenceDiagram\n\
  \    participant A as Alice<img src=\"x\" onerror=\"document.write(`xss on ${document.domain}`)\"\
  >$$\\\\text{Alice}$$\n    A->>John: Hello John, how are you?\n    Alice-)John: See you later!\n\
  ```\n\nHere is a PoC on mermaid.live: https://mermaid.live/edit#pako:eNpVUMtOwzAQ_BWzyoFKaRTyaFILiio4IK7ckA-1km1iKbaLY6spUf4dJ0AF68uOZ2dm7REqXSNQ6PHDoarwWfDGcMkUudaJGysqceLKkj3hPdl3osJ7IRvSm-qBwcCAaIXGaONRrSsnUdnobITF28PQ954lwXglai25UNNhxWAXBMyXxcGOi-3kL_5k79e73atuFSUv2HWazH1IWn0m3CC5aPf4b3p2WK--BW-4DJCOWzQ3TM0HQmiMqIFa4zAEicZv4iGMsw0D26JEBtS3NR656ywDpiYv869_11r-Ko12TQv0yLveI3eqfcjP111HUNVonrRTFuhdsVgAHWEAmuRxlG7SuEzKMi-yJAnhAjTLIk_EcbFJtuk2y9MphM8lM47KIp--AOZghtU\n\
  \n### Impact\nXSS on all sites that use mermaid and render user supplied diagrams without\
  \ further sanitization.\n\n### Remediation\nThe value of the `text` argument for the `calculateMathMLDimensions`\
  \ method needs to be sanitized before getting passed on to `innerHTML`."
severities:
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.04043'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.04091'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.04011'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04755'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04741'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04761'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04776'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0478'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04789'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04781'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04774'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04764'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04736'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04768'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04856'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04824'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04821'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04662'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04673'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04654'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04535'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04563'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04564'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04725'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04733'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05114'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05125'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05141'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05259'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05234'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.06227'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0622'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12644'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12708'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.12697'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.1841'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.18463'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.18525'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.18458'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.18409'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-7rqq-prvp-x9jh
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/5c69e5fdb004a6d0a2abe97e23d26e223a059832
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/5c69e5fdb004a6d0a2abe97e23d26e223a059832
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-08-19T18:10:57Z/
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/5c69e5fdb004a6d0a2abe97e23d26e223a059832
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/685516a85ec1df64cefd4fd15f26533be87d458e
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/685516a85ec1df64cefd4fd15f26533be87d458e
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-08-19T18:10:57Z/
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/685516a85ec1df64cefd4fd15f26533be87d458e
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-7rqq-prvp-x9jh
  - score: '5.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-7rqq-prvp-x9jh
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-7rqq-prvp-x9jh
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-08-19T18:10:57Z/
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-7rqq-prvp-x9jh
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-54881
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-54881
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-54881
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/commit/5c69e5fdb004a6d0a2abe97e23d26e223a059832
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/commit/685516a85ec1df64cefd4fd15f26533be87d458e
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-7rqq-prvp-x9jh
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-54881
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-7rqq-prvp-x9jh
    reference_type:
    reference_id: GHSA-7rqq-prvp-x9jh
