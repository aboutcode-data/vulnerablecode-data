vulnerability_id: VCID-jycz-n748-aaaf
aliases:
  - CVE-2021-47457
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  can: isotp: isotp_sendmsg(): add result check for wait_event_interruptible()

  Using wait_event_interruptible() to wait for complete transmission,
  but do not check the result of wait_event_interruptible() which can be
  interrupted. It will result in TX buffer has multiple accessors and
  the later process interferes with the previous process.

  Following is one of the problems reported by syzbot.

  =============================================================
  WARNING: CPU: 0 PID: 0 at net/can/isotp.c:840 isotp_tx_timer_handler+0x2e0/0x4c0
  CPU: 0 PID: 0 Comm: swapper/0 Not tainted 5.13.0-rc7+ #68
  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1 04/01/2014
  RIP: 0010:isotp_tx_timer_handler+0x2e0/0x4c0
  Call Trace:
   <IRQ>
   ? isotp_setsockopt+0x390/0x390
   __hrtimer_run_queues+0xb8/0x610
   hrtimer_run_softirq+0x91/0xd0
   ? rcu_read_lock_sched_held+0x4d/0x80
   __do_softirq+0xe8/0x553
   irq_exit_rcu+0xf8/0x100
   sysvec_apic_timer_interrupt+0x9e/0xc0
   </IRQ>
   asm_sysvec_apic_timer_interrupt+0x12/0x20

  Add result check for wait_event_interruptible() in isotp_sendmsg()
  to avoid multiple accessers for tx buffer.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47457.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26029'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22047'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26051'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26035'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.21983'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22122'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22138'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22147'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22137'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22091'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22051'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.2207'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.2209'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22133'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22119'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22075'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22061'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22032'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25946'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.2601'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26052'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26095'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26093'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26057'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26038'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26025'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26037'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26044'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.26067'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '0.00362'
    scoring_system: epss
    scoring_elements: '0.41329'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47457.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47457
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47457
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/053bc12df0d6097c1126d0e14fa778a0a8faeb64
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9acf636215a6ce9362fe618e7da4913b8bfe84c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a76abedd2be3926d6deba236a935c7f98abf9110
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2282901
    reference_type:
    reference_id: 2282901
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47457
    reference_type:
    reference_id: CVE-2021-47457
  - url: https://access.redhat.com/errata/RHSA-2024:9315
    reference_type:
    reference_id: RHSA-2024:9315
