vulnerability_id: VCID-kb78-s45s-tycy
aliases:
  - CVE-2025-59410
  - GHSA-mcvp-rpgg-9273
summary: |
  DragonFly's tiny file download uses hard coded HTTP protocol
  ### Impact
  The code in the scheduler for downloading a tiny file is hard coded to use the HTTP protocol, rather than HTTPS. This means that an attacker could perform a Man-in-the-Middle attack, changing the network request so that a different piece of data gets downloaded. Due to the use of weak integrity checks (TOB-DF2-15), this modification of the data may go unnoticed.

  ```golang
  // DownloadTinyFile downloads tiny file from peer without range.
  func (p *Peer) DownloadTinyFile() ([]byte, error) {
         ctx, cancel := context.WithTimeout(context.Background(),
  downloadTinyFileContextTimeout)
         defer cancel()
         // Download url:
  http://${host}:${port}/download/${taskIndex}/${taskID}?peerId=${peerID}
         targetURL := url.URL{
  Scheme:
  }
  "http",
  fmt.Sprintf("%s:%d", p.Host.IP, p.Host.DownloadPort),
  fmt.Sprintf("download/%s/%s", p.Task.ID[:3], p.Task.ID),
  Host:
  Path:
  RawQuery: fmt.Sprintf("peerId=%s", p.ID),
  ```

  A network-level attacker who cannot join a peer-to-peer network performs a Man-in-the-Middle attack on peers. The adversary can do this because peers (partially) communicate over plaintext HTTP protocol. The attack chains this vulnerability with the one described in TOB-DF2-15 to replace correct files with malicious ones. Unconscious peers use the malicious files.

  ### Patches

  - Dragonfy v2.1.0 and above.

  ### Workarounds

  There are no effective workarounds, beyond upgrading.

  ### References

  A third party security audit was performed by Trail of Bits, you can see the [full report](https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf).

  If you have any questions or comments about this advisory, please email us at [dragonfly-maintainers@googlegroups.com](mailto:dragonfly-maintainers@googlegroups.com).
severities:
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02413'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02533'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02534'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02539'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02546'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02503'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02496'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02505'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02598'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02572'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02567'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02471'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02469'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02482'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02411'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03057'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03074'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03072'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03059'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03049'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03048'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03173'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03162'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03885'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03781'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03703'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.0685'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-09-18T15:46:54Z/
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-mcvp-rpgg-9273
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-mcvp-rpgg-9273
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-mcvp-rpgg-9273
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-09-18T15:46:54Z/
    published_at: None
    url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-mcvp-rpgg-9273
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59410
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59410
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3974
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3974
weaknesses:
  - CWE-311
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-59410
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/blob/main/docs/security/dragonfly-comprehensive-report-2023.pdf
    reference_type:
    reference_id:
  - url: https://github.com/dragonflyoss/dragonfly/security/advisories/GHSA-mcvp-rpgg-9273
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59410
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3974
    reference_type:
    reference_id:
