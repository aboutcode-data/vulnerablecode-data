vulnerability_id: VCID-v6fx-8zze-aaaf
aliases:
  - CVE-2023-38697
  - GHSA-6jwc-qr2q-7xwj
summary: 'protocol-http1 provides a low-level implementation of the HTTP/1 protocol. RFC 9112
  Section 7.1 defined the format of chunk size, chunk data and chunk extension. The value of
  Content-Length header should be a string of 0-9 digits, the chunk size should be a string
  of hex digits and should split from chunk data using CRLF, and the chunk extension shouldn''t
  contain any invisible character. However, Falcon has following behaviors while disobey the
  corresponding RFCs: accepting Content-Length header values that have `+` prefix, accepting
  Content-Length header values that written in hexadecimal with `0x` prefix, accepting `0x`
  and `+` prefixed chunk size, and accepting LF in chunk extension. This behavior can lead to
  desync when forwarding through multiple HTTP parsers, potentially results in HTTP request
  smuggling and firewall bypassing. This issue is fixed in `protocol-http1` v0.15.1. There are
  no known workarounds.'
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-38697.json
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.35556'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.35517'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00078'
    scoring_system: epss
    scoring_elements: '0.35567'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.38190'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45529'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45279'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45614'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45633'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45715'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45710'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45714'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45732'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45759'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45926'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.45951'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.00111'
    scoring_system: epss
    scoring_elements: '0.46026'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0013'
    scoring_system: epss
    scoring_elements: '0.33909'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0013'
    scoring_system: epss
    scoring_elements: '0.33845'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0013'
    scoring_system: epss
    scoring_elements: '0.33976'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39215'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39224'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39216'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39223'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39324'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39321'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39159'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39212'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39226'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.39188'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.3921'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52122'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.51989'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.51973'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52071'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52076'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52101'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52096'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52079'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52097'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52119'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52141'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.5215'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52142'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52121'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.52102'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: '0.01161'
    scoring_system: epss
    scoring_elements: '0.65679'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-6jwc-qr2q-7xwj
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/socketry/protocol-http1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/socketry/protocol-http1
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/socketry/protocol-http1/commit/e11fc164fd2b36f7b7e785e69fa8859eb06bcedd
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/socketry/protocol-http1/commit/e11fc164fd2b36f7b7e785e69fa8859eb06bcedd
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/socketry/protocol-http1/pull/20
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/socketry/protocol-http1/pull/20
  - score: '5.8'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://github.com/socketry/protocol-http1/security/advisories/GHSA-6jwc-qr2q-7xwj
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/socketry/protocol-http1/security/advisories/GHSA-6jwc-qr2q-7xwj
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/socketry/protocol-http1/security/advisories/GHSA-6jwc-qr2q-7xwj
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/socketry/protocol-http1/security/advisories/GHSA-6jwc-qr2q-7xwj
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38697
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-38697
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N
    published_at: None
    url: https://www.rfc-editor.org/rfc/rfc9112#name-chunked-transfer-coding
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.rfc-editor.org/rfc/rfc9112#name-chunked-transfer-coding
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-444
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-38697.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-38697
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38697
    reference_type:
    reference_id:
  - url: https://github.com/socketry/protocol-http1
    reference_type:
    reference_id:
  - url: https://github.com/socketry/protocol-http1/commit/e11fc164fd2b36f7b7e785e69fa8859eb06bcedd
    reference_type:
    reference_id:
  - url: https://github.com/socketry/protocol-http1/pull/20
    reference_type:
    reference_id:
  - url: https://github.com/socketry/protocol-http1/security/advisories/GHSA-6jwc-qr2q-7xwj
    reference_type:
    reference_id:
  - url: https://www.rfc-editor.org/rfc/rfc9112#name-chunked-transfer-coding
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1043432
    reference_type:
    reference_id: 1043432
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2229389
    reference_type:
    reference_id: 2229389
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:socketry:protocol-http1:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:socketry:protocol-http1:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-38697
    reference_type:
    reference_id: CVE-2023-38697
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/protocol-http1/CVE-2023-38697.yml
    reference_type:
    reference_id: CVE-2023-38697.YML
  - url: https://github.com/advisories/GHSA-6jwc-qr2q-7xwj
    reference_type:
    reference_id: GHSA-6jwc-qr2q-7xwj
