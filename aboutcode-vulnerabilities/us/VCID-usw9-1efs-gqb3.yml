vulnerability_id: VCID-usw9-1efs-gqb3
aliases:
  - GHSA-r4pg-vg54-wxx4
summary: |
  cert-manager ha a potential slowdown / DoS when parsing specially crafted PEM inputs
  ### Impact

  cert-manager packages which call the standard library `pem.Decode()` function  can take a long time to process specially crafted invalid PEM data.

  If an attacker is able to modify PEM data which cert-manager reads (e.g. in a Secret resource), they may be able to use large amounts of CPU in the cert-manager controller pod to effectively create a denial-of-service (DoS) vector for cert-manager in the cluster.

  Secrets are limited in size to [1MiB](https://kubernetes.io/docs/concepts/configuration/secret/#restriction-data-size), which reduces the impact of this issue; it was discovered through an ~856kB fuzz test input which causes `pem.Decode` to take roughly 750ms to reject the input on an M2 Max Macbook Pro. By way of comparison, a valid PEM-encoded 4096-bit RSA key takes roughly 70Âµs to parse on the same machine.

  Given the required size of PEM data needed to present a realistic DoS vector, an attacker would need to create or insert many different large sized resources in the cluster, and so the best secondary defense is to ensure that sensible limits are placed via RBAC.

  This issue affects all versions of cert-manager to have been released since at least v0.1.0 (since `pem.Decode` is core functionality for cert-manager). All [supported releases](https://cert-manager.io/docs/releases/) are patched.

  ### Patches

  The fixed versions are v1.16.2, v1.15.4 and v1.12.14.

  - master branch: https://github.com/cert-manager/cert-manager/pull/7400
  - release-1.16 branch: https://github.com/cert-manager/cert-manager/pull/7401
  - release-1.15 branch: https://github.com/cert-manager/cert-manager/pull/7402
  - release-1.12 branch: https://github.com/cert-manager/cert-manager/pull/7403

  ### Workarounds

  Ensure that RBAC is scoped correctly in your cluster. If a user is able to modify resources containing PEM data to be able to exploit this, it's like that those permissions are a bigger security threat than this issue - especially for Secret resources.

  ### References

  - Upstream issue: https://github.com/golang/go/issues/50116
  - Similar issue: https://github.com/sigstore/sigstore/issues/198
  - Google OSSFuzz: https://issues.oss-fuzz.com/issues/376728466
severities:
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cert-manager/cert-manager
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cert-manager/cert-manager/pull/7400
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cert-manager/cert-manager/pull/7401
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cert-manager/cert-manager/pull/7402
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cert-manager/cert-manager/pull/7403
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cert-manager/cert-manager/security/advisories/GHSA-r4pg-vg54-wxx4
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/golang/go/issues/50116
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://go.dev/issue/50116
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2024-3282
weaknesses: []
references:
  - url: https://github.com/cert-manager/cert-manager
    reference_type:
    reference_id:
  - url: https://github.com/cert-manager/cert-manager/pull/7400
    reference_type:
    reference_id:
  - url: https://github.com/cert-manager/cert-manager/pull/7401
    reference_type:
    reference_id:
  - url: https://github.com/cert-manager/cert-manager/pull/7402
    reference_type:
    reference_id:
  - url: https://github.com/cert-manager/cert-manager/pull/7403
    reference_type:
    reference_id:
  - url: https://github.com/cert-manager/cert-manager/security/advisories/GHSA-r4pg-vg54-wxx4
    reference_type:
    reference_id:
  - url: https://github.com/golang/go/issues/50116
    reference_type:
    reference_id:
  - url: https://go.dev/issue/50116
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3282
    reference_type:
    reference_id:
