vulnerability_id: VCID-y4py-fwp6-aaap
aliases:
  - GHSA-w7hm-hmxv-pvhf
summary: |
  HPACK decoder panics on invalid input
  Due to insufficient checking of input data, decoding certain data sequences can lead to _Decoder::decode_ panicking rather than returning an error.

  Example code that triggers this vulnerability looks like this:

  ```rust
  use hpack::Decoder;

  pub fn main() {
    let input = &[0x3f];
    let mut decoder = Decoder::new();
    let _ = decoder.decode(input);
  }
  ```

  hpack is unmaintained. A crate with the panics fixed has been published as [hpack-patched](https://crates.io/crates/hpack-patched).

  Also consider using [fluke-hpack](https://crates.io/crates/fluke-hpack) or [httlib-huffman](https://crates.io/crates/httlib-huffman) as an alternative.
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-w7hm-hmxv-pvhf
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/mlalic/hpack-rs
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mlalic/hpack-rs
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/mlalic/hpack-rs/issues/11
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mlalic/hpack-rs/issues/11
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/sno2/hpack-rs-patched/commit/d669282924a95311599e9e7dd53869ee96b3a2f5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/sno2/hpack-rs-patched/commit/d669282924a95311599e9e7dd53869ee96b3a2f5
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2023-0085.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2023-0085.html
weaknesses:
  - CWE-754
references:
  - url: https://github.com/mlalic/hpack-rs
    reference_type:
    reference_id:
  - url: https://github.com/mlalic/hpack-rs/issues/11
    reference_type:
    reference_id:
  - url: https://github.com/sno2/hpack-rs-patched/commit/d669282924a95311599e9e7dd53869ee96b3a2f5
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2023-0085.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-w7hm-hmxv-pvhf
    reference_type:
    reference_id: GHSA-w7hm-hmxv-pvhf
