vulnerability_id: VCID-78z8-kpj1-aaaf
aliases:
  - BIT-2021-37654
  - BIT-tensorflow-2021-37654
  - CVE-2021-37654
  - GHSA-2r8p-fg3c-wcj4
  - PYSEC-2021-276
  - PYSEC-2021-567
  - PYSEC-2021-765
summary: TensorFlow is an end-to-end open source platform for machine learning. In affected
  versions an attacker can trigger a crash via a `CHECK`-fail in debug builds of TensorFlow
  using `tf.raw_ops.ResourceGather` or a read from outside the bounds of heap allocated data
  in the same API in a release build. The [implementation](https://github.com/tensorflow/tensorflow/blob/f24faa153ad31a4b51578f8181d3aaab77a1ddeb/tensorflow/core/kernels/resource_variable_ops.cc#L660-L668)
  does not check that the `batch_dims` value that the user supplies is less than the rank of
  the input tensor. Since the implementation uses several for loops over the dimensions of `tensor`,
  this results in reading data from outside the bounds of heap allocated buffer backing the
  tensor. We have patched the issue in GitHub commit bc9c546ce7015c57c2f15c168b3d9201de679a1d.
  The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow
  2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported
  range.
severities:
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11859'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11769'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11856'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11781'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11676'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09295'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11623'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09212'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09276'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09268'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09147'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09287'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09125'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09265'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09278'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09255'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.0929'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09313'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09345'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09322'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.09304'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11784'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11788'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11779'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11777'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11796'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11836'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14307'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13628'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13940'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14025'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14048'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14115'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14109'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14123'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14178'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14262'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14551'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14606'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14698'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14320'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14380'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14719'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.10693'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-2r8p-fg3c-wcj4
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-567.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-567.yaml
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-765.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-765.yaml
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-276.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-276.yaml
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/bc9c546ce7015c57c2f15c168b3d9201de679a1d
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/bc9c546ce7015c57c2f15c168b3d9201de679a1d
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-2r8p-fg3c-wcj4
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-2r8p-fg3c-wcj4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-2r8p-fg3c-wcj4
  - score: '3.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37654
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37654
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37654
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37654
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37654
  - score: Critical
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2292
weaknesses:
  - CWE-125
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-37654
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-567.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-765.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-276.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/bc9c546ce7015c57c2f15c168b3d9201de679a1d
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/AVG-2292
    reference_type:
    reference_id: AVG-2292
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.5.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc0:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:2.6.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37654
    reference_type:
    reference_id: CVE-2021-37654
  - url: https://github.com/advisories/GHSA-2r8p-fg3c-wcj4
    reference_type:
    reference_id: GHSA-2r8p-fg3c-wcj4
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-2r8p-fg3c-wcj4
    reference_type:
    reference_id: GHSA-2r8p-fg3c-wcj4
