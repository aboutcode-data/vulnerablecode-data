vulnerability_id: VCID-78bc-dhew-1fcs
aliases:
  - CVE-2025-64103
  - GHSA-cfjq-28r2-4jv5
summary: "Zitadel May Bypass Second Authentication Factor\n### Summary\n\nA vulnerability in\
  \ Zitadel's token verification prematurely marked sessions as authenticated when only one\
  \ factor was verified. \n\n### Impact\n\nZitadel provides an API for managing sessions, enabling\
  \ custom login experiences in a dedicated UI or direct integration into applications. Session\
  \ Tokens are issued for active sessions, which can be used as Bearer tokens to call the Zitadel\
  \ API.\n\nStarting from 2.55.0 (see other affected versions below), Zitadel only required\
  \ multi factor authentication in case the login policy has either enabled `requireMFA` or\
  \ `requireMFAForLocalUsers`. If a user has set up MFA without this requirement, Zitadel would\
  \ consider single factor auhtenticated sessions as valid as well and not require multiple\
  \ factors.\n\nBypassing second authentication factors weakens multifactor authentication and\
  \ enables attackers to bypass the more secure factor. An attacker can target the TOTP code\
  \ alone, only six digits, bypassing password verification entirely and potentially compromising\
  \ accounts with 2FA enabled.\n\n### Affected Versions\n\nSystems using the session API (v2\
  \ beta and v2) directly or via the new login UI in the following versions are affected:\n\
  - **4.x**: `4.0.0` to `4.5.0` (including RC versions)\n- **3.x**: `3.0.0` to `3.4.2` (including\
  \ RC versions)\n- **2.x**: `v2.53.6` to `v2.53.9`,  `v2.54.3` to `v2.54.10`, `2.55.0` to `2.71.17`\n\
  \n### Patches\n\nThe vulnerability has been addressed in the latest releases. The patch resolves\
  \ the issue by requiring a configured second factor regardless of the login policies `requireMFA`\
  \ or `requireMFAForLocalUsers` configuration.\n\n4.x: Upgrade to >=[4.6.0](https://github.com/zitadel/zitadel/releases/tag/v4.6.0)\n\
  3.x: Update to >=[3.4.3](https://github.com/zitadel/zitadel/releases/tag/v3.4.3)\n2.x: Update\
  \ to >=[2.71.18](https://github.com/zitadel/zitadel/releases/tag/v2.71.18)\n\n### Workarounds\n\
  \nThe recommended solution is to update Zitadel to a patched version.\n\n### Questions\n\n\
  If you have any questions or comments about this advisory, please email us at [security@zitadel.com](mailto:security@zitadel.com)\n\
  \n### Credits\n\nThis vulnerability was found by [zentrust partners GmbH](https://zentrust.partners)\
  \ during a scheduled penetration test. Thank you to the analysts Martin Tschirsich, Joud Zakharia,\
  \ Christopher Baumann.\nThe full report will be made public after the complete review."
severities:
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.26519'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64103
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.2646'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64103
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.26489'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64103
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.33454'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64103
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.33477'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64103
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/zitadel/zitadel/commit/b284f8474eed0cba531905101619e7ae7963156b
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel/commit/b284f8474eed0cba531905101619e7ae7963156b
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-10-30T14:51:11Z/
    published_at: None
    url: https://github.com/zitadel/zitadel/commit/b284f8474eed0cba531905101619e7ae7963156b
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/zitadel/zitadel/security/advisories/GHSA-cfjq-28r2-4jv5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel/security/advisories/GHSA-cfjq-28r2-4jv5
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-10-30T14:51:11Z/
    published_at: None
    url: https://github.com/zitadel/zitadel/security/advisories/GHSA-cfjq-28r2-4jv5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-64103
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-4083
weaknesses:
  - CWE-308
  - CWE-287
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-64103
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/b284f8474eed0cba531905101619e7ae7963156b
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-cfjq-28r2-4jv5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64103
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-4083
    reference_type:
    reference_id:
