vulnerability_id: VCID-pvg4-9ak1-yyd9
aliases:
  - CVE-2025-38236
summary: 'In the Linux kernel, the following vulnerability has been resolved:  af_unix: Don''t
  leave consecutive consumed OOB skbs.  Jann Horn reported a use-after-free in unix_stream_read_generic().  The
  following sequences reproduce the issue:    $ python3   from socket import *   s1, s2 = socketpair(AF_UNIX,
  SOCK_STREAM)   s1.send(b''x'', MSG_OOB)   s2.recv(1, MSG_OOB)     # leave a consumed OOB skb   s1.send(b''y'',
  MSG_OOB)   s2.recv(1, MSG_OOB)     # leave a consumed OOB skb   s1.send(b''z'', MSG_OOB)   s2.recv(1)              #
  recv ''z'' illegally   s2.recv(1, MSG_OOB)     # access ''z'' skb (use-after-free)  Even though
  a user reads OOB data, the skb holding the data stays on the recv queue to mark the OOB boundary
  and break the next recv().  After the last send() in the scenario above, the sk2''s recv queue
  has 2 leading consumed OOB skbs and 1 real OOB skb.  Then, the following happens during the
  next recv() without MSG_OOB    1. unix_stream_read_generic() peeks the first consumed OOB
  skb   2. manage_oob() returns the next consumed OOB skb   3. unix_stream_read_generic() fetches
  the next not-yet-consumed OOB skb   4. unix_stream_read_generic() reads and frees the OOB
  skb  , and the last recv(MSG_OOB) triggers KASAN splat.  The 3. above occurs because of the
  SO_PEEK_OFF code, which does not expect unix_skb_len(skb) to be 0, but this is true for such
  consumed OOB skbs.    while (skip >= unix_skb_len(skb)) {     skip -= unix_skb_len(skb);     skb
  = skb_peek_next(skb, &sk->sk_receive_queue);     ...   }  In addition to this use-after-free,
  there is another issue that ioctl(SIOCATMARK) does not function properly with consecutive
  consumed OOB skbs.  So, nothing good comes out of such a situation.  Instead of complicating
  manage_oob(), ioctl() handling, and the next ECONNRESET fix by introducing a loop for consecutive
  consumed OOB skbs, let''s not leave such consecutive OOB unnecessarily.  Now, while receiving
  an OOB skb in unix_stream_recv_urg(), if its previous skb is a consumed OOB skb, it is freed.  [0]:
  BUG: KASAN: slab-use-after-free in unix_stream_read_actor (net/unix/af_unix.c:3027) Read of
  size 4 at addr ffff888106ef2904 by task python3/315  CPU: 2 UID: 0 PID: 315 Comm: python3
  Not tainted 6.16.0-rc1-00407-gec315832f6f9 #8 PREEMPT(voluntary) Hardware name: QEMU Standard
  PC (i440FX + PIIX, 1996), BIOS 1.16.3-4.fc42 04/01/2014 Call Trace:  <TASK>  dump_stack_lvl
  (lib/dump_stack.c:122)  print_report (mm/kasan/report.c:409 mm/kasan/report.c:521)  kasan_report
  (mm/kasan/report.c:636)  unix_stream_read_actor (net/unix/af_unix.c:3027)  unix_stream_read_generic
  (net/unix/af_unix.c:2708 net/unix/af_unix.c:2847)  unix_stream_recvmsg (net/unix/af_unix.c:3048)  sock_recvmsg
  (net/socket.c:1063 (discriminator 20) net/socket.c:1085 (discriminator 20))  __sys_recvfrom
  (net/socket.c:2278)  __x64_sys_recvfrom (net/socket.c:2291 (discriminator 1) net/socket.c:2287
  (discriminator 1) net/socket.c:2287 (discriminator 1))  do_syscall_64 (arch/x86/entry/syscall_64.c:63
  (discriminator 1) arch/x86/entry/syscall_64.c:94 (discriminator 1))  entry_SYSCALL_64_after_hwframe
  (arch/x86/entry/entry_64.S:130) RIP: 0033:0x7f8911fcea06 Code: 5d e8 41 8b 93 08 03 00 00
  59 5e 48 83 f8 fc 75 19 83 e2 39 83 fa 08 75 11 e8 26 ff ff ff 66 0f 1f 44 00 00 48 8b 45
  10 0f 05 <48> 8b 5d f8 c9 c3 0f 1f 40 00 f3 0f 1e fa 55 48 89 e5 48 83 ec 08 RSP: 002b:00007fffdb0dccb0
  EFLAGS: 00000202 ORIG_RAX: 000000000000002d RAX: ffffffffffffffda RBX: 00007fffdb0dcdc8 RCX:
  00007f8911fcea06 RDX: 0000000000000001 RSI: 00007f8911a5e060 RDI: 0000000000000006 RBP: 00007fffdb0dccd0
  R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000001 R11: 0000000000000202 R12:
  00007f89119a7d20 R13: ffffffffc4653600 R14: 0000000000000000 R15: 0000000000000000  </TASK>  Allocated
  by task 315:  kasan_save_stack (mm/kasan/common.c:48)  kasan_save_track (mm/kasan/common.c:60
  (discriminator 1) mm/kasan/common.c:69 (discriminator 1))  __kasan_slab_alloc (mm/kasan/common.c:348)  kmem_cache_alloc_
  ---truncated---'
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38236.json
  - score: '7.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38236.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02898'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02901'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02913'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05176'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05165'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04688'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04685'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04692'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04606'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04605'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08595'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08575'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08587'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08678'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0841'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08389'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08329'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08296'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08287'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08257'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08228'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10204'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10282'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10228'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10222'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10211'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10281'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10231'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09751'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09861'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09926'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09979'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0992'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10024'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09997'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10155'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10134'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10135'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10279'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10267'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10299'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10271'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10242'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10287'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10284'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1032'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10333'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1031'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10276'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10233'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38236.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38236
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38236
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/32ca245464e1479bfea8592b9db227fdc1641705
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/61a9ad7b69ce688697e5f63332f03e17725353bc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8db4d2d026e6e3649832bfe23b96c4acff0756db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a12237865b48a73183df252029ff5065d73d305e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fad0a2c16062ac7c606b93166a7ce9d265bab976
    reference_type:
    reference_id:
  - url: https://project-zero.issues.chromium.org/issues/423023990
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2377077
    reference_type:
    reference_id: 2377077
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38236
    reference_type:
    reference_id: CVE-2025-38236
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
