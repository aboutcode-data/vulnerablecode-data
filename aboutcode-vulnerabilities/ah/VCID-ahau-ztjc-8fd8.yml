vulnerability_id: VCID-ahau-ztjc-8fd8
aliases:
  - CVE-2022-49911
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: ipset: enforce documented limit to prevent allocating huge memory

  Daniel Xu reported that the hash:net,iface type of the ipset subsystem does
  not limit adding the same network with different interfaces to a set, which
  can lead to huge memory usage or allocation failure.

  The quick reproducer is

  $ ipset create ACL.IN.ALL_PERMIT hash:net,iface hashsize 1048576 timeout 0
  $ for i in $(seq 0 100); do /sbin/ipset add ACL.IN.ALL_PERMIT 0.0.0.0/0,kaf_$i timeout 0 -exist; done

  The backtrace when vmalloc fails:

          [Tue Oct 25 00:13:08 2022] ipset: vmalloc error: size 1073741848, exceeds total pages
          <...>
          [Tue Oct 25 00:13:08 2022] Call Trace:
          [Tue Oct 25 00:13:08 2022]  <TASK>
          [Tue Oct 25 00:13:08 2022]  dump_stack_lvl+0x48/0x60
          [Tue Oct 25 00:13:08 2022]  warn_alloc+0x155/0x180
          [Tue Oct 25 00:13:08 2022]  __vmalloc_node_range+0x72a/0x760
          [Tue Oct 25 00:13:08 2022]  ? hash_netiface4_add+0x7c0/0xb20
          [Tue Oct 25 00:13:08 2022]  ? __kmalloc_large_node+0x4a/0x90
          [Tue Oct 25 00:13:08 2022]  kvmalloc_node+0xa6/0xd0
          [Tue Oct 25 00:13:08 2022]  ? hash_netiface4_resize+0x99/0x710
          <...>

  The fix is to enforce the limit documented in the ipset(8) manpage:

  >  The internal restriction of the hash:net,iface set type is that the same
  >  network prefix cannot be stored with more than 64 different interfaces
  >  in a single set.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49911.json
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01763'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01741'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02513'
    published_at: '2025-05-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02628'
    published_at: '2025-05-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02559'
    published_at: '2025-05-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02633'
    published_at: '2025-05-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02526'
    published_at: '2025-05-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03917'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03882'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03918'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.04022'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0399'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03987'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0381'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03801'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.0401'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04296'
    published_at: '2025-05-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04298'
    published_at: '2025-05-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04277'
    published_at: '2025-05-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04289'
    published_at: '2025-05-31 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04384'
    published_at: '2025-06-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04297'
    published_at: '2025-05-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04284'
    published_at: '2025-05-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04324'
    published_at: '2025-05-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04315'
    published_at: '2025-05-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04301'
    published_at: '2025-05-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.043'
    published_at: '2025-05-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04317'
    published_at: '2025-05-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04329'
    published_at: '2025-05-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04375'
    published_at: '2025-05-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0437'
    published_at: '2025-05-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04421'
    published_at: '2025-05-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04387'
    published_at: '2025-05-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04341'
    published_at: '2025-05-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04349'
    published_at: '2025-05-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04327'
    published_at: '2025-05-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04304'
    published_at: '2025-05-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04292'
    published_at: '2025-05-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05017'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05054'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05071'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04778'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04818'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04806'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04735'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04761'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04803'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04792'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04787'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0486'
    published_at: '2025-06-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05098'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05111'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05081'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04855'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04923'
    published_at: '2025-06-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05122'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05018'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05003'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0499'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04999'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05012'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0503'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0498'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05129'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05158'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05154'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05116'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05112'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05117'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05036'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0503'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04939'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04977'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04989'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.04988'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05024'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0788'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07893'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07824'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07862'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07822'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07784'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07673'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07698'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07595'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0757'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07588'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49911.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-49911
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/42d20d5e24575c9afa2d66d9a51e7386db9514f5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/510841da1fcc16f702440ab58ef0b4d82a9056b7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a37ef32fe5956fe9248df68f6a61997845ba047e
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2363421
    reference_type:
    reference_id: 2363421
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49911
    reference_type:
    reference_id: CVE-2022-49911
  - url: https://access.redhat.com/errata/RHSA-2023:2458
    reference_type:
    reference_id: RHSA-2023:2458
