vulnerability_id: VCID-bguf-u2zz-pfff
aliases:
  - GHSA-rp9h-rf7g-hwgr
summary: "s2n-tls has undefined behavior at process exit\n### Impact\ns2n-tls uses the Linux\
  \ atexit function to register functions that clean up the global state when the process exits.\
  \ In multi-threaded environments, the atexit handler may clean up state which is still in\
  \ use by other threads. When this occurs, the exiting process may experience a segmentation\
  \ fault or other undefined behavior. \n\nCustomers of AWS services do not need to take action.\
  \ Applications using s2n-tls should upgrade to the most recent release of s2n-tls.\n\n**Impacted\
  \ versions**: < v1.5.9.\n\n### Patches\nThe patch commit [493b771](https://github.com/aws/s2n-tls/commit/493b77167dc367c394de23cfe78a029298e2a254)\
  \ is included in s2n-tls v1.5.9 [1]\n\n### Workarounds\nThe atexit handler may be disabled\
  \ by calling `s2n_disable_atexit()` prior to initializing s2n-tls. The atexit handler is off\
  \ by default in the patched versions. For further details, refer to [s2n-tls Usage Guide:\
  \ Initialization and Teardown](https://github.com/aws/s2n-tls/blob/main/docs/usage-guide/topics/ch02-initialization.md).\n\
  \nIf you have any questions or comments about this advisory, we ask that you contact AWS/Amazon\
  \ Security via our vulnerability reporting page [2] or directly via email to [aws-security@amazon.com](mailto:aws-security@amazon.com).\
  \ Please do not create a public GitHub issue.\n\n[1] https://github.com/aws/s2n-tls/releases/tag/v1.5.9\n\
  [2] Vulnerability reporting page: https://aws.amazon.com/security/vulnerability-reporting"
severities:
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-rp9h-rf7g-hwgr
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/s2n-tls
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/s2n-tls/commit/493b77167dc367c394de23cfe78a029298e2a254
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/s2n-tls/releases/tag/v1.5.9
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/aws/s2n-tls/security/advisories/GHSA-rp9h-rf7g-hwgr
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/s2n-tls/security/advisories/GHSA-rp9h-rf7g-hwgr
weaknesses: []
references:
  - url: https://github.com/aws/s2n-tls
    reference_type:
    reference_id:
  - url: https://github.com/aws/s2n-tls/commit/493b77167dc367c394de23cfe78a029298e2a254
    reference_type:
    reference_id:
  - url: https://github.com/aws/s2n-tls/releases/tag/v1.5.9
    reference_type:
    reference_id:
  - url: https://github.com/aws/s2n-tls/security/advisories/GHSA-rp9h-rf7g-hwgr
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-rp9h-rf7g-hwgr
    reference_type:
    reference_id: GHSA-rp9h-rf7g-hwgr
