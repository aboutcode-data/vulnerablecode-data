vulnerability_id: VCID-q28g-pcx4-bqeu
aliases:
  - CVE-2022-50838
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: stream:
  purge sk_error_queue in sk_stream_kill_queues()  Changheon Lee reported TCP socket leaks,
  with a nice repro.  It seems we leak TCP sockets with the following sequence:  1) SOF_TIMESTAMPING_TX_ACK
  is enabled on the socket.     Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().    __skb_tstamp_tx()
  is using skb_clone(), unless    SOF_TIMESTAMPING_OPT_TSONLY was also requested.  2) If the
  application is also using MSG_ZEROCOPY, then we put in the    error queue cloned skbs that
  had a struct ubuf_info attached to them.     Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()    does
  a sock_hold().     As long as the cloned skbs are still in sk_error_queue,    socket refcount
  is kept elevated.  3) Application closes the socket, while error queue is not empty.  Since
  tcp_close() no longer purges the socket error queue, we might end up with a TCP socket with
  at least one skb in error queue keeping the socket alive forever.  This bug can be (ab)used
  to consume all kernel memory and freeze the host.  We need to purge the error queue, with
  proper synchronization against concurrent writers.'
severities:
  - score: '6.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50838.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.13262'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50838
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.13218'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50838
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-401
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50838.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50838
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-50838
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2426181
    reference_type:
    reference_id: 2426181
