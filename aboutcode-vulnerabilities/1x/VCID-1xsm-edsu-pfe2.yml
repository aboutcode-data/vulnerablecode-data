vulnerability_id: VCID-1xsm-edsu-pfe2
aliases:
  - CVE-2024-49875
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nfsd: map the EBADMSG to nfserr_io to avoid warning

  Ext4 will throw -EBADMSG through ext4_readdir when a checksum error
  occurs, resulting in the following WARNING.

  Fix it by mapping EBADMSG to nfserr_io.

  nfsd_buffered_readdir
   iterate_dir // -EBADMSG -74
    ext4_readdir // .iterate_shared
     ext4_dx_readdir
      ext4_htree_fill_tree
       htree_dirblock_to_tree
        ext4_read_dirblock
         __ext4_read_dirblock
          ext4_dirblock_csum_verify
           warn_no_space_for_csum
            __warn_no_space_for_csum
          return ERR_PTR(-EFSBADCRC) // -EBADMSG -74
   nfserrno // WARNING

  [  161.115610] ------------[ cut here ]------------
  [  161.116465] nfsd: non-standard errno: -74
  [  161.117315] WARNING: CPU: 1 PID: 780 at fs/nfsd/nfsproc.c:878 nfserrno+0x9d/0xd0
  [  161.118596] Modules linked in:
  [  161.119243] CPU: 1 PID: 780 Comm: nfsd Not tainted 5.10.0-00014-g79679361fd5d #138
  [  161.120684] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qe
  mu.org 04/01/2014
  [  161.123601] RIP: 0010:nfserrno+0x9d/0xd0
  [  161.124676] Code: 0f 87 da 30 dd 00 83 e3 01 b8 00 00 00 05 75 d7 44 89 ee 48 c7 c7 c0 57 24 98 89 44 24 04 c6
   05 ce 2b 61 03 01 e8 99 20 d8 00 <0f> 0b 8b 44 24 04 eb b5 4c 89 e6 48 c7 c7 a0 6d a4 99 e8 cc 15 33
  [  161.127797] RSP: 0018:ffffc90000e2f9c0 EFLAGS: 00010286
  [  161.128794] RAX: 0000000000000000 RBX: 0000000000000000 RCX: 0000000000000000
  [  161.130089] RDX: 1ffff1103ee16f6d RSI: 0000000000000008 RDI: fffff520001c5f2a
  [  161.131379] RBP: 0000000000000022 R08: 0000000000000001 R09: ffff8881f70c1827
  [  161.132664] R10: ffffed103ee18304 R11: 0000000000000001 R12: 0000000000000021
  [  161.133949] R13: 00000000ffffffb6 R14: ffff8881317c0000 R15: ffffc90000e2fbd8
  [  161.135244] FS:  0000000000000000(0000) GS:ffff8881f7080000(0000) knlGS:0000000000000000
  [  161.136695] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
  [  161.137761] CR2: 00007fcaad70b348 CR3: 0000000144256006 CR4: 0000000000770ee0
  [  161.139041] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
  [  161.140291] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
  [  161.141519] PKRU: 55555554
  [  161.142076] Call Trace:
  [  161.142575]  ? __warn+0x9b/0x140
  [  161.143229]  ? nfserrno+0x9d/0xd0
  [  161.143872]  ? report_bug+0x125/0x150
  [  161.144595]  ? handle_bug+0x41/0x90
  [  161.145284]  ? exc_invalid_op+0x14/0x70
  [  161.146009]  ? asm_exc_invalid_op+0x12/0x20
  [  161.146816]  ? nfserrno+0x9d/0xd0
  [  161.147487]  nfsd_buffered_readdir+0x28b/0x2b0
  [  161.148333]  ? nfsd4_encode_dirent_fattr+0x380/0x380
  [  161.149258]  ? nfsd_buffered_filldir+0xf0/0xf0
  [  161.150093]  ? wait_for_concurrent_writes+0x170/0x170
  [  161.151004]  ? generic_file_llseek_size+0x48/0x160
  [  161.151895]  nfsd_readdir+0x132/0x190
  [  161.152606]  ? nfsd4_encode_dirent_fattr+0x380/0x380
  [  161.153516]  ? nfsd_unlink+0x380/0x380
  [  161.154256]  ? override_creds+0x45/0x60
  [  161.155006]  nfsd4_encode_readdir+0x21a/0x3d0
  [  161.155850]  ? nfsd4_encode_readlink+0x210/0x210
  [  161.156731]  ? write_bytes_to_xdr_buf+0x97/0xe0
  [  161.157598]  ? __write_bytes_to_xdr_buf+0xd0/0xd0
  [  161.158494]  ? lock_downgrade+0x90/0x90
  [  161.159232]  ? nfs4svc_decode_voidarg+0x10/0x10
  [  161.160092]  nfsd4_encode_operation+0x15a/0x440
  [  161.160959]  nfsd4_proc_compound+0x718/0xe90
  [  161.161818]  nfsd_dispatch+0x18e/0x2c0
  [  161.162586]  svc_process_common+0x786/0xc50
  [  161.163403]  ? nfsd_svc+0x380/0x380
  [  161.164137]  ? svc_printk+0x160/0x160
  [  161.164846]  ? svc_xprt_do_enqueue.part.0+0x365/0x380
  [  161.165808]  ? nfsd_svc+0x380/0x380
  [  161.166523]  ? rcu_is_watching+0x23/0x40
  [  161.167309]  svc_process+0x1a5/0x200
  [  161.168019]  nfsd+0x1f5/0x380
  [  161.168663]  ? nfsd_shutdown_threads+0x260/0x260
  [  161.169554]  kthread+0x1c4/0x210
  [  161.170224]  ? kthread_insert_work_sanity_check+0x80/0x80
  [  161.171246]  ret_from_fork+0x1f/0x30
severities:
  - score: '3.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-49875.json
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-49875.json
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00899'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00609'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00611'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00612'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00622'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00624'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00625'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00629'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00632'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00633'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.0063'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00902'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00907'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00904'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00903'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00908'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00896'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00895'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00889'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00892'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00905'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00901'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00906'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.0062'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00614'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11214'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11518'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11609'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11632'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11700'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11696'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11709'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11764'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11819'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12119'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12177'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12271'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11828'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11841'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11891'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12225'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.0039'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00305'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00387'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
  - score: '0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49875
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-49875
weaknesses:
  - CWE-354
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-49875.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-49875
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-49875
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0ea4333c679f333e23956de743ad17387819d3f2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/340e61e44c1d2a15c42ec72ade9195ad525fd048
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6fe058502f8864649c3d614b06b2235223798f48
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/825789ca94602543101045ad3aad19b2b60c6b2a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c76005adfa93d1a027433331252422078750321f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e9cfecca22a36b927a440abc6307efb9e138fed5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f7d8ee9db94372b8235f5f22bb24381891594c42
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2320425
    reference_type:
    reference_id: 2320425
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-49875
    reference_type:
    reference_id: CVE-2024-49875
  - url: https://usn.ubuntu.com/7166-1/
    reference_type:
    reference_id: USN-7166-1
  - url: https://usn.ubuntu.com/7166-2/
    reference_type:
    reference_id: USN-7166-2
  - url: https://usn.ubuntu.com/7166-3/
    reference_type:
    reference_id: USN-7166-3
  - url: https://usn.ubuntu.com/7166-4/
    reference_type:
    reference_id: USN-7166-4
  - url: https://usn.ubuntu.com/7186-1/
    reference_type:
    reference_id: USN-7186-1
  - url: https://usn.ubuntu.com/7186-2/
    reference_type:
    reference_id: USN-7186-2
  - url: https://usn.ubuntu.com/7194-1/
    reference_type:
    reference_id: USN-7194-1
  - url: https://usn.ubuntu.com/7276-1/
    reference_type:
    reference_id: USN-7276-1
  - url: https://usn.ubuntu.com/7277-1/
    reference_type:
    reference_id: USN-7277-1
  - url: https://usn.ubuntu.com/7301-1/
    reference_type:
    reference_id: USN-7301-1
  - url: https://usn.ubuntu.com/7303-1/
    reference_type:
    reference_id: USN-7303-1
  - url: https://usn.ubuntu.com/7303-2/
    reference_type:
    reference_id: USN-7303-2
  - url: https://usn.ubuntu.com/7303-3/
    reference_type:
    reference_id: USN-7303-3
  - url: https://usn.ubuntu.com/7304-1/
    reference_type:
    reference_id: USN-7304-1
  - url: https://usn.ubuntu.com/7310-1/
    reference_type:
    reference_id: USN-7310-1
  - url: https://usn.ubuntu.com/7311-1/
    reference_type:
    reference_id: USN-7311-1
  - url: https://usn.ubuntu.com/7384-1/
    reference_type:
    reference_id: USN-7384-1
  - url: https://usn.ubuntu.com/7384-2/
    reference_type:
    reference_id: USN-7384-2
  - url: https://usn.ubuntu.com/7385-1/
    reference_type:
    reference_id: USN-7385-1
  - url: https://usn.ubuntu.com/7386-1/
    reference_type:
    reference_id: USN-7386-1
  - url: https://usn.ubuntu.com/7403-1/
    reference_type:
    reference_id: USN-7403-1
  - url: https://usn.ubuntu.com/7468-1/
    reference_type:
    reference_id: USN-7468-1
