vulnerability_id: VCID-1xzt-vwv2-pqdp
aliases:
  - CVE-2022-50476
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ntb_netdev: Use
  dev_kfree_skb_any() in interrupt context  TX/RX callback handlers (ntb_netdev_tx_handler(),
  ntb_netdev_rx_handler()) can be called in interrupt context via the DMA framework when the
  respective DMA operations have completed. As such, any calls by these routines to free skb''s,
  should use the interrupt context safe dev_kfree_skb_any() function.  Previously, these callback
  handlers would call the interrupt unsafe version of dev_kfree_skb(). This has not presented
  an issue on Intel IOAT DMA engines as that driver utilizes tasklets rather than a hard interrupt
  handler, like the AMD PTDMA DMA driver. On AMD systems, a kernel WARNING message is encountered,
  which is being issued from skb_release_head_state() due to in_hardirq() being true.  Besides
  the user visible WARNING from the kernel, the other symptom of this bug was that TCP/IP performance
  across the ntb_netdev interface was very poor, i.e. approximately an order of magnitude below
  what was expected. With the repair to use dev_kfree_skb_any(), kernel WARNINGs from skb_release_head_state()
  ceased and TCP/IP performance, as measured by iperf, was on par with expected results, approximately
  20 Gb/s on AMD Milan based server. Note that this performance is comparable with Intel based
  servers.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50476.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50476.json
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08384'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08434'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08398'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1293'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12898'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12832'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12929'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1292'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12927'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12907'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12919'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12923'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1298'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.13029'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12939'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1299'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.13006'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1297'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15522'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15541'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-763
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50476.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50476
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-50476
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2401527
    reference_type:
    reference_id: 2401527
