vulnerability_id: VCID-wh9t-t3a6-aaar
aliases:
  - CVE-2024-23649
  - GHSA-r64r-5h43-26qv
summary: |
  Lemmy is a link aggregator and forum for the fediverse. Starting in version 0.17.0 and prior to version 0.19.1, users can report private messages, even when they're neither sender nor recipient of the message. The API response to creating a private message report contains the private message itself, which means any user can just iterate over message ids to (loudly) obtain all private messages of an instance. A user with instance admin privileges can also abuse this if the private message is removed from the response, as they're able to see the resulting reports.

  Creating a private message report by POSTing to `/api/v3/private_message/report` does not validate whether the reporter is the recipient of the message. lemmy-ui does not allow the sender to report the message; the API method should likely be restricted to accessible to recipients only. The API response when creating a report contains the `private_message_report_view` with all the details of the report, including the private message that has been reported:

  Any authenticated user can obtain arbitrary (untargeted) private message contents. Privileges required depend on the instance configuration; when registrations are enabled without application system, the privileges required are practically none. When registration applications are required, privileges required could be considered low, but this assessment heavily varies by instance.

  Version 0.19.1 contains a patch for this issue. A workaround is available. If an update to a fixed Lemmy version is not immediately possible, the API route can be blocked in the reverse proxy. This will prevent anyone from reporting private messages, but it will also prevent exploitation before the update has been applied.
severities:
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19738'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20019'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20089'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20187'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20106'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20100'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19588'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19701'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19662'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19654'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19671'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19176'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19451'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19552'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.22926'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.23325'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43522'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43509'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43506'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43597'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43451'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43511'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43573'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43602'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43497'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43456'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.435'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43487'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.4351'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.43514'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40423'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.4035'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40319'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40429'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40439'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40437'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40463'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40442'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40443'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40461'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40486'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40484'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40455'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40435'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40416'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: '0.00406'
    scoring_system: epss
    scoring_elements: '0.44203'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-r64r-5h43-26qv
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/LemmyNet/lemmy
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/LemmyNet/lemmy
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/LemmyNet/lemmy/commit/bc32b408b523b9b64aa57b8e47748f96cce0dae5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/LemmyNet/lemmy/commit/bc32b408b523b9b64aa57b8e47748f96cce0dae5
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/LemmyNet/lemmy/security/advisories/GHSA-r64r-5h43-26qv
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/LemmyNet/lemmy/security/advisories/GHSA-r64r-5h43-26qv
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23649
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23649
weaknesses:
  - CWE-285
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-23649
    reference_type:
    reference_id:
  - url: https://github.com/LemmyNet/lemmy
    reference_type:
    reference_id:
  - url: https://github.com/LemmyNet/lemmy/commit/bc32b408b523b9b64aa57b8e47748f96cce0dae5
    reference_type:
    reference_id:
  - url: https://github.com/LemmyNet/lemmy/security/advisories/GHSA-r64r-5h43-26qv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:join-lemmy:lemmy:*:*:*:*:*:rust:*:*
    reference_type:
    reference_id: cpe:2.3:a:join-lemmy:lemmy:*:*:*:*:*:rust:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23649
    reference_type:
    reference_id: CVE-2024-23649
  - url: https://github.com/advisories/GHSA-r64r-5h43-26qv
    reference_type:
    reference_id: GHSA-r64r-5h43-26qv
