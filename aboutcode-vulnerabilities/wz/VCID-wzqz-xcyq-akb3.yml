vulnerability_id: VCID-wzqz-xcyq-akb3
aliases:
  - CVE-2023-53031
summary: 'In the Linux kernel, the following vulnerability has been resolved:  powerpc/imc-pmu:
  Fix use of mutex in IRQs disabled section  Current imc-pmu code triggers a WARNING with CONFIG_DEBUG_ATOMIC_SLEEP
  and CONFIG_PROVE_LOCKING enabled, while running a thread_imc event.  Command to trigger the
  warning:   # perf stat -e thread_imc/CPM_CS_FROM_L4_MEM_X_DPTEG/ sleep 5     Performance counter
  stats for ''sleep 5'':                     0      thread_imc/CPM_CS_FROM_L4_MEM_X_DPTEG/           5.002117947
  seconds time elapsed           0.000131000 seconds user          0.001063000 seconds sys  Below
  is snippet of the warning in dmesg:    BUG: sleeping function called from invalid context
  at kernel/locking/mutex.c:580   in_atomic(): 1, irqs_disabled(): 1, non_block: 0, pid: 2869,
  name: perf-exec   preempt_count: 2, expected: 0   4 locks held by perf-exec/2869:    #0: c00000004325c540
  (&sig->cred_guard_mutex){+.+.}-{3:3}, at: bprm_execve+0x64/0xa90    #1: c00000004325c5d8 (&sig->exec_update_lock){++++}-{3:3},
  at: begin_new_exec+0x460/0xef0    #2: c0000003fa99d4e0 (&cpuctx_lock){-...}-{2:2}, at: perf_event_exec+0x290/0x510    #3:
  c000000017ab8418 (&ctx->lock){....}-{2:2}, at: perf_event_exec+0x29c/0x510   irq event stamp:
  4806   hardirqs last  enabled at (4805): [<c000000000f65b94>] _raw_spin_unlock_irqrestore+0x94/0xd0   hardirqs
  last disabled at (4806): [<c0000000003fae44>] perf_event_exec+0x394/0x510   softirqs last  enabled
  at (0): [<c00000000013c404>] copy_process+0xc34/0x1ff0   softirqs last disabled at (0): [<0000000000000000>]
  0x0   CPU: 36 PID: 2869 Comm: perf-exec Not tainted 6.2.0-rc2-00011-g1247637727f2 #61   Hardware
  name: 8375-42A POWER9 0x4e1202 opal:v7.0-16-g9b85f7d961 PowerNV   Call Trace:     dump_stack_lvl+0x98/0xe0
  (unreliable)     __might_resched+0x2f8/0x310     __mutex_lock+0x6c/0x13f0     thread_imc_event_add+0xf4/0x1b0     event_sched_in+0xe0/0x210     merge_sched_in+0x1f0/0x600     visit_groups_merge.isra.92.constprop.166+0x2bc/0x6c0     ctx_flexible_sched_in+0xcc/0x140     ctx_sched_in+0x20c/0x2a0     ctx_resched+0x104/0x1c0     perf_event_exec+0x340/0x510     begin_new_exec+0x730/0xef0     load_elf_binary+0x3f8/0x1e10   ...   do
  not call blocking ops when !TASK_RUNNING; state=2001 set at [<00000000fd63e7cf>] do_nanosleep+0x60/0x1a0   WARNING:
  CPU: 36 PID: 2869 at kernel/sched/core.c:9912 __might_sleep+0x9c/0xb0   CPU: 36 PID: 2869
  Comm: sleep Tainted: G        W          6.2.0-rc2-00011-g1247637727f2 #61   Hardware name:
  8375-42A POWER9 0x4e1202 opal:v7.0-16-g9b85f7d961 PowerNV   NIP:  c000000000194a1c LR: c000000000194a18
  CTR: c000000000a78670   REGS: c00000004d2134e0 TRAP: 0700   Tainted: G        W           (6.2.0-rc2-00011-g1247637727f2)   MSR:  9000000000021033
  <SF,HV,ME,IR,DR,RI,LE>  CR: 48002824  XER: 00000000   CFAR: c00000000013fb64 IRQMASK: 1  The
  above warning triggered because the current imc-pmu code uses mutex lock in interrupt disabled
  sections. The function mutex_lock() internally calls __might_resched(), which will check if
  IRQs are disabled and in case IRQs are disabled, it will trigger the warning.  Fix the issue
  by changing the mutex lock to spinlock.  [mpe: Fix comments, trim oops in change log, add
  reported-by tags]'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53031.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02551'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02508'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.0195'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03727'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03735'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0375'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03752'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03771'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03803'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03799'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03796'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03789'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03775'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04779'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04804'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04835'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04815'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04811'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04788'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04746'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04741'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04749'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04751'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04755'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04764'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03736'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03725'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03724'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53031.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53031
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-53031
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/424bcb570cb320d1d15238cd4c933522b90f78fa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/76d588dddc459fefa1da96e0a081a397c5c8e216
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8cbeb60320ac45a8240b561c8ef466b86c34dedc
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a90d339f1f66be4a946769b565668e2bd0686dfa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d0c6d2a31026102d4738b47a610bed4401b9834f
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355516
    reference_type:
    reference_id: 2355516
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53031
    reference_type:
    reference_id: CVE-2023-53031
