vulnerability_id: VCID-uvsv-kagm-sbf2
aliases:
  - CVE-2025-38221
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ext4: fix out of bounds punch offset

  Punching a hole with a start offset that exceeds max_end is not
  permitted and will result in a negative length in the
  truncate_inode_partial_folio() function while truncating the page cache,
  potentially leading to undesirable consequences.

  A simple reproducer:

    truncate -s 9895604649994 /mnt/foo
    xfs_io -c "pwrite 8796093022208 4096" /mnt/foo
    xfs_io -c "fpunch 8796093022213 25769803777" /mnt/foo

    kernel BUG at include/linux/highmem.h:275!
    Oops: invalid opcode: 0000 [#1] SMP PTI
    CPU: 3 UID: 0 PID: 710 Comm: xfs_io Not tainted 6.15.0-rc3
    Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-2.fc40 04/01/2014
    RIP: 0010:zero_user_segments.constprop.0+0xd7/0x110
    RSP: 0018:ffffc90001cf3b38 EFLAGS: 00010287
    RAX: 0000000000000005 RBX: ffffea0001485e40 RCX: 0000000000001000
    RDX: 000000000040b000 RSI: 0000000000000005 RDI: 000000000040b000
    RBP: 000000000040affb R08: ffff888000000000 R09: ffffea0000000000
    R10: 0000000000000003 R11: 00000000fffc7fc5 R12: 0000000000000005
    R13: 000000000040affb R14: ffffea0001485e40 R15: ffff888031cd3000
    FS:  00007f4f63d0b780(0000) GS:ffff8880d337d000(0000)
    knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: 000000001ae0b038 CR3: 00000000536aa000 CR4: 00000000000006f0
    DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    Call Trace:
     <TASK>
     truncate_inode_partial_folio+0x3dd/0x620
     truncate_inode_pages_range+0x226/0x720
     ? bdev_getblk+0x52/0x3e0
     ? ext4_get_group_desc+0x78/0x150
     ? crc32c_arch+0xfd/0x180
     ? __ext4_get_inode_loc+0x18c/0x840
     ? ext4_inode_csum+0x117/0x160
     ? jbd2_journal_dirty_metadata+0x61/0x390
     ? __ext4_handle_dirty_metadata+0xa0/0x2b0
     ? kmem_cache_free+0x90/0x5a0
     ? jbd2_journal_stop+0x1d5/0x550
     ? __ext4_journal_stop+0x49/0x100
     truncate_pagecache_range+0x50/0x80
     ext4_truncate_page_cache_block_range+0x57/0x3a0
     ext4_punch_hole+0x1fe/0x670
     ext4_fallocate+0x792/0x17d0
     ? __count_memcg_events+0x175/0x2a0
     vfs_fallocate+0x121/0x560
     ksys_fallocate+0x51/0xc0
     __x64_sys_fallocate+0x24/0x40
     x64_sys_call+0x18d2/0x4170
     do_syscall_64+0xa7/0x220
     entry_SYSCALL_64_after_hwframe+0x76/0x7e

  Fix this by filtering out cases where the punching start offset exceeds
  max_end.
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38221.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0143'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01406'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03031'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04641'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04674'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04804'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04776'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04594'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04908'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04883'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04888'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0489'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04893'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04815'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04812'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04564'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04916'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04601'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04612'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0461'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05517'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05487'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05468'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05442'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05467'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05444'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05429'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05416'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05436'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05526'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05214'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05191'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05209'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05307'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05324'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05367'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05281'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05273'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05242'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05321'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05326'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05507'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05497'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05534'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05478'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0545'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0548'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05504'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05513'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05542'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08328'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38221.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38221
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/28b62cb58fd014338f5004170f2e3a35bf0af238
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a4d60ba277ecd8a98c5a593cbc0ef2237c20a541
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b5e58bcd79625423487fa3ecba8e8411b5396327
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2376412
    reference_type:
    reference_id: 2376412
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38221
    reference_type:
    reference_id: CVE-2025-38221
