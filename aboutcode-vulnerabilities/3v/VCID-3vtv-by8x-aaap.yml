vulnerability_id: VCID-3vtv-by8x-aaap
aliases:
  - CVE-2023-34236
  - GHSA-6hvv-j432-23cv
summary: Weave GitOps Terraform Controller (aka Weave TF-controller) is a controller for Flux
  to reconcile Terraform resources in a GitOps way. A vulnerability has been identified in Weave
  GitOps Terraform Controller which could allow an authenticated remote attacker to view sensitive
  information. This vulnerability stems from Weave GitOps Terraform Runners (`tf-runner`), where
  sensitive data is inadvertently printed - potentially revealing sensitive user data in their
  pod logs. In particular, functions `tfexec.ShowPlan`, `tfexec.ShowPlanRaw`, and `tfexec.Output`
  are implicated when the `tfexec` object set its `Stdout` and `Stderr` to be `os.Stdout` and
  `os.Stderr`. An unauthorized remote attacker could exploit this vulnerability by accessing
  these prints of sensitive information, which may contain configurations or tokens that could
  be used to gain unauthorized control or access to resources managed by the Terraform controller.
  A successful exploit could allow the attacker to utilize this sensitive data, potentially
  leading to unauthorized access or control of the system. This vulnerability has been addressed
  in Weave GitOps Terraform Controller versions `v0.14.4` and `v0.15.0-rc.5`. Users are urged
  to upgrade to one of these versions to mitigate the vulnerability. As a temporary measure
  until the patch can be applied, users can add the environment variable `DISABLE_TF_LOGS` to
  the tf-runners via the runner pod template of the Terraform Custom Resource. This will prevent
  the logging of sensitive information and mitigate the risk of this vulnerability.
severities:
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27527'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27561'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27566'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27585'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27606'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27592'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27598'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27595'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.2761'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27628'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.2767'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27675'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27634'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27589'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53294'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53522'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53471'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.52816'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53089'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53149'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53167'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53244'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53240'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53252'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53267'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00157'
    scoring_system: epss
    scoring_elements: '0.53437'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00262'
    scoring_system: epss
    scoring_elements: '0.65079'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00262'
    scoring_system: epss
    scoring_elements: '0.65051'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00262'
    scoring_system: epss
    scoring_elements: '0.65072'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00262'
    scoring_system: epss
    scoring_elements: '0.65309'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.5395'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53962'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53973'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53963'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53936'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53811'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53794'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53891'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53896'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53918'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53937'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53915'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53899'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00341'
    scoring_system: epss
    scoring_elements: '0.53941'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '0.00495'
    scoring_system: epss
    scoring_elements: '0.48649'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/weaveworks/tf-controller
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/weaveworks/tf-controller
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/weaveworks/tf-controller/commit/28282bc644054e157c3b9a3d38f1f9551ce09074
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/weaveworks/tf-controller/commit/28282bc644054e157c3b9a3d38f1f9551ce09074
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/weaveworks/tf-controller/commit/6323b355bd7f5d2ce85d0244fe0883af3881df4e
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/weaveworks/tf-controller/commit/6323b355bd7f5d2ce85d0244fe0883af3881df4e
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/weaveworks/tf-controller/commit/9708fda28ccd0466cb0a8fd409854ab4d92f7dca
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/weaveworks/tf-controller/commit/9708fda28ccd0466cb0a8fd409854ab4d92f7dca
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/weaveworks/tf-controller/commit/98a0688036e9dbcf43fa84960d9a1ef3e09a69cf
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/weaveworks/tf-controller/commit/98a0688036e9dbcf43fa84960d9a1ef3e09a69cf
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/weaveworks/tf-controller/issues/637
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/weaveworks/tf-controller/issues/637
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/weaveworks/tf-controller/issues/649
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/weaveworks/tf-controller/issues/649
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N
    published_at: None
    url: https://github.com/weaveworks/tf-controller/security/advisories/GHSA-6hvv-j432-23cv
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/weaveworks/tf-controller/security/advisories/GHSA-6hvv-j432-23cv
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34236
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34236
weaknesses:
  - CWE-312
  - CWE-532
  - CWE-200
  - CWE-522
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-34236
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/commit/28282bc644054e157c3b9a3d38f1f9551ce09074
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/commit/6323b355bd7f5d2ce85d0244fe0883af3881df4e
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/commit/9708fda28ccd0466cb0a8fd409854ab4d92f7dca
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/commit/98a0688036e9dbcf43fa84960d9a1ef3e09a69cf
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/issues/637
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/issues/649
    reference_type:
    reference_id:
  - url: https://github.com/weaveworks/tf-controller/security/advisories/GHSA-6hvv-j432-23cv
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:weave:gitops_terraform_controller:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:weave:gitops_terraform_controller:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:weave:gitops_terraform_controller:0.15.0:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34236
    reference_type:
    reference_id: CVE-2023-34236
