vulnerability_id: VCID-3v8q-46r4-sybm
aliases:
  - CVE-2024-53096
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm: resolve faulty
  mmap_region() error path behaviour  The mmap_region() function is somewhat terrifying, with
  spaghetti-like control flow and numerous means by which issues can arise and incomplete state,
  memory leaks and other unpleasantness can occur.  A large amount of the complexity arises
  from trying to handle errors late in the process of mapping a VMA, which forms the basis of
  recently observed issues with resource leaks and observable inconsistent state.  Taking advantage
  of previous patches in this series we move a number of checks earlier in the code, simplifying
  things by moving the core of the logic into a static internal function __mmap_region().  Doing
  this allows us to perform a number of checks up front before we do any real work, and allows
  us to unwind the writable unmap check unconditionally as required and to perform a CONFIG_DEBUG_VM_MAPLE_TREE
  validation unconditionally also.  We move a number of things here:  1. We preallocate memory
  for the iterator before we call the file-backed    memory hook, allowing us to exit early
  and avoid having to perform    complicated and error-prone close/free logic. We carefully
  free    iterator state on both success and error paths.  2. The enclosing mmap_region() function
  handles the mapping_map_writable()    logic early. Previously the logic had the mapping_map_writable()
  at the    point of mapping a newly allocated file-backed VMA, and a matching    mapping_unmap_writable()
  on success and error paths.     We now do this unconditionally if this is a file-backed, shared
  writable    mapping. If a driver changes the flags to eliminate VM_MAYWRITE, however    doing
  so does not invalidate the seal check we just performed, and we in    any case always decrement
  the counter in the wrapper.     We perform a debug assert to ensure a driver does not attempt
  to do the    opposite.  3. We also move arch_validate_flags() up into the mmap_region()    function.
  This is only relevant on arm64 and sparc64, and the check is    only meaningful for SPARC
  with ADI enabled. We explicitly add a warning    for this arch if a driver invalidates this
  check, though the code ought    eventually to be fixed to eliminate the need for this.  With
  all of these measures in place, we no longer need to explicitly close the VMA on error paths,
  as we place all checks which might fail prior to a call to any driver mmap hook.  This eliminates
  an entire class of errors, makes the code easier to reason about and more robust.'
severities:
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53096.json
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01997'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02656'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02652'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02659'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02649'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02842'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04516'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04488'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04513'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04535'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04528'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04495'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05839'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0586'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05951'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05899'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.059'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05884'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05867'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05827'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04544'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04491'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04474'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04477'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04478'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.04481'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0449'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.0374'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11841'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-53096
weaknesses:
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-53096.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-53096
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-53096
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/43323a4e5b3f8ccc08e2f835abfdc7ee9da8f6ed
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/44f48eb9a6051826227bbd375446064fb2a43c6c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/52c81fd0f5a8bf8032687b94ccf00d13b44cc5c8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5de195060b2e251a835f622759550e6202167641
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bdc136e2b05fabcd780fe5f165d154eb779dfcb0
    reference_type:
    reference_id:
  - url: https://project-zero.issues.chromium.org/issues/374117290
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2328791
    reference_type:
    reference_id: 2328791
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.19.17:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.19.17:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.12:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.12:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-53096
    reference_type:
    reference_id: CVE-2024-53096
  - url: https://usn.ubuntu.com/7387-1/
    reference_type:
    reference_id: USN-7387-1
  - url: https://usn.ubuntu.com/7387-2/
    reference_type:
    reference_id: USN-7387-2
  - url: https://usn.ubuntu.com/7387-3/
    reference_type:
    reference_id: USN-7387-3
  - url: https://usn.ubuntu.com/7388-1/
    reference_type:
    reference_id: USN-7388-1
  - url: https://usn.ubuntu.com/7389-1/
    reference_type:
    reference_id: USN-7389-1
  - url: https://usn.ubuntu.com/7390-1/
    reference_type:
    reference_id: USN-7390-1
  - url: https://usn.ubuntu.com/7407-1/
    reference_type:
    reference_id: USN-7407-1
  - url: https://usn.ubuntu.com/7421-1/
    reference_type:
    reference_id: USN-7421-1
  - url: https://usn.ubuntu.com/7449-1/
    reference_type:
    reference_id: USN-7449-1
  - url: https://usn.ubuntu.com/7449-2/
    reference_type:
    reference_id: USN-7449-2
  - url: https://usn.ubuntu.com/7450-1/
    reference_type:
    reference_id: USN-7450-1
  - url: https://usn.ubuntu.com/7451-1/
    reference_type:
    reference_id: USN-7451-1
  - url: https://usn.ubuntu.com/7452-1/
    reference_type:
    reference_id: USN-7452-1
  - url: https://usn.ubuntu.com/7453-1/
    reference_type:
    reference_id: USN-7453-1
  - url: https://usn.ubuntu.com/7458-1/
    reference_type:
    reference_id: USN-7458-1
  - url: https://usn.ubuntu.com/7459-1/
    reference_type:
    reference_id: USN-7459-1
  - url: https://usn.ubuntu.com/7459-2/
    reference_type:
    reference_id: USN-7459-2
  - url: https://usn.ubuntu.com/7468-1/
    reference_type:
    reference_id: USN-7468-1
