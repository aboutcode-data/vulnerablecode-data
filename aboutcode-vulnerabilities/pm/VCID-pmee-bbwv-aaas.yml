vulnerability_id: VCID-pmee-bbwv-aaas
aliases:
  - CVE-2022-3971
  - GHSA-ffwf-47x2-jpr8
summary: |
  Improper Neutralization
  A vulnerability was found in matrix-appservice-irc up to 0.35.1. It has been declared as critical. This vulnerability affects unknown code of the file src/datastore/postgres/PgDataStore.ts. The manipulation of the argument roomIds leads to sql injection. Upgrading to version 0.36.0 is able to address this issue. The name of the patch is 179313a37f06b298150edba3e2b0e5a73c1415e7. It is recommended to upgrade the affected component. VDB-213550 is the identifier assigned to this vulnerability.
severities:
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14043'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11201'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11159'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.1129'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11293'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11328'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11367'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11352'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11368'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11376'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11382'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11403'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11374'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.1134'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11311'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.11252'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.13896'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.13955'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14051'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14135'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14137'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14105'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.1407'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.1406'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14038'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14048'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14074'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.14063'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.10253'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51566'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.50701'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51796'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.50997'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51739'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51711'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51093'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51367'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51439'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51461'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51531'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51523'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51522'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.51539'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.50720'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: '0.00143'
    scoring_system: epss
    scoring_elements: '0.50721'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-ffwf-47x2-jpr8
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/commit/179313a37f06b298150edba3e2b0e5a73c1415e7
  - score: '5.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/commit/179313a37f06b298150edba3e2b0e5a73c1415e7
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/commit/179313a37f06b298150edba3e2b0e5a73c1415e7
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-14T17:05:25Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/commit/179313a37f06b298150edba3e2b0e5a73c1415e7
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/pull/1619
  - score: '5.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/pull/1619
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/pull/1619
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-14T17:05:25Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/pull/1619
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/releases/tag/0.36.0
  - score: '5.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/releases/tag/0.36.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/releases/tag/0.36.0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-14T17:05:25Z/
    published_at: None
    url: https://github.com/matrix-org/matrix-appservice-irc/releases/tag/0.36.0
  - score: '5.6'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-3971
  - score: '5.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-3971
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://vuldb.com/?id.213550
  - score: '5.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://vuldb.com/?id.213550
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://vuldb.com/?id.213550
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-14T17:05:25Z/
    published_at: None
    url: https://vuldb.com/?id.213550
weaknesses:
  - CWE-707
  - CWE-937
  - CWE-1035
  - CWE-89
  - CWE-74
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-3971
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/commit/179313a37f06b298150edba3e2b0e5a73c1415e7
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/pull/1619
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/matrix-appservice-irc/releases/tag/0.36.0
    reference_type:
    reference_id:
  - url: https://vuldb.com/?id.213550
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:matrix_irc_bridge:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:matrix_irc_bridge:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-3971
    reference_type:
    reference_id: CVE-2022-3971
  - url: https://github.com/advisories/GHSA-ffwf-47x2-jpr8
    reference_type:
    reference_id: GHSA-ffwf-47x2-jpr8
