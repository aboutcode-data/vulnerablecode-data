vulnerability_id: VCID-g2n3-zg8t-7ued
aliases:
  - CVE-2025-22005
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ipv6: Fix memleak of nhc_pcpu_rth_output in fib_check_nh_v6_gw().

  fib_check_nh_v6_gw() expects that fib6_nh_init() cleans up everything
  when it fails.

  Commit 7dd73168e273 ("ipv6: Always allocate pcpu memory in a fib6_nh")
  moved fib_nh_common_init() before alloc_percpu_gfp() within fib6_nh_init()
  but forgot to add cleanup for fib6_nh->nh_common.nhc_pcpu_rth_output in
  case it fails to allocate fib6_nh->rt6i_pcpu, resulting in memleak.

  Let's call fib_nh_common_release() and clear nhc_pcpu_rth_output in the
  error path.

  Note that we can remove the fib6_nh_release() call in nh_create_ipv6()
  later in net-next.git.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22005.json
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22005.json
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01387'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01425'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01431'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01419'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01411'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01397'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01398'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01414'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01408'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01409'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01405'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.0107'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01061'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01049'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.0105'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.0142'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01436'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01427'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02478'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02475'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02479'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02471'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02473'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02482'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03771'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03803'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-22005
weaknesses:
  - CWE-401
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22005.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-22005
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-22005
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/119dcafe36795a15ae53351cbbd6177aaf94ffef
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/16267a5036173d0173377545b4b6021b081d0933
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1bd12dfc058e1e68759d313d7727d68dbc1b8964
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/29d91820184d5cbc70f3246d4911d96eaeb930d6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/596a883c4ce2d2e9c175f25b98fed3a1f33fea38
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/77c41cdbe6bce476e08d3251c0d501feaf10a9f3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9740890ee20e01f99ff1dde84c63dcf089fabb98
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d3d5b4b5ae263c3225db363ba08b937e2e2b0380
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2357129
    reference_type:
    reference_id: 2357129
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.14:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.14:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22005
    reference_type:
    reference_id: CVE-2025-22005
