vulnerability_id: VCID-43f7-f44e-z3fm
aliases:
  - CVE-2025-27089
  - GHSA-99vm-5v2h-h6r6
summary: Directus is a real-time API and App dashboard for managing SQL database content. In
  affected versions if there are two overlapping policies for the `update` action that allow
  access to different fields, instead of correctly checking access permissions against the item
  they apply for the user is allowed to update the superset of fields allowed by any of the
  policies. E.g. have one policy allowing update access to `field_a` if the `id == 1` and one
  policy allowing update access to `field_b` if the `id == 2`. The user with both these policies
  is allowed to update both `field_a` and `field_b` for the items with ids `1` and `2`. Before
  v11, if a user was allowed to update an item they were allowed to update the fields that the
  single permission, that applied to that item, listed. With overlapping permissions this isn't
  as clear cut anymore and the union of fields might not be the fields the user is allowed to
  update for that specific item. The solution that this PR introduces is to evaluate the permissions
  for each field that the user tries to update in the validateItemAccess DB query, instead of
  only verifying access to the item as a whole. This is done by, instead of returning the actual
  field value, returning a flag that indicates if the user has access to that field. This uses
  the same case/when mechanism that is used for stripping out non permitted field that is at
  the core of the permissions engine. As a result, for every item that the access is validated
  for, the expected result is an item that has either 1 or null for all the "requested" fields
  instead of any of the actual field values. These results are not useful for anything other
  than verifying the field level access permissions. The final check in validateItemAccess can
  either fail if the number of items does not match the number of items the access is checked
  for (ie. the user does not have access to the item at all) or if not all of the passed in
  fields have access permissions for any of the returned items. This is a vulnerability that
  allows update access to unintended fields, potentially impacting the password field for user
  accounts. This has been addressed in version 11.1.2 and all users are advised to upgrade.
  There are no known workarounds for this vulnerability.
severities:
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04703'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03677'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03709'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03715'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03712'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03703'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03692'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04664'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0469'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04721'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04702'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04683'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04675'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04639'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04634'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0464'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04642'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04654'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04646'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03672'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0365'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03639'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03636'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03648'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.03656'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0366'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0581'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.03773'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-99vm-5v2h-h6r6
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/directus/directus
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/directus/directus/commit/a7ea67783b060d0d6fc964d71c2d4575d5eee4e2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus/commit/a7ea67783b060d0d6fc964d71c2d4575d5eee4e2
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/directus/directus/releases/tag/v11.1.2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus/releases/tag/v11.1.2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-19T17:18:55Z/
    published_at: None
    url: https://github.com/directus/directus/releases/tag/v11.1.2
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/directus/directus/security/advisories/GHSA-99vm-5v2h-h6r6
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus/security/advisories/GHSA-99vm-5v2h-h6r6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus/security/advisories/GHSA-99vm-5v2h-h6r6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-19T17:18:55Z/
    published_at: None
    url: https://github.com/directus/directus/security/advisories/GHSA-99vm-5v2h-h6r6
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-27089
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-27089
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-27089
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-863
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-27089
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/a7ea67783b060d0d6fc964d71c2d4575d5eee4e2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:monospace:directus:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:monospace:directus:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-27089
    reference_type:
    reference_id: CVE-2025-27089
  - url: https://github.com/advisories/GHSA-99vm-5v2h-h6r6
    reference_type:
    reference_id: GHSA-99vm-5v2h-h6r6
  - url: https://github.com/directus/directus/security/advisories/GHSA-99vm-5v2h-h6r6
    reference_type:
    reference_id: GHSA-99vm-5v2h-h6r6
  - url: https://github.com/directus/directus/releases/tag/v11.1.2
    reference_type:
    reference_id: v11.1.2
