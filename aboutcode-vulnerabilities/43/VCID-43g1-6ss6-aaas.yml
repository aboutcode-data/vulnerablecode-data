vulnerability_id: VCID-43g1-6ss6-aaas
aliases:
  - BIT-mlflow-2024-0520
  - CVE-2024-0520
  - GHSA-5q6c-ffvg-xcm9
  - PYSEC-2024-239
summary: |
  Remote code execution in mlflow
  A vulnerability in mlflow/mlflow version 8.2.1 allows for remote code execution due to improper neutralization of special elements used in an OS command ('Command Injection') within the `mlflow.data.http_dataset_source.py` module. Specifically, when loading a dataset from a source URL with an HTTP scheme, the filename extracted from the `Content-Disposition` header or the URL path is used to generate the final file path without proper sanitization. This flaw enables an attacker to control the file path fully by utilizing path traversal or absolute path techniques, such as '../../tmp/poc.txt' or '/tmp/poc.txt', leading to arbitrary file write. Exploiting this vulnerability could allow a malicious user to execute commands on the vulnerable machine, potentially gaining access to data and model information. The issue is fixed in version 2.9.0.
severities:
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39375'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39267'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39358'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39353'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39364'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39694'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39618'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39557'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39382'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.38895'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39162'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39239'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46429'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46134'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46151'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.00116'
    scoring_system: epss
    scoring_elements: '0.46127'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02137'
    scoring_system: epss
    scoring_elements: '0.82654'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02137'
    scoring_system: epss
    scoring_elements: '0.82648'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83195'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83202'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83199'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83215'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83224'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83233'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83228'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83172'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83221'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.02256'
    scoring_system: epss
    scoring_elements: '0.83174'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89099'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89085'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89098'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89108'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89119'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89122'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89117'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89115'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89114'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89109'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89107'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89105'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.05009'
    scoring_system: epss
    scoring_elements: '0.89102'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: '0.49311'
    scoring_system: epss
    scoring_elements: '0.96767'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5q6c-ffvg-xcm9
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/mlflow/mlflow
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://github.com/mlflow/mlflow
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mlflow/mlflow
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mlflow/mlflow
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/mlflow/mlflow/commit/400c226953b4568f4361bc0a0c223511652c2b9d
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/mlflow/mlflow/commit/400c226953b4568f4361bc0a0c223511652c2b9d
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mlflow/mlflow/commit/400c226953b4568f4361bc0a0c223511652c2b9d
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/mlflow/PYSEC-2024-239.yaml
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/mlflow/PYSEC-2024-239.yaml
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/93e470d7-b6f0-409b-af63-49d3e2a26dbc
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/93e470d7-b6f0-409b-af63-49d3e2a26dbc
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://huntr.com/bounties/93e470d7-b6f0-409b-af63-49d3e2a26dbc
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-0520
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-0520
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-0520
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-0520
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
  - CWE-23
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-0520
    reference_type:
    reference_id:
  - url: https://github.com/mlflow/mlflow
    reference_type:
    reference_id:
  - url: https://github.com/mlflow/mlflow/commit/400c226953b4568f4361bc0a0c223511652c2b9d
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/mlflow/PYSEC-2024-239.yaml
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/93e470d7-b6f0-409b-af63-49d3e2a26dbc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-0520
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:lfprojects:mlflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:lfprojects:mlflow:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-5q6c-ffvg-xcm9
    reference_type:
    reference_id: GHSA-5q6c-ffvg-xcm9
