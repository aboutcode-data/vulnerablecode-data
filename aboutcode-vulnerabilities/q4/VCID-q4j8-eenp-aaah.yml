vulnerability_id: VCID-q4j8-eenp-aaah
aliases:
  - CVE-2024-35938
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  wifi: ath11k: decrease MHI channel buffer length to 8KB

  Currently buf_len field of ath11k_mhi_config_qca6390 is assigned
  with 0, making MHI use a default size, 64KB, to allocate channel
  buffers. This is likely to fail in some scenarios where system
  memory is highly fragmented and memory compaction or reclaim is
  not allowed.

  There is a fail report which is caused by it:
  kworker/u32:45: page allocation failure: order:4, mode:0x40c00(GFP_NOIO|__GFP_COMP), nodemask=(null),cpuset=/,mems_allowed=0
  CPU: 0 PID: 19318 Comm: kworker/u32:45 Not tainted 6.8.0-rc3-1.gae4495f-default #1 openSUSE Tumbleweed (unreleased) 493b6d5b382c603654d7a81fc3c144d59a1dfceb
  Workqueue: events_unbound async_run_entry_fn
  Call Trace:
   <TASK>
   dump_stack_lvl+0x47/0x60
   warn_alloc+0x13a/0x1b0
   ? srso_alias_return_thunk+0x5/0xfbef5
   ? __alloc_pages_direct_compact+0xab/0x210
   __alloc_pages_slowpath.constprop.0+0xd3e/0xda0
   __alloc_pages+0x32d/0x350
   ? mhi_prepare_channel+0x127/0x2d0 [mhi 40df44e07c05479f7a6e7b90fba9f0e0031a7814]
   __kmalloc_large_node+0x72/0x110
   __kmalloc+0x37c/0x480
   ? mhi_map_single_no_bb+0x77/0xf0 [mhi 40df44e07c05479f7a6e7b90fba9f0e0031a7814]
   ? mhi_prepare_channel+0x127/0x2d0 [mhi 40df44e07c05479f7a6e7b90fba9f0e0031a7814]
   mhi_prepare_channel+0x127/0x2d0 [mhi 40df44e07c05479f7a6e7b90fba9f0e0031a7814]
   __mhi_prepare_for_transfer+0x44/0x80 [mhi 40df44e07c05479f7a6e7b90fba9f0e0031a7814]
   ? __pfx_____mhi_prepare_for_transfer+0x10/0x10 [mhi 40df44e07c05479f7a6e7b90fba9f0e0031a7814]
   device_for_each_child+0x5c/0xa0
   ? __pfx_pci_pm_resume+0x10/0x10
   ath11k_core_resume+0x65/0x100 [ath11k a5094e22d7223135c40d93c8f5321cf09fd85e4e]
   ? srso_alias_return_thunk+0x5/0xfbef5
   ath11k_pci_pm_resume+0x32/0x60 [ath11k_pci 830b7bfc3ea80ebef32e563cafe2cb55e9cc73ec]
   ? srso_alias_return_thunk+0x5/0xfbef5
   dpm_run_callback+0x8c/0x1e0
   device_resume+0x104/0x340
   ? __pfx_dpm_watchdog_handler+0x10/0x10
   async_resume+0x1d/0x30
   async_run_entry_fn+0x32/0x120
   process_one_work+0x168/0x330
   worker_thread+0x2f5/0x410
   ? __pfx_worker_thread+0x10/0x10
   kthread+0xe8/0x120
   ? __pfx_kthread+0x10/0x10
   ret_from_fork+0x34/0x50
   ? __pfx_kthread+0x10/0x10
   ret_from_fork_asm+0x1b/0x30
   </TASK>

  Actually those buffers are used only by QMI target -> host communication.
  And for WCN6855 and QCA6390, the largest packet size for that is less
  than 6KB. So change buf_len field to 8KB, which results in order 1
  allocation if page size is 4KB. In this way, we can at least save some
  memory, and as well as decrease the possibility of allocation failure
  in those scenarios.

  Tested-on: WCN6855 hw2.0 PCI WLAN.HSP.1.1-03125-QCAHSPSWPL_V1_V2_SILICONZ_LITE-3.6510.30
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-35938.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30168'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.3017'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35207'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.3516'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35223'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35292'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35336'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35343'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35256'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35244'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35246'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35263'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35255'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.35228'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38401'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38335'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38427'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38368'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38297'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38263'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38373'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38384'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38411'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38381'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38359'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38374'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38398'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.38428'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '0.00812'
    scoring_system: epss
    scoring_elements: '0.59383'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
  - score: '2.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-35938.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-35938
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-35938
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/138fdeac75fb7512a7f9f1c3b236cd2e754af793
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1cca1bddf9ef080503c15378cecf4877f7510015
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6597a6687af54e2cb58371cf8f6ee4dd85c537de
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/805a1cdde82fec00c7471a393f4bb437b2741559
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ae5876b3b7b2243d874e2afa099e7926122087a1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2281819
    reference_type:
    reference_id: 2281819
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35938
    reference_type:
    reference_id: CVE-2024-35938
  - url: https://access.redhat.com/errata/RHSA-2024:5101
    reference_type:
    reference_id: RHSA-2024:5101
  - url: https://access.redhat.com/errata/RHSA-2024:5102
    reference_type:
    reference_id: RHSA-2024:5102
  - url: https://access.redhat.com/errata/RHSA-2024:9315
    reference_type:
    reference_id: RHSA-2024:9315
  - url: https://access.redhat.com/errata/RHSA-2025:3935
    reference_type:
    reference_id: RHSA-2025:3935
  - url: https://usn.ubuntu.com/6893-1/
    reference_type:
    reference_id: USN-6893-1
  - url: https://usn.ubuntu.com/6893-2/
    reference_type:
    reference_id: USN-6893-2
  - url: https://usn.ubuntu.com/6893-3/
    reference_type:
    reference_id: USN-6893-3
  - url: https://usn.ubuntu.com/6898-1/
    reference_type:
    reference_id: USN-6898-1
  - url: https://usn.ubuntu.com/6898-2/
    reference_type:
    reference_id: USN-6898-2
  - url: https://usn.ubuntu.com/6898-3/
    reference_type:
    reference_id: USN-6898-3
  - url: https://usn.ubuntu.com/6898-4/
    reference_type:
    reference_id: USN-6898-4
  - url: https://usn.ubuntu.com/6917-1/
    reference_type:
    reference_id: USN-6917-1
  - url: https://usn.ubuntu.com/6918-1/
    reference_type:
    reference_id: USN-6918-1
  - url: https://usn.ubuntu.com/6919-1/
    reference_type:
    reference_id: USN-6919-1
  - url: https://usn.ubuntu.com/6927-1/
    reference_type:
    reference_id: USN-6927-1
  - url: https://usn.ubuntu.com/7019-1/
    reference_type:
    reference_id: USN-7019-1
