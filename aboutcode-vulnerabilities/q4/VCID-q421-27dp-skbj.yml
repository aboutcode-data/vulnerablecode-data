vulnerability_id: VCID-q421-27dp-skbj
aliases:
  - CVE-2024-43882
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  exec: Fix ToCToU between perm check and set-uid/gid usage

  When opening a file for exec via do_filp_open(), permission checking is
  done against the file's metadata at that moment, and on success, a file
  pointer is passed back. Much later in the execve() code path, the file
  metadata (specifically mode, uid, and gid) is used to determine if/how
  to set the uid and gid. However, those values may have changed since the
  permissions check, meaning the execution may gain unintended privileges.

  For example, if a file could change permissions from executable and not
  set-id:

  ---------x 1 root root 16048 Aug  7 13:16 target

  to set-id and non-executable:

  ---S------ 1 root root 16048 Aug  7 13:16 target

  it is possible to gain root privileges when execution should have been
  disallowed.

  While this race condition is rare in real-world scenarios, it has been
  observed (and proven exploitable) when package managers are updating
  the setuid bits of installed programs. Such files start with being
  world-executable but then are adjusted to be group-exec with a set-uid
  bit. For example, "chmod o-x,u+s target" makes "target" executable only
  by uid "root" and gid "cdrom", while also becoming setuid-root:

  -rwxr-xr-x 1 root cdrom 16048 Aug  7 13:16 target

  becomes:

  -rwsr-xr-- 1 root cdrom 16048 Aug  7 13:16 target

  But racing the chmod means users without group "cdrom" membership can
  get the permission to execute "target" just before the chmod, and when
  the chmod finishes, the exec reaches brpm_fill_uid(), and performs the
  setuid to root, violating the expressed authorization of "only cdrom
  group members can setuid to root".

  Re-check that we still have execute permissions in case the metadata
  has changed. It would be better to keep a copy from the perm-check time,
  but until we can do that refactoring, the least-bad option is to do a
  full inode_permission() call (under inode lock). It is understood that
  this is safe against dead-locks, but hardly optimal.
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-43882.json
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08896'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08926'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11649'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08904'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11661'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08876'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11673'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08872'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08854'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08726'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08869'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08883'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11325'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11313'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11321'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11338'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11377'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11396'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11392'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11318'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11215'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11158'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08855'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08811'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10251'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.15584'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
  - score: 7
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/15469d46ba34559bfe7e3de6659115778c624759
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T04:55:56Z/
    published_at: None
    url: https://git.kernel.org/stable/c/15469d46ba34559bfe7e3de6659115778c624759
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/368f6985d46657b8b466a421dddcacd4051f7ada
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T04:55:56Z/
    published_at: None
    url: https://git.kernel.org/stable/c/368f6985d46657b8b466a421dddcacd4051f7ada
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/90dfbba89ad4f0d9c9744ecbb1adac4aa2ff4f3e
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T04:55:56Z/
    published_at: None
    url: https://git.kernel.org/stable/c/90dfbba89ad4f0d9c9744ecbb1adac4aa2ff4f3e
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/9b424c5d4130d56312e2a3be17efb0928fec4d64
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T04:55:56Z/
    published_at: None
    url: https://git.kernel.org/stable/c/9b424c5d4130d56312e2a3be17efb0928fec4d64
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/d2a2a4714d80d09b0f8eb6438ab4224690b7121e
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T04:55:56Z/
    published_at: None
    url: https://git.kernel.org/stable/c/d2a2a4714d80d09b0f8eb6438ab4224690b7121e
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/d5c3c7e26275a2d83b894d30f7582a42853a958f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T04:55:56Z/
    published_at: None
    url: https://git.kernel.org/stable/c/d5c3c7e26275a2d83b894d30f7582a42853a958f
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/f50733b45d865f91db90919f8311e2127ce5a0cb
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T04:55:56Z/
    published_at: None
    url: https://git.kernel.org/stable/c/f50733b45d865f91db90919f8311e2127ce5a0cb
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/f6cfc6bcfd5e1cf76115b6450516ea4c99897ae1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T04:55:56Z/
    published_at: None
    url: https://git.kernel.org/stable/c/f6cfc6bcfd5e1cf76115b6450516ea4c99897ae1
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-43882
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-43882
weaknesses:
  - CWE-367
  - CWE-266
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-43882.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-43882
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-43882
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/15469d46ba34559bfe7e3de6659115778c624759
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/368f6985d46657b8b466a421dddcacd4051f7ada
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/90dfbba89ad4f0d9c9744ecbb1adac4aa2ff4f3e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9b424c5d4130d56312e2a3be17efb0928fec4d64
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d2a2a4714d80d09b0f8eb6438ab4224690b7121e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d5c3c7e26275a2d83b894d30f7582a42853a958f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f50733b45d865f91db90919f8311e2127ce5a0cb
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f6cfc6bcfd5e1cf76115b6450516ea4c99897ae1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2306376
    reference_type:
    reference_id: 2306376
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-43882
    reference_type:
    reference_id: CVE-2024-43882
  - url: https://usn.ubuntu.com/7088-1/
    reference_type:
    reference_id: USN-7088-1
  - url: https://usn.ubuntu.com/7088-2/
    reference_type:
    reference_id: USN-7088-2
  - url: https://usn.ubuntu.com/7088-3/
    reference_type:
    reference_id: USN-7088-3
  - url: https://usn.ubuntu.com/7088-4/
    reference_type:
    reference_id: USN-7088-4
  - url: https://usn.ubuntu.com/7088-5/
    reference_type:
    reference_id: USN-7088-5
  - url: https://usn.ubuntu.com/7100-1/
    reference_type:
    reference_id: USN-7100-1
  - url: https://usn.ubuntu.com/7100-2/
    reference_type:
    reference_id: USN-7100-2
  - url: https://usn.ubuntu.com/7119-1/
    reference_type:
    reference_id: USN-7119-1
  - url: https://usn.ubuntu.com/7120-1/
    reference_type:
    reference_id: USN-7120-1
  - url: https://usn.ubuntu.com/7120-2/
    reference_type:
    reference_id: USN-7120-2
  - url: https://usn.ubuntu.com/7120-3/
    reference_type:
    reference_id: USN-7120-3
  - url: https://usn.ubuntu.com/7121-1/
    reference_type:
    reference_id: USN-7121-1
  - url: https://usn.ubuntu.com/7121-2/
    reference_type:
    reference_id: USN-7121-2
  - url: https://usn.ubuntu.com/7121-3/
    reference_type:
    reference_id: USN-7121-3
  - url: https://usn.ubuntu.com/7123-1/
    reference_type:
    reference_id: USN-7123-1
  - url: https://usn.ubuntu.com/7144-1/
    reference_type:
    reference_id: USN-7144-1
  - url: https://usn.ubuntu.com/7148-1/
    reference_type:
    reference_id: USN-7148-1
  - url: https://usn.ubuntu.com/7156-1/
    reference_type:
    reference_id: USN-7156-1
  - url: https://usn.ubuntu.com/7194-1/
    reference_type:
    reference_id: USN-7194-1
