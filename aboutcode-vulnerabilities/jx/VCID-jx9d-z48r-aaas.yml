vulnerability_id: VCID-jx9d-z48r-aaas
aliases:
  - CVE-2023-52808
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: hisi_sas: Set debugfs_dir pointer to NULL after removing debugfs

  If init debugfs failed during device registration due to memory allocation
  failure, debugfs_remove_recursive() is called, after which debugfs_dir is
  not set to NULL. debugfs_remove_recursive() will be called again during
  device removal. As a result, illegal pointer is accessed.

  [ 1665.467244] hisi_sas_v3_hw 0000:b4:02.0: failed to init debugfs!
  ...
  [ 1669.836708] Unable to handle kernel NULL pointer dereference at virtual address 00000000000000a0
  [ 1669.872669] pc : down_write+0x24/0x70
  [ 1669.876315] lr : down_write+0x1c/0x70
  [ 1669.879961] sp : ffff000036f53a30
  [ 1669.883260] x29: ffff000036f53a30 x28: ffffa027c31549f8
  [ 1669.888547] x27: ffffa027c3140000 x26: 0000000000000000
  [ 1669.893834] x25: ffffa027bf37c270 x24: ffffa027bf37c270
  [ 1669.899122] x23: ffff0000095406b8 x22: ffff0000095406a8
  [ 1669.904408] x21: 0000000000000000 x20: ffffa027bf37c310
  [ 1669.909695] x19: 00000000000000a0 x18: ffff8027dcd86f10
  [ 1669.914982] x17: 0000000000000000 x16: 0000000000000000
  [ 1669.920268] x15: 0000000000000000 x14: ffffa0274014f870
  [ 1669.925555] x13: 0000000000000040 x12: 0000000000000228
  [ 1669.930842] x11: 0000000000000020 x10: 0000000000000bb0
  [ 1669.936129] x9 : ffff000036f537f0 x8 : ffff80273088ca10
  [ 1669.941416] x7 : 000000000000001d x6 : 00000000ffffffff
  [ 1669.946702] x5 : ffff000008a36310 x4 : ffff80273088be00
  [ 1669.951989] x3 : ffff000009513e90 x2 : 0000000000000000
  [ 1669.957276] x1 : 00000000000000a0 x0 : ffffffff00000001
  [ 1669.962563] Call trace:
  [ 1669.965000]  down_write+0x24/0x70
  [ 1669.968301]  debugfs_remove_recursive+0x5c/0x1b0
  [ 1669.972905]  hisi_sas_debugfs_exit+0x24/0x30 [hisi_sas_main]
  [ 1669.978541]  hisi_sas_v3_remove+0x130/0x150 [hisi_sas_v3_hw]
  [ 1669.984175]  pci_device_remove+0x48/0xd8
  [ 1669.988082]  device_release_driver_internal+0x1b4/0x250
  [ 1669.993282]  device_release_driver+0x28/0x38
  [ 1669.997534]  pci_stop_bus_device+0x84/0xb8
  [ 1670.001611]  pci_stop_and_remove_bus_device_locked+0x24/0x40
  [ 1670.007244]  remove_store+0xfc/0x140
  [ 1670.010802]  dev_attr_store+0x44/0x60
  [ 1670.014448]  sysfs_kf_write+0x58/0x80
  [ 1670.018095]  kernfs_fop_write+0xe8/0x1f0
  [ 1670.022000]  __vfs_write+0x60/0x190
  [ 1670.025472]  vfs_write+0xac/0x1c0
  [ 1670.028771]  ksys_write+0x6c/0xd8
  [ 1670.032071]  __arm64_sys_write+0x24/0x30
  [ 1670.035977]  el0_svc_common+0x78/0x130
  [ 1670.039710]  el0_svc_handler+0x38/0x78
  [ 1670.043442]  el0_svc+0x8/0xc

  To fix this, set debugfs_dir to NULL after debugfs_remove_recursive().
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52808.json
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14778'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14586'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14645'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14741'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.1482'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14822'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14789'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14759'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14751'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14754'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14765'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14788'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14791'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23046'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23067'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23027'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.2301'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.22986'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23009'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23025'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23082'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23008'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.22939'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23083'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23102'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23108'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23098'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.23045'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '0.00381'
    scoring_system: epss
    scoring_elements: '0.42492'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-52808
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52808.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52808
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52808
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/33331b265aac9441ac0c1a5442e3f05d038240ec
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6de426f9276c448e2db7238911c97fb157cb23be
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/75a2656260fe8c7eeabda6ff4600b29e183f48db
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b4465009e7d60c6111946db4c8f1e50d401ed7be
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f0bfc8a5561fb0b2c48183dcbfe00bdd6d973bd3
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2282665
    reference_type:
    reference_id: 2282665
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52808
    reference_type:
    reference_id: CVE-2023-52808
