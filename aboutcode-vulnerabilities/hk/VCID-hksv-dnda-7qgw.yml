vulnerability_id: VCID-hksv-dnda-7qgw
aliases:
  - CVE-2024-54149
  - GHSA-xhw3-4j3m-hq53
summary: |
  Winter CMS Modules allows a sandbox bypass in Twig templates leading to data modification and deletion
  ### Impact

  Affected versions of Winter CMS allow users with access to the CMS templates sections that modify Twig files to bypass the sandbox placed on Twig files and modify resources such as theme customisation values or modify, or remove, templates in the theme even if not provided direct access via the permissions.

  As all objects passed through to Twig are references to the live objects, it is also possible to also manipulate model data if models are passed directly to Twig, including changing attributes or even removing records entirely. In most cases, this is unwanted behavior and potentially dangerous.

  To actively exploit this security issue, an attacker would need access to the Backend with a user account with any of the following permissions:
  - `cms.manage_layouts`
  - `cms.manage_pages`
  - `cms.manage_partials`

  The Winter CMS maintainers strongly recommend that these permissions only be reserved to trusted administrators and developers in general.

  ### Patches

  In order to mitigate this issue, we have significantly increased the scope of the sandbox, effectively making all models and datasources read-only in Twig.

  This security issue has been fixed as of https://github.com/wintercms/winter/commit/fb88e6fabde3b3278ce1844e581c87dcf7daee22.

  ### Workarounds

  If you cannot upgrade, you may apply commit https://github.com/wintercms/winter/commit/fb88e6fabde3b3278ce1844e581c87dcf7daee22 to your Winter CMS installation manually to resolve this issue.

  In the rare event that you were relying on being able to write to models/datasources within your Twig templates, you should instead use or create components to make changes to your models.
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14564'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.1442'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14534'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14372'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14544'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14595'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14576'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14563'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.14581'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.146'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.0008'
    scoring_system: epss
    scoring_elements: '0.13727'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25903'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.21939'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.21912'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25819'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25882'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25924'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25968'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.2597'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25933'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25913'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25899'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25911'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.2592'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25939'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.25909'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.22007'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.21995'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: '0.00085'
    scoring_system: epss
    scoring_elements: '0.21951'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xhw3-4j3m-hq53
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/wintercms/winter
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wintercms/winter
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/wintercms/winter/commit/fb88e6fabde3b3278ce1844e581c87dcf7daee22
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/wintercms/winter/commit/fb88e6fabde3b3278ce1844e581c87dcf7daee22
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wintercms/winter/commit/fb88e6fabde3b3278ce1844e581c87dcf7daee22
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T16:11:07Z/
    published_at: None
    url: https://github.com/wintercms/winter/commit/fb88e6fabde3b3278ce1844e581c87dcf7daee22
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/wintercms/winter/security/advisories/GHSA-xhw3-4j3m-hq53
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/wintercms/winter/security/advisories/GHSA-xhw3-4j3m-hq53
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/wintercms/winter/security/advisories/GHSA-xhw3-4j3m-hq53
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/wintercms/winter/security/advisories/GHSA-xhw3-4j3m-hq53
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-12-10T16:11:07Z/
    published_at: None
    url: https://github.com/wintercms/winter/security/advisories/GHSA-xhw3-4j3m-hq53
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-54149
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-54149
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-184
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-54149
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/winter
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/winter/commit/fb88e6fabde3b3278ce1844e581c87dcf7daee22
    reference_type:
    reference_id:
  - url: https://github.com/wintercms/winter/security/advisories/GHSA-xhw3-4j3m-hq53
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-54149
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-xhw3-4j3m-hq53
    reference_type:
    reference_id: GHSA-xhw3-4j3m-hq53
