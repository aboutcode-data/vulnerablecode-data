vulnerability_id: VCID-rfxz-wbxn-4qba
aliases:
  - CVE-2025-21883
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ice: Fix deinitializing
  VF in error path  If ice_ena_vfs() fails after calling ice_create_vf_entries(), it frees all
  VFs without removing them from snapshot PF-VF mailbox list, leading to list corruption.  Reproducer:   devlink
  dev eswitch set $PF1_PCI mode switchdev   ip l s $PF1 up   ip l s $PF1 promisc on   sleep
  1   echo 1 > /sys/class/net/$PF1/device/sriov_numvfs   sleep 1   echo 1 > /sys/class/net/$PF1/device/sriov_numvfs  Trace
  (minimized):   list_add corruption. next->prev should be prev (ffff8882e241c6f0), but was
  0000000000000000. (next=ffff888455da1330).   kernel BUG at lib/list_debug.c:29!   RIP: 0010:__list_add_valid_or_report+0xa6/0x100    ice_mbx_init_vf_info+0xa7/0x180
  [ice]    ice_initialize_vf_entry+0x1fa/0x250 [ice]    ice_sriov_configure+0x8d7/0x1520 [ice]    ?
  __percpu_ref_switch_mode+0x1b1/0x5d0    ? __pfx_ice_sriov_configure+0x10/0x10 [ice]  Sometimes
  a KASAN report can be seen instead with a similar stack trace:   BUG: KASAN: use-after-free
  in __list_add_valid_or_report+0xf1/0x100  VFs are added to this list in ice_mbx_init_vf_info(),
  but only removed in ice_free_vfs(). Move the removing to ice_free_vf_entries(), which is also
  being called in other places where VFs are being removed (including ice_free_vfs() itself).'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-21883.json
  - score: '6.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-21883.json
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.02029'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.02951'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.02957'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04279'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04277'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04305'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04336'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04327'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04318'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04299'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05557'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05576'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05664'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0561'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05607'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05584'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05564'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05529'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05524'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05535'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05536'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05544'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05553'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0426'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04252'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04261'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.04264'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06303'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-21883.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-21883
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/34393fd78d7183a007eaf0090966ebedcc29bd57
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3c01102bec9592928e6b155da41cfcd5d25a2066
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/79990cf5e7aded76d0c092c9f5ed31eb1c75e02c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a4880583f88deba63504ce1c8287a70d39c01378
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355415
    reference_type:
    reference_id: 2355415
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21883
    reference_type:
    reference_id: CVE-2025-21883
