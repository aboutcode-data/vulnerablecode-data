vulnerability_id: VCID-rf8c-1v1z-aaac
aliases:
  - CVE-2020-15239
  - GHSA-hwv5-w8gm-fq9f
  - PYSEC-2020-158
summary: In xmpp-http-upload before version 0.4.0, when the GET method is attacked, attackers
  can read files which have a `.data` suffix and which are accompanied by a JSON file with the
  `.meta` suffix. This can lead to Information Disclosure and in some shared-hosting scenarios
  also to circumvention of authentication or other limitations on the outbound (GET) traffic.
  For example, in a scenario where a single server has multiple instances of the application
  running (with separate DATA_ROOT settings), an attacker who has knowledge about the directory
  structure is able to read files from any other instance to which the process has read access.
  If instances have individual authentication (for example, HTTP authentication via a reverse
  proxy, source IP based filtering) or other restrictions (such as quotas), attackers may circumvent
  those limits in such a scenario by using the Directory Traversal to retrieve data from the
  other instances. If the associated XMPP server (or anyone knowing the SECRET_KEY) is malicious,
  they can write files outside the DATA_ROOT. The files which are written are constrained to
  have the `.meta` and the `.data` suffixes; the `.meta` file will contain the JSON with the
  Content-Type of the original request and the `.data` file will contain the payload. The issue
  is patched in version 0.4.0.
severities:
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33276'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.34321'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33939'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33977'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33964'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33784'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33721'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33678'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33458'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33436'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.32858'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33188'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33414'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33408'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33405'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00073'
    scoring_system: epss
    scoring_elements: '0.33301'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33354'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28922'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28956'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28985'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28987'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28958'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28943'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.2892'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33314'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33379'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33439'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33483'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33486'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33411'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.3339'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33391'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33389'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33406'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33399'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33377'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28839'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28807'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28941'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28954'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28989'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28947'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.28915'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: '0.00151'
    scoring_system: epss
    scoring_elements: '0.22898'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-hwv5-w8gm-fq9f
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/horazont/xmpp-http-upload
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/horazont/xmpp-http-upload
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/horazont/xmpp-http-upload/commit/82056540191e89f0cd697c81f57714c00962ed75
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/horazont/xmpp-http-upload/commit/82056540191e89f0cd697c81f57714c00962ed75
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/horazont/xmpp-http-upload/pull/12
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/horazont/xmpp-http-upload/pull/12
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/horazont/xmpp-http-upload/security/advisories/GHSA-hwv5-w8gm-fq9f
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/horazont/xmpp-http-upload/security/advisories/GHSA-hwv5-w8gm-fq9f
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/horazont/xmpp-http-upload/security/advisories/GHSA-hwv5-w8gm-fq9f
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/xmpp-http-upload/PYSEC-2020-158.yaml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/xmpp-http-upload/PYSEC-2020-158.yaml
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15239
  - score: '3.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15239
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15239
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-15239
  - score: '3.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://pypi.org/project/xmpp-http-upload/#history
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pypi.org/project/xmpp-http-upload/#history
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2020-15239
    reference_type:
    reference_id:
  - url: https://github.com/horazont/xmpp-http-upload
    reference_type:
    reference_id:
  - url: https://github.com/horazont/xmpp-http-upload/commit/82056540191e89f0cd697c81f57714c00962ed75
    reference_type:
    reference_id:
  - url: https://github.com/horazont/xmpp-http-upload/pull/12
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/xmpp-http-upload/PYSEC-2020-158.yaml
    reference_type:
    reference_id:
  - url: https://pypi.org/project/xmpp-http-upload/#history
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xmpp-http-upload_project:xmpp-http-upload:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xmpp-http-upload_project:xmpp-http-upload:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-15239
    reference_type:
    reference_id: CVE-2020-15239
  - url: https://github.com/advisories/GHSA-hwv5-w8gm-fq9f
    reference_type:
    reference_id: GHSA-hwv5-w8gm-fq9f
  - url: https://github.com/horazont/xmpp-http-upload/security/advisories/GHSA-hwv5-w8gm-fq9f
    reference_type:
    reference_id: GHSA-hwv5-w8gm-fq9f
