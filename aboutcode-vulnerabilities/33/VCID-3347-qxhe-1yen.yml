vulnerability_id: VCID-3347-qxhe-1yen
aliases:
  - GHSA-r2vg-hvjm-fg38
summary: |
  Shopware Customer Orders can be canceled, even if refunds are disabled
  Refunds in general can be enabled through the administration setting `core.cart.enableOrderRefunds` (in the cart panel).Which visually shows and hides the button. However, using a custom crafted request, a customer can still cancel his own orders.As this is not checked inside the route (and also not in the controller):
  https://github.com/shopware/shopware/blob/trunk/src/Storefront/Controller/AccountOrderController.php#L98
  https://github.com/shopware/shopware/blob/trunk/src/Core/Checkout/Order/SalesChannel/CancelOrderRoute.php

  To mitigate this, a check should be added to the `CancelOrderRoute` which verifies that the feature is enabled.
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-r2vg-hvjm-fg38
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/shopware/shopware
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/shopware/shopware/commit/b157508aef2c820e7ff89ebd5848d3019f22b592
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/commit/b157508aef2c820e7ff89ebd5848d3019f22b592
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-r2vg-hvjm-fg38
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-r2vg-hvjm-fg38
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-r2vg-hvjm-fg38
weaknesses:
  - CWE-862
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/shopware/shopware
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/b157508aef2c820e7ff89ebd5848d3019f22b592
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/security/advisories/GHSA-r2vg-hvjm-fg38
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-r2vg-hvjm-fg38
    reference_type:
    reference_id: GHSA-r2vg-hvjm-fg38
