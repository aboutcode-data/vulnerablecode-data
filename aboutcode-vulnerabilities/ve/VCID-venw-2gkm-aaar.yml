vulnerability_id: VCID-venw-2gkm-aaar
aliases:
  - BIT-2021-29614
  - BIT-tensorflow-2021-29614
  - CVE-2021-29614
  - GHSA-8pmx-p244-g88h
  - PYSEC-2021-251
  - PYSEC-2021-542
  - PYSEC-2021-740
summary: 'TensorFlow is an end-to-end open source platform for machine learning. The implementation
  of `tf.io.decode_raw` produces incorrect results and crashes the Python interpreter when combining
  `fixed_length` and wider datatypes. The implementation of the padded version(https://github.com/tensorflow/tensorflow/blob/1d8903e5b167ed0432077a3db6e462daf781d1fe/tensorflow/core/kernels/decode_padded_raw_op.cc)
  is buggy due to a confusion about pointer arithmetic rules. First, the code computes(https://github.com/tensorflow/tensorflow/blob/1d8903e5b167ed0432077a3db6e462daf781d1fe/tensorflow/core/kernels/decode_padded_raw_op.cc#L61)
  the width of each output element by dividing the `fixed_length` value to the size of the type
  argument. The `fixed_length` argument is also used to determine the size needed for the output
  tensor(https://github.com/tensorflow/tensorflow/blob/1d8903e5b167ed0432077a3db6e462daf781d1fe/tensorflow/core/kernels/decode_padded_raw_op.cc#L63-L79).
  This is followed by reencoding code(https://github.com/tensorflow/tensorflow/blob/1d8903e5b167ed0432077a3db6e462daf781d1fe/tensorflow/core/kernels/decode_padded_raw_op.cc#L85-L94).
  The erroneous code is the last line above: it is moving the `out_data` pointer by `fixed_length
  * sizeof(T)` bytes whereas it only copied at most `fixed_length` bytes from the input. This
  results in parts of the input not being decoded into the output. Furthermore, because the
  pointer advance is far wider than desired, this quickly leads to writing to outside the bounds
  of the backing data. This OOB write leads to interpreter crash in the reproducer mentioned
  here, but more severe attacks can be mounted too, given that this gadget allows writing to
  periodically placed locations in memory. The fix will be included in TensorFlow 2.5.0. We
  will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and
  TensorFlow 2.1.4, as these are also affected and still in supported range.'
severities:
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02609'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08201'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08358'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08388'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08379'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08364'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08361'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08362'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08325'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08356'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08179'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08335'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.20086'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19064'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19445'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19481'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19557'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19548'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19566'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19596'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19635'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19918'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19988'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11981'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.11958'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.119'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14554'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14614'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14712'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14791'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14793'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14758'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14727'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14719'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14723'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14734'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.1476'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.14748'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00048'
    scoring_system: epss
    scoring_elements: '0.19342'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.10515'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-8pmx-p244-g88h
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-8pmx-p244-g88h
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-542.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-542.yaml
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-740.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-740.yaml
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-251.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-251.yaml
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/698e01511f62a3c185754db78ebce0eee1f0184d
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/698e01511f62a3c185754db78ebce0eee1f0184d
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/commit/698e01511f62a3c185754db78ebce0eee1f0184d
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8pmx-p244-g88h
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8pmx-p244-g88h
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8pmx-p244-g88h
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8pmx-p244-g88h
  - score: '4.6'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29614
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29614
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29614
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29614
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-29614
  - score: Critical
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-1962
weaknesses:
  - CWE-665
  - CWE-707
  - CWE-937
  - CWE-1035
  - CWE-787
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-29614
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-cpu/PYSEC-2021-542.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow-gpu/PYSEC-2021-740.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tensorflow/PYSEC-2021-251.yaml
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow
    reference_type:
    reference_id:
  - url: https://github.com/tensorflow/tensorflow/commit/698e01511f62a3c185754db78ebce0eee1f0184d
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/AVG-1962
    reference_type:
    reference_id: AVG-1962
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:google:tensorflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-29614
    reference_type:
    reference_id: CVE-2021-29614
  - url: https://github.com/advisories/GHSA-8pmx-p244-g88h
    reference_type:
    reference_id: GHSA-8pmx-p244-g88h
  - url: https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8pmx-p244-g88h
    reference_type:
    reference_id: GHSA-8pmx-p244-g88h
