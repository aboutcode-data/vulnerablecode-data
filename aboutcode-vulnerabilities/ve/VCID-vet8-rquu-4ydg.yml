vulnerability_id: VCID-vet8-rquu-4ydg
aliases:
  - CVE-2025-69263
  - GHSA-7vhp-vf5g-r2fw
summary: "pnpm Has Lockfile Integrity Bypass that Allows Remote Dynamic Dependencies\n### Summary\n\
  \nHTTP tarball dependencies (and git-hosted tarballs) are stored in the lockfile without integrity\
  \ hashes. This allows the remote server to serve different content on each install, even when\
  \ a lockfile is committed.\n\n### Details\n\nWhen a package depends on an HTTP tarball URL,\
  \ pnpm's tarball resolver returns only the URL without computing an integrity hash:\n\n`resolving/tarball-resolver/src/index.ts`:\n\
  ```javascript\nreturn {\n  resolution: {\n    tarball: resolvedUrl,\n    // No integrity field\n\
  \  },\n  resolvedVia: 'url',\n}\n```\n\nThe resulting lockfile entry has no integrity to verify:\n\
  ```yaml\nremote-dynamic-dependency@http://example.com/pkg.tgz:\n  resolution: {tarball: http://example.com/pkg.tgz}\n\
  \  version: 1.0.0\n```\n\nSince there is no integrity hash, pnpm cannot detect when the server\
  \ returns different content. \n\nThis affects:\n- HTTP/HTTPS tarball URLs (`\"pkg\": \"https://example.com/pkg.tgz\"\
  `)\n- Git shorthand dependencies (`\"pkg\": \"github:user/repo\"`)\n- Git URLs (`\"pkg\":\
  \ \"git+https://github.com/user/repo\"`)\n\nnpm registry packages are not affected as they\
  \ include integrity hashes from the registry metadata.\n\n### PoC\n\nSee attached [pnpm-bypass-integrity-poc.zip](https://github.com/user-attachments/files/23819648/pnpm-bypass-integrity-poc.zip)\n\
  \nThe POC includes:\n- A server that returns different tarball content on each request\n-\
  \ A `malicious-package` that depends on the HTTP tarball\n- A `victim` project that depends\
  \ on `malicious-package`\n\nTo run:\n```bash\ncd pnpm-bypass-integrity-poc\n./run-poc.sh\n\
  ```\n\nThe output shows that each install (with `pnpm store prune` between them) downloads\
  \ different code despite having a committed lockfile.\n\n### Impact\n\nAn attacker who publishes\
  \ a package with an HTTP tarball dependency can serve different code to different users or\
  \ CI/CD environments. This enables:\n\n- Targeted attacks based on request metadata (IP, headers,\
  \ timing)\n- Evasion of security audits (serve benign code during review, malicious code later)\n\
  - Supply chain attacks where the malicious payload changes over time\n\nThe attack requires\
  \ the victim to install a package that has an HTTP/git tarball in its dependency tree. The\
  \ victim's lockfile provides no protection."
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-69263.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03627'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-69263
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03624'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-69263
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-7vhp-vf5g-r2fw
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pnpm/pnpm
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pnpm/pnpm
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pnpm/pnpm/commit/0958027f88a99ccefe7e9676cdebba393dfbdc85
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pnpm/pnpm/commit/0958027f88a99ccefe7e9676cdebba393dfbdc85
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2026-01-07T21:40:10Z/
    published_at: None
    url: https://github.com/pnpm/pnpm/commit/0958027f88a99ccefe7e9676cdebba393dfbdc85
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pnpm/pnpm/security/advisories/GHSA-7vhp-vf5g-r2fw
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/pnpm/pnpm/security/advisories/GHSA-7vhp-vf5g-r2fw
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pnpm/pnpm/security/advisories/GHSA-7vhp-vf5g-r2fw
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2026-01-07T21:40:10Z/
    published_at: None
    url: https://github.com/pnpm/pnpm/security/advisories/GHSA-7vhp-vf5g-r2fw
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-69263
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-69263
weaknesses:
  - CWE-494
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-69263.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-69263
    reference_type:
    reference_id:
  - url: https://github.com/pnpm/pnpm
    reference_type:
    reference_id:
  - url: https://github.com/pnpm/pnpm/security/advisories/GHSA-7vhp-vf5g-r2fw
    reference_type:
    reference_id:
  - url: https://github.com/pnpm/pnpm/commit/0958027f88a99ccefe7e9676cdebba393dfbdc85
    reference_type:
    reference_id: 0958027f88a99ccefe7e9676cdebba393dfbdc85
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2427703
    reference_type:
    reference_id: 2427703
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-69263
    reference_type:
    reference_id: CVE-2025-69263
  - url: https://github.com/advisories/GHSA-7vhp-vf5g-r2fw
    reference_type:
    reference_id: GHSA-7vhp-vf5g-r2fw
