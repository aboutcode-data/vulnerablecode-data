vulnerability_id: VCID-ry9u-hv84-cbfz
aliases:
  - CVE-2022-49961
summary: 'In the Linux kernel, the following vulnerability has been resolved:  bpf: Do mark_chain_precision
  for ARG_CONST_ALLOC_SIZE_OR_ZERO  Precision markers need to be propagated whenever we have
  an ARG_CONST_* style argument, as the verifier cannot consider imprecise scalars to be equivalent
  for the purposes of states_equal check when such arguments refine the return value (in this
  case, set mem_size for PTR_TO_MEM). The resultant mem_size for the R0 is derived from the
  constant value, and if the verifier incorrectly prunes states considering them equivalent
  where such arguments exist (by seeing that both registers have reg->precise as false in regsafe),
  we can end up with invalid programs passing the verifier which can do access beyond what should
  have been the correct mem_size in that explored state.  To show a concrete example of the
  problem:  0000000000000000 <prog>:        0:       r2 = *(u32 *)(r1 + 80)        1:       r1
  = *(u32 *)(r1 + 76)        2:       r3 = r1        3:       r3 += 4        4:       if r3
  > r2 goto +18 <LBB5_5>        5:       w2 = 0        6:       *(u32 *)(r1 + 0) = r2        7:       r1
  = *(u32 *)(r1 + 0)        8:       r2 = 1        9:       if w1 == 0 goto +1 <LBB5_3>       10:       r2
  = -1  0000000000000058 <LBB5_3>:       11:       r1 = 0 ll       13:       r3 = 0       14:       call
  bpf_ringbuf_reserve       15:       if r0 == 0 goto +7 <LBB5_5>       16:       r1 = r0       17:       r1
  += 16777215       18:       w2 = 0       19:       *(u8 *)(r1 + 0) = r2       20:       r1
  = r0       21:       r2 = 0       22:       call bpf_ringbuf_submit  00000000000000b8 <LBB5_5>:       23:       w0
  = 0       24:       exit  For the first case, the single line execution''s exploration will
  prune the search at insn 14 for the branch insn 9''s second leg as it will be verified first
  using r2 = -1 (UINT_MAX), while as w1 at insn 9 will always be 0 so at runtime we don''t get
  error for being greater than UINT_MAX/4 from bpf_ringbuf_reserve. The verifier during regsafe
  just sees reg->precise as false for both r2 registers in both states, hence considers them
  equal for purposes of states_equal.  If we propagated precise markers using the backtracking
  support, we would use the precise marking to then ensure that old r2 (UINT_MAX) was within
  the new r2 (1) and this would never be true, so the verification would rightfully fail.  The
  end result is that the out of bounds access at instruction 19 would be permitted without this
  fix.  Note that reg->precise is always set to true when user does not have CAP_BPF (or when
  subprog count is greater than 1 (i.e. use of any static or global functions)), hence this
  is only a problem when precision marks need to be explicitly propagated (i.e. privileged users
  with CAP_BPF).  A simplified test case has been included in the next patch to prevent future
  regressions.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49961.json
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03388'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04357'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03363'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04368'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05288'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05243'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05228'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05237'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0524'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05271'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05255'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05314'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05257'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05948'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05947'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05902'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05949'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05985'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05866'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05862'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.05911'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.0595'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06992'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06544'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06498'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06513'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06554'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06539'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06635'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06663'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06695'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06607'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06646'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06614'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06734'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06725'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06728'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06848'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06825'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06861'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06836'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06817'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.0686'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.06944'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00029'
    scoring_system: epss
    scoring_elements: '0.07002'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10553'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10523'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10602'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10537'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10528'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10521'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10507'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10635'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10592'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10604'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49961.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-49961
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-49961
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2459615a8d7f44ac81f0965bc094e55ccb254717
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2fc31465c5373b5ca4edf2e5238558cb62902311
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2373530
    reference_type:
    reference_id: 2373530
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49961
    reference_type:
    reference_id: CVE-2022-49961
  - url: https://access.redhat.com/errata/RHSA-2023:2458
    reference_type:
    reference_id: RHSA-2023:2458
