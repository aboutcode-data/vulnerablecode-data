vulnerability_id: VCID-ru9b-jam4-xbgr
aliases:
  - GHSA-5cph-wvm9-45gj
summary: "Flowise OverrideConfig security vulnerability\n### Impact\nFlowise allows developers\
  \ to inject configuration into the Chainflow during execution through the `overrideConfig`\
  \ option. This is supported in both the frontend web integration and the backend Prediction\
  \ API. \n\nThis has a range of fundamental issues that are a **major** security vulnerability.\
  \ \nWhile this feature is intentional, it should have strong protections added and be disabled\
  \ by default. \n\nThese issues include: \n1. Remote code execution. While inside a sandbox\
  \ this allows for\n  1. Sandbox escape \n  2. DoS by crashing the server\n  3. SSRF\n2. Prompt\
  \ Injection, both System and User\n  1. Full control over LLM prompts\n  2. Server variable\
  \ and data exfiltration\nAnd many many more such as altering the flow of a conversation, prompt\
  \ exfiltration via LLM proxying etc.\n\nThese issues are self-targeted and do not persist\
  \ to other users but do leave the server and business exposed. \nAll issues are shown with\
  \ the API but also work with the web embed.\n\n### Workarounds\n- `overrideConfig` should\
  \ be disabled by default\n- `overrideConfig` should have an explicit allow list of variables\
  \ that are allowed to be modified. This way the user opts-in to where modifications can be\
  \ made. \n- `vm2` and any forks of it should be removed as in the authors own words, \"fixing\
  \ the vulnerability seems impossible\". The recommended replacement is https://www.npmjs.com/package/isolated-vm"
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5cph-wvm9-45gj
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FlowiseAI/Flowise
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-5cph-wvm9-45gj
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-5cph-wvm9-45gj
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-15
references:
  - url: https://github.com/FlowiseAI/Flowise
    reference_type:
    reference_id:
  - url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-5cph-wvm9-45gj
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5cph-wvm9-45gj
    reference_type:
    reference_id: GHSA-5cph-wvm9-45gj
