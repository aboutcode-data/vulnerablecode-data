vulnerability_id: VCID-qfvw-x46d-aaas
aliases:
  - BIT-2023-40273
  - BIT-airflow-2023-40273
  - CVE-2023-40273
  - GHSA-pm87-24wq-r8w9
  - PYSEC-0000-CVE-2023-40273
  - PYSEC-2023-158
summary: |
  The session fixation vulnerability allowed the authenticated user to continue accessing Airflow webserver even after the password of the user has been reset by the admin - up until the expiry of the session of the user. Other than manually cleaning the session database (for database session backend), or changing the secure_key and restarting the webserver, there were no mechanisms to force-logout the user (and all other users with that).

  With this fix implemented, when using the database session backend, the existing sessions of the user are invalidated when the password of the user is reset. When using the securecookie session backend, the sessions are NOT invalidated and still require changing the secure key and restarting the webserver (and logging out all other users), but the user resetting the password is informed about it with a flash message warning displayed in the UI. Documentation is also updated explaining this behaviour.

  Users of Apache Airflow are advised to upgrade to version 2.7.0 or newer to mitigate the risk associated with this vulnerability.
severities:
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.29991'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30117'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30009'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30015'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30045'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30064'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30043'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30035'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30038'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30074'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30054'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30093'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30166'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00107'
    scoring_system: epss
    scoring_elements: '0.30165'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29655'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29629'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29482'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29597'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.2944'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29589'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29607'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29601'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29632'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29591'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.2956'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29562'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29613'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.29635'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00234'
    scoring_system: epss
    scoring_elements: '0.61036'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00234'
    scoring_system: epss
    scoring_elements: '0.61054'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00234'
    scoring_system: epss
    scoring_elements: '0.61064'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00234'
    scoring_system: epss
    scoring_elements: '0.61322'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62650'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62317'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62493'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62547'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62562'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62622'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62606'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62620'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62638'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62763'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62793'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00239'
    scoring_system: epss
    scoring_elements: '0.62812'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: '0.00255'
    scoring_system: epss
    scoring_elements: '0.33225'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-pm87-24wq-r8w9
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-pm87-24wq-r8w9
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/airflow
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/airflow
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/airflow/commit/2caa186935151683076b74357daad83d2538a3f6
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/airflow/commit/2caa186935151683076b74357daad83d2538a3f6
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/airflow/commit/f5d8201ea7935d17cecaf25fc90d4ef0ccdd627b
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/airflow/commit/f5d8201ea7935d17cecaf25fc90d4ef0ccdd627b
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/airflow/pull/33347
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/airflow/pull/33347
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/apache-airflow/PYSEC-2023-158.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/apache-airflow/PYSEC-2023-158.yaml
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.apache.org/thread/9rdmv8ln4y4ncbyrlmjrsj903x4l80nj
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/9rdmv8ln4y4ncbyrlmjrsj903x4l80nj
  - score: '8.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40273
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-40273
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.openwall.com/lists/oss-security/2023/08/23/1
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.openwall.com/lists/oss-security/2023/08/23/1
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-384
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-40273
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/2caa186935151683076b74357daad83d2538a3f6
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/commit/f5d8201ea7935d17cecaf25fc90d4ef0ccdd627b
    reference_type:
    reference_id:
  - url: https://github.com/apache/airflow/pull/33347
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/apache-airflow/PYSEC-2023-158.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/9rdmv8ln4y4ncbyrlmjrsj903x4l80nj
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2023/08/23/1
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/08/23/1
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:airflow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:airflow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-40273
    reference_type:
    reference_id: CVE-2023-40273
  - url: https://github.com/advisories/GHSA-pm87-24wq-r8w9
    reference_type:
    reference_id: GHSA-pm87-24wq-r8w9
