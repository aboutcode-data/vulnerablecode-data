vulnerability_id: VCID-qf1g-25hj-aaac
aliases:
  - CVE-2024-41001
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  io_uring/sqpoll: work around a potential audit memory leak

  kmemleak complains that there's a memory leak related to connect
  handling:

  unreferenced object 0xffff0001093bdf00 (size 128):
  comm "iou-sqp-455", pid 457, jiffies 4294894164
  hex dump (first 32 bytes):
  02 00 fa ea 7f 00 00 01 00 00 00 00 00 00 00 00  ................
  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
  backtrace (crc 2e481b1a):
  [<00000000c0a26af4>] kmemleak_alloc+0x30/0x38
  [<000000009c30bb45>] kmalloc_trace+0x228/0x358
  [<000000009da9d39f>] __audit_sockaddr+0xd0/0x138
  [<0000000089a93e34>] move_addr_to_kernel+0x1a0/0x1f8
  [<000000000b4e80e6>] io_connect_prep+0x1ec/0x2d4
  [<00000000abfbcd99>] io_submit_sqes+0x588/0x1e48
  [<00000000e7c25e07>] io_sq_thread+0x8a4/0x10e4
  [<00000000d999b491>] ret_from_fork+0x10/0x20

  which can can happen if:

  1) The command type does something on the prep side that triggers an
     audit call.
  2) The thread hasn't done any operations before this that triggered
     an audit call inside ->issue(), where we have audit_uring_entry()
     and audit_uring_exit().

  Work around this by issuing a blanket NOP operation before the SQPOLL
  does anything.
severities:
  - score: '5.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-41001.json
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13461'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13266'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13323'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13423'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13499'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13501'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13474'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13437'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13431'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13409'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13416'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13441'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13442'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13433'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16094'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.15939'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16071'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.15897'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16059'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16097'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.16127'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.18002'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.18'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17974'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17944'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17914'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17945'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17947'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.17966'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '0.00256'
    scoring_system: epss
    scoring_elements: '0.33304'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41001
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41001
weaknesses:
  - CWE-402
  - CWE-401
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-41001.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-41001
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-41001
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/55c22375cbaa24f77dd13f9ae0642915444a1227
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9e810bd995823786ea30543e480e8a573e5e5667
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a40e90d9304629002fb17200f7779823a81191d3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c4ce0ab27646f4206a9eb502d6fe45cb080e1cae
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2297585
    reference_type:
    reference_id: 2297585
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41001
    reference_type:
    reference_id: CVE-2024-41001
  - url: https://access.redhat.com/errata/RHSA-2024:9315
    reference_type:
    reference_id: RHSA-2024:9315
  - url: https://usn.ubuntu.com/6999-1/
    reference_type:
    reference_id: USN-6999-1
  - url: https://usn.ubuntu.com/6999-2/
    reference_type:
    reference_id: USN-6999-2
  - url: https://usn.ubuntu.com/7004-1/
    reference_type:
    reference_id: USN-7004-1
  - url: https://usn.ubuntu.com/7005-1/
    reference_type:
    reference_id: USN-7005-1
  - url: https://usn.ubuntu.com/7005-2/
    reference_type:
    reference_id: USN-7005-2
  - url: https://usn.ubuntu.com/7008-1/
    reference_type:
    reference_id: USN-7008-1
  - url: https://usn.ubuntu.com/7029-1/
    reference_type:
    reference_id: USN-7029-1
