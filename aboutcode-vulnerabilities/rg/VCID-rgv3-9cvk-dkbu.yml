vulnerability_id: VCID-rgv3-9cvk-dkbu
aliases:
  - CVE-2025-52995
  - GHSA-w7qc-6grj-w7r8
summary: "File Browser vulnerable to command execution allowlist bypass\n## Summary ##\n\nThe\
  \ *Command Execution* feature of Filebrowser only allows the execution of shell command which\
  \ have been predefined on a user-specific allowlist. The implementation of this allowlist\
  \ is erroneous, allowing a user to execute additional commands not permitted.\n\n## Impact\
  \ ##\n\nA user can execute more shell commands than they are authorized for. The concrete\
  \ impact of this vulnerability depends on the commands configured, and the binaries installed\
  \ on the server or in the container image. Due to the missing separation of *scopes* on the\
  \ OS-level, this could give an attacker access to all files managed the application, including\
  \ the File Browser database.\n\n## Vulnerability Description ##\n\nFor a user to make use\
  \ of the command execution feature, two things need to happen in advance:\n\n1. An administrator\
  \ needs to grant that account the `Execute commands` permission\n2. The command to be executed\
  \ needs to be listed in the `Commands` input field (also done by an administrator)\n\nIf a\
  \ user tries to execute a different command, it gets rejected by the application.\n\nThe allowlist\
  \ verification of a command happens in the function `CanExecute` in the file `users/users.go`:\n\
  \n```go\n// CanExecute checks if an user can execute a specific command.\nfunc (u *User) CanExecute(command\
  \ string) bool {\n\tif !u.Perm.Execute {\n\t\treturn false\n\t}\n\n\tfor _, cmd := range u.Commands\
  \ {\n\t\tif regexp.MustCompile(cmd).MatchString(command) {\n\t\t\treturn true\n\t\t}\n\t}\n\
  \n\treturn false\n}\n```\n\nThis check employs a regular expression which does not test if\
  \ the command issued (`command`) is identical to a configured one (`cmd`, part of the array\
  \ `u.Commands`) but rather only if the issued command contains an allowed one.\nThis has the\
  \ consequence, that, e.g., if you are only granted access to the `ls` command, you will also\
  \ be allowed to execute `lsof` and `lsusb`.\n\nAs a prerequisite, an attacker needs an account\
  \ with the `Execute Commands` permission and some permitted commands.\n\n## Proof of Concept\
  \ ##\n\nGrant a user the `Execute commands` permission and allow them to use only `ls` in\
  \ the `Commands` field.\n\n![image](https://github.com/user-attachments/assets/30b84315-16bd-4b8f-ba30-2a395c89f002)\n\
  \nAfterwards, login as that user, open a command execution window and execute `lsof` and `lsusb`.\n\
  \n![image](https://github.com/user-attachments/assets/f40baf90-832e-4ced-a596-bc75cf691549)\n\
  \n## Recommended Countermeasures ##\n\nThe `CanExecute` function in the *Filebrowser* source\
  \ code should be fixed to only allow exact matches of the command specified instead of doing\
  \ partial matching.\nThe correctness of this fix should be extensively tested in the application's\
  \ automated test suite.\n\n## Timeline ##\n\n* `2025-03-25` Identified the vulnerability in\
  \ version 2.32.0\n* `2025-04-11` Contacted the project\n* `2025-04-18` Vulnerability disclosed\
  \ to the project\n* `2025-06-25` Uploaded advisories to the project's GitHub repository\n\
  * `2025-06-25` CVE ID assigned by GitHub\n* `2025-06-26` Fix released in version 2.33.10\n\
  \n## References ##\n\n## Credits ##\n\n* Mathias Tausig ([SBA Research](https://www.sba-research.org/))"
severities:
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.11941'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17086'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17056'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20665'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20614'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20569'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20651'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20658'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20662'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20633'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.26024'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.0009'
    scoring_system: epss
    scoring_elements: '0.25961'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.27725'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.27766'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.27741'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.27712'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.27718'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.27681'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00097'
    scoring_system: epss
    scoring_elements: '0.27742'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28563'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28478'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.2853'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28526'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28494'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.2856'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28592'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28607'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28538'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28625'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28587'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28613'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28597'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28578'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28681'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28675'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28688'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28554'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28521'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28543'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28624'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28627'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28544'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28632'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28622'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00101'
    scoring_system: epss
    scoring_elements: '0.28487'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.33478'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.33527'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '0.00131'
    scoring_system: epss
    scoring_elements: '0.33547'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/filebrowser/filebrowser
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/filebrowser/filebrowser
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/filebrowser/filebrowser/commit/4d830f707fc4314741fd431e70c2ce50cd5a3108
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/filebrowser/filebrowser/commit/4d830f707fc4314741fd431e70c2ce50cd5a3108
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/filebrowser/filebrowser/commit/4d830f707fc4314741fd431e70c2ce50cd5a3108
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-06-30T20:25:42Z/
    published_at: None
    url: https://github.com/filebrowser/filebrowser/commit/4d830f707fc4314741fd431e70c2ce50cd5a3108
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/filebrowser/filebrowser/releases/tag/v2.33.10
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/filebrowser/filebrowser/releases/tag/v2.33.10
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/filebrowser/filebrowser/releases/tag/v2.33.10
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-06-30T20:25:42Z/
    published_at: None
    url: https://github.com/filebrowser/filebrowser/releases/tag/v2.33.10
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/filebrowser/filebrowser/security/advisories/GHSA-w7qc-6grj-w7r8
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/filebrowser/filebrowser/security/advisories/GHSA-w7qc-6grj-w7r8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/filebrowser/filebrowser/security/advisories/GHSA-w7qc-6grj-w7r8
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-06-30T20:25:42Z/
    published_at: None
    url: https://github.com/filebrowser/filebrowser/security/advisories/GHSA-w7qc-6grj-w7r8
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/sbaresearch/advisories/tree/public/2025/SBA-ADV-20250325-05_Filebrowser_Bypass_Command_Execution_Allowlist
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/sbaresearch/advisories/tree/public/2025/SBA-ADV-20250325-05_Filebrowser_Bypass_Command_Execution_Allowlist
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-52995
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-52995
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-52995
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3795
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3795
weaknesses:
  - CWE-77
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-52995
    reference_type:
    reference_id:
  - url: https://github.com/filebrowser/filebrowser
    reference_type:
    reference_id:
  - url: https://github.com/filebrowser/filebrowser/commit/4d830f707fc4314741fd431e70c2ce50cd5a3108
    reference_type:
    reference_id:
  - url: https://github.com/filebrowser/filebrowser/releases/tag/v2.33.10
    reference_type:
    reference_id:
  - url: https://github.com/filebrowser/filebrowser/security/advisories/GHSA-w7qc-6grj-w7r8
    reference_type:
    reference_id:
  - url: https://github.com/sbaresearch/advisories/tree/public/2025/SBA-ADV-20250325-05_Filebrowser_Bypass_Command_Execution_Allowlist
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-52995
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3795
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:filebrowser:filebrowser:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:filebrowser:filebrowser:*:*:*:*:*:*:*:*
