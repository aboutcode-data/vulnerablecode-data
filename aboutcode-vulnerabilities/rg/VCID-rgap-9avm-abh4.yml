vulnerability_id: VCID-rgap-9avm-abh4
aliases:
  - GHSA-j2pc-v64r-mv4f
summary: |
  Protobuf Maven Plugin protocDigest is ignored when using protoc from PATH
  ### Summary
  The expected `protocDigest` is ignored when protoc is taken from the `PATH`.

  ### Details
  The documentation for the `protocDigest` parameter says:
  > ... Users may wish to specify this if using a `PATH`-based binary ...

  However, when specifying `<protoc>PATH</protoc>` the `protocDigest` is not actually checked because the code returns here already
  https://github.com/ascopes/protobuf-maven-plugin/blob/59097aae8062c461129a13dcda2f4116b90a8765/protobuf-maven-plugin/src/main/java/io/github/ascopes/protobufmavenplugin/protoc/ProtocResolver.java#L91-L93

  before the digest check:
  https://github.com/ascopes/protobuf-maven-plugin/blob/59097aae8062c461129a13dcda2f4116b90a8765/protobuf-maven-plugin/src/main/java/io/github/ascopes/protobufmavenplugin/protoc/ProtocResolver.java#L106

  ### PoC
  Specify:
  ```xml
  <protoc>PATH</protoc>
  <protocDigest>sha256:0000000000000000000000000000000000000000000000000000000000000000</protocDigest>
  ```

  And notice how the `protoc` on the `PATH` is not rejected, despite a digest mismatch.

  ### Impact
  Users who have an untrusted `protoc` executable on their `PATH` and rely `<protocDigest>` as protection are affected.
severities:
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-j2pc-v64r-mv4f
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ascopes/protobuf-maven-plugin
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ascopes/protobuf-maven-plugin/commit/d3330e7038a296fe595c5470a22019eb70e35b07
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/ascopes/protobuf-maven-plugin/security/advisories/GHSA-j2pc-v64r-mv4f
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ascopes/protobuf-maven-plugin/security/advisories/GHSA-j2pc-v64r-mv4f
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-354
  - CWE-693
references:
  - url: https://github.com/ascopes/protobuf-maven-plugin
    reference_type:
    reference_id:
  - url: https://github.com/ascopes/protobuf-maven-plugin/commit/d3330e7038a296fe595c5470a22019eb70e35b07
    reference_type:
    reference_id:
  - url: https://github.com/ascopes/protobuf-maven-plugin/security/advisories/GHSA-j2pc-v64r-mv4f
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-j2pc-v64r-mv4f
    reference_type:
    reference_id: GHSA-j2pc-v64r-mv4f
