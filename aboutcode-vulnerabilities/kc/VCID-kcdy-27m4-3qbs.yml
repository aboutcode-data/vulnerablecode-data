vulnerability_id: VCID-kcdy-27m4-3qbs
aliases:
  - GHSA-6qhv-4h7r-2g9m
summary: |
  rfc3161-client has insufficient verification for timestamp response signatures
  ### Impact

  `rfc3161-client` 1.0.2 and earlier contain a flaw in their timestamp response signature verification logic. In particular, it performs chain verification against the TSR's embedded certificates up to the trusted root(s), but fails to verify the TSR's own signature against the timestamping leaf certificates. Consequently, vulnerable versions perform insufficient signature validation to properly consider a TSR verified, as the attacker can introduce _any_ TSR signature so long as the embedded leaf chains up to some root TSA.

  ### Patches

  Users should immediately upgrade to `rfc3161-client` 1.0.3 or later.

  ### Workarounds

  There is no workaround possible. Users should immediately upgrade to a fixed version.
severities:
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-6qhv-4h7r-2g9m
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/trailofbits/rfc3161-client
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/trailofbits/rfc3161-client/commit/724a184f953e3f171f85cb223871172b41b0d0dc
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/trailofbits/rfc3161-client/security/advisories/GHSA-6qhv-4h7r-2g9m
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/trailofbits/rfc3161-client/security/advisories/GHSA-6qhv-4h7r-2g9m
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-347
references:
  - url: https://github.com/trailofbits/rfc3161-client
    reference_type:
    reference_id:
  - url: https://github.com/trailofbits/rfc3161-client/commit/724a184f953e3f171f85cb223871172b41b0d0dc
    reference_type:
    reference_id:
  - url: https://github.com/trailofbits/rfc3161-client/security/advisories/GHSA-6qhv-4h7r-2g9m
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-6qhv-4h7r-2g9m
    reference_type:
    reference_id: GHSA-6qhv-4h7r-2g9m
