vulnerability_id: VCID-gz21-ght3-p7cj
aliases:
  - CVE-2025-68740
summary: 'In the Linux kernel, the following vulnerability has been resolved:  ima: Handle error
  code returned by ima_filter_rule_match()  In ima_match_rules(), if ima_filter_rule_match()
  returns -ENOENT due to the rule being NULL, the function incorrectly skips the ''if (!rc)''
  check and sets ''result = true''. The LSM rule is considered a match, causing extra files
  to be measured by IMA.  This issue can be reproduced in the following scenario: After unloading
  the SELinux policy module via ''semodule -d'', if an IMA measurement is triggered before ima_lsm_rules
  is updated, in ima_match_rules(), the first call to ima_filter_rule_match() returns -ESTALE.
  This causes the code to enter the ''if (rc == -ESTALE && !rule_reinitialized)'' block, perform
  ima_lsm_copy_rule() and retry. In ima_lsm_copy_rule(), since the SELinux module has been removed,
  the rule becomes NULL, and the second call to ima_filter_rule_match() returns -ENOENT. This
  bypasses the ''if (!rc)'' check and results in a false match.  Call trace:   selinux_audit_rule_match+0x310/0x3b8   security_audit_rule_match+0x60/0xa0   ima_match_rules+0x2e4/0x4a0   ima_match_policy+0x9c/0x1e8   ima_get_action+0x48/0x60   process_measurement+0xf8/0xa98   ima_bprm_check+0x98/0xd8   security_bprm_check+0x5c/0x78   search_binary_handler+0x6c/0x318   exec_binprm+0x58/0x1b8   bprm_execve+0xb8/0x130   do_execveat_common.isra.0+0x1a8/0x258   __arm64_sys_execve+0x48/0x68   invoke_syscall+0x50/0x128   el0_svc_common.constprop.0+0xc8/0xf0   do_el0_svc+0x24/0x38   el0_svc+0x44/0x200   el0t_64_sync_handler+0x100/0x130   el0t_64_sync+0x3c8/0x3d0  Fix
  this by changing ''if (!rc)'' to ''if (rc <= 0)'' to ensure that error codes like -ENOENT
  do not bypass the check and accidentally result in a successful match.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-68740.json
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05589'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68740
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05572'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68740
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-68740.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-68740
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-68740
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2425044
    reference_type:
    reference_id: 2425044
