vulnerability_id: VCID-cqrj-e7a5-aaaq
aliases:
  - CVE-2021-39880
  - GHSA-w6pv-c757-6rgr
summary: A Denial Of Service vulnerability in the apollo_upload_server Ruby gem in GitLab CE/EE
  all versions starting from 11.9 before 14.0.9, all versions starting from 14.1 before 14.1.4,
  and all versions starting from 14.2 before 14.2.2 allows an attacker to deny access to all
  users via specially crafted requests to the apollo_upload_server middleware.
severities:
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.44483'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.44151'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.44173'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.44145'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53173'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53621'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53608'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53596'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53598'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53524'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53507'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53450'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53862'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53812'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53786'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00159'
    scoring_system: epss
    scoring_elements: '0.53646'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00472'
    scoring_system: epss
    scoring_elements: '0.63378'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00472'
    scoring_system: epss
    scoring_elements: '0.63372'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00472'
    scoring_system: epss
    scoring_elements: '0.63368'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00472'
    scoring_system: epss
    scoring_elements: '0.63389'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00472'
    scoring_system: epss
    scoring_elements: '0.63391'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00472'
    scoring_system: epss
    scoring_elements: '0.6338'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00472'
    scoring_system: epss
    scoring_elements: '0.63375'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.69252'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68085'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68067'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68155'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68161'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68178'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68198'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68185'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.6818'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68184'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68201'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68209'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68217'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68211'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68197'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.68177'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.69172'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.69201'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.69228'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.69251'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.00638'
    scoring_system: epss
    scoring_elements: '0.6923'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: '0.01179'
    scoring_system: epss
    scoring_elements: '0.65942'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-w6pv-c757-6rgr
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/jetruby/apollo_upload_server-ruby
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jetruby/apollo_upload_server-ruby
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/jetruby/apollo_upload_server-ruby/commit/b0582c1a3e458eee3c994fb38278bd0221f20486
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jetruby/apollo_upload_server-ruby/commit/b0582c1a3e458eee3c994fb38278bd0221f20486
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/jetruby/apollo_upload_server-ruby/pull/44
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jetruby/apollo_upload_server-ruby/pull/44
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/jetruby/apollo_upload_server-ruby/releases/tag/2.1.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jetruby/apollo_upload_server-ruby/releases/tag/2.1.0
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-39880.json
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-39880.json
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561#note_642879964
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561#note_642879964
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://hackerone.com/reports/1181284
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://hackerone.com/reports/1181284
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://hackerone.com/reports/1181284
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39880
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39880
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39880
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://vuldb.com/?id.183842
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://vuldb.com/?id.183842
weaknesses:
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-39880
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39880
    reference_type:
    reference_id:
  - url: https://github.com/jetruby/apollo_upload_server-ruby
    reference_type:
    reference_id:
  - url: https://github.com/jetruby/apollo_upload_server-ruby/commit/b0582c1a3e458eee3c994fb38278bd0221f20486
    reference_type:
    reference_id:
  - url: https://github.com/jetruby/apollo_upload_server-ruby/pull/44
    reference_type:
    reference_id:
  - url: https://github.com/jetruby/apollo_upload_server-ruby/releases/tag/2.1.0
    reference_type:
    reference_id:
  - url: https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-39880.json
    reference_type:
    reference_id:
  - url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561
    reference_type:
    reference_id:
  - url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561#note_642879964
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1181284
    reference_type:
    reference_id:
  - url: https://vuldb.com/?id.183842
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39880
    reference_type:
    reference_id: CVE-2021-39880
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/apollo_upload_server/CVE-2021-39880.yml
    reference_type:
    reference_id: CVE-2021-39880.YML
  - url: https://github.com/advisories/GHSA-w6pv-c757-6rgr
    reference_type:
    reference_id: GHSA-w6pv-c757-6rgr
