vulnerability_id: VCID-rx2s-g7cs-aaap
aliases:
  - CVE-2021-47452
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  netfilter: nf_tables: skip netdev events generated on netns removal

  syzbot reported following (harmless) WARN:

   WARNING: CPU: 1 PID: 2648 at net/netfilter/core.c:468
    nft_netdev_unregister_hooks net/netfilter/nf_tables_api.c:230 [inline]
    nf_tables_unregister_hook include/net/netfilter/nf_tables.h:1090 [inline]
    __nft_release_basechain+0x138/0x640 net/netfilter/nf_tables_api.c:9524
    nft_netdev_event net/netfilter/nft_chain_filter.c:351 [inline]
    nf_tables_netdev_event+0x521/0x8a0 net/netfilter/nft_chain_filter.c:382

  reproducer:
  unshare -n bash -c 'ip link add br0 type bridge; nft add table netdev t ; \
   nft add chain netdev t ingress \{ type filter hook ingress device "br0" \
   priority 0\; policy drop\; \}'

  Problem is that when netns device exit hooks create the UNREGISTER
  event, the .pre_exit hook for nf_tables core has already removed the
  base hook.  Notifier attempts to do this again.

  The need to do base hook unregister unconditionally was needed in the past,
  because notifier was last stage where reg->dev dereference was safe.

  Now that nf_tables does the hook removal in .pre_exit, this isn't
  needed anymore.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47452.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17962'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14732'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17968'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17965'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14687'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14849'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14859'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.1488'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14915'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14898'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14885'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14894'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14954'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14958'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14929'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14905'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.14856'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17735'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17809'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17904'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17981'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17971'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17952'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17924'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17917'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17928'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.17941'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '0.0025'
    scoring_system: epss
    scoring_elements: '0.3279'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47452.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47452
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47452
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/68a3765c659f809dcaac20030853a054646eb739
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/90c7c58aa2bd02c65a4c63b7dfe0b16eab12cf9f
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2282906
    reference_type:
    reference_id: 2282906
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47452
    reference_type:
    reference_id: CVE-2021-47452
