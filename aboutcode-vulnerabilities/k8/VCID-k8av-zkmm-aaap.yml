vulnerability_id: VCID-k8av-zkmm-aaap
aliases:
  - CVE-2022-22941
  - GHSA-qcr3-hr2f-6557
  - PYSEC-2022-174
summary: An issue was discovered in SaltStack Salt in versions before 3002.8, 3003.4, 3004.1.
  When configured as a Master-of-Masters, with a publisher_acl, if a user configured in the
  publisher_acl targets any minion connected to the Syndic, the Salt Master incorrectly interpreted
  no valid targets as valid, allowing configured users to target any of the minions connected
  to the syndic with their configured commands. This requires a syndic master combined with
  publisher_acl configured on the Master-of-Masters, allowing users specified in the publisher_acl
  to bypass permissions, publishing authorized commands to any configured minion.
severities:
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00806'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0109'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01087'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01091'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01075'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01074'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01082'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00809'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01085'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01097'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01093'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01096'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01102'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01088'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00803'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00801'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00815'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00811'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00804'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00802'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00792'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00793'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00788'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01077'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00799'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00798'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.11111'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00302'
    scoring_system: epss
    scoring_elements: '0.70257'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00302'
    scoring_system: epss
    scoring_elements: '0.70115'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00302'
    scoring_system: epss
    scoring_elements: '0.70297'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00302'
    scoring_system: epss
    scoring_elements: '0.70312'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00302'
    scoring_system: epss
    scoring_elements: '0.70357'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00302'
    scoring_system: epss
    scoring_elements: '0.70358'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00302'
    scoring_system: epss
    scoring_elements: '0.70365'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00302'
    scoring_system: epss
    scoring_elements: '0.70375'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00426'
    scoring_system: epss
    scoring_elements: '0.74070'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00426'
    scoring_system: epss
    scoring_elements: '0.74082'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00426'
    scoring_system: epss
    scoring_elements: '0.74263'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00426'
    scoring_system: epss
    scoring_elements: '0.74052'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00608'
    scoring_system: epss
    scoring_elements: '0.79308'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00608'
    scoring_system: epss
    scoring_elements: '0.79322'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00608'
    scoring_system: epss
    scoring_elements: '0.79344'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '0.00608'
    scoring_system: epss
    scoring_elements: '0.79254'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-qcr3-hr2f-6557
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/salt/PYSEC-2022-174.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/salt/PYSEC-2022-174.yaml
  - score: '7.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/saltstack/salt
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/saltstack/salt
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3002.8.rst#L31
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3002.8.rst#L31
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3003.4.rst#L32
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3003.4.rst#L32
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3004.1.rst#L30
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3004.1.rst#L30
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/saltstack/salt/releases
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/saltstack/salt/releases
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/saltstack/salt/releases,
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/saltstack/salt/releases,
  - score: '6.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-22941
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-22941
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-22941
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://repo.saltproject.io
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://repo.saltproject.io
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://saltproject.io/security_announcements/salt-security-advisory-release
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://saltproject.io/security_announcements/salt-security-advisory-release
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://saltproject.io/security_announcements/salt-security-advisory-release/,
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://saltproject.io/security_announcements/salt-security-advisory-release/,
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://security.gentoo.org/glsa/202310-22
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.gentoo.org/glsa/202310-22
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-732
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-22941
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22941
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/salt/PYSEC-2022-174.yaml
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3002.8.rst#L31
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3003.4.rst#L32
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/blob/8f9405cf8e6f7d7776d5000841c886dec6d96250/doc/topics/releases/3004.1.rst#L30
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/releases
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/releases,
    reference_type:
    reference_id:
  - url: https://github.com/saltstack/salt/releases%2C
    reference_type:
    reference_id:
  - url: https://repo.saltproject.io
    reference_type:
    reference_id:
  - url: https://repo.saltproject.io/
    reference_type:
    reference_id:
  - url: https://saltproject.io/security_announcements/salt-security-advisory-release
    reference_type:
    reference_id:
  - url: https://saltproject.io/security_announcements/salt-security-advisory-release/,
    reference_type:
    reference_id:
  - url: https://saltproject.io/security_announcements/salt-security-advisory-release/%2C
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202310-22
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1008945
    reference_type:
    reference_id: 1008945
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-22941
    reference_type:
    reference_id: CVE-2022-22941
  - url: https://github.com/advisories/GHSA-qcr3-hr2f-6557
    reference_type:
    reference_id: GHSA-qcr3-hr2f-6557
