vulnerability_id: VCID-4rs4-9d2b-a3hx
aliases:
  - CVE-2025-68950
  - GHSA-7rvh-xqp3-pr8j
summary: |
  ImageMagick's failure to limit MVG mutual causes Stack Overflow
  ### Summary
  Magick fails to check for circular references between two MVGs, leading to a stack overflow.

  ### Details

  After reading mvg1 using Magick, the following is displayed:
  ```
  ./magick -limit memory 2GiB -limit map 2GiB -limit disk 0 mvg:L1.mvg out.png
  AddressSanitizer:DEADLYSIGNAL
  =================================================================
  ==3564123==ERROR: AddressSanitizer: UNKNOWN SIGNAL on unknown address 0x000000000000 (pc 0x5589549a4458 bp 0x7ffcc61f34a0 sp 0x7ffcc61efdd0 T0)
      #0 0x5589549a4458 in GetImagePixelCache MagickCore/cache.c:1726
      #1 0x5589549b02c1 in QueueAuthenticPixelCacheNexus MagickCore/cache.c:4261
      #2 0x5589549a2f24 in GetAuthenticPixelCacheNexus MagickCore/cache.c:1368
      #3 0x5589549bae98 in GetCacheViewAuthenticPixels MagickCore/cache-view.c:311
      #4 0x558954afb3a5 in DrawPolygonPrimitive._omp_fn.1 MagickCore/draw.c:5172
      #5 0x7f62dd89fa15 in GOMP_parallel (/lib/x86_64-linux-gnu/libgomp.so.1+0x14a15)
      #6 0x558954ae0f41 in DrawPolygonPrimitive MagickCore/draw.c:5156
      #7 0x558954ae5607 in DrawPrimitive MagickCore/draw.c:5875
      #8 0x558954adc72d in RenderMVGContent MagickCore/draw.c:4522
      #9 0x558954adcf67 in DrawImage MagickCore/draw.c:4561
      #10 0x55895496cedb in RenderFreetype MagickCore/annotate.c:2065
      #11 0x55895496702e in RenderType MagickCore/annotate.c:1112
      #12 0x558954963da7 in AnnotateImage MagickCore/annotate.c:544
      #13 0x558954ae4e0a in DrawPrimitive MagickCore/draw.c:5799
      #14 0x558954adc72d in RenderMVGContent MagickCore/draw.c:4522
      #15 0x558954adcf67 in DrawImage MagickCore/draw.c:4561
      #16 0x558954755a46 in ReadMVGImage coders/mvg.c:240
      #17 0x558954a15ecc in ReadImage MagickCore/constitute.c:743
      #18 0x558954ae3c76 in DrawPrimitive MagickCore/draw.c:5705
      #19 0x558954adc72d in RenderMVGContent MagickCore/draw.c:4522
      #20 0x558954adcf67 in DrawImage MagickCore/draw.c:4561
      #21 0x558954755a46 in ReadMVGImage coders/mvg.c:240
      ...
  ```

  ### Impact
  This is a DoS vulnerability, and any situation that allows reading the mvg file will be affected.
severities:
  - score: '4.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-68950.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03307'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68950
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03311'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68950
  - score: 4
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-7rvh-xqp3-pr8j
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick
  - score: 4
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick/commit/204718c2211903949dcfc0df8e65ed066b008dec
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick/commit/204718c2211903949dcfc0df8e65ed066b008dec
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick/commit/204718c2211903949dcfc0df8e65ed066b008dec
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-30T18:09:01Z/
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick/commit/204718c2211903949dcfc0df8e65ed066b008dec
  - score: 4
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-7rvh-xqp3-pr8j
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-7rvh-xqp3-pr8j
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-7rvh-xqp3-pr8j
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-7rvh-xqp3-pr8j
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-30T18:09:01Z/
    published_at: None
    url: https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-7rvh-xqp3-pr8j
  - score: '4.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-68950
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-68950
weaknesses:
  - CWE-674
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-68950.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-68950
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-68950
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/ImageMagick/ImageMagick
    reference_type:
    reference_id:
  - url: https://github.com/ImageMagick/ImageMagick/commit/204718c2211903949dcfc0df8e65ed066b008dec
    reference_type:
    reference_id:
  - url: https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-7rvh-xqp3-pr8j
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68950
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2426284
    reference_type:
    reference_id: 2426284
  - url: https://github.com/advisories/GHSA-7rvh-xqp3-pr8j
    reference_type:
    reference_id: GHSA-7rvh-xqp3-pr8j
