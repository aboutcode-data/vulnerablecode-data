vulnerability_id: VCID-umwq-ct2q-aaan
aliases:
  - CVE-2021-39138
  - GHSA-23r4-5mxp-c7g5
summary: |
  Improper Authentication
  Parse Server is an open source backend that can be deployed to any infrastructure that can run Node.js. Developers can use the REST API to signup users and also allow users to login anonymously., when an anonymous user is first signed up using REST, the server creates session incorrectly. Particularly, the `authProvider` field in `_Session` class under `createdWith` shows the user logged in creating a password. If a developer later depends on the `createdWith` field to provide a different level of access between a password user and anonymous user, the server incorrectly classified the session type as being created with a `password`. The server does not currently use `createdWith` to make decisions about internal functions, so if a developer is not using `createdWith` directly, they are not affected. The vulnerability only affects users who depend on `createdWith` by using it directly. As a workaround, do not use the `createdWith` Session field to make decisions if one allows anonymous login.
severities:
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38035'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.37841'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.37921'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.37950'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38040'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38047'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38409'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38333'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38269'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38077'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38065'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.37565'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46822'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46529'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46531'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46506'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00191'
    scoring_system: epss
    scoring_elements: '0.27193'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44532'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.4453'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44587'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44647'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44676'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44674'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44572'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44568'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44579'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44588'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44594'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44604'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.44567'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41508'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41478'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41593'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41604'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41608'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41628'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41597'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41573'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41595'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41611'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41641'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41636'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41614'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41575'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-23r4-5mxp-c7g5
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/parse-community/parse-server
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/parse-community/parse-server
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/parse-community/parse-server/commit/147bd9a3dc43391e92c36e05d5db860b04ca27db
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/parse-community/parse-server/commit/147bd9a3dc43391e92c36e05d5db860b04ca27db
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/parse-community/parse-server/releases/tag/4.5.2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/parse-community/parse-server/releases/tag/4.5.2
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/parse-community/parse-server/security/advisories/GHSA-23r4-5mxp-c7g5
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/parse-community/parse-server/security/advisories/GHSA-23r4-5mxp-c7g5
  - score: '6.4'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39138
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39138
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39138
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-863
  - CWE-287
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-39138
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/commit/147bd9a3dc43391e92c36e05d5db860b04ca27db
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/releases/tag/4.5.1
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/releases/tag/4.5.2
    reference_type:
    reference_id:
  - url: https://github.com/parse-community/parse-server/security/advisories/GHSA-23r4-5mxp-c7g5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:parseplatform:parse-server:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:parseplatform:parse-server:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39138
    reference_type:
    reference_id: CVE-2021-39138
  - url: https://github.com/advisories/GHSA-23r4-5mxp-c7g5
    reference_type:
    reference_id: GHSA-23r4-5mxp-c7g5
