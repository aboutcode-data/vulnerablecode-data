vulnerability_id: VCID-an6d-u89f-aaag
aliases:
  - CVE-2022-20001
summary: fish is a command line shell. fish version 3.1.0 through version 3.3.1 is vulnerable
  to arbitrary code execution. git repositories can contain per-repository configuration that
  change the behavior of git, including running arbitrary commands. When using the default configuration
  of fish, changing to a directory automatically runs `git` commands in order to display information
  about the current repository in the prompt. If an attacker can convince a user to change their
  current directory into one controlled by the attacker, such as on a shared file system or
  extracted archive, fish will run arbitrary commands under the attacker's control. This problem
  has been fixed in fish 3.4.0. Note that running git in these directories, including using
  the git tab completion, remains a potential trigger for this issue. As a workaround, remove
  the `fish_git_prompt` function from the prompt.
severities:
  - score: '0.00265'
    scoring_system: epss
    scoring_elements: '0.66873'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00265'
    scoring_system: epss
    scoring_elements: '0.66529'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00265'
    scoring_system: epss
    scoring_elements: '0.66619'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00265'
    scoring_system: epss
    scoring_elements: '0.66869'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00265'
    scoring_system: epss
    scoring_elements: '0.66762'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00265'
    scoring_system: epss
    scoring_elements: '0.66807'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00265'
    scoring_system: epss
    scoring_elements: '0.66825'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.69306'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.69287'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.69496'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70415'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70405'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70472'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70489'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70521'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00401'
    scoring_system: epss
    scoring_elements: '0.57897'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00401'
    scoring_system: epss
    scoring_elements: '0.57844'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63119'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61659'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61628'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.6163'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61652'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61666'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61689'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61686'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61679'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61663'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63041'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63081'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63145'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.6315'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63118'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63126'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63136'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.6314'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63127'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63123'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61606'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61609'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61637'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '0.00765'
    scoring_system: epss
    scoring_elements: '0.58195'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/fish-shell/fish-shell/pull/8589
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:55:08Z/
    published_at: None
    url: https://github.com/fish-shell/fish-shell/pull/8589
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/fish-shell/fish-shell/releases/tag/3.4.0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:55:08Z/
    published_at: None
    url: https://github.com/fish-shell/fish-shell/releases/tag/3.4.0
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/fish-shell/fish-shell/security/advisories/GHSA-pj5f-6vxj-f5mq
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:55:08Z/
    published_at: None
    url: https://github.com/fish-shell/fish-shell/security/advisories/GHSA-pj5f-6vxj-f5mq
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BPZ7JV22DSZB5LNUCUEJ2HO3PKM2TVVK/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:55:08Z/
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BPZ7JV22DSZB5LNUCUEJ2HO3PKM2TVVK/
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TRNMYS2LKB6TKOOBQQRSRQICDMWLZ4QL/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:55:08Z/
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TRNMYS2LKB6TKOOBQQRSRQICDMWLZ4QL/
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-20001
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-20001
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-20001
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://security.gentoo.org/glsa/202309-10
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:55:08Z/
    published_at: None
    url: https://security.gentoo.org/glsa/202309-10
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.debian.org/security/2022/dsa-5234
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:55:08Z/
    published_at: None
    url: https://www.debian.org/security/2022/dsa-5234
weaknesses:
  - CWE-427
  - CWE-74
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-20001
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-20001
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/fish-shell/fish-shell/pull/8589
    reference_type:
    reference_id:
  - url: https://github.com/fish-shell/fish-shell/releases/tag/3.4.0
    reference_type:
    reference_id:
  - url: https://github.com/fish-shell/fish-shell/security/advisories/GHSA-pj5f-6vxj-f5mq
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BPZ7JV22DSZB5LNUCUEJ2HO3PKM2TVVK/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TRNMYS2LKB6TKOOBQQRSRQICDMWLZ4QL/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BPZ7JV22DSZB5LNUCUEJ2HO3PKM2TVVK/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TRNMYS2LKB6TKOOBQQRSRQICDMWLZ4QL/
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2022/dsa-5234
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fishshell:fish:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:fishshell:fish:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-20001
    reference_type:
    reference_id: CVE-2022-20001
  - url: https://security.gentoo.org/glsa/202309-10
    reference_type:
    reference_id: GLSA-202309-10
  - url: https://usn.ubuntu.com/USN-5367-1/
    reference_type:
    reference_id: USN-USN-5367-1
