vulnerability_id: VCID-8f83-nfsb-aaan
aliases:
  - CVE-2021-20327
  - GHSA-rjmf-p882-645m
summary: |
  Improper Certificate Validation
  A specific version of the Node.js mongodb-client-encryption module does not perform correct validation of the KMS server’s certificate. This vulnerability in combination with a privileged network position active MITM attack could result in interception of traffic between the Node.js driver and the KMS service rendering client-side field level encryption (CSFLE) ineffective. This issue was discovered during internal testing and affects mongodb-client-encryption module, which was available from and deprecated in the NPM Registry on . This vulnerability does not impact driver traffic payloads with CSFLE-supported key services from applications residing inside the AWS, GCP, and Azure nework fabrics due to compensating controls in these environments. This issue does not impact driver workloads that don’t use Field Level Encryption.
severities:
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18635'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19184'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18902'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18900'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18923'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19241'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19138'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.19064'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18754'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18691'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18653'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18120'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18419'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18517'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18552'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18642'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.3315'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28727'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33116'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33179'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.3324'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33284'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33288'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33213'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.3319'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33191'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33189'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33203'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33194'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.33173'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28645'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28611'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28742'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28756'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28755'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28787'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28745'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28711'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28719'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28752'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28782'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.2879'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28759'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00125'
    scoring_system: epss
    scoring_elements: '0.28747'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.27442'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-rjmf-p882-645m
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/mongodb/libmongocrypt
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mongodb/libmongocrypt
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/mongodb/libmongocrypt/commit/76365515ff8754b9f705e56428dd0d7efa7f541b
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mongodb/libmongocrypt/commit/76365515ff8754b9f705e56428dd0d7efa7f541b
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://jira.mongodb.org/browse/NODE-3125
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.mongodb.org/browse/NODE-3125
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:A/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20327
  - score: '6.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20327
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20327
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://www.npmjs.com/advisories/1660
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.npmjs.com/advisories/1660
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-295
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-20327
    reference_type:
    reference_id:
  - url: https://github.com/mongodb/libmongocrypt
    reference_type:
    reference_id:
  - url: https://github.com/mongodb/libmongocrypt/commit/76365515ff8754b9f705e56428dd0d7efa7f541b
    reference_type:
    reference_id:
  - url: https://jira.mongodb.org/browse/NODE-3125
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/1660
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mongodb:libmongocrypt:1.2.0:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:mongodb:libmongocrypt:1.2.0:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-20327
    reference_type:
    reference_id: CVE-2021-20327
  - url: https://github.com/advisories/GHSA-rjmf-p882-645m
    reference_type:
    reference_id: GHSA-rjmf-p882-645m
