vulnerability_id: VCID-z5be-2wp1-ufcx
aliases:
  - CVE-2026-21885
  - GHSA-xwh2-742g-w3wp
summary: "Miniflux Media Proxy SSRF via /proxy endpoint allows access to internal network resources\n\
  ### Summary\nMiniflux's media proxy endpoint (`GET /proxy/{encodedDigest}/{encodedURL}`) can\
  \ be abused to perform Server-Side Request Forgery (SSRF). An authenticated user can cause\
  \ Miniflux to generate a signed proxy URL for attacker-chosen media URLs embedded in feed\
  \ entry content, including internal addresses (e.g., localhost, private RFC1918 ranges, or\
  \ link-local metadata endpoints). Requesting the resulting `/proxy/...` URL makes Miniflux\
  \ fetch and return the internal response.\n\n### Details\n- **Vulnerable route**: `GET /proxy/{encodedDigest}/{encodedURL}`\
  \ (accessible without authentication, but requires a server-generated HMAC-signed URL)\n-\
  \ **Handler**: `internal/ui/proxy.go` (`(*handler).mediaProxy`)\n- **Trigger**: entry content\
  \ is rewritten to proxy media URLs (e.g., `mediaproxy.RewriteDocumentWithAbsoluteProxyURL(...)`),\
  \ producing signed `/proxy/...` URLs.\n- **Root cause**: the proxy validates the URL scheme\
  \ and HMAC signature, but does not restrict target hosts/IPs. As a result, requests to loopback/private/link-local\
  \ addresses are allowed and fetched by the server.\n\n### PoC\n1) Run Miniflux 2.2.15 with\
  \ default configuration (media proxy enabled by default: `MEDIA_PROXY_MODE=http-only`).\n\n\
  2) Log in with any normal user account.\n\n3) Subscribe to a feed you control that contains\
  \ an entry with an image URL pointing to an internal address reachable from the Miniflux server,\
  \ e.g.:\n   - `<img src=\"http://<internal-target>/secret\">`\n   (Note: `<internal-target>`\
  \ must be reachable *from the Miniflux process/network*; in containerized setups, `127.0.0.1`\
  \ may not refer to the host.)\n\n4) Open the entry and locate the rewritten media proxy URL\
  \ (`/proxy/<encodedDigest>/<encodedURL>`) in the rendered HTML/page source.\n\n5) Request\
  \ the `/proxy/...` URL.\nExpected (vulnerable): Miniflux fetches the internal URL and returns\
  \ the internal response (SSRF).\n\n### Impact\n**Type**: SSRF (Server-Side Request Forgery)\
  \ via media proxy  \n**Who is impacted**: Miniflux instances with media proxy enabled (default\
  \ configuration typically enables it for HTTP/mixed content handling).  \n**Impact**: attackers\
  \ with a valid Miniflux account can fetch internal resources reachable from the Miniflux server\
  \ (e.g., localhost services, private network services, and link-local endpoints such as 169.254.169.254),\
  \ potentially exposing sensitive data.\n\n### Suggested CVSS (v3.1)\n`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N`\
  \ (Base 6.5)\n\n\n\n\nIf there any questions or issues reproducing this, please contact: jeongwoolee340@gmail.com"
severities:
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.07523'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2026-21885
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/miniflux/v2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/miniflux/v2
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/miniflux/v2/security/advisories/GHSA-xwh2-742g-w3wp
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/miniflux/v2/security/advisories/GHSA-xwh2-742g-w3wp
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2026-01-08T14:52:34Z/
    published_at: None
    url: https://github.com/miniflux/v2/security/advisories/GHSA-xwh2-742g-w3wp
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21885
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21885
weaknesses:
  - CWE-918
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2026-21885
    reference_type:
    reference_id:
  - url: https://github.com/miniflux/v2
    reference_type:
    reference_id:
  - url: https://github.com/miniflux/v2/security/advisories/GHSA-xwh2-742g-w3wp
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-21885
    reference_type:
    reference_id:
