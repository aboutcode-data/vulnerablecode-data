vulnerability_id: VCID-pdqd-z8jj-aaas
aliases:
  - CVE-2022-23628
  - GHSA-hcw3-j74m-qc58
summary: 'OPA is an open source, general-purpose policy engine. Under certain conditions, pretty-printing
  an abstract syntax tree (AST) that contains synthetic nodes could change the logic of some
  statements by reordering array literals. Example of policies impacted are those that parse
  and compare web paths. **All of these** three conditions have to be met to create an adverse
  effect: 1. An AST of Rego had to be **created programmatically** such that it ends up containing
  terms without a location (such as wildcard variables). 2. The AST had to be **pretty-printed**
  using the `github.com/open-policy-agent/opa/format` package. 3. The result of the pretty-printing
  had to be **parsed and evaluated again** via an OPA instance using the bundles, or the Golang
  packages. If any of these three conditions are not met, you are not affected. Notably, all
  three would be true if using **optimized bundles**, i.e. bundles created with `opa build -O=1`
  or higher. In that case, the optimizer would fulfil condition (1.), the result of that would
  be pretty-printed when writing the bundle to disk, fulfilling (2.). When the bundle was then
  used, we''d satisfy (3.). As a workaround users may disable optimization when creating bundles.'
severities:
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53471'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53894'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53896'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53825'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53807'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53752'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.54163'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.54115'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.54089'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53947'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53920'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53905'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00195'
    scoring_system: epss
    scoring_elements: '0.57431'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00195'
    scoring_system: epss
    scoring_elements: '0.57153'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00195'
    scoring_system: epss
    scoring_elements: '0.57160'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00195'
    scoring_system: epss
    scoring_elements: '0.57134'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00259'
    scoring_system: epss
    scoring_elements: '0.33481'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52264'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.49983'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.50003'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.50022'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.50044'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.50055'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.5005'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.5003'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.50011'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52219'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52321'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52346'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52353'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52271'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52284'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52291'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52299'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52302'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52326'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52312'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52296'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.52273'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.49894'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.49882'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.49994'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.5'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.50024'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.50036'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.50007'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:L
    published_at: None
    url: https://github.com/open-policy-agent/opa
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-policy-agent/opa
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/open-policy-agent/opa/commit/2bd8edab9e10e2dc9cf76ae8335ced0c224f3055
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-policy-agent/opa/commit/2bd8edab9e10e2dc9cf76ae8335ced0c224f3055
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/open-policy-agent/opa/commit/932e4ffc37a590ace79e9b75ca4340288c220239
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-policy-agent/opa/commit/932e4ffc37a590ace79e9b75ca4340288c220239
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:49:41Z/
    published_at: None
    url: https://github.com/open-policy-agent/opa/commit/932e4ffc37a590ace79e9b75ca4340288c220239
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/open-policy-agent/opa/commit/bfd984ddf93ef2c4963a08d4fdadae0bcf1a3717
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-policy-agent/opa/commit/bfd984ddf93ef2c4963a08d4fdadae0bcf1a3717
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:49:41Z/
    published_at: None
    url: https://github.com/open-policy-agent/opa/commit/bfd984ddf93ef2c4963a08d4fdadae0bcf1a3717
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/open-policy-agent/opa/pull/3851
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-policy-agent/opa/pull/3851
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:49:41Z/
    published_at: None
    url: https://github.com/open-policy-agent/opa/pull/3851
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/open-policy-agent/opa/security/advisories/GHSA-hcw3-j74m-qc58
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/open-policy-agent/opa/security/advisories/GHSA-hcw3-j74m-qc58
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:49:41Z/
    published_at: None
    url: https://github.com/open-policy-agent/opa/security/advisories/GHSA-hcw3-j74m-qc58
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-23628
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-23628
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-23628
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2022-0316
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2022-0316
weaknesses:
  - CWE-682
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-23628
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa/commit/2bd8edab9e10e2dc9cf76ae8335ced0c224f3055
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa/commit/932e4ffc37a590ace79e9b75ca4340288c220239
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa/commit/bfd984ddf93ef2c4963a08d4fdadae0bcf1a3717
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa/pull/3851
    reference_type:
    reference_id:
  - url: https://github.com/open-policy-agent/opa/security/advisories/GHSA-hcw3-j74m-qc58
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2022-0316
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:openpolicyagent:open_policy_agent:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:openpolicyagent:open_policy_agent:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-23628
    reference_type:
    reference_id: CVE-2022-23628
