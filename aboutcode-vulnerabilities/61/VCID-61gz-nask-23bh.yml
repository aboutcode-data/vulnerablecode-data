vulnerability_id: VCID-61gz-nask-23bh
aliases:
  - CVE-2024-56515
  - GHSA-rcxc-wjgw-579r
summary: "Matrix Media Repo (MMR) allows untrusted file formats can be thumbnailed, invoking\
  \ potentially further untrusted decoders\n### Impact\n\nIf SVG or JPEGXL thumbnailers are\
  \ enabled (they are disabled by default), a user may upload a file which claims to be either\
  \ of these types and request a thumbnail to invoke a different decoder in ImageMagick. In\
  \ some ImageMagick installations, this includes the capability to run Ghostscript to decode\
  \ the image/file.\n\nIf MP4 thumbnailers are enabled (also disabled by default), the same\
  \ issue as above may occur with the ffmpeg installation instead.\n\nMMR uses a number of other\
  \ decoders for all other file types when preparing thumbnails. Theoretical issues are possible\
  \ with these decoders, however in testing they were not possible to exploit.\n\n### Patches\n\
  \nThis is fixed in [MMR v1.3.8](https://github.com/t2bot/matrix-media-repo/releases/tag/v1.3.8).\
  \ MMR now inspects the mimetype of media prior to thumbnailing, and picks a thumbnailer based\
  \ on those results instead of relying on user-supplied values. This may lead to fewer thumbnails\
  \ when obscure file shapes are used. This also helps narrow scope of theoretical issues with\
  \ all decoders MMR uses for thumbnails.\n\n### Workarounds\n\nDisabling the SVG, JPEGXL, and\
  \ MP4 thumbnail types in the MMR config prevents the decoders from being invoked. Further\
  \ disabling uncommon file types on the server is recommended to limit risk surface. \n\nContainers\
  \ and other similar technologies may also be used to limit the impact of vulnerabilities in\
  \ external decoders, like ImageMagick and ffmpeg. \n\nSome installations of ImageMagick may\
  \ disable \"unsafe\" file types, like PDFs, already. This option can be replicated to other\
  \ environments as needed. ffmpeg may be compiled with limited decoders/codecs. The Docker\
  \ image for MMR disables PDFs and similar formats by default.\n\n### References\n\nA similar\
  \ issue was discovered in Synapse: https://github.com/element-hq/synapse/security/advisories/GHSA-vp6v-whfm-rv3g"
severities:
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17012'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16773'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16847'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16946'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17023'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17025'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17008'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16981'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16973'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16984'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17003'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17024'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.17029'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.1702'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13803'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13757'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13918'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13932'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13967'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.1401'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13988'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13975'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13992'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.14039'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.14044'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.14017'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13996'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13939'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '0.00057'
    scoring_system: epss
    scoring_elements: '0.09718'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/t2bot/matrix-media-repo
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/t2bot/matrix-media-repo
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/t2bot/matrix-media-repo/releases/tag/v1.3.8
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/t2bot/matrix-media-repo/releases/tag/v1.3.8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-16T20:10:20Z/
    published_at: None
    url: https://github.com/t2bot/matrix-media-repo/releases/tag/v1.3.8
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/t2bot/matrix-media-repo/security/advisories/GHSA-rcxc-wjgw-579r
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/t2bot/matrix-media-repo/security/advisories/GHSA-rcxc-wjgw-579r
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-16T20:10:20Z/
    published_at: None
    url: https://github.com/t2bot/matrix-media-repo/security/advisories/GHSA-rcxc-wjgw-579r
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56515
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-56515
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3400
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3400
weaknesses:
  - CWE-502
  - CWE-434
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-56515
    reference_type:
    reference_id:
  - url: https://github.com/t2bot/matrix-media-repo
    reference_type:
    reference_id:
  - url: https://github.com/t2bot/matrix-media-repo/releases/tag/v1.3.8
    reference_type:
    reference_id:
  - url: https://github.com/t2bot/matrix-media-repo/security/advisories/GHSA-rcxc-wjgw-579r
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3400
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-56515
    reference_type:
    reference_id: CVE-2024-56515
