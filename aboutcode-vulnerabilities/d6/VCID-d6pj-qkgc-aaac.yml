vulnerability_id: VCID-d6pj-qkgc-aaac
aliases:
  - CVE-2021-43837
  - GHSA-q34h-97wf-8r8j
  - PYSEC-2021-853
summary: 'vault-cli is a configurable command-line interface tool (and python library) to interact
  with Hashicorp Vault. In versions before 3.0.0 vault-cli features the ability for rendering
  templated values. When a secret starts with the prefix `!template!`, vault-cli interprets
  the rest of the contents of the secret as a Jinja2 template. Jinja2 is a powerful templating
  engine and is not designed to safely render arbitrary templates. An attacker controlling a
  jinja2 template rendered on a machine can trigger arbitrary code, making this a Remote Code
  Execution (RCE) risk. If the content of the vault can be completely trusted, then this is
  not a problem. Otherwise, if your threat model includes cases where an attacker can manipulate
  a secret value read from the vault using vault-cli, then this vulnerability may impact you.
  In 3.0.0, the code related to interpreting vault templated secrets has been removed entirely.
  Users are advised to upgrade as soon as possible. For users unable to upgrade a workaround
  does exist. Using the environment variable `VAULT_CLI_RENDER=false` or the flag `--no-render`
  (placed between `vault-cli` and the subcommand, e.g. `vault-cli --no-render get-all`) or adding
  `render: false` to the vault-cli configuration yaml file disables rendering and removes the
  vulnerability. Using the python library, you can use: `vault_cli.get_client(render=False)`
  when creating your client to get a client that will not render templated secrets and thus
  operates securely.'
severities:
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.76355'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.76335'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.76520'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00508'
    scoring_system: epss
    scoring_elements: '0.76372'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77805'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77798'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77785'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77783'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77742'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77732'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77698'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77567'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77897'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77878'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.00532'
    scoring_system: epss
    scoring_elements: '0.77862'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92381'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92116'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92106'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92134'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.9213'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92137'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92139'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92131'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92126'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92122'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92128'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92132'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92362'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92371'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92382'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92385'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92392'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92387'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92384'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92383'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.09551'
    scoring_system: epss
    scoring_elements: '0.92386'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: '0.12775'
    scoring_system: epss
    scoring_elements: '0.89998'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-q34h-97wf-8r8j
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-q34h-97wf-8r8j
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/peopledoc/vault-cli
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/peopledoc/vault-cli/commit/3ba3955887fd6b7d4d646c8b260f21cebf5db852
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli/commit/3ba3955887fd6b7d4d646c8b260f21cebf5db852
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli/commit/3ba3955887fd6b7d4d646c8b260f21cebf5db852
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/peopledoc/vault-cli/pull/198
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli/pull/198
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli/pull/198
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/peopledoc/vault-cli/releases/tag/3.0.0
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli/releases/tag/3.0.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli/releases/tag/3.0.0
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/peopledoc/vault-cli/security/advisories/GHSA-q34h-97wf-8r8j
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli/security/advisories/GHSA-q34h-97wf-8r8j
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli/security/advisories/GHSA-q34h-97wf-8r8j
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/peopledoc/vault-cli/security/advisories/GHSA-q34h-97wf-8r8j
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/vault-cli/PYSEC-2021-853.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/vault-cli/PYSEC-2021-853.yaml
  - score: '9.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43837
  - score: '9.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43837
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43837
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43837
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-43837
  - score: '8.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2
weaknesses:
  - CWE-94
  - CWE-937
  - CWE-1035
  - CWE-74
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-43837
    reference_type:
    reference_id:
  - url: https://github.com/peopledoc/vault-cli
    reference_type:
    reference_id:
  - url: https://github.com/peopledoc/vault-cli/commit/3ba3955887fd6b7d4d646c8b260f21cebf5db852
    reference_type:
    reference_id:
  - url: https://github.com/peopledoc/vault-cli/pull/198
    reference_type:
    reference_id:
  - url: https://github.com/peopledoc/vault-cli/releases/tag/3.0.0
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vault-cli/PYSEC-2021-853.yaml
    reference_type:
    reference_id:
  - url: https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2
    reference_type:
    reference_id:
  - url: https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vault-cli_project:vault-cli:*:*:*:*:*:python:*:*
    reference_type:
    reference_id: cpe:2.3:a:vault-cli_project:vault-cli:*:*:*:*:*:python:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-43837
    reference_type:
    reference_id: CVE-2021-43837
  - url: https://github.com/advisories/GHSA-q34h-97wf-8r8j
    reference_type:
    reference_id: GHSA-q34h-97wf-8r8j
  - url: https://github.com/peopledoc/vault-cli/security/advisories/GHSA-q34h-97wf-8r8j
    reference_type:
    reference_id: GHSA-q34h-97wf-8r8j
