vulnerability_id: VCID-9gca-nsq9-aaab
aliases:
  - GHSA-77vh-xpmg-72qh
summary: |
  Clarify `mediaType` handling
  ### Impact
  In the OCI Image Specification version 1.0.1 and prior, manifest and index documents are not self-describing and documents with a single digest could be interpreted as either a manifest or an index.

  ### Patches
  The Image Specification will be updated to recommend that both manifest and index documents contain a `mediaType` field to identify the type of document.
  Release [v1.0.2](https://github.com/opencontainers/image-spec/releases/tag/v1.0.2) includes these updates.

  ### Workarounds
  Software attempting to deserialize an ambiguous document may reject the document if it contains both “manifests” and “layers” fields or “manifests” and “config” fields.

  ### References
  https://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m

  ### For more information
  If you have any questions or comments about this advisory:
  * Open an issue in https://github.com/opencontainers/image-spec
  * Email us at [security@opencontainers.org](mailto:security@opencontainers.org)
  * https://github.com/opencontainers/image-spec/commits/v1.0.2
severities:
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/opencontainers/image-spec
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/opencontainers/image-spec
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/opencontainers/image-spec/commit/693428a734f5bab1a84bd2f990d92ef1111cd60c
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/opencontainers/image-spec/commit/693428a734f5bab1a84bd2f990d92ef1111cd60c
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/opencontainers/image-spec/releases/tag/v1.0.2
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/opencontainers/image-spec/releases/tag/v1.0.2
  - score: '3.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N
    published_at: None
    url: https://github.com/opencontainers/image-spec/security/advisories/GHSA-77vh-xpmg-72qh
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/opencontainers/image-spec/security/advisories/GHSA-77vh-xpmg-72qh
weaknesses:
  - CWE-843
references:
  - url: https://github.com/opencontainers/distribution-spec/security/advisories/GHSA-mc8v-mgrf-8f4m
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/image-spec
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/image-spec/commit/693428a734f5bab1a84bd2f990d92ef1111cd60c
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/image-spec/releases/tag/v1.0.2
    reference_type:
    reference_id:
  - url: https://github.com/opencontainers/image-spec/security/advisories/GHSA-77vh-xpmg-72qh
    reference_type:
    reference_id:
