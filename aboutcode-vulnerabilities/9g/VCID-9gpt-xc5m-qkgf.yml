vulnerability_id: VCID-9gpt-xc5m-qkgf
aliases:
  - GHSA-vxg3-w9rv-rhr2
summary: "Contrast leaks workload secrets to logs on INFO level\nThis is the same vulnerability\
  \ as https://github.com/edgelesssys/contrast/security/advisories/GHSA-h5f8-crrq-4pw8. The\
  \ original vulnerability had been fixed for release `v1.8.1`, but the fix was not ported to\
  \ the main branch and thus not present in releases `v1.9.0` ff.\n\nBelow is a brief repetition\
  \ of the relevant sections from the first GHSA, where you can find the full details.\n\n###\
  \ Impact\n\n* [Workload secrets](https://docs.edgeless.systems/contrast/1.11/architecture/secrets#workload-secrets)\
  \ are visible to Kubernetes users with `get` or `list` permission on `pods/logs`, and thus\
  \ need to be considered compromised.\n* Since workload secrets are used for [encrypted storage](https://docs.edgeless.systems/contrast/1.11/howto/encrypted-storage)\
  \ and [Vault integration](https://docs.edgeless.systems/contrast/1.11/howto/vault), those\
  \ need to be considered compromised, too.\n\n### Patches\n\nPatches:\n\n* https://github.com/edgelesssys/contrast/commit/5a5512c4af63c17bb66331e7bd2768a863b2f225\n\
  * https://github.com/edgelesssys/contrast/commit/cf58026b30c43fe7df91eac5322da02e1725d554\n\
  \nThe patches are released with `v1.12.2` and `v1.13.0` (not yet published). Since the secrets\
  \ are compromised, Contrast needs to be initialized from scratch.\n\n### Workarounds\n\nExisting\
  \ workload secrets are compromised. The Contrast cluster needs to be newly initialized, and\
  \ logging needs to be turned off. \n\n### References\n\nFirst occurrence:\n* https://github.com/edgelesssys/contrast/security/advisories/GHSA-h5f8-crrq-4pw8\n\
  \nWe are defining a process for handling GHSAs that should prevent such regressions in the\
  \ future:\n* https://github.com/edgelesssys/contrast/pull/1739"
severities:
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/edgelesssys/contrast
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/edgelesssys/contrast
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/edgelesssys/contrast/commit/5a5512c4af63c17bb66331e7bd2768a863b2f225
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/edgelesssys/contrast/commit/5a5512c4af63c17bb66331e7bd2768a863b2f225
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/edgelesssys/contrast/commit/cf58026b30c43fe7df91eac5322da02e1725d554
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/edgelesssys/contrast/commit/cf58026b30c43fe7df91eac5322da02e1725d554
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/edgelesssys/contrast/pull/1739
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/edgelesssys/contrast/pull/1739
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/edgelesssys/contrast/security/advisories/GHSA-h5f8-crrq-4pw8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/edgelesssys/contrast/security/advisories/GHSA-h5f8-crrq-4pw8
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/edgelesssys/contrast/security/advisories/GHSA-vxg3-w9rv-rhr2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/edgelesssys/contrast/security/advisories/GHSA-vxg3-w9rv-rhr2
weaknesses:
  - CWE-532
references:
  - url: https://github.com/edgelesssys/contrast
    reference_type:
    reference_id:
  - url: https://github.com/edgelesssys/contrast/commit/5a5512c4af63c17bb66331e7bd2768a863b2f225
    reference_type:
    reference_id:
  - url: https://github.com/edgelesssys/contrast/commit/cf58026b30c43fe7df91eac5322da02e1725d554
    reference_type:
    reference_id:
  - url: https://github.com/edgelesssys/contrast/pull/1739
    reference_type:
    reference_id:
  - url: https://github.com/edgelesssys/contrast/security/advisories/GHSA-h5f8-crrq-4pw8
    reference_type:
    reference_id:
  - url: https://github.com/edgelesssys/contrast/security/advisories/GHSA-vxg3-w9rv-rhr2
    reference_type:
    reference_id:
