vulnerability_id: VCID-yf2z-jr9a-myfk
aliases:
  - CVE-2024-51481
summary: Nix is a package manager for Linux and other Unix systems. On macOS, built-in builders
  (such as `builtin:fetchurl`, exposed to users with `import <nix/fetchurl.nix>`) were not executed
  in the macOS sandbox. Thus, these builders (which are running under the `nixbld*` users) had
  read access to world-readable paths and write access to world-writable paths outside of the
  sandbox. This issue is fixed in 2.18.9, 2.19.7, 2.20.9, 2.21.5, 2.22.4, 2.23.4, and 2.24.10.
  Note that sandboxing is not enabled by default on macOS. The Nix sandbox is not primarily
  intended as a security mechanism, but as an aid to improve reproducibility and purity of Nix
  builds. However, sandboxing *can* mitigate the impact of other security issues by limiting
  what parts of the host system a build has access to.
severities:
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04798'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04735'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04774'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04783'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0477'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04768'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0476'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04764'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04797'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04807'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04831'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04834'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04853'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04823'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.07012'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08233'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08271'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08285'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08314'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.08346'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.0586'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.09069'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.08945'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.0908'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.09092'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.091'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.09088'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.09096'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.09107'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.09122'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
  - score: 1
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:H/AT:P/PR:L/UI:P/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/NixOS/nix/commit/597fcc98e18e3178734d06a9e7306250e8cb8d74
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-31T16:51:51Z/
    published_at: None
    url: https://github.com/NixOS/nix/commit/597fcc98e18e3178734d06a9e7306250e8cb8d74
  - score: 1
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:H/AT:P/PR:L/UI:P/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/NixOS/nix/security/advisories/GHSA-wf4c-57rh-9pjg
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-31T16:51:51Z/
    published_at: None
    url: https://github.com/NixOS/nix/security/advisories/GHSA-wf4c-57rh-9pjg
weaknesses:
  - CWE-693
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-51481
    reference_type:
    reference_id:
  - url: https://github.com/NixOS/nix/commit/597fcc98e18e3178734d06a9e7306250e8cb8d74
    reference_type:
    reference_id: 597fcc98e18e3178734d06a9e7306250e8cb8d74
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-51481
    reference_type:
    reference_id: CVE-2024-51481
  - url: https://github.com/NixOS/nix/security/advisories/GHSA-wf4c-57rh-9pjg
    reference_type:
    reference_id: GHSA-wf4c-57rh-9pjg
