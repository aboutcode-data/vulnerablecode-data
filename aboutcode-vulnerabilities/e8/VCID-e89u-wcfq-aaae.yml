vulnerability_id: VCID-e89u-wcfq-aaae
aliases:
  - GHSA-5vgj-ggm4-fg62
summary: |
  pdoc embeds link to malicious CDN if math mode is enabled
  ### Impact

  Documentation generated with `pdoc --math` linked to JavaScript files from polyfill.io.
  The polyfill.io CDN has been sold and now serves malicious code.

  Users who produce documentation with math mode should update immediately. All other users are unaffected.

  ### Patches

  This issue has been fixed in pdoc 14.5.1.

  ### References

  https://github.com/mitmproxy/pdoc/pull/703
  https://sansec.io/research/polyfill-supply-chain-attack

  ### Timeline

  - **[2024-06-25]** https://sansec.io/research/polyfill-supply-chain-attack is published.
  - **[2024-06-25 20:54 UTC]** Issue reported to the pdoc project by @adhintz.
  - **[2024-06-25 21:33 UTC]** Patched version released.
  - **[2024-06-25 21:37 UTC]** Security advisory published.
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5vgj-ggm4-fg62
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mitmproxy/pdoc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mitmproxy/pdoc/commit/726b8f2e365fe8afeb3604a7c73d19b460395d58
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mitmproxy/pdoc/pull/703
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mitmproxy/pdoc/security/advisories/GHSA-5vgj-ggm4-fg62
  - score: '0.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://sansec.io/research/polyfill-supply-chain-attack
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://sansec.io/research/polyfill-supply-chain-attack
weaknesses: []
references:
  - url: https://github.com/mitmproxy/pdoc
    reference_type:
    reference_id:
  - url: https://github.com/mitmproxy/pdoc/commit/726b8f2e365fe8afeb3604a7c73d19b460395d58
    reference_type:
    reference_id:
  - url: https://github.com/mitmproxy/pdoc/pull/703
    reference_type:
    reference_id:
  - url: https://github.com/mitmproxy/pdoc/security/advisories/GHSA-5vgj-ggm4-fg62
    reference_type:
    reference_id:
  - url: https://sansec.io/research/polyfill-supply-chain-attack
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5vgj-ggm4-fg62
    reference_type:
    reference_id: GHSA-5vgj-ggm4-fg62
