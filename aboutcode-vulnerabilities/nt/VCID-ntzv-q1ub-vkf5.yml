vulnerability_id: VCID-ntzv-q1ub-vkf5
aliases:
  - CVE-2025-38174
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  thunderbolt: Do not double dequeue a configuration request

  Some of our devices crash in tb_cfg_request_dequeue():

   general protection fault, probably for non-canonical address 0xdead000000000122

   CPU: 6 PID: 91007 Comm: kworker/6:2 Tainted: G U W 6.6.65
   RIP: 0010:tb_cfg_request_dequeue+0x2d/0xa0
   Call Trace:
   <TASK>
   ? tb_cfg_request_dequeue+0x2d/0xa0
   tb_cfg_request_work+0x33/0x80
   worker_thread+0x386/0x8f0
   kthread+0xed/0x110
   ret_from_fork+0x38/0x50
   ret_from_fork_asm+0x1b/0x30

  The circumstances are unclear, however, the theory is that
  tb_cfg_request_work() can be scheduled twice for a request:
  first time via frame.callback from ring_work() and second
  time from tb_cfg_request().  Both times kworkers will execute
  tb_cfg_request_dequeue(), which results in double list_del()
  from the ctl->request_queue (the list poison deference hints
  at it: 0xdead000000000122).

  Do not dequeue requests that don't have TB_CFG_REQUEST_ACTIVE
  bit set.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38174.json
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08981'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08952'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07761'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1259'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12548'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12557'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12481'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12465'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12622'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12657'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12552'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.13906'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.13948'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.13799'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.13845'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.13848'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14016'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1393'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.13958'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15129'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14861'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14932'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14869'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14952'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14973'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15011'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14908'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15002'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.14994'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15119'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15101'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15081'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.1515'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15166'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15063'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15001'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15048'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15018'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15047'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15082'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22294'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22244'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22199'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22288'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22275'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22278'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22264'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22259'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22253'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22321'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.26872'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38174.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38174
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38174
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0771bcbe2f6e5d5f263cf466efe571d2754a46da
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0a3011d47dbc92a33621861c423cb64833d7fe57
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0f73628e9da1ee39daf5f188190cdbaee5e0c98c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2f62eda4d974c26bc595425eafd429067541f2c9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5a057f261539720165d03d85024da2b52e67f63d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/85286e634ebbaf9c0fb1cdf580add2f33fc7628c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cdb4feab2f39e75a66239e3a112beced279612a8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e49e994cd83705f7ca30eda1e304abddfd96a37a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/eb2d5e794fb966b3ef8bde99eb8561446a53509f
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2376305
    reference_type:
    reference_id: 2376305
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38174
    reference_type:
    reference_id: CVE-2025-38174
  - url: https://usn.ubuntu.com/7724-1/
    reference_type:
    reference_id: USN-7724-1
  - url: https://usn.ubuntu.com/7769-1/
    reference_type:
    reference_id: USN-7769-1
  - url: https://usn.ubuntu.com/7769-2/
    reference_type:
    reference_id: USN-7769-2
  - url: https://usn.ubuntu.com/7769-3/
    reference_type:
    reference_id: USN-7769-3
  - url: https://usn.ubuntu.com/7770-1/
    reference_type:
    reference_id: USN-7770-1
  - url: https://usn.ubuntu.com/7774-1/
    reference_type:
    reference_id: USN-7774-1
  - url: https://usn.ubuntu.com/7774-2/
    reference_type:
    reference_id: USN-7774-2
  - url: https://usn.ubuntu.com/7774-3/
    reference_type:
    reference_id: USN-7774-3
  - url: https://usn.ubuntu.com/7774-4/
    reference_type:
    reference_id: USN-7774-4
  - url: https://usn.ubuntu.com/7774-5/
    reference_type:
    reference_id: USN-7774-5
  - url: https://usn.ubuntu.com/7775-1/
    reference_type:
    reference_id: USN-7775-1
  - url: https://usn.ubuntu.com/7775-2/
    reference_type:
    reference_id: USN-7775-2
  - url: https://usn.ubuntu.com/7775-3/
    reference_type:
    reference_id: USN-7775-3
  - url: https://usn.ubuntu.com/7776-1/
    reference_type:
    reference_id: USN-7776-1
  - url: https://usn.ubuntu.com/7789-1/
    reference_type:
    reference_id: USN-7789-1
  - url: https://usn.ubuntu.com/7789-2/
    reference_type:
    reference_id: USN-7789-2
