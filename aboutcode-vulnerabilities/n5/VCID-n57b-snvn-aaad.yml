vulnerability_id: VCID-n57b-snvn-aaad
aliases:
  - CVE-2024-30471
  - GHSA-2qph-v9p2-q2gv
  - PYSEC-2024-172
summary: |
  Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in Apache StreamPipes in user self-registration.
  This allows an attacker to potentially request the creation of multiple accounts with the same email address until the email address is registered, creating many identical users and corrupting StreamPipe's user management.
  This issue affects Apache StreamPipes: through 0.93.0.

  Users are recommended to upgrade to version 0.95.0, which fixes the issue.
severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11820'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12120'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12178'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12272'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11700'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11697'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11709'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11765'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11214'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11519'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11610'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11633'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.39659'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.39677'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.39660'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.39998'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71031'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71006'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71082'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71084'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71076'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71071'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71057'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71061'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71083'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.7106'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71064'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.00714'
    scoring_system: epss
    scoring_elements: '0.71079'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01004'
    scoring_system: epss
    scoring_elements: '0.75012'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01004'
    scoring_system: epss
    scoring_elements: '0.7501'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01115'
    scoring_system: epss
    scoring_elements: '0.76288'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01115'
    scoring_system: epss
    scoring_elements: '0.76295'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01115'
    scoring_system: epss
    scoring_elements: '0.76315'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01115'
    scoring_system: epss
    scoring_elements: '0.76327'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01115'
    scoring_system: epss
    scoring_elements: '0.76319'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01115'
    scoring_system: epss
    scoring_elements: '0.76323'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01115'
    scoring_system: epss
    scoring_elements: '0.76336'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01115'
    scoring_system: epss
    scoring_elements: '0.76344'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01115'
    scoring_system: epss
    scoring_elements: '0.76346'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01239'
    scoring_system: epss
    scoring_elements: '0.77522'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01239'
    scoring_system: epss
    scoring_elements: '0.77518'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.01239'
    scoring_system: epss
    scoring_elements: '0.77523'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: '0.02737'
    scoring_system: epss
    scoring_elements: '0.76583'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-2qph-v9p2-q2gv
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/apache/streampipes
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/apache/streampipes
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/streampipes
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/apache/streampipes/releases/tag/release%2F0.95.0
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/apache/streampipes/releases/tag/release%2F0.95.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/streampipes/releases/tag/release%2F0.95.0
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/streampipes/PYSEC-2024-172.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/streampipes/PYSEC-2024-172.yaml
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://lists.apache.org/thread/8yodrmohgcybq900or3d4hc1msl230fr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/8yodrmohgcybq900or3d4hc1msl230fr
  - score: '3.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-30471
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-30471
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-30471
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/07/16/9
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/07/16/9
weaknesses:
  - CWE-367
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-30471
    reference_type:
    reference_id:
  - url: https://github.com/apache/streampipes
    reference_type:
    reference_id:
  - url: https://github.com/apache/streampipes/releases/tag/release%2F0.95.0
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/streampipes/PYSEC-2024-172.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/8yodrmohgcybq900or3d4hc1msl230fr
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/07/16/9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:streampipes:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:streampipes:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-30471
    reference_type:
    reference_id: CVE-2024-30471
  - url: https://github.com/advisories/GHSA-2qph-v9p2-q2gv
    reference_type:
    reference_id: GHSA-2qph-v9p2-q2gv
