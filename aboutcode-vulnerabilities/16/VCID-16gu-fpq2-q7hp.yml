vulnerability_id: VCID-16gu-fpq2-q7hp
aliases:
  - CVE-2024-46680
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  Bluetooth: btnxpuart: Fix random crash seen while removing driver

  This fixes the random kernel crash seen while removing the driver, when
  running the load/unload test over multiple iterations.

  1) modprobe btnxpuart
  2) hciconfig hci0 reset
  3) hciconfig (check hci0 interface up with valid BD address)
  4) modprobe -r btnxpuart
  Repeat steps 1 to 4

  The ps_wakeup() call in btnxpuart_close() schedules the psdata->work(),
  which gets scheduled after module is removed, causing a kernel crash.

  This hidden issue got highlighted after enabling Power Save by default
  in 4183a7be7700 (Bluetooth: btnxpuart: Enable Power Save feature on
  startup)

  The new ps_cleanup() deasserts UART break immediately while closing
  serdev device, cancels any scheduled ps_work and destroys the ps_lock
  mutex.

  [   85.884604] Unable to handle kernel paging request at virtual address ffffd4a61638f258
  [   85.884624] Mem abort info:
  [   85.884625]   ESR = 0x0000000086000007
  [   85.884628]   EC = 0x21: IABT (current EL), IL = 32 bits
  [   85.884633]   SET = 0, FnV = 0
  [   85.884636]   EA = 0, S1PTW = 0
  [   85.884638]   FSC = 0x07: level 3 translation fault
  [   85.884642] swapper pgtable: 4k pages, 48-bit VAs, pgdp=0000000041dd0000
  [   85.884646] [ffffd4a61638f258] pgd=1000000095fff003, p4d=1000000095fff003, pud=100000004823d003, pmd=100000004823e003, pte=0000000000000000
  [   85.884662] Internal error: Oops: 0000000086000007 [#1] PREEMPT SMP
  [   85.890932] Modules linked in: algif_hash algif_skcipher af_alg overlay fsl_jr_uio caam_jr caamkeyblob_desc caamhash_desc caamalg_desc crypto_engine authenc libdes crct10dif_ce polyval_ce polyval_generic snd_soc_imx_spdif snd_soc_imx_card snd_soc_ak5558 snd_soc_ak4458 caam secvio error snd_soc_fsl_spdif snd_soc_fsl_micfil snd_soc_fsl_sai snd_soc_fsl_utils gpio_ir_recv rc_core fuse [last unloaded: btnxpuart(O)]
  [   85.927297] CPU: 1 PID: 67 Comm: kworker/1:3 Tainted: G           O       6.1.36+g937b1be4345a #1
  [   85.936176] Hardware name: FSL i.MX8MM EVK board (DT)
  [   85.936182] Workqueue: events 0xffffd4a61638f380
  [   85.936198] pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
  [   85.952817] pc : 0xffffd4a61638f258
  [   85.952823] lr : 0xffffd4a61638f258
  [   85.952827] sp : ffff8000084fbd70
  [   85.952829] x29: ffff8000084fbd70 x28: 0000000000000000 x27: 0000000000000000
  [   85.963112] x26: ffffd4a69133f000 x25: ffff4bf1c8540990 x24: ffff4bf215b87305
  [   85.963119] x23: ffff4bf215b87300 x22: ffff4bf1c85409d0 x21: ffff4bf1c8540970
  [   85.977382] x20: 0000000000000000 x19: ffff4bf1c8540880 x18: 0000000000000000
  [   85.977391] x17: 0000000000000000 x16: 0000000000000133 x15: 0000ffffe2217090
  [   85.977399] x14: 0000000000000001 x13: 0000000000000133 x12: 0000000000000139
  [   85.977407] x11: 0000000000000001 x10: 0000000000000a60 x9 : ffff8000084fbc50
  [   85.977417] x8 : ffff4bf215b7d000 x7 : ffff4bf215b83b40 x6 : 00000000000003e8
  [   85.977424] x5 : 00000000410fd030 x4 : 0000000000000000 x3 : 0000000000000000
  [   85.977432] x2 : 0000000000000000 x1 : ffff4bf1c4265880 x0 : 0000000000000000
  [   85.977443] Call trace:
  [   85.977446]  0xffffd4a61638f258
  [   85.977451]  0xffffd4a61638f3e8
  [   85.977455]  process_one_work+0x1d4/0x330
  [   85.977464]  worker_thread+0x6c/0x430
  [   85.977471]  kthread+0x108/0x10c
  [   85.977476]  ret_from_fork+0x10/0x20
  [   85.977488] Code: bad PC value
  [   85.977491] ---[ end trace 0000000000000000 ]---

  Preset since v6.9.11
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-46680.json
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07256'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07183'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07242'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07249'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07246'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07264'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07287'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07315'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07333'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07347'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.0734'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07243'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07217'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07248'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13852'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13818'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13804'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13644'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.09118'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13688'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13872'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13856'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13871'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.13892'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15111'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15116'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15085'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1506'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1501'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15071'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
  - score: '4.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-46680
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-46680
weaknesses:
  - CWE-362
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-46680.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-46680
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/29a1d9971e38f92c84b363ff50379dd434ddfe1c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/35237475384ab3622f63c3c09bdf6af6dacfe9c3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/662a55986b88807da4d112d838c8aaa05810e938
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2312068
    reference_type:
    reference_id: 2312068
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-46680
    reference_type:
    reference_id: CVE-2024-46680
  - url: https://usn.ubuntu.com/7154-1/
    reference_type:
    reference_id: USN-7154-1
  - url: https://usn.ubuntu.com/7154-2/
    reference_type:
    reference_id: USN-7154-2
  - url: https://usn.ubuntu.com/7155-1/
    reference_type:
    reference_id: USN-7155-1
  - url: https://usn.ubuntu.com/7156-1/
    reference_type:
    reference_id: USN-7156-1
  - url: https://usn.ubuntu.com/7196-1/
    reference_type:
    reference_id: USN-7196-1
