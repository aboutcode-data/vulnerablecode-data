vulnerability_id: VCID-16gv-85bq-4ygq
aliases:
  - CVE-2025-55214
  - GHSA-p7q8-grrj-3m8w
summary: |
  Copier's safe template has filesystem write access outside destination path
  ### Impact

  Copier suggests that it's safe to generate a project from a safe template, i.e. one that doesn't use [unsafe](https://copier.readthedocs.io/en/stable/configuring/#unsafe) features like custom Jinja extensions which would require passing the `--UNSAFE,--trust` flag. As it turns out, a safe template can currently write files outside the destination path where a project shall be generated or updated. This is possible when rendering a [generated directory structure](https://copier.readthedocs.io/en/stable/configuring/#generating-a-directory-structure) whose rendered path is either a relative parent path or an absolute path. Constructing such paths is possible using Copier's builtin `pathjoin` Jinja filter and its builtin `_copier_conf.sep` variable, which is the platform-native path separator. This way, a malicious template author can create a template that overwrites arbitrary files (according to the user's write permissions), e.g., to cause havoc.

  #### Write access via generated relative path

  Reproducible example:

  ```shell
  echo "foo" > forbidden.txt
  mkdir src/
  echo "bar" > "src/{{ pathjoin('..', 'forbidden.txt') }}"
  uvx copier copy src/ dst/
  cat forbidden.txt
  ```

  #### Write access via generated absolute path

  Reproducible example:

  - POSIX:

      ```shell
      # Assumption: The current working directory is `/tmp/test-copier-vulnerability/`
      echo "foo" > forbidden.txt
      mkdir src/
      echo "bar" > "src/{{ pathjoin(_copier_conf.sep, 'tmp', 'test-copier-vulnerability', 'forbidden.txt') }}"
      uvx --from copier python -O -m copier copy --overwrite src/ dst/
      cat forbidden.txt
      ```

  - Windows (PowerShell):

      ```powershell
      # Assumption: The current working directory is `C:\Users\<user>\Temp\test-copier-vulnerability`
      echo "foo" > forbidden.txt
      mkdir src
      Set-Content -Path src\copier.yml @'
      drive:
        type: str
        default: "C:"
        when: false
      '@
      echo "bar" > "src\{{ pathjoin(drive, 'Users', '<user>', 'Temp', 'test-copier-vulnerability', 'forbidden.txt') }}"
      uvx --from copier python -O -m copier copy --overwrite src dst
      cat forbidden.txt
      ```

  This scenario is slightly less severe, as Copier has a few [assertions of the destination path being relative](https://github.com/copier-org/copier/blob/d106ea543fd26e1ac1b9a3dcef3e99cc70fdf57c/copier/_main.py#L747) which would typically be raised. But `python -O` (or `PYTHONOPTIMIZE=x`) removes asserts, so these guards may be ineffective. In addition, this scenario will prompt for overwrite confirmation or require the `--overwrite` flag for non-interactive mode; yet malicious file writes might go unnoticed.
severities:
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.0343'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.0002'
    scoring_system: epss
    scoring_elements: '0.03475'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05549'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05559'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05592'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05463'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05665'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05683'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05571'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05607'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06583'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06479'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06515'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.0648'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06596'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06588'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06592'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06714'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06692'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06725'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06698'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06727'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06683'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06778'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06795'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06764'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06775'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06802'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06871'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06873'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06862'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06819'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.07353'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.07393'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.07344'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.0736'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.0744'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.07403'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09868'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09882'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p7q8-grrj-3m8w
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/copier-org/copier
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:P/VC:N/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/copier-org/copier/commit/fdbc0167cc22780b497e4db176feaf6f024757d6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/copier-org/copier/commit/fdbc0167cc22780b497e4db176feaf6f024757d6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-08-18T19:46:44Z/
    published_at: None
    url: https://github.com/copier-org/copier/commit/fdbc0167cc22780b497e4db176feaf6f024757d6
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/copier-org/copier/security/advisories/GHSA-p7q8-grrj-3m8w
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:P/VC:N/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/copier-org/copier/security/advisories/GHSA-p7q8-grrj-3m8w
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/copier-org/copier/security/advisories/GHSA-p7q8-grrj-3m8w
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-08-18T19:46:44Z/
    published_at: None
    url: https://github.com/copier-org/copier/security/advisories/GHSA-p7q8-grrj-3m8w
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-55214
weaknesses:
  - CWE-22
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-55214
    reference_type:
    reference_id:
  - url: https://github.com/copier-org/copier
    reference_type:
    reference_id:
  - url: https://github.com/copier-org/copier/commit/fdbc0167cc22780b497e4db176feaf6f024757d6
    reference_type:
    reference_id:
  - url: https://github.com/copier-org/copier/security/advisories/GHSA-p7q8-grrj-3m8w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55214
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-p7q8-grrj-3m8w
    reference_type:
    reference_id: GHSA-p7q8-grrj-3m8w
