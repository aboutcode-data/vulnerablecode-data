vulnerability_id: VCID-emwt-ezmx-aaap
aliases:
  - BIT-2021-28677
  - BIT-pillow-2021-28677
  - CVE-2021-28677
  - GHSA-q5hq-fp76-qmrc
  - PYSEC-2021-93
summary: An issue was discovered in Pillow before 8.2.0. For EPS data, the readline implementation
  used in EPSImageFile has to deal with any combination of \r and \n as line endings. It used
  an accidentally quadratic method of accumulating lines while looking for a line ending. A
  malicious EPS file could use this to perform a DoS of Pillow in the open phase, before an
  image was accepted for opening.
severities:
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2021/CVE-2021-28677.html
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:4149
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-28677.json
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53182'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53336'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53258'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53240'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.52910'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53611'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53561'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53526'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53385'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53359'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53344'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.53333'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00216'
    scoring_system: epss
    scoring_elements: '0.59222'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00216'
    scoring_system: epss
    scoring_elements: '0.59221'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00216'
    scoring_system: epss
    scoring_elements: '0.59196'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00216'
    scoring_system: epss
    scoring_elements: '0.59473'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62138'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60505'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60456'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60549'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60557'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60588'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60609'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60586'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60573'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60582'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60602'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.6062'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60638'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.60634'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62058'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62095'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62142'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62166'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62174'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62136'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62137'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.6214'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62146'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00444'
    scoring_system: epss
    scoring_elements: '0.62161'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: '0.00706'
    scoring_system: epss
    scoring_elements: '0.56508'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1958257
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28677
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-q5hq-fp76-qmrc
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/pillow/PYSEC-2021-93.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/pillow/PYSEC-2021-93.yaml
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/python-pillow/Pillow
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/python-pillow/Pillow
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/python-pillow/Pillow/commit/5a5e6db0abf4e7a638fb1b3408c4e495a096cb92
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/python-pillow/Pillow/commit/5a5e6db0abf4e7a638fb1b3408c4e495a096cb92
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/python-pillow/Pillow/pull/5377
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/python-pillow/Pillow/pull/5377
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2021/07/msg00018.html
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2021/07/msg00018.html
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MQHA5HAIBOYI3R6HDWCLAGFTIQP767FL
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MQHA5HAIBOYI3R6HDWCLAGFTIQP767FL
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28677
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28677
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28677
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://pillow.readthedocs.io/en/stable/releasenotes/8.2.0.html#cve-2021-28677-fix-eps-dos-on-open
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pillow.readthedocs.io/en/stable/releasenotes/8.2.0.html#cve-2021-28677-fix-eps-dos-on-open
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://security.gentoo.org/glsa/202107-33
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.gentoo.org/glsa/202107-33
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-4963-1
weaknesses:
  - CWE-20
  - CWE-400
  - CWE-937
  - CWE-1035
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2021/CVE-2021-28677.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-28677.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-28677
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28677
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pillow/PYSEC-2021-93.yaml
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow/commit/5a5e6db0abf4e7a638fb1b3408c4e495a096cb92
    reference_type:
    reference_id:
  - url: https://github.com/python-pillow/Pillow/pull/5377
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2021/07/msg00018.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MQHA5HAIBOYI3R6HDWCLAGFTIQP767FL/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MQHA5HAIBOYI3R6HDWCLAGFTIQP767FL
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MQHA5HAIBOYI3R6HDWCLAGFTIQP767FL/
    reference_type:
    reference_id:
  - url: https://pillow.readthedocs.io/en/stable/releasenotes/8.2.0.html#cve-2021-28677-fix-eps-dos-on-open
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202107-33
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-4963-1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1958257
    reference_type:
    reference_id: '1958257'
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=989062
    reference_type:
    reference_id: 989062
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:python:pillow:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:python:pillow:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28677
    reference_type:
    reference_id: CVE-2021-28677
  - url: https://github.com/advisories/GHSA-q5hq-fp76-qmrc
    reference_type:
    reference_id: GHSA-q5hq-fp76-qmrc
  - url: https://access.redhat.com/errata/RHSA-2021:4149
    reference_type:
    reference_id: RHSA-2021:4149
  - url: https://usn.ubuntu.com/4963-1/
    reference_type:
    reference_id: USN-4963-1
