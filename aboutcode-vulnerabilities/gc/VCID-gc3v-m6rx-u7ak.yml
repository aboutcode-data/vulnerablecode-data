vulnerability_id: VCID-gc3v-m6rx-u7ak
aliases:
  - CVE-2025-38244
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  smb: client: fix potential deadlock when reconnecting channels

  Fix cifs_signal_cifsd_for_reconnect() to take the correct lock order
  and prevent the following deadlock from happening

  ======================================================
  WARNING: possible circular locking dependency detected
  6.16.0-rc3-build2+ #1301 Tainted: G S      W
  ------------------------------------------------------
  cifsd/6055 is trying to acquire lock:
  ffff88810ad56038 (&tcp_ses->srv_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0x134/0x200

  but task is already holding lock:
  ffff888119c64330 (&ret_buf->chan_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0xcf/0x200

  which lock already depends on the new lock.

  the existing dependency chain (in reverse order) is:

  -> #2 (&ret_buf->chan_lock){+.+.}-{3:3}:
         validate_chain+0x1cf/0x270
         __lock_acquire+0x60e/0x780
         lock_acquire.part.0+0xb4/0x1f0
         _raw_spin_lock+0x2f/0x40
         cifs_setup_session+0x81/0x4b0
         cifs_get_smb_ses+0x771/0x900
         cifs_mount_get_session+0x7e/0x170
         cifs_mount+0x92/0x2d0
         cifs_smb3_do_mount+0x161/0x460
         smb3_get_tree+0x55/0x90
         vfs_get_tree+0x46/0x180
         do_new_mount+0x1b0/0x2e0
         path_mount+0x6ee/0x740
         do_mount+0x98/0xe0
         __do_sys_mount+0x148/0x180
         do_syscall_64+0xa4/0x260
         entry_SYSCALL_64_after_hwframe+0x76/0x7e

  -> #1 (&ret_buf->ses_lock){+.+.}-{3:3}:
         validate_chain+0x1cf/0x270
         __lock_acquire+0x60e/0x780
         lock_acquire.part.0+0xb4/0x1f0
         _raw_spin_lock+0x2f/0x40
         cifs_match_super+0x101/0x320
         sget+0xab/0x270
         cifs_smb3_do_mount+0x1e0/0x460
         smb3_get_tree+0x55/0x90
         vfs_get_tree+0x46/0x180
         do_new_mount+0x1b0/0x2e0
         path_mount+0x6ee/0x740
         do_mount+0x98/0xe0
         __do_sys_mount+0x148/0x180
         do_syscall_64+0xa4/0x260
         entry_SYSCALL_64_after_hwframe+0x76/0x7e

  -> #0 (&tcp_ses->srv_lock){+.+.}-{3:3}:
         check_noncircular+0x95/0xc0
         check_prev_add+0x115/0x2f0
         validate_chain+0x1cf/0x270
         __lock_acquire+0x60e/0x780
         lock_acquire.part.0+0xb4/0x1f0
         _raw_spin_lock+0x2f/0x40
         cifs_signal_cifsd_for_reconnect+0x134/0x200
         __cifs_reconnect+0x8f/0x500
         cifs_handle_standard+0x112/0x280
         cifs_demultiplex_thread+0x64d/0xbc0
         kthread+0x2f7/0x310
         ret_from_fork+0x2a/0x230
         ret_from_fork_asm+0x1a/0x30

  other info that might help us debug this:

  Chain exists of:
    &tcp_ses->srv_lock --> &ret_buf->ses_lock --> &ret_buf->chan_lock

   Possible unsafe locking scenario:

         CPU0                    CPU1
         ----                    ----
    lock(&ret_buf->chan_lock);
                                 lock(&ret_buf->ses_lock);
                                 lock(&ret_buf->chan_lock);
    lock(&tcp_ses->srv_lock);

   *** DEADLOCK ***

  3 locks held by cifsd/6055:
   #0: ffffffff857de398 (&cifs_tcp_ses_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0x7b/0x200
   #1: ffff888119c64060 (&ret_buf->ses_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0x9c/0x200
   #2: ffff888119c64330 (&ret_buf->chan_lock){+.+.}-{3:3}, at: cifs_signal_cifsd_for_reconnect+0xcf/0x200
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38244.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38244.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0126'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0124'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02775'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02753'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02788'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02773'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.0449'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04424'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04406'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04495'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04502'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0534'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05353'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05406'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05231'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05188'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05149'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05174'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05166'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05168'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0513'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05351'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05361'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05975'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05962'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05981'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06087'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06061'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0596'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05796'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05819'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05858'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05744'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05746'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05713'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05815'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0581'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05812'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05968'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05955'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05993'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05947'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05927'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05961'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06028'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06049'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06065'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06056'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06016'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05996'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05985'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05995'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05979'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-833
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38244.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38244
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/711741f94ac3cf9f4e3aa73aa171e76d188c0819
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7f3ead8ebc0ef65b6c89a13912b4e80218425629
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c82c7041258d96e3286f6790ab700e4edd3cc9e3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fe035dc78aa6ca8f862857d45beaf7a0e03206ca
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2378998
    reference_type:
    reference_id: 2378998
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38244
    reference_type:
    reference_id: CVE-2025-38244
  - url: https://usn.ubuntu.com/7798-1/
    reference_type:
    reference_id: USN-7798-1
  - url: https://usn.ubuntu.com/7808-1/
    reference_type:
    reference_id: USN-7808-1
  - url: https://usn.ubuntu.com/7808-2/
    reference_type:
    reference_id: USN-7808-2
  - url: https://usn.ubuntu.com/7809-1/
    reference_type:
    reference_id: USN-7809-1
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
