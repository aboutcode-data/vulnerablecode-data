vulnerability_id: VCID-59zy-1kdh-guha
aliases:
  - CVE-2025-55191
  - GHSA-g88p-r42r-ppp9
summary: |
  Repository Credentials Race Condition Crashes Argo CD Server
  ### Summary

  A race condition in the repository credentials handler can cause the Argo CD server to panic and crash when concurrent operations are performed on the same repository URL.

  ### Details
  The vulnerability is located in numerous repository related handlers in the `util/db/repository_secrets.go` file. For example, in the `secretToRepoCred` function. The issue manifests as a concurrent map access panic:

  ```
  concurrent map read and map write
  ...
  goroutine 1104 [running]:
  github.com/argoproj/argo-cd/v2/util/db.(*secretsRepositoryBackend).secretToRepoCred(0xc000e50ea8?, 0xc000c65540)
          /go/src/github.com/argoproj/argo-cd/util/db/repository_secrets.go:404 +0x31e
  ```

  The race condition occurs due to:
  1. Concurrent repository credential operations (create/update/delete) accessing the same map
  2. Kubernetes informer re-syncs happening simultaneously
  3. Background watchers updating the same secret data
  4. No mutex protection for map access

  A valid API token with `repositories` resource permissions (`create`, `update`, or `delete` actions) is required to trigger the race condition.

  ### Impact

  This vulnerability causes the entire Argo CD server to crash and become unavailable. Attackers can repeatedly and continuously trigger the race condition to maintain a denial-of-service state, disrupting all GitOps operations. Default ArgoCD configuration is vulnerable.

  The affected code was originally introduced in [PR #6103](https://github.com/argoproj/argo-cd/pull/6103) and released in [v2.1.0](https://github.com/argoproj/argo-cd/releases/tag/v2.1.0).

  This data race was addressed by deep-copying the `Secret` objects before reading/writing.

  ### Credits

  This vulnerability was found, reported and fixed by:

  @thevilledev

  The Argo team would like to thank him for his responsible disclosure and constructive communications during the resolve of this issue.
severities:
  - score: '4.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-55191.json
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06451'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06435'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.06415'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07753'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00031'
    scoring_system: epss
    scoring_elements: '0.07734'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09208'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09091'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09115'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09121'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09204'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09212'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09199'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09151'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09168'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.092'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09177'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09161'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09154'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09145'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11873'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11862'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11672'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11711'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/argoproj/argo-cd
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/argoproj/argo-cd
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/argoproj/argo-cd/commit/701bc50d01c752cad96185f848088d287a97c7b7
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/argoproj/argo-cd/commit/701bc50d01c752cad96185f848088d287a97c7b7
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-06T18:32:25Z/
    published_at: None
    url: https://github.com/argoproj/argo-cd/commit/701bc50d01c752cad96185f848088d287a97c7b7
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/argoproj/argo-cd/pull/6103
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/argoproj/argo-cd/pull/6103
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-06T18:32:25Z/
    published_at: None
    url: https://github.com/argoproj/argo-cd/pull/6103
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/argoproj/argo-cd/security/advisories/GHSA-g88p-r42r-ppp9
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/argoproj/argo-cd/security/advisories/GHSA-g88p-r42r-ppp9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-06T18:32:25Z/
    published_at: None
    url: https://github.com/argoproj/argo-cd/security/advisories/GHSA-g88p-r42r-ppp9
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-55191
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-55191
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3994
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3994
weaknesses:
  - CWE-362
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-55191.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-55191
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-cd
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-cd/commit/701bc50d01c752cad96185f848088d287a97c7b7
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-cd/pull/6103
    reference_type:
    reference_id:
  - url: https://github.com/argoproj/argo-cd/security/advisories/GHSA-g88p-r42r-ppp9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55191
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3994
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2400562
    reference_type:
    reference_id: 2400562
  - url: https://access.redhat.com/errata/RHSA-2025:17730
    reference_type:
    reference_id: RHSA-2025:17730
  - url: https://access.redhat.com/errata/RHSA-2025:17731
    reference_type:
    reference_id: RHSA-2025:17731
  - url: https://access.redhat.com/errata/RHSA-2025:18093
    reference_type:
    reference_id: RHSA-2025:18093
