vulnerability_id: VCID-p3wu-24xn-ekcn
aliases:
  - CVE-2025-38211
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  RDMA/iwcm: Fix use-after-free of work objects after cm_id destruction

  The commit 59c68ac31e15 ("iw_cm: free cm_id resources on the last
  deref") simplified cm_id resource management by freeing cm_id once all
  references to the cm_id were removed. The references are removed either
  upon completion of iw_cm event handlers or when the application destroys
  the cm_id. This commit introduced the use-after-free condition where
  cm_id_private object could still be in use by event handler works during
  the destruction of cm_id. The commit aee2424246f9 ("RDMA/iwcm: Fix a
  use-after-free related to destroying CM IDs") addressed this use-after-
  free by flushing all pending works at the cm_id destruction.

  However, still another use-after-free possibility remained. It happens
  with the work objects allocated for each cm_id_priv within
  alloc_work_entries() during cm_id creation, and subsequently freed in
  dealloc_work_entries() once all references to the cm_id are removed.
  If the cm_id's last reference is decremented in the event handler work,
  the work object for the work itself gets removed, and causes the use-
  after-free BUG below:

    BUG: KASAN: slab-use-after-free in __pwq_activate_work+0x1ff/0x250
    Read of size 8 at addr ffff88811f9cf800 by task kworker/u16:1/147091

    CPU: 2 UID: 0 PID: 147091 Comm: kworker/u16:1 Not tainted 6.15.0-rc2+ #27 PREEMPT(voluntary)
    Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-3.fc41 04/01/2014
    Workqueue:  0x0 (iw_cm_wq)
    Call Trace:
     <TASK>
     dump_stack_lvl+0x6a/0x90
     print_report+0x174/0x554
     ? __virt_addr_valid+0x208/0x430
     ? __pwq_activate_work+0x1ff/0x250
     kasan_report+0xae/0x170
     ? __pwq_activate_work+0x1ff/0x250
     __pwq_activate_work+0x1ff/0x250
     pwq_dec_nr_in_flight+0x8c5/0xfb0
     process_one_work+0xc11/0x1460
     ? __pfx_process_one_work+0x10/0x10
     ? assign_work+0x16c/0x240
     worker_thread+0x5ef/0xfd0
     ? __pfx_worker_thread+0x10/0x10
     kthread+0x3b0/0x770
     ? __pfx_kthread+0x10/0x10
     ? rcu_is_watching+0x11/0xb0
     ? _raw_spin_unlock_irq+0x24/0x50
     ? rcu_is_watching+0x11/0xb0
     ? __pfx_kthread+0x10/0x10
     ret_from_fork+0x30/0x70
     ? __pfx_kthread+0x10/0x10
     ret_from_fork_asm+0x1a/0x30
     </TASK>

    Allocated by task 147416:
     kasan_save_stack+0x2c/0x50
     kasan_save_track+0x10/0x30
     __kasan_kmalloc+0xa6/0xb0
     alloc_work_entries+0xa9/0x260 [iw_cm]
     iw_cm_connect+0x23/0x4a0 [iw_cm]
     rdma_connect_locked+0xbfd/0x1920 [rdma_cm]
     nvme_rdma_cm_handler+0x8e5/0x1b60 [nvme_rdma]
     cma_cm_event_handler+0xae/0x320 [rdma_cm]
     cma_work_handler+0x106/0x1b0 [rdma_cm]
     process_one_work+0x84f/0x1460
     worker_thread+0x5ef/0xfd0
     kthread+0x3b0/0x770
     ret_from_fork+0x30/0x70
     ret_from_fork_asm+0x1a/0x30

    Freed by task 147091:
     kasan_save_stack+0x2c/0x50
     kasan_save_track+0x10/0x30
     kasan_save_free_info+0x37/0x60
     __kasan_slab_free+0x4b/0x70
     kfree+0x13a/0x4b0
     dealloc_work_entries+0x125/0x1f0 [iw_cm]
     iwcm_deref_id+0x6f/0xa0 [iw_cm]
     cm_work_handler+0x136/0x1ba0 [iw_cm]
     process_one_work+0x84f/0x1460
     worker_thread+0x5ef/0xfd0
     kthread+0x3b0/0x770
     ret_from_fork+0x30/0x70
     ret_from_fork_asm+0x1a/0x30

    Last potentially related work creation:
     kasan_save_stack+0x2c/0x50
     kasan_record_aux_stack+0xa3/0xb0
     __queue_work+0x2ff/0x1390
     queue_work_on+0x67/0xc0
     cm_event_handler+0x46a/0x820 [iw_cm]
     siw_cm_upcall+0x330/0x650 [siw]
     siw_cm_work_handler+0x6b9/0x2b20 [siw]
     process_one_work+0x84f/0x1460
     worker_thread+0x5ef/0xfd0
     kthread+0x3b0/0x770
     ret_from_fork+0x30/0x70
     ret_from_fork_asm+0x1a/0x30

  This BUG is reproducible by repeating the blktests test case nvme/061
  for the rdma transport and the siw driver.

  To avoid the use-after-free of cm_id_private work objects, ensure that
  the last reference to the cm_id is decremented not in the event handler
  works, but in the cm_id destruction context. For that purpose, mo
  ---truncated---
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38211.json
  - score: '7.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38211.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.0335'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.03352'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07314'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07322'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07522'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07439'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07393'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07416'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0738'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07395'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08228'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08257'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08329'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08389'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0841'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08595'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08575'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08296'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.08287'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1031'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10276'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10233'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10204'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10282'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10228'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10222'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10211'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10231'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09672'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09772'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09751'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09861'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09926'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09979'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0992'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10024'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09997'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10155'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10134'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10135'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10279'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10267'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10299'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10271'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10242'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10287'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10284'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.1032'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10333'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14327'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38211.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38211
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38211
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/013dcdf6f03bcedbaf1669e3db71c34a197715b2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/23a707bbcbea468eedb398832eeb7e8e0ceafd21
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3b4a50d733acad6831f6bd9288a76a80f70650ac
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6883b680e703c6b2efddb4e7a8d891ce1803d06b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/764c9f69beabef8bdc651a7746c59f7a340d104f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/78381dc8a6b61c9bb9987d37b4d671b99767c4a1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bf7eff5e3a36c54bbe8aff7fd6dd7c07490b81c5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd960b5ddf4faf00da43babdd3acda68842e1f6a
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2376406
    reference_type:
    reference_id: 2376406
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38211
    reference_type:
    reference_id: CVE-2025-38211
  - url: https://access.redhat.com/errata/RHSA-2025:15005
    reference_type:
    reference_id: RHSA-2025:15005
  - url: https://access.redhat.com/errata/RHSA-2025:15008
    reference_type:
    reference_id: RHSA-2025:15008
  - url: https://access.redhat.com/errata/RHSA-2025:15009
    reference_type:
    reference_id: RHSA-2025:15009
  - url: https://access.redhat.com/errata/RHSA-2025:15011
    reference_type:
    reference_id: RHSA-2025:15011
  - url: https://access.redhat.com/errata/RHSA-2025:15657
    reference_type:
    reference_id: RHSA-2025:15657
  - url: https://access.redhat.com/errata/RHSA-2025:15669
    reference_type:
    reference_id: RHSA-2025:15669
  - url: https://access.redhat.com/errata/RHSA-2025:16669
    reference_type:
    reference_id: RHSA-2025:16669
  - url: https://access.redhat.com/errata/RHSA-2025:17159
    reference_type:
    reference_id: RHSA-2025:17159
  - url: https://access.redhat.com/errata/RHSA-2025:17192
    reference_type:
    reference_id: RHSA-2025:17192
  - url: https://access.redhat.com/errata/RHSA-2025:17570
    reference_type:
    reference_id: RHSA-2025:17570
  - url: https://access.redhat.com/errata/RHSA-2025:18043
    reference_type:
    reference_id: RHSA-2025:18043
  - url: https://access.redhat.com/errata/RHSA-2025:21667
    reference_type:
    reference_id: RHSA-2025:21667
  - url: https://access.redhat.com/errata/RHSA-2025:22752
    reference_type:
    reference_id: RHSA-2025:22752
  - url: https://usn.ubuntu.com/7774-1/
    reference_type:
    reference_id: USN-7774-1
  - url: https://usn.ubuntu.com/7774-2/
    reference_type:
    reference_id: USN-7774-2
  - url: https://usn.ubuntu.com/7774-3/
    reference_type:
    reference_id: USN-7774-3
  - url: https://usn.ubuntu.com/7774-4/
    reference_type:
    reference_id: USN-7774-4
  - url: https://usn.ubuntu.com/7774-5/
    reference_type:
    reference_id: USN-7774-5
  - url: https://usn.ubuntu.com/7775-1/
    reference_type:
    reference_id: USN-7775-1
  - url: https://usn.ubuntu.com/7775-2/
    reference_type:
    reference_id: USN-7775-2
  - url: https://usn.ubuntu.com/7775-3/
    reference_type:
    reference_id: USN-7775-3
  - url: https://usn.ubuntu.com/7776-1/
    reference_type:
    reference_id: USN-7776-1
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
