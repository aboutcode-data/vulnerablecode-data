vulnerability_id: VCID-cm76-spx2-aaab
aliases:
  - CVE-2022-31186
  - GHSA-p6mm-27gq-9v3p
summary: 'NextAuth.js is a complete open source authentication solution for Next.js applications.
  An information disclosure vulnerability in `next-auth` before `v4.10.2` and `v3.29.9` allows
  an attacker with log access privilege to obtain excessive information such as an identity
  provider''s secret in the log (which is thrown during OAuth error handling) and use it to
  leverage further attacks on the system, like impersonating the client to ask for extensive
  permissions. This issue has been patched in `v4.10.2` and `v3.29.9` by moving the log for
  `provider` information to the debug level. In addition, we added a warning for having the
  `debug: true` option turned on in production. If for some reason you cannot upgrade, you can
  user the `logger` configuration option by sanitizing the logs.'
severities:
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.06569'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17297'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17271'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17256'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17235'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17251'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17281'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17277'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17254'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17201'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.1723'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20582'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20566'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20564'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20553'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20558'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.2058'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20595'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20599'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20539'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20482'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.20416'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17126'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17074'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17225'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17245'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00065'
    scoring_system: epss
    scoring_elements: '0.17278'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22641'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22653'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: '0.00072'
    scoring_system: epss
    scoring_elements: '0.22647'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p6mm-27gq-9v3p
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/nextauthjs/next-auth
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-p6mm-27gq-9v3p
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-p6mm-27gq-9v3p
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:02:52Z/
    published_at: None
    url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-p6mm-27gq-9v3p
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://next-auth.js.org/configuration/options#logger
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://next-auth.js.org/configuration/options#logger
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:02:52Z/
    published_at: None
    url: https://next-auth.js.org/configuration/options#logger
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://next-auth.js.org/getting-started/upgrade-v4
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://next-auth.js.org/getting-started/upgrade-v4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:02:52Z/
    published_at: None
    url: https://next-auth.js.org/getting-started/upgrade-v4
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://next-auth.js.org/warnings#debug_enabled
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://next-auth.js.org/warnings#debug_enabled
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:02:52Z/
    published_at: None
    url: https://next-auth.js.org/warnings#debug_enabled
  - score: '3.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31186
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31186
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-532
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-31186
    reference_type:
    reference_id:
  - url: https://github.com/nextauthjs/next-auth
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/configuration/options#logger
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/getting-started/upgrade-v4
    reference_type:
    reference_id:
  - url: https://next-auth.js.org/warnings#debug_enabled
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:next-auth:nextauth.js:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:next-auth:nextauth.js:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31186
    reference_type:
    reference_id: CVE-2022-31186
  - url: https://github.com/advisories/GHSA-p6mm-27gq-9v3p
    reference_type:
    reference_id: GHSA-p6mm-27gq-9v3p
  - url: https://github.com/nextauthjs/next-auth/security/advisories/GHSA-p6mm-27gq-9v3p
    reference_type:
    reference_id: GHSA-p6mm-27gq-9v3p
