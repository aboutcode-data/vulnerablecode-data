vulnerability_id: VCID-z3yn-54mj-aaak
aliases:
  - CVE-2021-46990
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  powerpc/64s: Fix crashes when toggling entry flush barrier

  The entry flush mitigation can be enabled/disabled at runtime via a
  debugfs file (entry_flush), which causes the kernel to patch itself to
  enable/disable the relevant mitigations.

  However depending on which mitigation we're using, it may not be safe to
  do that patching while other CPUs are active. For example the following
  crash:

    sleeper[15639]: segfault (11) at c000000000004c20 nip c000000000004c20 lr c000000000004c20

  Shows that we returned to userspace with a corrupted LR that points into
  the kernel, due to executing the partially patched call to the fallback
  entry flush (ie. we missed the LR restore).

  Fix it by doing the patching under stop machine. The CPUs that aren't
  doing the patching will be spinning in the core of the stop machine
  logic. That is currently sufficient for our purposes, because none of
  the patching we do is to that code or anywhere in the vicinity.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-46990.json
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14083'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14461'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14482'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14548'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14541'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14556'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14611'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14691'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14976'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15033'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15128'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14714'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14726'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14371'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.14194'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.14229'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.14251'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.14071'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.14023'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.14179'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00055'
    scoring_system: epss
    scoring_elements: '0.14214'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '0.00244'
    scoring_system: epss
    scoring_elements: '0.32294'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00442'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00448'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00444'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00443'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00334'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00336'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00335'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00333'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00332'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00445'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00447'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00446'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00388'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-46990
weaknesses:
  - CWE-20
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-46990.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-46990
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46990
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0b4eb172cc12dc102cd0ad013e53ee4463db9508
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0c25a7bb697f2e6ee65b6d63782f675bf129511a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2db22ba4e0e103f00e0512e0ecce36ac78c644f8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5bc00fdda1e934c557351a9c751a205293e68cbf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8382b15864e5014261b4f36c2aa89723612ee058
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aec86b052df6541cc97c5fca44e5934cbea4963b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d2e3590ca39ccfd8a5a46d8c7f095cb6c7b9ae92
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dd0d6117052faace5440db20fc37175efe921c7d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ee4b7aab93c2631c3bb0753023c5dda592bb666b
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2266896
    reference_type:
    reference_id: 2266896
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:5.13:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:5.13:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-46990
    reference_type:
    reference_id: CVE-2021-46990
  - url: https://usn.ubuntu.com/6739-1/
    reference_type:
    reference_id: USN-6739-1
