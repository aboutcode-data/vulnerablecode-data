vulnerability_id: VCID-dzj1-h755-93ae
aliases:
  - CVE-2025-66307
  - GHSA-q3qx-cp62-f6m7
summary: "Grav Admin Plugin vulnerable to User Enumeration & Email Disclosure\n# Grav v1.7.49.5\
  \ / Admin v1.10.49.1 – User Enumeration & Email Disclosure\n\n### Summary\nA **user enumeration\
  \ and email disclosure vulnerability** exists in Grav **v1.7.49.5** with Admin plugin **v1.10.49.1**.\
  \  \nThe \"Forgot Password\" functionality at `/admin/forgot` leaks information about valid\
  \ usernames and their associated email addresses through distinct server responses.  \nThis\
  \ allows an attacker to enumerate users and disclose sensitive email addresses, which can\
  \ be leveraged for targeted attacks such as password spraying, phishing, or social engineering.\
  \  \n\n### Details\n\nThe issue resides in the [`taskForgot()`](https://github.com/getgrav/grav-plugin-admin/blob/6d673fc7c4f6962756f93ae651371e81f7f20924/classes/plugin/Controllers/Login/LoginController.php#L349)\
  \ function, which handles the forgot password workflow.  \nRelevant vulnerable logic:\n\n\
  ```php\nif (null === $user || $user->state !== 'enabled' || !$to) {\n    ...\n    // Generic\
  \ message for invalid/non-existing users\n    $this->setMessage($this->translate('PLUGIN_ADMIN.FORGOT_INSTRUCTIONS_SENT_VIA_EMAIL'));\n\
  \    return $this->createRedirectResponse($current);\n}\n\nif ($rateLimiter->isRateLimited($username))\
  \ {\n    ...\n    $interval = $config->get('plugins.login.max_pw_resets_interval', 2);\n\n\
  \    // Sensitive message for valid users\n    $this->setMessage($this->translate('PLUGIN_LOGIN.FORGOT_CANNOT_RESET_IT_IS_BLOCKED',\
  \ $to, $interval), 'error');\n\n    return $this->createRedirectResponse($current);\n}\n```\n\
  \nWhen an attacker submits the password reset form at `/admin/forgot` with an **invalid username**,\
  \ the application responds with:  \n\n```\nInstructions to reset your password have been sent\
  \ to your email address\n```\n\nHowever, when a **valid username** is supplied, and the attacker\
  \ repeatedly triggers password reset requests, the application responds with:  \n\n```\nCannot\
  \ reset password for <USER_EMAIL>, password reset functionality temporarily blocked, please\
  \ try later (maximum 60 minutes)\n```\n\nThis discrepancy in responses enables:  \n1. **User\
  \ Enumeration** – Attackers can determine if a username exists in the system by analyzing\
  \ the response.  \n2. **User Email Disclosure** – The system discloses the actual email address\
  \ associated with the account (e.g., `admin@localhost.test`).  \n\nThis violates best practices\
  \ for authentication flows, where responses should remain generic to avoid leaking sensitive\
  \ information.\n\n### PoC\n1. Navigate to the **Forgot Password** page:  `https://<target>/admin/forgot`\n\
  1. Submit a reset request with a random/invalid username (e.g., `invalid_user`):  \n\n- Response:\
  \  \n  ```\n  Instructions to reset your password have been sent to your email address\n \
  \ ```\n3. Submit a reset request with a valid username (e.g., `admin`).  \n4. Repeatedly request\
  \ a reset for the same username until the lockout mechanism triggers.  \n- Response:  \n \
  \ ```\n  Cannot reset password for admin@localhost.test, password reset functionality temporarily\
  \ blocked, please try later (maximum 60 minutes)\n  ```\n5. Observe the leaked **email address**\
  \ of the admin account in the error message.  \n\n### Impact\n- **Severity:** Medium  \n-\
  \ **Type:** Information Disclosure / User Enumeration  \n- **Who is Impacted:** All Grav sites\
  \ using Admin plugin **v1.10.49.1** with password reset enabled.  \n- **Risks:**  \n  - Allows\
  \ attackers to enumerate valid usernames.  \n  - Exposes email addresses of admin accounts,\
  \ which can be used in:  \n  - Credential stuffing  \n  - Password spraying  \n  - Phishing/social\
  \ engineering campaigns  \n  - Further exploitation in combination with other vulnerabilities\
  \  \n\n\n### Recommendation\n\n- Modify the [`taskForgot()`](https://github.com/getgrav/grav-plugin-admin/blob/6d673fc7c4f6962756f93ae651371e81f7f20924/classes/plugin/Controllers/Login/LoginController.php#L349)\
  \ logic to always return a generic, non-identifying message, regardless of whether the username\
  \ exists or rate limits are hit.\n\n- Example safe response:\n  ```ini\n  If the account exists,\
  \ password reset instructions will be sent.\n  ```\n\n- Do not include email addresses ($to)\
  \ or other sensitive data in error messages."
severities:
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11715'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66307
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11707'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-66307
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-q3qx-cp62-f6m7
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/getgrav/grav
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/blob/6d673fc7c4f6962756f93ae651371e81f7f20924/classes/plugin/Controllers/Login/LoginController.php#L349
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/blob/6d673fc7c4f6962756f93ae651371e81f7f20924/classes/plugin/Controllers/Login/LoginController.php#L349
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-12-02T20:07:49Z/
    published_at: None
    url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-q3qx-cp62-f6m7
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-q3qx-cp62-f6m7
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-q3qx-cp62-f6m7
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-12-02T20:07:49Z/
    published_at: None
    url: https://github.com/getgrav/grav/security/advisories/GHSA-q3qx-cp62-f6m7
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66307
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-66307
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-204
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-66307
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav-plugin-admin/blob/6d673fc7c4f6962756f93ae651371e81f7f20924/classes/plugin/Controllers/Login/LoginController.php#L349
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav-plugin-admin/commit/99f653296504f1d6408510dd2f6f20a45a26f9b0
    reference_type:
    reference_id:
  - url: https://github.com/getgrav/grav/security/advisories/GHSA-q3qx-cp62-f6m7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-66307
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-q3qx-cp62-f6m7
    reference_type:
    reference_id: GHSA-q3qx-cp62-f6m7
