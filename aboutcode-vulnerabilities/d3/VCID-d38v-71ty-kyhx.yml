vulnerability_id: VCID-d38v-71ty-kyhx
aliases:
  - CVE-2024-47763
  - GHSA-q8hx-mm92-4wvg
summary: 'Wasmtime is an open source runtime for WebAssembly. Wasmtime''s implementation of
  WebAssembly tail calls combined with stack traces can result in a runtime crash in certain
  WebAssembly modules. The runtime crash may be undefined behavior if Wasmtime was compiled
  with Rust 1.80 or prior. The runtime crash is a deterministic process abort when Wasmtime
  is compiled with Rust 1.81 and later. WebAssembly tail calls are a proposal which relatively
  recently reached stage 4 in the standardization process. Wasmtime first enabled support for
  tail calls by default in Wasmtime 21.0.0, although that release contained a bug where it was
  only on-by-default for some configurations. In Wasmtime 22.0.0 tail calls were enabled by
  default for all configurations. The specific crash happens when an exported function in a
  WebAssembly module (or component) performs a `return_call` (or `return_call_indirect` or `return_call_ref`)
  to an imported host function which captures a stack trace (for example, the host function
  raises a trap). In this situation, the stack-walking code previously assumed there was always
  at least one WebAssembly frame on the stack but with tail calls that is no longer true. With
  the tail-call proposal it''s possible to have an entry trampoline appear as if it directly
  called the exit trampoline. This situation triggers an internal assert in the stack-walking
  code which raises a Rust `panic!()`. When Wasmtime is compiled with Rust versions 1.80 and
  prior this means that an `extern "C"` function in Rust is raising a `panic!()`. This is technically
  undefined behavior and typically manifests as a process abort when the unwinder fails to unwind
  Cranelift-generated frames. When Wasmtime is compiled with Rust versions 1.81 and later this
  panic becomes a deterministic process abort. Overall the impact of this issue is that this
  is a denial-of-service vector where a malicious WebAssembly module or component can cause
  the host to crash. There is no other impact at this time other than availability of a service
  as the result of the crash is always a crash and no more. This issue was discovered by routine
  fuzzing performed by the Wasmtime project via Google''s OSS-Fuzz infrastructure. We have no
  evidence that it has ever been exploited by an attacker in the wild. All versions of Wasmtime
  which have tail calls enabled by default have been patched: * 21.0.x - patched in 21.0.2 *
  22.0.x - patched in 22.0.1 * 23.0.x - patched in 23.0.3  * 24.0.x - patched in 24.0.1 * 25.0.x
  - patched in 25.0.2. Wasmtime versions from 12.0.x (the first release with experimental tail
  call support) to 20.0.x (the last release with tail-calls off-by-default) have support for
  tail calls but the support is disabled by default. These versions are not affected in their
  default configurations, but users who explicitly enabled tail call support will need to either
  disable tail call support or upgrade to a patched version of Wasmtime. The main workaround
  for this issue is to disable tail support for tail calls in Wasmtime, for example with `Config::wasm_tail_call(false)`.
  Users are otherwise encouraged to upgrade to patched versions.'
severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11214'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12225'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11891'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11841'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11828'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12271'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12177'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12119'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11819'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11764'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11709'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11696'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11700'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11632'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11609'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11518'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12576'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.1236'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12334'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.125'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12504'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12539'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12553'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12549'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12556'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12571'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12595'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12582'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12533'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12473'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.11386'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00231'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00232'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00233'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.0023'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00234'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: 5e-05
    scoring_system: epss
    scoring_elements: '0.00235'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_tail_call
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-09T19:47:52Z/
    published_at: None
    url: https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_tail_call
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-q8hx-mm92-4wvg
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/commit/0ebe54d05f0e1f6c64b7c8bb48c9e9f6c95cacba
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/commit/0ebe54d05f0e1f6c64b7c8bb48c9e9f6c95cacba
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/6774
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/6774
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/8540
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-09T19:47:52Z/
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/8540
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/8682
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-09T19:47:52Z/
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/pull/8682
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-q8hx-mm92-4wvg
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-q8hx-mm92-4wvg
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-09T19:47:52Z/
    published_at: None
    url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-q8hx-mm92-4wvg
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/WebAssembly/proposals
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-09T19:47:52Z/
    published_at: None
    url: https://github.com/WebAssembly/proposals
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/webassembly/tail-call
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-09T19:47:52Z/
    published_at: None
    url: https://github.com/webassembly/tail-call
weaknesses:
  - CWE-670
  - CWE-617
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47763.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47763
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime/commit/0ebe54d05f0e1f6c64b7c8bb48c9e9f6c95cacba
    reference_type:
    reference_id:
  - url: https://github.com/bytecodealliance/wasmtime/pull/6774
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2317646
    reference_type:
    reference_id: 2317646
  - url: https://github.com/bytecodealliance/wasmtime/pull/8540
    reference_type:
    reference_id: 8540
  - url: https://github.com/bytecodealliance/wasmtime/pull/8682
    reference_type:
    reference_id: 8682
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47763
    reference_type:
    reference_id: CVE-2024-47763
  - url: https://github.com/advisories/GHSA-q8hx-mm92-4wvg
    reference_type:
    reference_id: GHSA-q8hx-mm92-4wvg
  - url: https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-q8hx-mm92-4wvg
    reference_type:
    reference_id: GHSA-q8hx-mm92-4wvg
  - url: https://github.com/WebAssembly/proposals
    reference_type:
    reference_id: proposals
  - url: https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_tail_call
    reference_type:
    reference_id: struct.Config.html#method.wasm_tail_call
  - url: https://github.com/webassembly/tail-call
    reference_type:
    reference_id: tail-call
