vulnerability_id: VCID-d3v8-rjcs-eka8
aliases:
  - CVE-2025-21869
summary: 'In the Linux kernel, the following vulnerability has been resolved:  powerpc/code-patching:
  Disable KASAN report during patching via temporary mm  Erhard reports the following KASAN
  hit on Talos II (power9) with kernel 6.13:  [   12.028126] ==================================================================
  [   12.028198] BUG: KASAN: user-memory-access in copy_to_kernel_nofault+0x8c/0x1a0 [   12.028260]
  Write of size 8 at addr 0000187e458f2000 by task systemd/1  [   12.028346] CPU: 87 UID: 0
  PID: 1 Comm: systemd Tainted: G                T  6.13.0-P9-dirty #3 [   12.028408] Tainted:
  [T]=RANDSTRUCT [   12.028446] Hardware name: T2P9D01 REV 1.01 POWER9 0x4e1202 opal:skiboot-bc106a0
  PowerNV [   12.028500] Call Trace: [   12.028536] [c000000008dbf3b0] [c000000001656a48] dump_stack_lvl+0xbc/0x110
  (unreliable) [   12.028609] [c000000008dbf3f0] [c0000000006e2fc8] print_report+0x6b0/0x708
  [   12.028666] [c000000008dbf4e0] [c0000000006e2454] kasan_report+0x164/0x300 [   12.028725]
  [c000000008dbf600] [c0000000006e54d4] kasan_check_range+0x314/0x370 [   12.028784] [c000000008dbf640]
  [c0000000006e6310] __kasan_check_write+0x20/0x40 [   12.028842] [c000000008dbf660] [c000000000578e8c]
  copy_to_kernel_nofault+0x8c/0x1a0 [   12.028902] [c000000008dbf6a0] [c0000000000acfe4] __patch_instructions+0x194/0x210
  [   12.028965] [c000000008dbf6e0] [c0000000000ade80] patch_instructions+0x150/0x590 [   12.029026]
  [c000000008dbf7c0] [c0000000001159bc] bpf_arch_text_copy+0x6c/0xe0 [   12.029085] [c000000008dbf800]
  [c000000000424250] bpf_jit_binary_pack_finalize+0x40/0xc0 [   12.029147] [c000000008dbf830]
  [c000000000115dec] bpf_int_jit_compile+0x3bc/0x930 [   12.029206] [c000000008dbf990] [c000000000423720]
  bpf_prog_select_runtime+0x1f0/0x280 [   12.029266] [c000000008dbfa00] [c000000000434b18] bpf_prog_load+0xbb8/0x1370
  [   12.029324] [c000000008dbfb70] [c000000000436ebc] __sys_bpf+0x5ac/0x2e00 [   12.029379]
  [c000000008dbfd00] [c00000000043a228] sys_bpf+0x28/0x40 [   12.029435] [c000000008dbfd20]
  [c000000000038eb4] system_call_exception+0x334/0x610 [   12.029497] [c000000008dbfe50] [c00000000000c270]
  system_call_vectored_common+0xf0/0x280 [   12.029561] --- interrupt: 3000 at 0x3fff82f5cfa8
  [   12.029608] NIP:  00003fff82f5cfa8 LR: 00003fff82f5cfa8 CTR: 0000000000000000 [   12.029660]
  REGS: c000000008dbfe80 TRAP: 3000   Tainted: G                T   (6.13.0-P9-dirty) [   12.029735]
  MSR:  900000000280f032 <SF,HV,VEC,VSX,EE,PR,FP,ME,IR,DR,RI>  CR: 42004848  XER: 00000000 [   12.029855]
  IRQMASK: 0                GPR00: 0000000000000169 00003fffdcf789a0 00003fff83067100 0000000000000005                GPR04:
  00003fffdcf78a98 0000000000000090 0000000000000000 0000000000000008                GPR08:
  0000000000000000 0000000000000000 0000000000000000 0000000000000000                GPR12:
  0000000000000000 00003fff836ff7e0 c000000000010678 0000000000000000                GPR16:
  0000000000000000 0000000000000000 00003fffdcf78f28 00003fffdcf78f90                GPR20:
  0000000000000000 0000000000000000 0000000000000000 00003fffdcf78f80                GPR24:
  00003fffdcf78f70 00003fffdcf78d10 00003fff835c7239 00003fffdcf78bd8                GPR28:
  00003fffdcf78a98 0000000000000000 0000000000000000 000000011f547580 [   12.030316] NIP [00003fff82f5cfa8]
  0x3fff82f5cfa8 [   12.030361] LR [00003fff82f5cfa8] 0x3fff82f5cfa8 [   12.030405] --- interrupt:
  3000 [   12.030444] ==================================================================  Commit
  c28c15b6d28a ("powerpc/code-patching: Use temporary mm for Radix MMU") is inspired from x86
  but unlike x86 is doesn''t disable KASAN reports during patching. This wasn''t a problem at
  the begining because __patch_mem() is not instrumented.  Commit 465cabc97b42 ("powerpc/code-patching:
  introduce patch_instructions()") use copy_to_kernel_nofault() to copy several instructions
  at once. But when using temporary mm the destination is not regular kernel memory but a kind
  of kernel-like memory located in user address space.  ---truncated---'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-21869.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02028'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02117'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.01727'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03381'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03384'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03393'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03428'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03436'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03442'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03435'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0343'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04273'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04307'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0434'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04323'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04338'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04321'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04317'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04275'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04281'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04282'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04283'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04294'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0339'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03378'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03377'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04773'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-21869.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-21869
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5980d4456dd66d1b6505d5ec15048bd87e8775e0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dc9c5166c3cb044f8a001e397195242fd6796eee
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ea291447a4031f3dac5c23d55bc83fe833820d84
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355329
    reference_type:
    reference_id: 2355329
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-21869
    reference_type:
    reference_id: CVE-2025-21869
