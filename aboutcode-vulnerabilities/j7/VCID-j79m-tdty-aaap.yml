vulnerability_id: VCID-j79m-tdty-aaap
aliases:
  - CVE-2024-41815
  - GHSA-vx24-x4mv-vwr5
summary: "Starship vulnerable to shell injection via undocumented, unpredictable shell expansion\
  \ in custom commands\n## Description \nStarship is a cross-shell prompt. Starting in version\
  \ 1.0.0 and prior to version 1.20.0, undocumented and unpredictable shell expansion and/or\
  \ quoting rules make it easily to accidentally cause shell injection when using custom commands\
  \ with starship in bash. Version 1.20.0 fixes the vulnerability.\n\n### PoC\nHave some custom\
  \ command which prints out information from a potentially untrusted/unverified source.\n```\n\
  [custom.git_commit_name]\ncommand = 'git show -s --format=\"%<(25,mtrunc)%s\"'\nstyle = \"\
  italic\"\nwhen = true\n```\n\n### Impact\nThis issue only affects users with custom commands,\
  \ so the scope is limited, and without knowledge of others' commands, it could be hard to\
  \ successfully target someone."
severities:
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17852'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17873'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17934'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17923'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17964'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18514'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18407'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18324'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18001'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.18253'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17950'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17322'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17636'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17736'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17766'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00046'
    scoring_system: epss
    scoring_elements: '0.17857'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29897'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29941'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.3001'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.30009'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.2996'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29834'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31888'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31887'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.319'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31889'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31865'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31845'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.31886'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00117'
    scoring_system: epss
    scoring_elements: '0.3189'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00395'
    scoring_system: epss
    scoring_elements: '0.57535'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00395'
    scoring_system: epss
    scoring_elements: '0.5752'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00395'
    scoring_system: epss
    scoring_elements: '0.57525'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00395'
    scoring_system: epss
    scoring_elements: '0.57548'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00395'
    scoring_system: epss
    scoring_elements: '0.57567'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00395'
    scoring_system: epss
    scoring_elements: '0.57551'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00395'
    scoring_system: epss
    scoring_elements: '0.5758'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00395'
    scoring_system: epss
    scoring_elements: '0.57595'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00404'
    scoring_system: epss
    scoring_elements: '0.58059'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00404'
    scoring_system: epss
    scoring_elements: '0.58111'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00418'
    scoring_system: epss
    scoring_elements: '0.59116'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00418'
    scoring_system: epss
    scoring_elements: '0.59108'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00418'
    scoring_system: epss
    scoring_elements: '0.59107'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00418'
    scoring_system: epss
    scoring_elements: '0.59089'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: '0.00682'
    scoring_system: epss
    scoring_elements: '0.55771'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-vx24-x4mv-vwr5
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/starship/starship
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/starship/starship
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/starship/starship/commit/cfc58161e0ec595db90af686ad77a73df6d44d74
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/starship/starship/commit/cfc58161e0ec595db90af686ad77a73df6d44d74
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/starship/starship/releases/tag/v1.20.0
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/starship/starship/releases/tag/v1.20.0
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/starship/starship/security/advisories/GHSA-vx24-x4mv-vwr5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/starship/starship/security/advisories/GHSA-vx24-x4mv-vwr5
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41815
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41815
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41815
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-41815
weaknesses:
  - CWE-77
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-41815
    reference_type:
    reference_id:
  - url: https://github.com/starship/starship
    reference_type:
    reference_id:
  - url: https://github.com/starship/starship/commit/cfc58161e0ec595db90af686ad77a73df6d44d74
    reference_type:
    reference_id:
  - url: https://github.com/starship/starship/releases/tag/v1.20.0
    reference_type:
    reference_id:
  - url: https://github.com/starship/starship/security/advisories/GHSA-vx24-x4mv-vwr5
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41815
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:starship:starship:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:starship:starship:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-vx24-x4mv-vwr5
    reference_type:
    reference_id: GHSA-vx24-x4mv-vwr5
