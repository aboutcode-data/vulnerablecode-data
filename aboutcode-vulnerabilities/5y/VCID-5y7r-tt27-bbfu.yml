vulnerability_id: VCID-5y7r-tt27-bbfu
aliases:
  - CVE-2023-54020
summary: 'In the Linux kernel, the following vulnerability has been resolved:  dmaengine: sf-pdma:
  pdma_desc memory leak fix  Commit b2cc5c465c2c ("dmaengine: sf-pdma: Add multithread support
  for a DMA channel") changed sf_pdma_prep_dma_memcpy() to unconditionally allocate a new sf_pdma_desc
  each time it is called.  The driver previously recycled descs, by checking the in_use flag,
  only allocating additional descs if the existing one was in use. This logic was removed in
  commit b2cc5c465c2c ("dmaengine: sf-pdma: Add multithread support for a DMA channel"), but
  sf_pdma_free_desc() was not changed to handle the new behaviour.  As a result, each time sf_pdma_prep_dma_memcpy()
  is called, the previous descriptor is leaked, over time leading to memory starvation:    unreferenced
  object 0xffffffe008447300 (size 192):   comm "irq/39-mchp_dsc", pid 343, jiffies 4294906910
  (age 981.200s)   hex dump (first 32 bytes):     00 00 00 ff 00 00 00 00 b8 c1 00 00 00 00
  00 00  ................     00 00 70 08 10 00 00 00 00 00 00 c0 00 00 00 00  ..p.............   backtrace:     [<00000000064a04f4>]
  kmemleak_alloc+0x1e/0x28     [<00000000018927a7>] kmem_cache_alloc+0x11e/0x178     [<000000002aea8d16>]
  sf_pdma_prep_dma_memcpy+0x40/0x112  Add the missing kfree() to sf_pdma_free_desc(), and remove
  the redundant in_use flag.'
severities:
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05589'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54020
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.05572'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54020
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54020.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-54020
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-54020
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2424988
    reference_type:
    reference_id: 2424988
