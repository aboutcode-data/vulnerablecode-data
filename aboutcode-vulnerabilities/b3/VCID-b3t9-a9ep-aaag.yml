vulnerability_id: VCID-b3t9-a9ep-aaag
aliases:
  - CVE-2022-41931
  - GHSA-5j7g-cf6r-g2h7
  - GMS-2022-6930
summary: 'xwiki-platform-icon-ui is vulnerable to Improper Neutralization of Directives in Dynamically
  Evaluated Code (''Eval Injection''). Any user with view rights on commonly accessible documents
  including the icon picker macro can execute arbitrary Groovy, Python or Velocity code in XWiki
  due to improper neutralization of the macro parameters of the icon picker macro. The problem
  has been patched in XWiki 13.10.7, 14.5 and 14.4.2. Workarounds: The [patch](https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01)
  can be manually applied by editing `IconThemesCode.IconPickerMacro` in the object editor.
  The whole document can also be replaced by the current version by importing the document from
  the XAR archive of a fixed version as the only changes to the document have been security
  fixes and small formatting changes.'
severities:
  - score: '0.00274'
    scoring_system: epss
    scoring_elements: '0.67649'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00274'
    scoring_system: epss
    scoring_elements: '0.67628'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00274'
    scoring_system: epss
    scoring_elements: '0.67869'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00274'
    scoring_system: epss
    scoring_elements: '0.67655'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70548'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70537'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70287'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70431'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70470'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70483'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70532'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70529'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70654'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70621'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.00305'
    scoring_system: epss
    scoring_elements: '0.70603'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.8461'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84211'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.8422'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.8423'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84246'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84232'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84235'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84594'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84606'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84624'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84628'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84636'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84627'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84625'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84626'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84629'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84617'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84137'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84133'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84182'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84179'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84205'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.8421'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84201'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.02551'
    scoring_system: epss
    scoring_elements: '0.84203'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: '0.03218'
    scoring_system: epss
    scoring_elements: '0.7825'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5j7g-cf6r-g2h7
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:40:22Z/
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:40:22Z/
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-19805
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-19805
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-04-22T15:40:22Z/
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-19805
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-41931
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-41931
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-95
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-41931
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19805
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:14.4.3:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:14.4.3:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:14.4.4:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:14.4.4:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:6.4:milestone2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:6.4:milestone2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:6.4:milestone3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:6.4:milestone3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-41931
    reference_type:
    reference_id: CVE-2022-41931
  - url: https://github.com/advisories/GHSA-5j7g-cf6r-g2h7
    reference_type:
    reference_id: GHSA-5j7g-cf6r-g2h7
