vulnerability_id: VCID-9ur9-qmu1-aaaa
aliases:
  - CVE-2021-47536
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/smc: fix wrong list_del in smc_lgr_cleanup_early

  smc_lgr_cleanup_early() meant to delete the link
  group from the link group list, but it deleted
  the list head by mistake.

  This may cause memory corruption since we didn't
  remove the real link group from the list and later
  memseted the link group structure.
  We got a list corruption panic when testing:

  [  231.277259] list_del corruption. prev->next should be ffff8881398a8000, but was 0000000000000000
  [  231.278222] ------------[ cut here ]------------
  [  231.278726] kernel BUG at lib/list_debug.c:53!
  [  231.279326] invalid opcode: 0000 [#1] SMP NOPTI
  [  231.279803] CPU: 0 PID: 5 Comm: kworker/0:0 Not tainted 5.10.46+ #435
  [  231.280466] Hardware name: Alibaba Cloud ECS, BIOS 8c24b4c 04/01/2014
  [  231.281248] Workqueue: events smc_link_down_work
  [  231.281732] RIP: 0010:__list_del_entry_valid+0x70/0x90
  [  231.282258] Code: 4c 60 82 e8 7d cc 6a 00 0f 0b 48 89 fe 48 c7 c7 88 4c
  60 82 e8 6c cc 6a 00 0f 0b 48 89 fe 48 c7 c7 c0 4c 60 82 e8 5b cc 6a 00 <0f>
  0b 48 89 fe 48 c7 c7 00 4d 60 82 e8 4a cc 6a 00 0f 0b cc cc cc
  [  231.284146] RSP: 0018:ffffc90000033d58 EFLAGS: 00010292
  [  231.284685] RAX: 0000000000000054 RBX: ffff8881398a8000 RCX: 0000000000000000
  [  231.285415] RDX: 0000000000000001 RSI: ffff88813bc18040 RDI: ffff88813bc18040
  [  231.286141] RBP: ffffffff8305ad40 R08: 0000000000000003 R09: 0000000000000001
  [  231.286873] R10: ffffffff82803da0 R11: ffffc90000033b90 R12: 0000000000000001
  [  231.287606] R13: 0000000000000000 R14: ffff8881398a8000 R15: 0000000000000003
  [  231.288337] FS:  0000000000000000(0000) GS:ffff88813bc00000(0000) knlGS:0000000000000000
  [  231.289160] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
  [  231.289754] CR2: 0000000000e72058 CR3: 000000010fa96006 CR4: 00000000003706f0
  [  231.290485] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
  [  231.291211] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
  [  231.291940] Call Trace:
  [  231.292211]  smc_lgr_terminate_sched+0x53/0xa0
  [  231.292677]  smc_switch_conns+0x75/0x6b0
  [  231.293085]  ? update_load_avg+0x1a6/0x590
  [  231.293517]  ? ttwu_do_wakeup+0x17/0x150
  [  231.293907]  ? update_load_avg+0x1a6/0x590
  [  231.294317]  ? newidle_balance+0xca/0x3d0
  [  231.294716]  smcr_link_down+0x50/0x1a0
  [  231.295090]  ? __wake_up_common_lock+0x77/0x90
  [  231.295534]  smc_link_down_work+0x46/0x60
  [  231.295933]  process_one_work+0x18b/0x350
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47536.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28472'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24493'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28499'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28476'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24434'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24579'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24606'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24617'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24624'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24577'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24545'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24562'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24589'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24626'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24621'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.2458'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24564'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.24537'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28467'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28527'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28591'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28634'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28628'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28567'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28549'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28508'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28509'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28502'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00098'
    scoring_system: epss
    scoring_elements: '0.28519'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '0.00413'
    scoring_system: epss
    scoring_elements: '0.4457'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-119
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47536.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47536
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47536
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/77731fede297a23d26f2d169b4269466b2c82529
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/789b6cc2a5f9123b9c549b886fdc47c865cfe0ba
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/95518fe354d712dca6f431cf2a11b8f63bc9a66c
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2283415
    reference_type:
    reference_id: 2283415
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47536
    reference_type:
    reference_id: CVE-2021-47536
