vulnerability_id: VCID-3ftr-xgzw-fkds
aliases:
  - CVE-2025-59834
  - GHSA-54j7-grvr-9xwg
summary: "# Command Injection in adb-mcp MCP Server\n\nThe MCP Server at https://github.com/srmorete/adb-mcp\
  \ is written in a way that is vulnerable to command injection vulnerability attacks as part\
  \ of some of its MCP Server tool definition and implementation.\n\nThe MCP Server is also\
  \ published publicly to npm at www.npmjs.com/package/adb-mcp and allows users to install it.\n\
  \n## Vulnerable tool\n\nThe MCP Server defines the function `executeAdbCommand()` which executes\
  \ commands via string as a parameter and wraps the promise-based `exec` function.\n\nThe MCP\
  \ Server then exposes the tool `inspect_ui` which relies on Node.js child process API `exec`\
  \ (through the function wrapper) to execute the Android debugging command (`adb`). Relying\
  \ on `exec` is an unsafe and vulnerable API if concatenated with untrusted user input.\n\n\
  Data flows from the tool definition [here](https://github.com/srmorete/adb-mcp/blob/master/src/index.ts#L334-L343)\
  \ which takes in `args.device` and calls `execPromise()` in [this definitino](https://github.com/srmorete/adb-mcp/blob/master/src/index.ts#L346-L348C13)\
  \ that uses `exec` in an insecure way.\n\nVulnerable line of code: [https://github.com/srmorete/adb-mcp/blob/master/src/index.ts#L334-L352](https://github.com/srmorete/adb-mcp/blob/master/src/index.ts#L334-L355)\n\
  \n```js\n// Add adb UI dump tool\nserver.tool(\n  \"inspect_ui\",\n  AdbUidumpSchema.shape,\n\
  \  async (args: z.infer<typeof AdbUidumpSchema>, _extra: RequestHandlerExtra) => {\n    log(LogLevel.INFO,\
  \ \"Dumping UI hierarchy\");\n    \n    const deviceArg = formatDeviceArg(args.device);\n\
  \    const tempFilePath = createTempFilePath(\"adb-mcp\", \"window_dump.xml\");\n    const\
  \ remotePath = args.outputPath || \"/sdcard/window_dump.xml\";\n    \n    try {\n      //\
  \ Dump UI hierarchy on device\n      const dumpCommand = `adb ${deviceArg}shell uiautomator\
  \ dump ${remotePath}`;\n      await execPromise(dumpCommand);\n      \n      // Pull the UI\
  \ dump from the device\n      const pullCommand = `adb ${deviceArg}pull ${remotePath} ${tempFilePath}`;\n\
  \      await execPromise(pullCommand);\n      \n      // Clean up the remote file\n      await\
  \ execPromise(`adb ${deviceArg}shell rm ${remotePath}`);\n```\n\nThe argument to the tool,\
  \ `AdbDevicesSchema`, is a Zod inferred type defined in the `src/types.ts` file in the project:\n\
  \n```js\nexport const inspectUiInputSchema = {\n  device: z.string().optional().describe(\"\
  Specific device ID (optional)\"),\n  outputPath: z.string().optional().describe(\"Custom output\
  \ path on device (default: /sdcard/window_dump.xml)\"),\n  asBase64: z.boolean().optional().default(false).describe(\"\
  Return XML content as base64 (default: false)\")\n};\n```\n\nand exposes `device` as a string\
  \ which is an open way to trick the LLM into pushing arbitrary strings into it and hence achieve\
  \ the command injection exploitation.\n\n\n## Exploitation\n\nWhen LLMs are tricked through\
  \ prompt injection (and other techniques and attack vectors) to call the tool with input that\
  \ uses special shell characters such as `; rm -rf /tmp;#` (be careful actually executing this\
  \ payload) and other payload variations, the full command-line text will be interepted by\
  \ the shell and result in other commands except of `ps` executing on the host running the\
  \ MCP Server.\n\nReference example from prior security research on this topic, demonstrating\
  \ how a similarly vulnerable MCP Server connected to Cursor is abused with prompt injection\
  \ to bypass the developer's intended command:\n\n![Cursor defined MCP Server vulnerable to\
  \ command injection](https://res.cloudinary.com/snyk/image/upload/f_auto,w_2560,q_auto/v1747081395/Screenshot_2025-05-07_at_9.22.11_AM_d76kvm.png)\n\
  \n## Impact\n\nUser initiated and remote command injection on a running MCP Server.\n\n##\
  \ Recommendation\n\n- Don't use `exec`. Use `execFile` instead, which pins the command and\
  \ provides the arguments as array elements.\n- If the user input is not a command-line flag,\
  \ use the `--` notation to terminate command and command-line flag, and indicate that the\
  \ text after the `--` double dash notation is benign value.\n\n## References and Prior work\n\
  \n1. Command Injection in codehooks-mcp-server MCP Server project https://www.nodejs-security.com/blog/command-injection-vulnerability-codehooks-mcp-server-security-analysis\
  \ identified as CVE-2025-53100\n2. Command Injection in ios-simulator-mcp-server MCP Server\
  \ project https://www.nodejs-security.com/blog/ios-simulator-mcp-server-command-injection-vulnerability\
  \ identified as CVE-2025-52573\n3. Liran's [Node.js Secure Coding: Defending Against Command\
  \ Injection Vulnerabilities](https://www.nodejs-security.com/book/command-injection)\n\n##\
  \ Credit\n\nDisclosed by [Liran Tal](https://lirantal.com)"
severities:
  - score: '0.00251'
    scoring_system: epss
    scoring_elements: '0.48433'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00251'
    scoring_system: epss
    scoring_elements: '0.48412'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00251'
    scoring_system: epss
    scoring_elements: '0.48421'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.5702'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.57008'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.57182'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.57183'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.57199'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.57029'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00842'
    scoring_system: epss
    scoring_elements: '0.7401'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00842'
    scoring_system: epss
    scoring_elements: '0.74005'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00842'
    scoring_system: epss
    scoring_elements: '0.74018'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00842'
    scoring_system: epss
    scoring_elements: '0.74112'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00842'
    scoring_system: epss
    scoring_elements: '0.74115'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00865'
    scoring_system: epss
    scoring_elements: '0.74361'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00865'
    scoring_system: epss
    scoring_elements: '0.74365'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00865'
    scoring_system: epss
    scoring_elements: '0.74328'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00865'
    scoring_system: epss
    scoring_elements: '0.7432'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00865'
    scoring_system: epss
    scoring_elements: '0.74334'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00865'
    scoring_system: epss
    scoring_elements: '0.74333'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00865'
    scoring_system: epss
    scoring_elements: '0.7433'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.00865'
    scoring_system: epss
    scoring_elements: '0.74322'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.01002'
    scoring_system: epss
    scoring_elements: '0.76508'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: '0.01002'
    scoring_system: epss
    scoring_elements: '0.76506'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-54j7-grvr-9xwg
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/srmorete/adb-mcp
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/srmorete/adb-mcp
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/srmorete/adb-mcp/blob/master/src/index.ts#L334-L355
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/srmorete/adb-mcp/blob/master/src/index.ts#L334-L355
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-09-25T14:36:09Z/
    published_at: None
    url: https://github.com/srmorete/adb-mcp/blob/master/src/index.ts#L334-L355
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/srmorete/adb-mcp/commit/041729c0b25432df3199ff71b3163a307cf4c28c
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/srmorete/adb-mcp/commit/041729c0b25432df3199ff71b3163a307cf4c28c
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-09-25T14:36:09Z/
    published_at: None
    url: https://github.com/srmorete/adb-mcp/commit/041729c0b25432df3199ff71b3163a307cf4c28c
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/srmorete/adb-mcp/security/advisories/GHSA-54j7-grvr-9xwg
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/srmorete/adb-mcp/security/advisories/GHSA-54j7-grvr-9xwg
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/srmorete/adb-mcp/security/advisories/GHSA-54j7-grvr-9xwg
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2025-09-25T14:36:09Z/
    published_at: None
    url: https://github.com/srmorete/adb-mcp/security/advisories/GHSA-54j7-grvr-9xwg
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59834
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59834
weaknesses:
  - CWE-78
  - CWE-1035
  - CWE-937
  - CWE-77
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-59834
    reference_type:
    reference_id:
  - url: https://github.com/srmorete/adb-mcp
    reference_type:
    reference_id:
  - url: https://github.com/srmorete/adb-mcp/blob/master/src/index.ts#L334-L355
    reference_type:
    reference_id:
  - url: https://github.com/srmorete/adb-mcp/commit/041729c0b25432df3199ff71b3163a307cf4c28c
    reference_type:
    reference_id:
  - url: https://github.com/srmorete/adb-mcp/security/advisories/GHSA-54j7-grvr-9xwg
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59834
    reference_type:
    reference_id: CVE-2025-59834
  - url: https://github.com/advisories/GHSA-54j7-grvr-9xwg
    reference_type:
    reference_id: GHSA-54j7-grvr-9xwg
