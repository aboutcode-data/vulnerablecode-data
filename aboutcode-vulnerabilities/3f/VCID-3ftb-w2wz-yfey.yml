vulnerability_id: VCID-3ftb-w2wz-yfey
aliases:
  - CVE-2025-52478
  - GHSA-hfmv-hhh3-43f2
summary: |
  Stored XSS in n8n Form Trigger allows Account Takeover via injected iframe and video/source
  ### Impact

  A stored **Cross-Site Scripting (XSS)** vulnerability was identified in [n8n](https://github.com/n8n-io/n8n), specifically in the **Form Trigger** node's **HTML form element**. An authenticated attacker can inject malicious HTML via an `<iframe>` with a `srcdoc` payload that includes arbitrary JavaScript execution. The attacker can also inject malicious Javascript by using `<video>` coupled `<source>` using an `onerror` event.

  While using `iframe` or a combination of `video` and `source` tag, this vulnerability allows for Account Takeover (ATO) by exfiltrating `n8n-browserId` and session cookies from authenticated users who visit a maliciously crafted form. Using these tokens and cookies, an attacker can impersonate the victim and change account details such as email addresses, enabling full control over the accountâ€”especially if 2FA is not enabled.

  ### Patches
  The issue was addressed in [PR #16329](https://github.com/n8n-io/n8n/pull/16329). Users should upgrade to version >=1.98.2.

  ### Workarounds
  Apart from updating to the fixed version, n8n instance administrators can:
  - Configure a reverse proxy to **serve webhook requests from a different domain** [[docs](https://docs.n8n.io/hosting/configuration/configuration-examples/webhook-url/)].
  - Disable or restrict use of the **Form Trigger node**, particularly the **HTML** element type.
  - Use a Content Security Policy (CSP) to block execution of inline scripts and disallow use of `srcdoc`.

  ### References
  - [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/XSS_Prevention_Cheat_Sheet.html)
  - [MDN: iframe `srcdoc` attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-srcdoc)
  - [HTML: `onerror` attribute](https://html.spec.whatwg.org/multipage/webappapis.html#handler-onerror)
severities:
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07331'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07382'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07411'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.08534'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.08249'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.08232'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.08336'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.08349'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.08444'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.08489'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11421'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11367'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11319'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11334'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1139'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10963'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11062'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11049'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11214'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11212'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11355'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11365'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.1136'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11373'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11407'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11339'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11389'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11432'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11462'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11483'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11474'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13679'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13692'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13698'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13812'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13742'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19345'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19325'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-hfmv-hhh3-43f2
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/n8n-io/n8n
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/n8n-io/n8n
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/n8n-io/n8n/commit/7940384a85041a1890b1203d69c092c887312500
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/n8n-io/n8n/commit/7940384a85041a1890b1203d69c092c887312500
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-08-19T19:18:07Z/
    published_at: None
    url: https://github.com/n8n-io/n8n/commit/7940384a85041a1890b1203d69c092c887312500
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/n8n-io/n8n/pull/16329
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/n8n-io/n8n/pull/16329
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-08-19T19:18:07Z/
    published_at: None
    url: https://github.com/n8n-io/n8n/pull/16329
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/n8n-io/n8n/security/advisories/GHSA-hfmv-hhh3-43f2
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/n8n-io/n8n/security/advisories/GHSA-hfmv-hhh3-43f2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/n8n-io/n8n/security/advisories/GHSA-hfmv-hhh3-43f2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-08-19T19:18:07Z/
    published_at: None
    url: https://github.com/n8n-io/n8n/security/advisories/GHSA-hfmv-hhh3-43f2
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-52478
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-52478
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-52478
    reference_type:
    reference_id:
  - url: https://github.com/n8n-io/n8n
    reference_type:
    reference_id:
  - url: https://github.com/n8n-io/n8n/commit/7940384a85041a1890b1203d69c092c887312500
    reference_type:
    reference_id:
  - url: https://github.com/n8n-io/n8n/pull/16329
    reference_type:
    reference_id:
  - url: https://github.com/n8n-io/n8n/security/advisories/GHSA-hfmv-hhh3-43f2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-52478
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-hfmv-hhh3-43f2
    reference_type:
    reference_id: GHSA-hfmv-hhh3-43f2
