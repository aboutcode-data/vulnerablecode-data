vulnerability_id: VCID-xvc1-tpks-aaah
aliases:
  - CVE-2024-3271
  - GHSA-r6gp-rff2-p3hf
summary: A command injection vulnerability exists in the run-llama/llama_index repository, specifically
  within the safe_eval function. Attackers can bypass the intended security mechanism, which
  checks for the presence of underscores in code generated by LLM, to execute arbitrary code.
  This is achieved by crafting input that does not contain an underscore but still results in
  the execution of OS commands. The vulnerability allows for remote code execution (RCE) on
  the server hosting the application.
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75542'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75523'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75532'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75526'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75534'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75531'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75556'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75477'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.755'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75533'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.75548'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.7554'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81623'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81556'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81545'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81601'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81606'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81619'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81632'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81625'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81627'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81639'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81657'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81668'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81654'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81656'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.01885'
    scoring_system: epss
    scoring_elements: '0.81649'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: '0.06137'
    scoring_system: epss
    scoring_elements: '0.84248'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-r6gp-rff2-p3hf
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/run-llama/llama_index
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/run-llama/llama_index
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/run-llama/llama_index/commit/2c92e88838a5f481d50840240b1dd3180066c6f5
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/run-llama/llama_index/commit/2c92e88838a5f481d50840240b1dd3180066c6f5
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/run-llama/llama_index/commit/5fbcb5a8b9f20f81b791c7fc8849e352613ab475
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/run-llama/llama_index/commit/5fbcb5a8b9f20f81b791c7fc8849e352613ab475
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/9b32490e-7cf9-470e-8d49-ba083ae7a279
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://huntr.com/bounties/9b32490e-7cf9-470e-8d49-ba083ae7a279
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-77
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-3271
    reference_type:
    reference_id:
  - url: https://github.com/run-llama/llama_index
    reference_type:
    reference_id:
  - url: https://github.com/run-llama/llama_index/commit/2c92e88838a5f481d50840240b1dd3180066c6f5
    reference_type:
    reference_id:
  - url: https://github.com/run-llama/llama_index/commit/5fbcb5a8b9f20f81b791c7fc8849e352613ab475
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/9b32490e-7cf9-470e-8d49-ba083ae7a279
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-3271
    reference_type:
    reference_id: CVE-2024-3271
  - url: https://github.com/advisories/GHSA-r6gp-rff2-p3hf
    reference_type:
    reference_id: GHSA-r6gp-rff2-p3hf
