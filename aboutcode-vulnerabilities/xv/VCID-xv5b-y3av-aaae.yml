vulnerability_id: VCID-xv5b-y3av-aaae
aliases:
  - CVE-2021-31810
summary: An issue was discovered in Ruby through 2.6.7, 2.7.x through 2.7.3, and 3.x through
  3.0.1. A malicious FTP server can use the PASV response to trick Net::FTP into connecting
  back to a given IP address and port. This potentially makes curl extract information about
  services that are otherwise private and not disclosed (e.g., the attacker can conduct port
  scans and service banner extractions).
severities:
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2021/CVE-2021-31810.html
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:3020
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:3559
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2021:3982
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:0543
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:0544
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:0581
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:0582
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:0672
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:0708
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-31810.json
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.36435'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.36463'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.36429'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.68379'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.68606'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.68392'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00286'
    scoring_system: epss
    scoring_elements: '0.68359'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71551'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70541'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70534'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70617'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70636'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70652'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70624'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70633'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70632'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70644'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70637'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70628'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.70613'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71493'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71519'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71546'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71563'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71568'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71549'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71541'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71553'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.7155'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71556'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71564'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00738'
    scoring_system: epss
    scoring_elements: '0.71565'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84042'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84229'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84221'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84217'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84213'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84184'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84175'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84145'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84305'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84278'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.00999'
    scoring_system: epss
    scoring_elements: '0.84269'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: '0.01671'
    scoring_system: epss
    scoring_elements: '0.70673'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1980126
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28965
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31799
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31810
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32066
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://hackerone.com/reports/1145454
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2021/10/msg00009.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2021/10/msg00009.html
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2023/04/msg00033.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.debian.org/debian-lts-announce/2023/04/msg00033.html
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-31810
  - score: '5.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-31810
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-31810
  - score: High
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-1906
  - score: High
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2138
  - score: High
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2139
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-5020-1
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://www.oracle.com/security-alerts/cpuapr2022.html
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.oracle.com/security-alerts/cpuapr2022.html
  - score: Low
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.ruby-lang.org/en/news/2021/07/07/trusting-pasv-responses-in-net-ftp/
weaknesses:
  - CWE-200
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2021/CVE-2021-31810.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-31810.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-31810
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28965
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31799
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31810
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32066
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41817
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41819
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1145454
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2021/10/msg00009.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2023/04/msg00033.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MWXHK5UUHVSHF7HTHMX6JY3WXDVNIHSL/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MWXHK5UUHVSHF7HTHMX6JY3WXDVNIHSL/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20210917-0001/
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5020-1
    reference_type:
    reference_id:
  - url: https://www.oracle.com/security-alerts/cpuapr2022.html
    reference_type:
    reference_id:
  - url: https://www.ruby-lang.org/en/news/2021/07/07/trusting-pasv-responses-in-net-ftp/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1980126
    reference_type:
    reference_id: '1980126'
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=990815
    reference_type:
    reference_id: 990815
  - url: https://security.archlinux.org/ASA-202107-23
    reference_type:
    reference_id: ASA-202107-23
  - url: https://security.archlinux.org/ASA-202107-24
    reference_type:
    reference_id: ASA-202107-24
  - url: https://security.archlinux.org/AVG-1906
    reference_type:
    reference_id: AVG-1906
  - url: https://security.archlinux.org/AVG-2138
    reference_type:
    reference_id: AVG-2138
  - url: https://security.archlinux.org/AVG-2139
    reference_type:
    reference_id: AVG-2139
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:oracle:jd_edwards_enterpriseone_tools:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:oracle:jd_edwards_enterpriseone_tools:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-31810
    reference_type:
    reference_id: CVE-2021-31810
  - url: https://security.gentoo.org/glsa/202401-27
    reference_type:
    reference_id: GLSA-202401-27
  - url: https://access.redhat.com/errata/RHSA-2021:3020
    reference_type:
    reference_id: RHSA-2021:3020
  - url: https://access.redhat.com/errata/RHSA-2021:3559
    reference_type:
    reference_id: RHSA-2021:3559
  - url: https://access.redhat.com/errata/RHSA-2021:3982
    reference_type:
    reference_id: RHSA-2021:3982
  - url: https://access.redhat.com/errata/RHSA-2022:0543
    reference_type:
    reference_id: RHSA-2022:0543
  - url: https://access.redhat.com/errata/RHSA-2022:0544
    reference_type:
    reference_id: RHSA-2022:0544
  - url: https://access.redhat.com/errata/RHSA-2022:0581
    reference_type:
    reference_id: RHSA-2022:0581
  - url: https://access.redhat.com/errata/RHSA-2022:0582
    reference_type:
    reference_id: RHSA-2022:0582
  - url: https://access.redhat.com/errata/RHSA-2022:0672
    reference_type:
    reference_id: RHSA-2022:0672
  - url: https://access.redhat.com/errata/RHSA-2022:0708
    reference_type:
    reference_id: RHSA-2022:0708
  - url: https://usn.ubuntu.com/5020-1/
    reference_type:
    reference_id: USN-5020-1
