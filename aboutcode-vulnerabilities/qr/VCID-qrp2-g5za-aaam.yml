vulnerability_id: VCID-qrp2-g5za-aaam
aliases:
  - CVE-2023-34040
  - GHSA-crqf-q9fp-hwjw
summary: |
  In Spring for Apache Kafka 3.0.9 and earlier and versions 2.9.10 and earlier, a possible deserialization attack vector existed, but only if unusual configuration was applied. An attacker would have to construct a malicious serialized object in one of the deserialization exception record headers.

  Specifically, an application is vulnerable when all of the following are true:

    *  The user does notÂ configure an ErrorHandlingDeserializer for the key and/or value of the record
    *  The user explicitly sets container properties checkDeserExWhenKeyNull and/or checkDeserExWhenValueNull container properties to true.
    *  The user allows untrusted sources to publish to a Kafka topic


  By default, these properties are false, and the container only attempts to deserialize the headers if an ErrorHandlingDeserializer is configured. The ErrorHandlingDeserializer prevents the vulnerability by removing any such malicious headers before processing the record.


severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14246'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14301'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14381'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14667'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14721'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14814'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14422'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14435'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14492'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.13756'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14827'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14065'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14150'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14172'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14239'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14232'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92353'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92364'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.9237'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92365'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92361'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92363'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92368'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92374'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92372'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92367'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92369'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.1006'
    scoring_system: epss
    scoring_elements: '0.92344'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.11197'
    scoring_system: epss
    scoring_elements: '0.89133'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.95886'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.95858'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.95862'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.95864'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.9587'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.95874'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.95871'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.95875'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.95877'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: '0.25602'
    scoring_system: epss
    scoring_elements: '0.95881'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-crqf-q9fp-hwjw
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-crqf-q9fp-hwjw
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/spring-projects/spring-kafka
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/spring-projects/spring-kafka
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/spring-projects/spring-kafka/commit/25ac793a78725e2ca4a3a2888a1506a4bfcf0c9d
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/spring-projects/spring-kafka/commit/25ac793a78725e2ca4a3a2888a1506a4bfcf0c9d
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/spring-projects/spring-kafka/commit/eb779679812f61a8553ced3d0e4069dca65560ed
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/spring-projects/spring-kafka/commit/eb779679812f61a8553ced3d0e4069dca65560ed
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34040
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34040
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://spring.io/security/cve-2023-34040
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://spring.io/security/cve-2023-34040
weaknesses:
  - CWE-502
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-34040
    reference_type:
    reference_id:
  - url: https://github.com/spring-projects/spring-kafka
    reference_type:
    reference_id:
  - url: https://github.com/spring-projects/spring-kafka/commit/25ac793a78725e2ca4a3a2888a1506a4bfcf0c9d
    reference_type:
    reference_id:
  - url: https://github.com/spring-projects/spring-kafka/commit/eb779679812f61a8553ced3d0e4069dca65560ed
    reference_type:
    reference_id:
  - url: https://spring.io/security/cve-2023-34040
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vmware:spring:*:*:*:*:*:apache_kafka:*:*
    reference_type:
    reference_id: cpe:2.3:a:vmware:spring:*:*:*:*:*:apache_kafka:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vmware:spring_for_apache_kafka:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:vmware:spring_for_apache_kafka:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34040
    reference_type:
    reference_id: CVE-2023-34040
  - url: https://github.com/advisories/GHSA-crqf-q9fp-hwjw
    reference_type:
    reference_id: GHSA-crqf-q9fp-hwjw
