vulnerability_id: VCID-84xb-x28u-aaab
aliases:
  - CVE-2024-35223
  - GHSA-284c-x8m7-9w5h
summary: "Dapr API Token Exposure\n### **Summary**\n\nA vulnerability has been found in Dapr\
  \ that causes a leak of the application token of the invoker app to the invoked app when using\
  \ Dapr as a gRPC proxy for remote service invocation. This issue arises because Dapr sends\
  \ the app token of the invoker app instead of the app token of the invoked app.\n\nUsers who\
  \ leverage Dapr for gRPC proxy service invocation and are using the app API token feature\
  \ are encouraged to upgrade Dapr to version [1.13.3](https://github.com/dapr/dapr/releases/tag/v1.13.3).\n\
  \n### Impact\n\nThis vulnerability impacts Dapr users who use Dapr as a gRPC proxy for remote\
  \ service invocation as well as the [Dapr App API token](https://docs.dapr.io/operations/security/app-api-token/)\
  \ functionality. An attacker could exploit this vulnerability to gain access to the app token\
  \ of the invoker app, potentially compromising security and authentication mechanisms.\n\n\
  ### Patches\n\nThe issue has been fixed in Dapr version [1.13.3](https://github.com/dapr/dapr/releases/tag/v1.13.3).\n\
  \n### Details\n\nDapr uses two types of tokens for authentication:\n\n- `APP_API_TOKEN`: Used\
  \ by Dapr to authenticate to the app.\n- `DAPR_API_TOKEN`: Used by the app to authenticate\
  \ to Dapr.\n\nDapr uses the `dapr-api-token` metadata in gRPC calls (or header, for HTTP calls)\
  \ for authentication.\n\n- In communication from dapr to the app, the `dapr-api-token` metadata\
  \ field will carry the  `APP_API_TOKEN`.\n- In communication from the app to daprd, the `dapr-api-token`\
  \ metadata field will carry the  `DAPR_API_TOKEN`.\n\nBefore version 1.13.0, the `APP_API_TOKEN`\
  \ was not being sent to the invoked app for authentication, as reported in [this issue](https://github.com/dapr/dapr/issues/7344).\
  \ Instead, Dapr was incorrectly using the same `DAPR_API_TOKEN` that the invoker app had passed\
  \ to Dapr. This was addressed in [PR #7404](https://github.com/dapr/dapr/pull/7404), but the\
  \ fix only worked for self-invocation scenarios.\n\nWhen Dapr needed to communicate with another\
  \ instance, it would mistakenly include the `APP_API_TOKEN` of the invoker app in the request.\
  \ This behavior is incorrect, app tokens should never be included in requests between Dapr\
  \ sidecars. This vulnerability allows the receiving app to see the app token of the invoker\
  \ app, leading to potential misuse and security breaches.\n\nThe vulnerability is addressed\
  \ by ensuring that Dapr uses the correct app token (of the invoked app) during gRPC proxy\
  \ service invocation.\n\n### References\n\n- https://docs.dapr.io/operations/security/app-api-token/\n\
  - https://github.com/dapr/dapr/issues/7344\n- https://github.com/dapr/dapr/pull/7404 \n\n\
  ### Credits\n\nThanks to [Benjamin Delay](mailto:benjamin.delay@gmail.com) for reporting this\
  \ issue."
severities:
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48116'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48113'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48165'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48225'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48246'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48247'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48156'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48155'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48185'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48182'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48194'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48175'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00249'
    scoring_system: epss
    scoring_elements: '0.48147'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52429'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52298'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52461'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52451'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52282'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52383'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52389'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52412'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52436'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52415'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52395'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52414'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52433'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00323'
    scoring_system: epss
    scoring_elements: '0.52453'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '0.00366'
    scoring_system: epss
    scoring_elements: '0.41585'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/dapr/dapr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dapr/dapr
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/dapr/dapr/commit/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dapr/dapr/commit/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/dapr/dapr/issues/7344
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dapr/dapr/issues/7344
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/dapr/dapr/pull/7404
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dapr/dapr/pull/7404
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/dapr/dapr/releases/tag/v1.13.3
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dapr/dapr/releases/tag/v1.13.3
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/dapr/dapr/security/advisories/GHSA-284c-x8m7-9w5h
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dapr/dapr/security/advisories/GHSA-284c-x8m7-9w5h
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-35223
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-35223
weaknesses:
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-35223
    reference_type:
    reference_id:
  - url: https://github.com/dapr/dapr
    reference_type:
    reference_id:
  - url: https://github.com/dapr/dapr/commit/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c
    reference_type:
    reference_id:
  - url: https://github.com/dapr/dapr/issues/7344
    reference_type:
    reference_id:
  - url: https://github.com/dapr/dapr/pull/7404
    reference_type:
    reference_id:
  - url: https://github.com/dapr/dapr/releases/tag/v1.13.3
    reference_type:
    reference_id:
  - url: https://github.com/dapr/dapr/security/advisories/GHSA-284c-x8m7-9w5h
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35223
    reference_type:
    reference_id:
