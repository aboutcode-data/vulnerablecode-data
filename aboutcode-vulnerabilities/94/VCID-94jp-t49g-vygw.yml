vulnerability_id: VCID-94jp-t49g-vygw
aliases:
  - CVE-2025-59956
  - GHSA-w64r-2g3w-w8w4
summary: |
  Coder AgentAPI exposed user chat history via a DNS rebinding attack
  ### Summary
  AgentAPI prior to version [0.4.0](https://github.com/coder/agentapi/releases/tag/v0.4.0) was susceptible to a client-side DNS rebinding attack when hosted over plain HTTP on localhost.

  ### Impact
  An attacker could have gained access to the `/messages` endpoint served by the Agent API. This allowed for the unauthorized exfiltration of sensitive user data, specifically local message history, which could've included secret keys, file system contents, and intellectual property the user was working on locally.

  ### Remediation
  We've [implemented](https://github.com/coder/agentapi/pull/49) an `Origin` and `Host` header validating middleware and set a secure by default configuration.

  Please upgrade to version [0.4.0](https://github.com/coder/agentapi/releases/tag/v0.4.0) or later.

  ### Credits
  We'd like to thank [Evan Harris](https://github.com/eharris128) from [mcpsec.dev](https://mcpsec.dev/) for reporting this issue and following the coordinated disclosure [policy](https://coder.com/security/policy).
severities:
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08554'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.0849'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.08534'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.0915'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09128'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09112'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09108'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.091'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09168'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09047'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.0907'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09121'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.09158'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09743'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09789'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09745'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10711'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.10669'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11516'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11466'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11485'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.1861'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '0.00059'
    scoring_system: epss
    scoring_elements: '0.18634'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.blog/security/application-security/localhost-dangers-cors-and-dns-rebinding
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.blog/security/application-security/localhost-dangers-cors-and-dns-rebinding
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-30T14:14:39Z/
    published_at: None
    url: https://github.blog/security/application-security/localhost-dangers-cors-and-dns-rebinding
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/coder/agentapi
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/agentapi
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/coder/agentapi/commit/5c425c62447b8a9eac19e9fc5a2eae7f0803f149
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/agentapi/commit/5c425c62447b8a9eac19e9fc5a2eae7f0803f149
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-30T14:14:39Z/
    published_at: None
    url: https://github.com/coder/agentapi/commit/5c425c62447b8a9eac19e9fc5a2eae7f0803f149
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/coder/agentapi/pull/49
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/agentapi/pull/49
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-30T14:14:39Z/
    published_at: None
    url: https://github.com/coder/agentapi/pull/49
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/coder/agentapi/releases/tag/v0.4.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/agentapi/releases/tag/v0.4.0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-30T14:14:39Z/
    published_at: None
    url: https://github.com/coder/agentapi/releases/tag/v0.4.0
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/coder/agentapi/security/advisories/GHSA-w64r-2g3w-w8w4
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/agentapi/security/advisories/GHSA-w64r-2g3w-w8w4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-30T14:14:39Z/
    published_at: None
    url: https://github.com/coder/agentapi/security/advisories/GHSA-w64r-2g3w-w8w4
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://mcpsec.dev/advisories/2025-09-19-coder-chat-exfiltration
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://mcpsec.dev/advisories/2025-09-19-coder-chat-exfiltration
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-09-30T14:14:39Z/
    published_at: None
    url: https://mcpsec.dev/advisories/2025-09-19-coder-chat-exfiltration
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59956
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-59956
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3991
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2025-3991
weaknesses:
  - CWE-350
  - CWE-290
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-59956
    reference_type:
    reference_id:
  - url: https://github.blog/security/application-security/localhost-dangers-cors-and-dns-rebinding
    reference_type:
    reference_id:
  - url: https://github.com/coder/agentapi
    reference_type:
    reference_id:
  - url: https://github.com/coder/agentapi/commit/5c425c62447b8a9eac19e9fc5a2eae7f0803f149
    reference_type:
    reference_id:
  - url: https://github.com/coder/agentapi/pull/49
    reference_type:
    reference_id:
  - url: https://github.com/coder/agentapi/releases/tag/v0.4.0
    reference_type:
    reference_id:
  - url: https://github.com/coder/agentapi/security/advisories/GHSA-w64r-2g3w-w8w4
    reference_type:
    reference_id:
  - url: https://mcpsec.dev/advisories/2025-09-19-coder-chat-exfiltration
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-59956
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2025-3991
    reference_type:
    reference_id:
