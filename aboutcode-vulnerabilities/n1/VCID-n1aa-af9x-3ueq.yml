vulnerability_id: VCID-n1aa-af9x-3ueq
aliases:
  - CVE-2025-30222
  - GHSA-66pp-5p9w-q87j
summary: 'Shescape is a simple shell escape library for JavaScript. Versions 1.7.2 through 2.1.1
  are vulnerable to potential environment variable exposure on Windows with CMD. This impact
  users of Shescape on Windows that explicitly configure `shell: ''cmd.exe''` or `shell: true`
  using any of `quote`/`quoteAll`/`escape`/`escapeAll`. An attacker may be able to get read-only
  access to environment variables. This bug has been patched in v2.1.2. For those who are already
  using v2 of Shescape, no further changes are required. Those who are are using v1 of Shescape
  should follow the migration guide to upgrade to v2. There is no plan to release a patch compatible
  with v1 of Shescape. As a workaround, users can remove all instances of `%` from user input
  before using Shescape.'
severities:
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01158'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01478'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00015'
    scoring_system: epss
    scoring_elements: '0.01452'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03563'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02827'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02821'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02816'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02813'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.0282'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02855'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02879'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02871'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02865'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02861'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03499'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03534'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03541'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03553'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03537'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03536'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03481'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.0348'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.03493'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.0284'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.02819'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.04'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.04037'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.04026'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-66pp-5p9w-q87j
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ericcornelissen/shescape
  - score: '2.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/ericcornelissen/shescape/commit/0a81f1eb077bab8caae283a2490cd7be9af179c6
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ericcornelissen/shescape/commit/0a81f1eb077bab8caae283a2490cd7be9af179c6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-03-26T13:30:30Z/
    published_at: None
    url: https://github.com/ericcornelissen/shescape/commit/0a81f1eb077bab8caae283a2490cd7be9af179c6
  - score: '2.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/ericcornelissen/shescape/pull/1916
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ericcornelissen/shescape/pull/1916
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-03-26T13:30:30Z/
    published_at: None
    url: https://github.com/ericcornelissen/shescape/pull/1916
  - score: '2.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/ericcornelissen/shescape/releases/tag/v2.1.2
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ericcornelissen/shescape/releases/tag/v2.1.2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-03-26T13:30:30Z/
    published_at: None
    url: https://github.com/ericcornelissen/shescape/releases/tag/v2.1.2
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/ericcornelissen/shescape/security/advisories/GHSA-66pp-5p9w-q87j
  - score: '2.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:L/AC:L/AT:P/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:U
    published_at: None
    url: https://github.com/ericcornelissen/shescape/security/advisories/GHSA-66pp-5p9w-q87j
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ericcornelissen/shescape/security/advisories/GHSA-66pp-5p9w-q87j
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-03-26T13:30:30Z/
    published_at: None
    url: https://github.com/ericcornelissen/shescape/security/advisories/GHSA-66pp-5p9w-q87j
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-30222
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-30222
    reference_type:
    reference_id:
  - url: https://github.com/ericcornelissen/shescape
    reference_type:
    reference_id:
  - url: https://github.com/ericcornelissen/shescape/commit/0a81f1eb077bab8caae283a2490cd7be9af179c6
    reference_type:
    reference_id: 0a81f1eb077bab8caae283a2490cd7be9af179c6
  - url: https://github.com/ericcornelissen/shescape/pull/1916
    reference_type:
    reference_id: '1916'
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-30222
    reference_type:
    reference_id: CVE-2025-30222
  - url: https://github.com/advisories/GHSA-66pp-5p9w-q87j
    reference_type:
    reference_id: GHSA-66pp-5p9w-q87j
  - url: https://github.com/ericcornelissen/shescape/security/advisories/GHSA-66pp-5p9w-q87j
    reference_type:
    reference_id: GHSA-66pp-5p9w-q87j
  - url: https://github.com/ericcornelissen/shescape/releases/tag/v2.1.2
    reference_type:
    reference_id: v2.1.2
