vulnerability_id: VCID-n1sh-68hr-aaae
aliases:
  - CVE-2022-33140
  - GHSA-77hf-23pq-2g7c
summary: The optional ShellUserGroupProvider in Apache NiFi 1.10.0 to 1.16.2 and Apache NiFi
  Registry 0.6.0 to 1.16.2 does not neutralize arguments for group resolution commands, allowing
  injection of operating system commands on Linux and macOS platforms. The ShellUserGroupProvider
  is not included in the default configuration. Command injection requires ShellUserGroupProvider
  to be one of the enabled User Group Providers in the Authorizers configuration. Command injection
  also requires an authenticated user with elevated privileges. Apache NiFi requires an authenticated
  user with authorization to modify access policies in order to execute the command. Apache
  NiFi Registry requires an authenticated user with authorization to read user groups in order
  to execute the command. The resolution removes command formatting based on user-provided arguments.
severities:
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.80802'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81301'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81312'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81315'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81318'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81309'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81308'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81304'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81314'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81323'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81316'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81302'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81279'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.81258'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.80788'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.80795'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01715'
    scoring_system: epss
    scoring_elements: '0.80791'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81251'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81306'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81291'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81275'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81273'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81281'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81267'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81255'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81201'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.01807'
    scoring_system: epss
    scoring_elements: '0.81193'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.02291'
    scoring_system: epss
    scoring_elements: '0.74477'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.02606'
    scoring_system: epss
    scoring_elements: '0.90588'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.02664'
    scoring_system: epss
    scoring_elements: '0.90737'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.02664'
    scoring_system: epss
    scoring_elements: '0.90757'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.02664'
    scoring_system: epss
    scoring_elements: '0.90778'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.02664'
    scoring_system: epss
    scoring_elements: '0.90773'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.02664'
    scoring_system: epss
    scoring_elements: '0.90771'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.02664'
    scoring_system: epss
    scoring_elements: '0.90755'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.02664'
    scoring_system: epss
    scoring_elements: '0.90751'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.06661'
    scoring_system: epss
    scoring_elements: '0.93732'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.06661'
    scoring_system: epss
    scoring_elements: '0.93730'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.09131'
    scoring_system: epss
    scoring_elements: '0.94908'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.09131'
    scoring_system: epss
    scoring_elements: '0.94910'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.09131'
    scoring_system: epss
    scoring_elements: '0.94922'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.11840'
    scoring_system: epss
    scoring_elements: '0.95295'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: '0.11840'
    scoring_system: epss
    scoring_elements: '0.95316'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-77hf-23pq-2g7c
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/apache/nifi
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/nifi
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.apache.org/thread/bzs2pcdjsdrh5039oslmfr9mbs9qqdhr
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/bzs2pcdjsdrh5039oslmfr9mbs9qqdhr
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nifi.apache.org/security.html#CVE-2022-33140
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nifi.apache.org/security.html#CVE-2022-33140
  - score: '6.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-33140
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-33140
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-33140
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-78
  - CWE-74
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-33140
    reference_type:
    reference_id:
  - url: https://github.com/apache/nifi
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/bzs2pcdjsdrh5039oslmfr9mbs9qqdhr
    reference_type:
    reference_id:
  - url: https://nifi.apache.org/security.html#CVE-2022-33140
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-33140
    reference_type:
    reference_id: CVE-2022-33140
  - url: https://github.com/advisories/GHSA-77hf-23pq-2g7c
    reference_type:
    reference_id: GHSA-77hf-23pq-2g7c
