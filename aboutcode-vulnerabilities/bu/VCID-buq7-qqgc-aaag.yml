vulnerability_id: VCID-buq7-qqgc-aaag
aliases:
  - GHSA-ppgf-8745-8pgx
summary: |
  Insecure Deserialization & Arbitrary Code Execution in TYPO3 CMS
  Phar files (formerly known as "PHP archives") can act als self extracting archives which leads to the fact that source code is executed when Phar files are invoked. The Phar file format is not limited to be stored with a dedicated file extension - "bundle.phar" would be valid as well as "bundle.txt" would be. This way, Phar files can be obfuscated as image or text file which would not be denied from being uploaded and persisted to a TYPO3 installation. Due to a missing sanitization of user input, those Phar files can be invoked by manipulated URLs in TYPO3 backend forms. A valid backend user account is needed to exploit this vulnerability. In theory the attack vector would be possible in the TYPO3 frontend as well, however no functional exploit has been identified so far.
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-ppgf-8745-8pgx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms/2018-07-12-2.yaml
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://typo3.org/security/advisory/typo3-core-sa-2018-002
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://typo3.org/security/advisory/typo3-core-sa-2018-002
weaknesses:
  - CWE-502
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/typo3/cms/2018-07-12-2.yaml
    reference_type:
    reference_id:
  - url: https://typo3.org/security/advisory/typo3-core-sa-2018-002
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-ppgf-8745-8pgx
    reference_type:
    reference_id: GHSA-ppgf-8745-8pgx
