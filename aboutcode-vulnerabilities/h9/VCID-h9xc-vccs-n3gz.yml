vulnerability_id: VCID-h9xc-vccs-n3gz
aliases:
  - CVE-2024-45596
  - GHSA-cff8-x7jv-4fm8
summary: Directus is a real-time API and App dashboard for managing SQL database content. An
  unauthenticated user can access credentials of last authenticated user via OpenID or OAuth2
  where the authentication URL did not include redirect query string. This happens because on
  that endpoint for both OpenId and Oauth2 Directus is using the respond middleware, which by
  default will try to cache GET requests that met some conditions. Although, those conditions
  do not include this scenario, when an unauthenticated request returns user credentials. This
  vulnerability is fixed in 10.13.3 and 11.1.0.
severities:
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39204'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39261'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39324'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39365'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39368'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39267'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39259'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39258'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39254'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.3927'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39256'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39233'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.42285'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00308'
    scoring_system: epss
    scoring_elements: '0.51'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00308'
    scoring_system: epss
    scoring_elements: '0.5101'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00308'
    scoring_system: epss
    scoring_elements: '0.51112'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00308'
    scoring_system: epss
    scoring_elements: '0.51137'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00308'
    scoring_system: epss
    scoring_elements: '0.5116'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00308'
    scoring_system: epss
    scoring_elements: '0.51108'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.5495'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.54937'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.54914'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.54896'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.54938'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.54959'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.54973'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00354'
    scoring_system: epss
    scoring_elements: '0.5496'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: '0.00568'
    scoring_system: epss
    scoring_elements: '0.51753'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-cff8-x7jv-4fm8
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/directus/directus
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/directus/directus/blob/main/api/src/auth/drivers/oauth2.ts#L422-L428
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus/blob/main/api/src/auth/drivers/oauth2.ts#L422-L428
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/directus/directus/blob/main/api/src/auth/drivers/openid.ts#L453-L459
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus/blob/main/api/src/auth/drivers/openid.ts#L453-L459
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/directus/directus/commit/4aace0bbe57232e38cd6a287ee475293e46dc91b
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus/commit/4aace0bbe57232e38cd6a287ee475293e46dc91b
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/directus/directus/commit/769fa22797bff5a9231599883b391e013f122e52
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus/commit/769fa22797bff5a9231599883b391e013f122e52
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N
    published_at: None
    url: https://github.com/directus/directus/security/advisories/GHSA-cff8-x7jv-4fm8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/directus/directus/security/advisories/GHSA-cff8-x7jv-4fm8
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-384
  - CWE-524
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-45596
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/blob/main/api/src/auth/drivers/oauth2.ts#L422-L428
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/blob/main/api/src/auth/drivers/openid.ts#L453-L459
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/4aace0bbe57232e38cd6a287ee475293e46dc91b
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/commit/769fa22797bff5a9231599883b391e013f122e52
    reference_type:
    reference_id:
  - url: https://github.com/directus/directus/security/advisories/GHSA-cff8-x7jv-4fm8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45596
    reference_type:
    reference_id: CVE-2024-45596
  - url: https://github.com/advisories/GHSA-cff8-x7jv-4fm8
    reference_type:
    reference_id: GHSA-cff8-x7jv-4fm8
