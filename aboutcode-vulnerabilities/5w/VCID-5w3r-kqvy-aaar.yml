vulnerability_id: VCID-5w3r-kqvy-aaar
aliases:
  - CVE-2024-35958
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net: ena: Fix incorrect descriptor free behavior

  ENA has two types of TX queues:
  - queues which only process TX packets arriving from the network stack
  - queues which only process TX packets forwarded to it by XDP_REDIRECT
    or XDP_TX instructions

  The ena_free_tx_bufs() cycles through all descriptors in a TX queue
  and unmaps + frees every descriptor that hasn't been acknowledged yet
  by the device (uncompleted TX transactions).
  The function assumes that the processed TX queue is necessarily from
  the first category listed above and ends up using napi_consume_skb()
  for descriptors belonging to an XDP specific queue.

  This patch solves a bug in which, in case of a VF reset, the
  descriptors aren't freed correctly, leading to crashes.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-35958.json
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11214'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11518'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11609'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11632'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11700'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11696'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11709'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11764'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11819'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12119'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12177'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12271'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11828'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11891'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12225'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11841'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.13264'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16227'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16234'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18335'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18107'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18181'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1828'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18355'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18347'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18331'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18305'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18299'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18311'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18317'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22672'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22604'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22745'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22764'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22773'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22766'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22713'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22676'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22689'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22708'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22744'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22728'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22685'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22671'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00088'
    scoring_system: epss
    scoring_elements: '0.22642'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '0.00374'
    scoring_system: epss
    scoring_elements: '0.4213'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/19ff8fed3338898b70b2aad831386c78564912e1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:17:10Z/
    published_at: None
    url: https://git.kernel.org/stable/c/19ff8fed3338898b70b2aad831386c78564912e1
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/5c7f2240d9835a7823d87f7460d8eae9f4e504c7
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:17:10Z/
    published_at: None
    url: https://git.kernel.org/stable/c/5c7f2240d9835a7823d87f7460d8eae9f4e504c7
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/b26aa765f7437e1bbe8db4c1641b12bd5dd378f0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:17:10Z/
    published_at: None
    url: https://git.kernel.org/stable/c/b26aa765f7437e1bbe8db4c1641b12bd5dd378f0
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/bf02d9fe00632d22fa91d34749c7aacf397b6cde
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:17:10Z/
    published_at: None
    url: https://git.kernel.org/stable/c/bf02d9fe00632d22fa91d34749c7aacf397b6cde
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/c31baa07f01307b7ae05f3ce32b89d8e2ba0cc1d
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:17:10Z/
    published_at: None
    url: https://git.kernel.org/stable/c/c31baa07f01307b7ae05f3ce32b89d8e2ba0cc1d
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/fdfbf54d128ab6ab255db138488f9650485795a2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-29T18:17:10Z/
    published_at: None
    url: https://git.kernel.org/stable/c/fdfbf54d128ab6ab255db138488f9650485795a2
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-35958.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-35958
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-35958
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/19ff8fed3338898b70b2aad831386c78564912e1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/5c7f2240d9835a7823d87f7460d8eae9f4e504c7
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b26aa765f7437e1bbe8db4c1641b12bd5dd378f0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bf02d9fe00632d22fa91d34749c7aacf397b6cde
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c31baa07f01307b7ae05f3ce32b89d8e2ba0cc1d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fdfbf54d128ab6ab255db138488f9650485795a2
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2281925
    reference_type:
    reference_id: 2281925
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35958
    reference_type:
    reference_id: CVE-2024-35958
  - url: https://access.redhat.com/errata/RHSA-2024:4106
    reference_type:
    reference_id: RHSA-2024:4106
  - url: https://access.redhat.com/errata/RHSA-2024:4108
    reference_type:
    reference_id: RHSA-2024:4108
  - url: https://access.redhat.com/errata/RHSA-2024:4211
    reference_type:
    reference_id: RHSA-2024:4211
  - url: https://access.redhat.com/errata/RHSA-2024:4447
    reference_type:
    reference_id: RHSA-2024:4447
  - url: https://access.redhat.com/errata/RHSA-2024:4583
    reference_type:
    reference_id: RHSA-2024:4583
  - url: https://access.redhat.com/errata/RHSA-2024:4740
    reference_type:
    reference_id: RHSA-2024:4740
  - url: https://usn.ubuntu.com/6893-1/
    reference_type:
    reference_id: USN-6893-1
  - url: https://usn.ubuntu.com/6893-2/
    reference_type:
    reference_id: USN-6893-2
  - url: https://usn.ubuntu.com/6893-3/
    reference_type:
    reference_id: USN-6893-3
  - url: https://usn.ubuntu.com/6898-1/
    reference_type:
    reference_id: USN-6898-1
  - url: https://usn.ubuntu.com/6898-2/
    reference_type:
    reference_id: USN-6898-2
  - url: https://usn.ubuntu.com/6898-3/
    reference_type:
    reference_id: USN-6898-3
  - url: https://usn.ubuntu.com/6898-4/
    reference_type:
    reference_id: USN-6898-4
  - url: https://usn.ubuntu.com/6917-1/
    reference_type:
    reference_id: USN-6917-1
  - url: https://usn.ubuntu.com/6918-1/
    reference_type:
    reference_id: USN-6918-1
  - url: https://usn.ubuntu.com/6919-1/
    reference_type:
    reference_id: USN-6919-1
  - url: https://usn.ubuntu.com/6927-1/
    reference_type:
    reference_id: USN-6927-1
  - url: https://usn.ubuntu.com/7019-1/
    reference_type:
    reference_id: USN-7019-1
  - url: https://usn.ubuntu.com/7461-1/
    reference_type:
    reference_id: USN-7461-1
  - url: https://usn.ubuntu.com/7461-2/
    reference_type:
    reference_id: USN-7461-2
  - url: https://usn.ubuntu.com/7462-1/
    reference_type:
    reference_id: USN-7462-1
  - url: https://usn.ubuntu.com/7462-2/
    reference_type:
    reference_id: USN-7462-2
  - url: https://usn.ubuntu.com/7463-1/
    reference_type:
    reference_id: USN-7463-1
