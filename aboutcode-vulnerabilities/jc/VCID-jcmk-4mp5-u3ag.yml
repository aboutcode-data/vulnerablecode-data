vulnerability_id: VCID-jcmk-4mp5-u3ag
aliases:
  - CVE-2024-46795
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  ksmbd: unset the binding mark of a reused connection

  Steve French reported null pointer dereference error from sha256 lib.
  cifs.ko can send session setup requests on reused connection.
  If reused connection is used for binding session, conn->binding can
  still remain true and generate_preauth_hash() will not set
  sess->Preauth_HashValue and it will be NULL.
  It is used as a material to create an encryption key in
  ksmbd_gen_smb311_encryptionkey. ->Preauth_HashValue cause null pointer
  dereference error from crypto_shash_update().

  BUG: kernel NULL pointer dereference, address: 0000000000000000
  #PF: supervisor read access in kernel mode
  #PF: error_code(0x0000) - not-present page
  PGD 0 P4D 0
  Oops: 0000 [#1] PREEMPT SMP PTI
  CPU: 8 PID: 429254 Comm: kworker/8:39
  Hardware name: LENOVO 20MAS08500/20MAS08500, BIOS N2CET69W (1.52 )
  Workqueue: ksmbd-io handle_ksmbd_work [ksmbd]
  RIP: 0010:lib_sha256_base_do_update.isra.0+0x11e/0x1d0 [sha256_ssse3]
  <TASK>
  ? show_regs+0x6d/0x80
  ? __die+0x24/0x80
  ? page_fault_oops+0x99/0x1b0
  ? do_user_addr_fault+0x2ee/0x6b0
  ? exc_page_fault+0x83/0x1b0
  ? asm_exc_page_fault+0x27/0x30
  ? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3]
  ? lib_sha256_base_do_update.isra.0+0x11e/0x1d0 [sha256_ssse3]
  ? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3]
  ? __pfx_sha256_transform_rorx+0x10/0x10 [sha256_ssse3]
  _sha256_update+0x77/0xa0 [sha256_ssse3]
  sha256_avx2_update+0x15/0x30 [sha256_ssse3]
  crypto_shash_update+0x1e/0x40
  hmac_update+0x12/0x20
  crypto_shash_update+0x1e/0x40
  generate_key+0x234/0x380 [ksmbd]
  generate_smb3encryptionkey+0x40/0x1c0 [ksmbd]
  ksmbd_gen_smb311_encryptionkey+0x72/0xa0 [ksmbd]
  ntlm_authenticate.isra.0+0x423/0x5d0 [ksmbd]
  smb2_sess_setup+0x952/0xaa0 [ksmbd]
  __process_request+0xa3/0x1d0 [ksmbd]
  __handle_ksmbd_work+0x1c4/0x2f0 [ksmbd]
  handle_ksmbd_work+0x2d/0xa0 [ksmbd]
  process_one_work+0x16c/0x350
  worker_thread+0x306/0x440
  ? __pfx_worker_thread+0x10/0x10
  kthread+0xef/0x120
  ? __pfx_kthread+0x10/0x10
  ret_from_fork+0x44/0x70
  ? __pfx_kthread+0x10/0x10
  ret_from_fork_asm+0x1b/0x30
  </TASK>
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-46795.json
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05537'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05565'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05574'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05558'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05547'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05552'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05588'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05606'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05628'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05631'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05685'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05597'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05576'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07938'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07735'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.0771'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07866'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07885'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07888'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07923'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07925'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07926'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.0793'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07949'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.0791'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00037'
    scoring_system: epss
    scoring_elements: '0.07892'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.05762'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.09703'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-46795
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-46795
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-46795.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-46795
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-46795
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/41bc256da7e47b679df87c7fc7a5b393052b9cce
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4c8496f44f5bb5c06cdef5eb130ab259643392a1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/78c5a6f1f630172b19af4912e755e1da93ef0ab5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/93d54a4b59c4b3d803d20aa645ab5ca71f3b3b02
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9914f1bd61d5e838bb1ab15a71076d37a6db65d1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2313143
    reference_type:
    reference_id: 2313143
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.11:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.11:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-46795
    reference_type:
    reference_id: CVE-2024-46795
  - url: https://usn.ubuntu.com/7100-1/
    reference_type:
    reference_id: USN-7100-1
  - url: https://usn.ubuntu.com/7100-2/
    reference_type:
    reference_id: USN-7100-2
  - url: https://usn.ubuntu.com/7123-1/
    reference_type:
    reference_id: USN-7123-1
  - url: https://usn.ubuntu.com/7144-1/
    reference_type:
    reference_id: USN-7144-1
  - url: https://usn.ubuntu.com/7154-1/
    reference_type:
    reference_id: USN-7154-1
  - url: https://usn.ubuntu.com/7154-2/
    reference_type:
    reference_id: USN-7154-2
  - url: https://usn.ubuntu.com/7155-1/
    reference_type:
    reference_id: USN-7155-1
  - url: https://usn.ubuntu.com/7156-1/
    reference_type:
    reference_id: USN-7156-1
  - url: https://usn.ubuntu.com/7194-1/
    reference_type:
    reference_id: USN-7194-1
  - url: https://usn.ubuntu.com/7196-1/
    reference_type:
    reference_id: USN-7196-1
