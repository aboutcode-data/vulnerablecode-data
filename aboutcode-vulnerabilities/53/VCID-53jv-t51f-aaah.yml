vulnerability_id: VCID-53jv-t51f-aaah
aliases:
  - CVE-2023-51652
  - GHSA-8x6f-956f-q43w
summary: OWASP AntiSamy .NET is a library for performing cleansing of HTML coming from untrusted
  sources. Prior to version 1.2.0, there is a potential for a mutation cross-site scripting
  (mXSS) vulnerability in AntiSamy caused by flawed parsing of the HTML being sanitized. To
  be subject to this vulnerability the `preserveComments` directive must be enabled in your
  policy file and also allow for certain tags at the same time. As a result, certain crafty
  inputs can result in elements in comment tags being interpreted as executable when using AntiSamy's
  sanitized output. This is patched in OWASP AntiSamy .NET 1.2.0 and later. See important remediation
  details in the reference given below. As a workaround, manually edit the AntiSamy policy file
  (e.g., antisamy.xml) by deleting the `preserveComments` directive or setting its value to
  `false`,  if present. Also it would be useful to make AntiSamy remove the `noscript` tag by
  adding a line described in the GitHub Security Advisory to the tag definitions under the `<tagrules>`
  node, or deleting it entirely if present. As the previously mentioned policy settings are
  preconditions for the mXSS attack to work, changing them as recommended should be sufficient
  to protect you against this vulnerability when using a vulnerable version of this library.
  However, the existing bug would still be present in AntiSamy or its parser dependency (HtmlAgilityPack).
  The safety of this workaround relies on configurations that may change in the future and don't
  address the root cause of the vulnerability. As such, it is strongly recommended to upgrade
  to a fixed version of AntiSamy.
severities:
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.21312'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.20829'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.21118'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.21204'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.21239'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.21309'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.21303'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00050'
    scoring_system: epss
    scoring_elements: '0.21330'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.25119'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.25143'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.25121'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24444'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24690'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24756'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.24853'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33331'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00454'
    scoring_system: epss
    scoring_elements: '0.46742'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.6403'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64036'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64052'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64057'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64058'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64039'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64025'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64045'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64048'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64067'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64053'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.63959'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.63936'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00515'
    scoring_system: epss
    scoring_elements: '0.64034'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70249'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70194'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70219'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.7025'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70271'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70274'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70246'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70255'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70251'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70257'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70267'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70268'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: '0.00677'
    scoring_system: epss
    scoring_elements: '0.70264'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-8x6f-956f-q43w
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet/commit/7e500daef6ad9c10e97c68feab78f4cb6e3083c6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet/commit/7e500daef6ad9c10e97c68feab78f4cb6e3083c6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-01-08T16:41:55Z/
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet/commit/7e500daef6ad9c10e97c68feab78f4cb6e3083c6
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet/commit/8117911933e75a25cd0054ef017577486338444a
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet/commit/8117911933e75a25cd0054ef017577486338444a
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-01-08T16:41:55Z/
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet/commit/8117911933e75a25cd0054ef017577486338444a
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet/security/advisories/GHSA-8x6f-956f-q43w
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet/security/advisories/GHSA-8x6f-956f-q43w
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-01-08T16:41:55Z/
    published_at: None
    url: https://github.com/spassarop/antisamy-dotnet/security/advisories/GHSA-8x6f-956f-q43w
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-51652
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-51652
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-51652
    reference_type:
    reference_id:
  - url: https://github.com/spassarop/antisamy-dotnet
    reference_type:
    reference_id:
  - url: https://github.com/spassarop/antisamy-dotnet/commit/7e500daef6ad9c10e97c68feab78f4cb6e3083c6
    reference_type:
    reference_id:
  - url: https://github.com/spassarop/antisamy-dotnet/commit/8117911933e75a25cd0054ef017577486338444a
    reference_type:
    reference_id:
  - url: https://github.com/spassarop/antisamy-dotnet/security/advisories/GHSA-8x6f-956f-q43w
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:spassarop:owasp_antisamy_.net:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:spassarop:owasp_antisamy_.net:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-51652
    reference_type:
    reference_id: CVE-2023-51652
  - url: https://github.com/advisories/GHSA-8x6f-956f-q43w
    reference_type:
    reference_id: GHSA-8x6f-956f-q43w
