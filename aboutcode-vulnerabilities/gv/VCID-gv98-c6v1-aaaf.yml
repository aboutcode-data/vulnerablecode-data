vulnerability_id: VCID-gv98-c6v1-aaaf
aliases:
  - CVE-2021-41090
  - GHSA-9c4x-5hgq-q3wh
summary: 'Grafana Agent is a telemetry collector for sending metrics, logs, and trace data to
  the opinionated Grafana observability stack. Prior to versions 0.20.1 and 0.21.2, inline secrets
  defined within a metrics instance config are exposed in plaintext over two endpoints: metrics
  instance configs defined in the base YAML file are exposed at `/-/config` and metrics instance
  configs defined for the scraping service are exposed at `/agent/api/v1/configs/:key`. Inline
  secrets will be exposed to anyone being able to reach these endpoints. If HTTPS with client
  authentication is not configured, these endpoints are accessible to unauthenticated users.
  Secrets found in these sections are used for delivering metrics to a Prometheus Remote Write
  system, authenticating against a system for discovering Prometheus targets, and authenticating
  against a system for collecting metrics. This does not apply for non-inlined secrets, such
  as `*_file` based secrets. This issue is patched in Grafana Agent versions 0.20.1 and 0.21.2.
  A few workarounds are available. Users who cannot upgrade should use non-inline secrets where
  possible. Users may also desire to restrict API access to Grafana Agent with some combination
  of restricting the network interfaces Grafana Agent listens on through `http_listen_address`
  in the `server` block, configuring Grafana Agent to use HTTPS with client authentication,
  and/or using firewall rules to restrict external access to Grafana Agent''s API.'
severities:
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69324'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69524'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69458'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69452'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69438'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69429'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69431'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69381'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69205'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69367'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69571'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00284'
    scoring_system: epss
    scoring_elements: '0.69540'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.70366'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.70192'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.70197'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00320'
    scoring_system: epss
    scoring_elements: '0.70176'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00662'
    scoring_system: epss
    scoring_elements: '0.68894'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00662'
    scoring_system: epss
    scoring_elements: '0.68789'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00662'
    scoring_system: epss
    scoring_elements: '0.68877'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00662'
    scoring_system: epss
    scoring_elements: '0.68869'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00662'
    scoring_system: epss
    scoring_elements: '0.68781'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71682'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.70761'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.70767'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.70751'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.70736'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.7161'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71636'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71664'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.7168'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71685'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71668'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71663'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71674'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71671'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71677'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00742'
    scoring_system: epss
    scoring_elements: '0.71681'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00747'
    scoring_system: epss
    scoring_elements: '0.70845'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00747'
    scoring_system: epss
    scoring_elements: '0.7085'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00747'
    scoring_system: epss
    scoring_elements: '0.70851'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00747'
    scoring_system: epss
    scoring_elements: '0.70842'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00747'
    scoring_system: epss
    scoring_elements: '0.70869'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '0.00837'
    scoring_system: epss
    scoring_elements: '0.59944'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/grafana/agent
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/agent
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/grafana/agent/commit/a5479755e946e5c7cddb793ee9adda8f5692ba11
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/agent/commit/a5479755e946e5c7cddb793ee9adda8f5692ba11
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/grafana/agent/commit/af7fb01e31fe2d389e5f1c36b399ddc46b412b21
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/agent/commit/af7fb01e31fe2d389e5f1c36b399ddc46b412b21
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/grafana/agent/pull/1152
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/agent/pull/1152
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/grafana/agent/releases/tag/v0.20.1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/agent/releases/tag/v0.20.1
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/grafana/agent/releases/tag/v0.21.2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/agent/releases/tag/v0.21.2
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/grafana/agent/security/advisories/GHSA-9c4x-5hgq-q3wh
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/agent/security/advisories/GHSA-9c4x-5hgq-q3wh
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41090
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41090
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41090
  - score: High
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2614
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20211229-0004
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20211229-0004
weaknesses:
  - CWE-312
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-41090
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/commit/a5479755e946e5c7cddb793ee9adda8f5692ba11
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/commit/af7fb01e31fe2d389e5f1c36b399ddc46b412b21
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/pull/1152
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/releases/tag/v0.20.1
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/releases/tag/v0.21.2
    reference_type:
    reference_id:
  - url: https://github.com/grafana/agent/security/advisories/GHSA-9c4x-5hgq-q3wh
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20211229-0004
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20211229-0004/
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/ASA-202112-12
    reference_type:
    reference_id: ASA-202112-12
  - url: https://security.archlinux.org/AVG-2614
    reference_type:
    reference_id: AVG-2614
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:grafana:agent:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:grafana:agent:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41090
    reference_type:
    reference_id: CVE-2021-41090
