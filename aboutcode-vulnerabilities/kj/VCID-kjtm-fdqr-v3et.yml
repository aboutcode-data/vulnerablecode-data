vulnerability_id: VCID-kjtm-fdqr-v3et
aliases:
  - CVE-2025-61912
  - GHSA-p34h-wq7j-h5v6
summary: "python-ldap is Vulnerable to Improper Encoding or Escaping of Output and Improper\
  \ Null Termination\n### Summary\n\n\n`ldap.dn.escape_dn_chars()` escapes `\\x00` incorrectly\
  \ by emitting a backslash followed by a literal NUL byte instead of the RFC-4514 hex form\
  \ `\\00`. Any application that uses this helper to construct DNs from untrusted input can\
  \ be made to consistently fail before a request is sent to the LDAP server (e.g., AD), resulting\
  \ in a client-side denial of service.\n\n\n\n### Details\n\n\n\nAffected function: `ldap.dn.escape_dn_chars(s)`\n\
  \nFile: Lib/ldap/dn.py\n\nBuggy behavior:\nFor NUL, the function does:\n\n`s = s.replace('\\\
  000', '\\\\\\000')  # backslash + literal NUL`\n\nThis produces Python strings which, when\
  \ passed to python-ldap APIs (e.g., `add_s`, `modify_s`, r`ename_s`, or used as search bases),\
  \ contain an embedded NUL. python-ldap then raises ValueError: embedded null character (or\
  \ otherwise fails) before any network I/O.\nWith correct RFC-4514 encoding (`\\00`), the client\
  \ proceeds and the server can apply its own syntax rules (e.g., AD will reject NUL in CN with\
  \ result: 34), proving the failure originates in the escaping helper.\n\nWhy it matters: Projects\
  \ follow the docs which state this function “should be used when building LDAP DN strings\
  \ from arbitrary input.” The function’s guarantee is therefore relied upon as a safety API.\
  \ A single NUL in attacker-controlled input reliably breaks client workflows (crash/unhandled\
  \ exception, stuck retries, poison queue record), i.e., a DoS.\n\nStandards: RFC 4514 requires\
  \ special characters and controls to be escaped using hex form; a literal NUL is not a valid\
  \ DN character.\n\nMinimal fix: Escape NUL as hex:\n\n`s = s.replace('\\x00', r'\\00')`\n\n\
  \n\n### PoC\n\nPrereqs: Any python-ldap install and a reachable LDAP server (for the second\
  \ half). The first half (client-side failure) does not require a live server.\n\n```import\
  \ ldap\nfrom ldap.dn import escape_dn_chars, str2dn\n\nl = ldap.initialize(\"ldap://10.0.1.11\"\
  )              # your lab DC/LDAP\nl.protocol_version = 3\nl.set_option(ldap.OPT_REFERRALS,\
  \ 0)\nl.simple_bind_s(r\"DSEC\\dani.aga\", \"PassAa1\")         \n\n# --- Attacker-controlled\
  \ value contains NUL ---\ncn = \"bad\\0name\"\nescaped_cn = escape_dn_chars(cn)\ndn = f\"\
  CN={escaped_cn},OU=Users,DC=dsec,DC=local\"\nattrs = [('objectClass', [b'user']), ('sAMAccountName',\
  \ [b'badsam'])]\n\nprint(\"=== BUGGY DN (contains literal NUL) ===\")\nprint(\"escaped_cn\
  \ repr:\", repr(escaped_cn))\nprint(\"dn repr:\", repr(dn))\nprint(\"contains NUL?:\", \"\\\
  x00\" in dn, \"at index:\", dn.find(\"\\x00\"))\n\nprint(\"=> add_s(buggy DN): expected client-side\
  \ failure (no server contact)\")\ntry:\n    l.add_s(dn, attrs)\n    print(\"add_s(buggy):\
  \ succeeded (unexpected)\")\nexcept Exception as e:\n    print(\"add_s(buggy):\", type(e).__name__,\
  \ e)  # ValueError: embedded null character\n\n# --- Correct hex escape demonstrates the client\
  \ proceeds to the server ---\nsafe_dn = dn.replace(\"\\x00\", r\"\\00\")                 #\
  \ RFC 4514-compliant\nprint(\"\\n=== HEX-ESCAPED DN (\\\\00) ===\")\nprint(\"safe_dn repr:\"\
  , repr(safe_dn))\nprint(\"=> sanity parse:\", str2dn(safe_dn))           # parses locally\n\
  \nprint(\"=> add_s(safe DN): reaches server (AD will likely reject with 34)\")\ntry:\n   \
  \ l.add_s(safe_dn, attrs)\n    print(\"add_s(safe): success (unlikely without required attrs/rights)\"\
  )\nexcept ldap.LDAPError as e:\n    print(\"add_s(safe):\", e.__class__.__name__, e)  # e.g.,\
  \ result 34 Invalid DN syntax (AD forbids NUL in CN)\n```\n\nObserved result (example):\n\n\
  `add_s(buggy): ValueError embedded null character` ← client-side DoS\n\n`add_s(safe): INVALID_DN_SYNTAX\
  \ (result 34, BAD_NAME)` ← request reached server; rejection due to server policy, not client\
  \ bug\n\n\n### Impact\n\nType: Denial of Service (client-side).\n\nWho is impacted: Any application\
  \ that uses ldap.dn.escape_dn_chars() to build DNs from (partially) untrusted input—e.g.,\
  \ user `creation/rename tools`, `sync/ETL jobs`, portals allowing self-service attributes,\
  \ device onboarding, batch imports. A single crafted value with `\\x00` reliably forces exceptions/failures\
  \ and can crash handlers or jam pipelines with poison records."
severities:
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-61912.json
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11697'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11751'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16129'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16118'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16123'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16156'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16172'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16164'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16049'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16101'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16116'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16109'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16176'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16184'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16221'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.21809'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.21868'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p34h-wq7j-h5v6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/python-ldap/python-ldap
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/python-ldap/python-ldap/commit/6ea80326a34ee6093219628d7690bced50c49a3f
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/python-ldap/python-ldap/commit/6ea80326a34ee6093219628d7690bced50c49a3f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-14T14:57:58Z/
    published_at: None
    url: https://github.com/python-ldap/python-ldap/commit/6ea80326a34ee6093219628d7690bced50c49a3f
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/python-ldap/python-ldap/releases/tag/python-ldap-3.4.5
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/python-ldap/python-ldap/releases/tag/python-ldap-3.4.5
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-14T14:57:58Z/
    published_at: None
    url: https://github.com/python-ldap/python-ldap/releases/tag/python-ldap-3.4.5
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/python-ldap/python-ldap/security/advisories/GHSA-p34h-wq7j-h5v6
  - score: '5.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:N/E:P
    published_at: None
    url: https://github.com/python-ldap/python-ldap/security/advisories/GHSA-p34h-wq7j-h5v6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/python-ldap/python-ldap/security/advisories/GHSA-p34h-wq7j-h5v6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-10-14T14:57:58Z/
    published_at: None
    url: https://github.com/python-ldap/python-ldap/security/advisories/GHSA-p34h-wq7j-h5v6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-61912
weaknesses:
  - CWE-170
  - CWE-1035
  - CWE-937
  - CWE-116
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-61912.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-61912
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-61912
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/python-ldap/python-ldap
    reference_type:
    reference_id:
  - url: https://github.com/python-ldap/python-ldap/commit/6ea80326a34ee6093219628d7690bced50c49a3f
    reference_type:
    reference_id:
  - url: https://github.com/python-ldap/python-ldap/releases/tag/python-ldap-3.4.5
    reference_type:
    reference_id:
  - url: https://github.com/python-ldap/python-ldap/security/advisories/GHSA-p34h-wq7j-h5v6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-61912
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1117859
    reference_type:
    reference_id: 1117859
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2403230
    reference_type:
    reference_id: 2403230
  - url: https://github.com/advisories/GHSA-p34h-wq7j-h5v6
    reference_type:
    reference_id: GHSA-p34h-wq7j-h5v6
  - url: https://usn.ubuntu.com/7828-1/
    reference_type:
    reference_id: USN-7828-1
