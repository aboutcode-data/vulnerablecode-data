vulnerability_id: VCID-aukx-3jc9-aaap
aliases:
  - CVE-2023-51447
  - GHSA-9w99-78rj-hmxq
summary: Decidim is a participatory democracy framework. Starting in version 0.27.0 and prior
  to versions 0.27.5 and 0.28.0, the dynamic file upload feature is subject to potential cross-site
  scripting attacks in case the attacker manages to modify the file names of the records being
  uploaded to the server. This appears in sections where the user controls the file upload dialogs
  themselves and has the technical knowledge to change the file names through the dynamic upload
  endpoint. Therefore I believe it would require the attacker to control the whole session of
  the particular user but in any case, this needs to be fixed. Successful exploit of this vulnerability
  would require the user to have successfully uploaded a file blob to the server with a malicious
  file name and then have the possibility to direct the other user to the edit page of the record
  where the attachment is attached. The users are able to craft the direct upload requests themselves
  controlling the file name that gets stored to the database. The attacker is able to change
  the filename e.g. to `<svg onload=alert('XSS')>` if they know how to craft these requests
  themselves. And then enter the returned blob ID to the form inputs manually by modifying the
  edit page source. Versions 0.27.5 and 0.28.0 contain a patch for this issue. As a workaround,
  disable dynamic uploads for the instance, e.g. from proposals.
severities:
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11518'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11700'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11632'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11609'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11214'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12271'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12177'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.12119'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11819'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11764'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11709'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.11696'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32751'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32373'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32394'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00069'
    scoring_system: epss
    scoring_elements: '0.32392'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57078'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.56979'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.5702'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57071'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57099'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57111'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57043'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.5706'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57065'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57072'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57076'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57092'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00358'
    scoring_system: epss
    scoring_elements: '0.57087'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70115'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.7011'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70119'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70123'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70107'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70091'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.7001'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70002'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.7008'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70089'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70108'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70125'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70102'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.70099'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: '0.01033'
    scoring_system: epss
    scoring_elements: '0.63783'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-9w99-78rj-hmxq
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/decidim/decidim
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/decidim/decidim
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/decidim/decidim/commit/aaf72787cf18beeeb6a771c1f7cbb7654b073423
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/decidim/decidim/commit/aaf72787cf18beeeb6a771c1f7cbb7654b073423
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/decidim/decidim/pull/11612
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/decidim/decidim/pull/11612
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/decidim/decidim/releases/tag/v0.27.5
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/decidim/decidim/releases/tag/v0.27.5
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/decidim/decidim/releases/tag/v0.28.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/decidim/decidim/releases/tag/v0.28.0
  - score: '6.3'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://github.com/decidim/decidim/security/advisories/GHSA-9w99-78rj-hmxq
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/decidim/decidim/security/advisories/GHSA-9w99-78rj-hmxq
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/decidim/decidim/security/advisories/GHSA-9w99-78rj-hmxq
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/rails/rails/blob/a967d355c6fee9ad9b8bd115d43bc8b0fc207e7e/activestorage/app/controllers/active_storage/direct_uploads_controller.rb#L14
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rails/rails/blob/a967d355c6fee9ad9b8bd115d43bc8b0fc207e7e/activestorage/app/controllers/active_storage/direct_uploads_controller.rb#L14
  - score: '5.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-51447
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-51447
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-51447
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim/commit/aaf72787cf18beeeb6a771c1f7cbb7654b073423
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim/pull/11612
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim/releases/tag/v0.27.5
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim/releases/tag/v0.28.0
    reference_type:
    reference_id:
  - url: https://github.com/decidim/decidim/security/advisories/GHSA-9w99-78rj-hmxq
    reference_type:
    reference_id:
  - url: https://github.com/rails/rails/blob/a967d355c6fee9ad9b8bd115d43bc8b0fc207e7e/activestorage/app/controllers/active_storage/direct_uploads_controller.rb#L14
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:decidim:decidim:*:*:*:*:*:ruby:*:*
    reference_type:
    reference_id: cpe:2.3:a:decidim:decidim:*:*:*:*:*:ruby:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-51447
    reference_type:
    reference_id: CVE-2023-51447
  - url: https://github.com/advisories/GHSA-9w99-78rj-hmxq
    reference_type:
    reference_id: GHSA-9w99-78rj-hmxq
