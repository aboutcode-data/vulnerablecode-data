vulnerability_id: VCID-scfq-xdb8-aaah
aliases:
  - CVE-2021-40153
summary: squashfs_opendir in unsquash-1.c in Squashfs-Tools 4.5 stores the filename in the directory
  entry; this is then used by unsquashfs to create the new file during the unsquash. The filename
  is not validated for traversal outside of the destination directory, and thus allows writing
  to locations outside of the destination.
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2021/CVE-2021-40153.html
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-40153.json
  - score: '0.00455'
    scoring_system: epss
    scoring_elements: '0.74947'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00455'
    scoring_system: epss
    scoring_elements: '0.74957'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00455'
    scoring_system: epss
    scoring_elements: '0.75144'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00455'
    scoring_system: epss
    scoring_elements: '0.74933'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61671'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61692'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61707'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.6173'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61726'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63141'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63104'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63145'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63149'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63162'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63158'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63148'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63142'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63064'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63173'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.63168'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61703'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61601'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61551'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.6172'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61647'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.6165'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61678'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61698'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.00466'
    scoring_system: epss
    scoring_elements: '0.61668'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85829'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85659'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85751'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85771'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85777'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85806'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85805'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85808'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85788'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85836'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01202'
    scoring_system: epss
    scoring_elements: '0.85859'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: '0.01918'
    scoring_system: epss
    scoring_elements: '0.72367'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugs.launchpad.net/ubuntu/+source/squashfs-tools/+bug/1941790
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1998621
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40153
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/plougher/squashfs-tools/commit/79b5a555058eef4e1e7ff220c344d39f8cd09646
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/plougher/squashfs-tools/issues/72
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40153
  - score: '8.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40153
  - score: '8.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40153
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2328
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-5057-1
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-5078-2
weaknesses:
  - CWE-22
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2021/CVE-2021-40153.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-40153.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-40153
    reference_type:
    reference_id:
  - url: https://bugs.launchpad.net/ubuntu/+source/squashfs-tools/+bug/1941790
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40153
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/plougher/squashfs-tools/commit/79b5a555058eef4e1e7ff220c344d39f8cd09646
    reference_type:
    reference_id:
  - url: https://github.com/plougher/squashfs-tools/issues/72
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2021/08/msg00030.html
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/GSMRKVJMJFX3MB7D3PXJSYY3TLZROE5S/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RAOZ4BKWAC4Y3U2K5MMW3S77HWWXHQDL/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GSMRKVJMJFX3MB7D3PXJSYY3TLZROE5S/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RAOZ4BKWAC4Y3U2K5MMW3S77HWWXHQDL/
    reference_type:
    reference_id:
  - url: https://security.gentoo.org/glsa/202305-29
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5057-1
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5078-2
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2021/dsa-4967
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1998621
    reference_type:
    reference_id: '1998621'
  - url: https://security.archlinux.org/AVG-2328
    reference_type:
    reference_id: AVG-2328
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:squashfs-tools_project:squashfs-tools:4.5:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:squashfs-tools_project:squashfs-tools:4.5:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:redhat:enterprise_linux:7.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:redhat:enterprise_linux:7.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-40153
    reference_type:
    reference_id: CVE-2021-40153
  - url: https://access.redhat.com/errata/RHSA-2024:2396
    reference_type:
    reference_id: RHSA-2024:2396
  - url: https://access.redhat.com/errata/RHSA-2024:3139
    reference_type:
    reference_id: RHSA-2024:3139
  - url: https://usn.ubuntu.com/5057-1/
    reference_type:
    reference_id: USN-5057-1
  - url: https://usn.ubuntu.com/5078-2/
    reference_type:
    reference_id: USN-5078-2
