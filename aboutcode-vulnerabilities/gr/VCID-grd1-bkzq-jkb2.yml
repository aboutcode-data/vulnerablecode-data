vulnerability_id: VCID-grd1-bkzq-jkb2
aliases:
  - CVE-2025-39824
summary: 'In the Linux kernel, the following vulnerability has been resolved:  HID: asus: fix
  UAF via HID_CLAIMED_INPUT validation  After hid_hw_start() is called hidinput_connect() will
  eventually be called to set up the device with the input layer since the HID_CONNECT_DEFAULT
  connect mask is used. During hidinput_connect() all input and output reports are processed
  and corresponding hid_inputs are allocated and configured via hidinput_configure_usages().
  This process involves slot tagging report fields and configuring usages by setting relevant
  bits in the capability bitmaps. However it is possible that the capability bitmaps are not
  set at all leading to the subsequent hidinput_has_been_populated() check to fail leading to
  the freeing of the hid_input and the underlying input device.  This becomes problematic because
  a malicious HID device like a ASUS ROG N-Key keyboard can trigger the above scenario via a
  specially crafted descriptor which then leads to a user-after-free when the name of the freed
  input device is written to later on after hid_hw_start(). Below, report 93 intentionally utilises
  the HID_UP_UNDEFINED Usage Page which is skipped during usage configuration, leading to the
  frees.  0x05, 0x0D,        // Usage Page (Digitizer) 0x09, 0x05,        // Usage (Touch Pad)
  0xA1, 0x01,        // Collection (Application) 0x85, 0x0D,        //   Report ID (13) 0x06,
  0x00, 0xFF,  //   Usage Page (Vendor Defined 0xFF00) 0x09, 0xC5,        //   Usage (0xC5)
  0x15, 0x00,        //   Logical Minimum (0) 0x26, 0xFF, 0x00,  //   Logical Maximum (255)
  0x75, 0x08,        //   Report Size (8) 0x95, 0x04,        //   Report Count (4) 0xB1, 0x02,        //   Feature
  (Data,Var,Abs) 0x85, 0x5D,        //   Report ID (93) 0x06, 0x00, 0x00,  //   Usage Page (Undefined)
  0x09, 0x01,        //   Usage (0x01) 0x15, 0x00,        //   Logical Minimum (0) 0x26, 0xFF,
  0x00,  //   Logical Maximum (255) 0x75, 0x08,        //   Report Size (8) 0x95, 0x1B,        //   Report
  Count (27) 0x81, 0x02,        //   Input (Data,Var,Abs) 0xC0,              // End Collection  Below
  is the KASAN splat after triggering the UAF:  [   21.672709] ==================================================================
  [   21.673700] BUG: KASAN: slab-use-after-free in asus_probe+0xeeb/0xf80 [   21.673700] Write
  of size 8 at addr ffff88810a0ac000 by task kworker/1:2/54 [   21.673700] [   21.673700] CPU:
  1 UID: 0 PID: 54 Comm: kworker/1:2 Not tainted 6.16.0-rc4-g9773391cf4dd-dirty #36 PREEMPT(voluntary)
  [   21.673700] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1
  04/01/2014 [   21.673700] Call Trace: [   21.673700]  <TASK> [   21.673700]  dump_stack_lvl+0x5f/0x80
  [   21.673700]  print_report+0xd1/0x660 [   21.673700]  kasan_report+0xe5/0x120 [   21.673700]  __asan_report_store8_noabort+0x1b/0x30
  [   21.673700]  asus_probe+0xeeb/0xf80 [   21.673700]  hid_device_probe+0x2ee/0x700 [   21.673700]  really_probe+0x1c6/0x6b0
  [   21.673700]  __driver_probe_device+0x24f/0x310 [   21.673700]  driver_probe_device+0x4e/0x220
  [...] [   21.673700] [   21.673700] Allocated by task 54: [   21.673700]  kasan_save_stack+0x3d/0x60
  [   21.673700]  kasan_save_track+0x18/0x40 [   21.673700]  kasan_save_alloc_info+0x3b/0x50
  [   21.673700]  __kasan_kmalloc+0x9c/0xa0 [   21.673700]  __kmalloc_cache_noprof+0x139/0x340
  [   21.673700]  input_allocate_device+0x44/0x370 [   21.673700]  hidinput_connect+0xcb6/0x2630
  [   21.673700]  hid_connect+0xf74/0x1d60 [   21.673700]  hid_hw_start+0x8c/0x110 [   21.673700]  asus_probe+0x5a3/0xf80
  [   21.673700]  hid_device_probe+0x2ee/0x700 [   21.673700]  really_probe+0x1c6/0x6b0 [   21.673700]  __driver_probe_device+0x24f/0x310
  [   21.673700]  driver_probe_device+0x4e/0x220 [...] [   21.673700] [   21.673700] Freed by
  task 54: [   21.673700]  kasan_save_stack+0x3d/0x60 [   21.673700]  kasan_save_track+0x18/0x40
  [   21.673700]  kasan_save_free_info+0x3f/0x60 [   21.673700]  __kasan_slab_free+0x3c/0x50
  [   21.673700]  kfre ---truncated---'
severities:
  - score: '6.6'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:P/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39824.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39824.json
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05164'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05085'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08001'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08009'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08145'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0808'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08136'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08117'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08148'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08235'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08288'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08304'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08283'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08106'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07772'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07843'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0783'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0801'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09362'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09308'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09293'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09402'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0934'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09352'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09363'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09383'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09511'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09468'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15522'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '0.00049'
    scoring_system: epss
    scoring_elements: '0.15541'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39824.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-39824
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-39824
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2395784
    reference_type:
    reference_id: 2395784
  - url: https://usn.ubuntu.com/7909-1/
    reference_type:
    reference_id: USN-7909-1
  - url: https://usn.ubuntu.com/7909-2/
    reference_type:
    reference_id: USN-7909-2
  - url: https://usn.ubuntu.com/7909-3/
    reference_type:
    reference_id: USN-7909-3
  - url: https://usn.ubuntu.com/7909-4/
    reference_type:
    reference_id: USN-7909-4
  - url: https://usn.ubuntu.com/7909-5/
    reference_type:
    reference_id: USN-7909-5
  - url: https://usn.ubuntu.com/7910-1/
    reference_type:
    reference_id: USN-7910-1
  - url: https://usn.ubuntu.com/7910-2/
    reference_type:
    reference_id: USN-7910-2
  - url: https://usn.ubuntu.com/7933-1/
    reference_type:
    reference_id: USN-7933-1
  - url: https://usn.ubuntu.com/7938-1/
    reference_type:
    reference_id: USN-7938-1
