vulnerability_id: VCID-k4sc-7v4g-nyau
aliases:
  - CVE-2025-38677
summary: 'In the Linux kernel, the following vulnerability has been resolved:  f2fs: fix to
  avoid out-of-boundary access in dnode page  As Jiaming Zhang reported:   <TASK>  __dump_stack
  lib/dump_stack.c:94 [inline]  dump_stack_lvl+0x1c1/0x2a0 lib/dump_stack.c:120  print_address_description
  mm/kasan/report.c:378 [inline]  print_report+0x17e/0x800 mm/kasan/report.c:480  kasan_report+0x147/0x180
  mm/kasan/report.c:593  data_blkaddr fs/f2fs/f2fs.h:3053 [inline]  f2fs_data_blkaddr fs/f2fs/f2fs.h:3058
  [inline]  f2fs_get_dnode_of_data+0x1a09/0x1c40 fs/f2fs/node.c:855  f2fs_reserve_block+0x53/0x310
  fs/f2fs/data.c:1195  prepare_write_begin fs/f2fs/data.c:3395 [inline]  f2fs_write_begin+0xf39/0x2190
  fs/f2fs/data.c:3594  generic_perform_write+0x2c7/0x910 mm/filemap.c:4112  f2fs_buffered_write_iter
  fs/f2fs/file.c:4988 [inline]  f2fs_file_write_iter+0x1ec8/0x2410 fs/f2fs/file.c:5216  new_sync_write
  fs/read_write.c:593 [inline]  vfs_write+0x546/0xa90 fs/read_write.c:686  ksys_write+0x149/0x250
  fs/read_write.c:738  do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]  do_syscall_64+0xf3/0x3d0
  arch/x86/entry/syscall_64.c:94  entry_SYSCALL_64_after_hwframe+0x77/0x7f  The root cause is
  in the corrupted image, there is a dnode has the same node id w/ its inode, so during f2fs_get_dnode_of_data(),
  it tries to access block address in dnode at offset 934, however it parses the dnode as inode
  node, so that get_dnode_addr() returns 360, then it tries to access page address from 360
  + 934 * 4 = 4096 w/ 4 bytes.  To fix this issue, let''s add sanity check for node id of all
  direct nodes during f2fs_get_dnode_of_data().'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38677.json
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06795'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07549'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07653'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07628'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07738'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07777'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0781'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07772'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07843'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0783'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0801'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08001'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0754'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08009'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07524'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09228'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0921'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.092'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09255'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09208'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09261'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09305'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09348'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09362'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.15509'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.15531'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.15637'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.15596'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.15574'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.15566'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.15508'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19183'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19168'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19134'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00061'
    scoring_system: epss
    scoring_elements: '0.19083'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.26564'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
  - score: '5.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38677.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38677
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38677
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2392113
    reference_type:
    reference_id: 2392113
  - url: https://usn.ubuntu.com/7909-1/
    reference_type:
    reference_id: USN-7909-1
  - url: https://usn.ubuntu.com/7909-2/
    reference_type:
    reference_id: USN-7909-2
  - url: https://usn.ubuntu.com/7909-3/
    reference_type:
    reference_id: USN-7909-3
  - url: https://usn.ubuntu.com/7909-4/
    reference_type:
    reference_id: USN-7909-4
  - url: https://usn.ubuntu.com/7909-5/
    reference_type:
    reference_id: USN-7909-5
  - url: https://usn.ubuntu.com/7910-1/
    reference_type:
    reference_id: USN-7910-1
  - url: https://usn.ubuntu.com/7910-2/
    reference_type:
    reference_id: USN-7910-2
  - url: https://usn.ubuntu.com/7933-1/
    reference_type:
    reference_id: USN-7933-1
  - url: https://usn.ubuntu.com/7938-1/
    reference_type:
    reference_id: USN-7938-1
