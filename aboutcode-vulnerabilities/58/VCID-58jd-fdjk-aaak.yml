vulnerability_id: VCID-58jd-fdjk-aaak
aliases:
  - CVE-2024-26586
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mlxsw: spectrum_acl_tcam: Fix stack corruption

  When tc filters are first added to a net device, the corresponding local
  port gets bound to an ACL group in the device. The group contains a list
  of ACLs. In turn, each ACL points to a different TCAM region where the
  filters are stored. During forwarding, the ACLs are sequentially
  evaluated until a match is found.

  One reason to place filters in different regions is when they are added
  with decreasing priorities and in an alternating order so that two
  consecutive filters can never fit in the same region because of their
  key usage.

  In Spectrum-2 and newer ASICs the firmware started to report that the
  maximum number of ACLs in a group is more than 16, but the layout of the
  register that configures ACL groups (PAGT) was not updated to account
  for that. It is therefore possible to hit stack corruption [1] in the
  rare case where more than 16 ACLs in a group are required.

  Fix by limiting the maximum ACL group size to the minimum between what
  the firmware reports and the maximum ACLs that fit in the PAGT register.

  Add a test case to make sure the machine does not crash when this
  condition is hit.

  [1]
  Kernel panic - not syncing: stack-protector: Kernel stack is corrupted in: mlxsw_sp_acl_tcam_group_update+0x116/0x120
  [...]
   dump_stack_lvl+0x36/0x50
   panic+0x305/0x330
   __stack_chk_fail+0x15/0x20
   mlxsw_sp_acl_tcam_group_update+0x116/0x120
   mlxsw_sp_acl_tcam_group_region_attach+0x69/0x110
   mlxsw_sp_acl_tcam_vchunk_get+0x492/0xa20
   mlxsw_sp_acl_tcam_ventry_add+0x25/0xe0
   mlxsw_sp_acl_rule_add+0x47/0x240
   mlxsw_sp_flower_replace+0x1a9/0x1d0
   tc_setup_cb_add+0xdc/0x1c0
   fl_hw_replace_filter+0x146/0x1f0
   fl_change+0xc17/0x1360
   tc_new_tfilter+0x472/0xb90
   rtnetlink_rcv_msg+0x313/0x3b0
   netlink_rcv_skb+0x58/0x100
   netlink_unicast+0x244/0x390
   netlink_sendmsg+0x1e4/0x440
   ____sys_sendmsg+0x164/0x260
   ___sys_sendmsg+0x9a/0xe0
   __sys_sendmsg+0x7a/0xc0
   do_syscall_64+0x40/0xe0
   entry_SYSCALL_64_after_hwframe+0x63/0x6b
severities:
  - score: 7
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2024:2394
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-01-23T16:22:59Z/
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2024:2394
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2024:3810
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-02-08T17:12:36Z/
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2024:3810
  - score: '6.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26586.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01003'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0102'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01022'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0101'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01025'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01013'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01029'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01012'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01021'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01015'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01005'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.23014'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.22921'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.22851'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.22996'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.23021'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.23013'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.2296'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.22924'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.22939'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.2298'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.2294'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.22927'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.22899'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '0.00378'
    scoring_system: epss
    scoring_elements: '0.4236'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-02-22T20:41:19Z/
    published_at: None
    url: https://git.kernel.org/stable/c/2f5e1565740490706332c06f36211d4ce0f88e62
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-02-22T20:41:19Z/
    published_at: None
    url: https://git.kernel.org/stable/c/348112522a35527c5bcba933b9fefb40a4f44f15
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-02-22T20:41:19Z/
    published_at: None
    url: https://git.kernel.org/stable/c/483ae90d8f976f8339cf81066312e1329f2d3706
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-02-22T20:41:19Z/
    published_at: None
    url: https://git.kernel.org/stable/c/56750ea5d15426b5f307554e7699e8b5f76c3182
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-02-22T20:41:19Z/
    published_at: None
    url: https://git.kernel.org/stable/c/6fd24675188d354b1cad47462969afa2ab09d819
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-02-22T20:41:19Z/
    published_at: None
    url: https://git.kernel.org/stable/c/a361c2c1da5dbb13ca67601cf961ab3ad68af383
  - score: '6.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26586
  - score: '6.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26586
weaknesses:
  - CWE-787
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26586.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-26586
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26586
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2f5e1565740490706332c06f36211d4ce0f88e62
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/348112522a35527c5bcba933b9fefb40a4f44f15
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/483ae90d8f976f8339cf81066312e1329f2d3706
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/56750ea5d15426b5f307554e7699e8b5f76c3182
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6fd24675188d354b1cad47462969afa2ab09d819
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/a361c2c1da5dbb13ca67601cf961ab3ad68af383
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00016.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2265645
    reference_type:
    reference_id: 2265645
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26586
    reference_type:
    reference_id: CVE-2024-26586
  - url: https://access.redhat.com/errata/RHSA-2024:2006
    reference_type:
    reference_id: RHSA-2024:2006
  - url: https://access.redhat.com/errata/RHSA-2024:2008
    reference_type:
    reference_id: RHSA-2024:2008
  - url: https://access.redhat.com/errata/RHSA-2024:2394
    reference_type:
    reference_id: RHSA-2024:2394
  - url: https://access.redhat.com/errata/RHSA-2024:2582
    reference_type:
    reference_id: RHSA-2024:2582
  - url: https://access.redhat.com/errata/RHSA-2024:2585
    reference_type:
    reference_id: RHSA-2024:2585
  - url: https://access.redhat.com/errata/RHSA-2024:2674
    reference_type:
    reference_id: RHSA-2024:2674
  - url: https://access.redhat.com/errata/RHSA-2024:3414
    reference_type:
    reference_id: RHSA-2024:3414
  - url: https://access.redhat.com/errata/RHSA-2024:3421
    reference_type:
    reference_id: RHSA-2024:3421
  - url: https://access.redhat.com/errata/RHSA-2024:3810
    reference_type:
    reference_id: RHSA-2024:3810
  - url: https://access.redhat.com/errata/RHSA-2024:5101
    reference_type:
    reference_id: RHSA-2024:5101
  - url: https://access.redhat.com/errata/RHSA-2024:5102
    reference_type:
    reference_id: RHSA-2024:5102
  - url: https://usn.ubuntu.com/6725-1/
    reference_type:
    reference_id: USN-6725-1
  - url: https://usn.ubuntu.com/6725-2/
    reference_type:
    reference_id: USN-6725-2
  - url: https://usn.ubuntu.com/6765-1/
    reference_type:
    reference_id: USN-6765-1
  - url: https://usn.ubuntu.com/6818-1/
    reference_type:
    reference_id: USN-6818-1
  - url: https://usn.ubuntu.com/6818-2/
    reference_type:
    reference_id: USN-6818-2
  - url: https://usn.ubuntu.com/6818-3/
    reference_type:
    reference_id: USN-6818-3
  - url: https://usn.ubuntu.com/6818-4/
    reference_type:
    reference_id: USN-6818-4
  - url: https://usn.ubuntu.com/6819-1/
    reference_type:
    reference_id: USN-6819-1
  - url: https://usn.ubuntu.com/6819-2/
    reference_type:
    reference_id: USN-6819-2
  - url: https://usn.ubuntu.com/6819-3/
    reference_type:
    reference_id: USN-6819-3
  - url: https://usn.ubuntu.com/6819-4/
    reference_type:
    reference_id: USN-6819-4
  - url: https://usn.ubuntu.com/6896-1/
    reference_type:
    reference_id: USN-6896-1
  - url: https://usn.ubuntu.com/6896-2/
    reference_type:
    reference_id: USN-6896-2
  - url: https://usn.ubuntu.com/6896-3/
    reference_type:
    reference_id: USN-6896-3
  - url: https://usn.ubuntu.com/6896-4/
    reference_type:
    reference_id: USN-6896-4
  - url: https://usn.ubuntu.com/6896-5/
    reference_type:
    reference_id: USN-6896-5
