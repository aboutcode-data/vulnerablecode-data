vulnerability_id: VCID-qkdw-3g98-3qhk
aliases:
  - CVE-2022-49744
summary: 'In the Linux kernel, the following vulnerability has been resolved:  mm/uffd: fix
  pte marker when fork() without fork event  Patch series "mm: Fixes on pte markers".  Patch
  1 resolves the syzkiller report from Pengfei.  Patch 2 further harden pte markers when used
  with the recent swapin error markers.  The major case is we should persist a swapin error
  marker after fork(), so child shouldn''t read a corrupted page.   This patch (of 2):  When
  fork(), dst_vma is not guaranteed to have VM_UFFD_WP even if src may have it and has pte marker
  installed.  The warning is improper along with the comment.  The right thing is to inherit
  the pte marker when needed, or keep the dst pte empty.  A vague guess is this happened by
  an accident when there''s the prior patch to introduce src/dst vma into this helper during
  the uffd-wp feature got developed and I probably messed up in the rebase, since if we replace
  dst_vma with src_vma the warning & comment it all makes sense too.  Hugetlb did exactly the
  right here (copy_hugetlb_page_range()).  Fix the general path.  Reproducer:  https://github.com/xupengfe/syzkaller_logs/blob/main/221208_115556_copy_page_range/repro.c  Bugzilla
  report: https://bugzilla.kernel.org/show_bug.cgi?id=216808'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49744.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.01571'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02645'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02651'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03829'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03837'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03861'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03859'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03881'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03912'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03906'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03901'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03895'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03882'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04946'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04969'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05001'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04986'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04962'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04951'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04923'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04919'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04929'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04931'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04937'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04944'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03839'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03828'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03826'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05568'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-49744.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-49744
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/2d11727655bf931776fb541f5862daf04bd5bf02
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/49d6d7fb631345b0f2957a7c4be24ad63903150f
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355495
    reference_type:
    reference_id: 2355495
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-49744
    reference_type:
    reference_id: CVE-2022-49744
