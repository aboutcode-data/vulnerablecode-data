vulnerability_id: VCID-7n93-f75r-aaag
aliases:
  - CVE-2022-21668
  - GHSA-qc9x-gjcv-465w
  - PYSEC-2022-6
summary: pipenv is a Python development workflow tool. Starting with version 2018.10.9 and prior
  to version 2022.1.8, a flaw in pipenv's parsing of requirements files allows an attacker to
  insert a specially crafted string inside a comment anywhere within a requirements.txt file,
  which will cause victims who use pipenv to install the requirements file to download dependencies
  from a package index server controlled by the attacker. By embedding malicious code in packages
  served from their malicious index server, the attacker can trigger arbitrary remote code execution
  (RCE) on the victims' systems. If an attacker is able to hide a malicious `--index-url` option
  in a requirements file that a victim installs with pipenv, the attacker can embed arbitrary
  malicious code in packages served from their malicious index server that will be executed
  on the victim's host during installation (remote code execution/RCE). When pip installs from
  a source distribution, any code in the setup.py is executed by the install process. This issue
  is patched in version 2022.1.8. The GitHub Security Advisory contains more information about
  this vulnerability.
severities:
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.51312'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.51007'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.51028'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00146'
    scoring_system: epss
    scoring_elements: '0.51025'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68646'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68516'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68752'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68704'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68688'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68895'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68863'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68843'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68773'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68769'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68756'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00273'
    scoring_system: epss
    scoring_elements: '0.68749'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00431'
    scoring_system: epss
    scoring_elements: '0.59754'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00431'
    scoring_system: epss
    scoring_elements: '0.59704'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00453'
    scoring_system: epss
    scoring_elements: '0.60984'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00453'
    scoring_system: epss
    scoring_elements: '0.60992'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.62218'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.62233'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.62252'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.62234'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.62227'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.62207'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.62223'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.62245'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.62244'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63568'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63607'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63643'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63668'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63673'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63641'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.6364'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63644'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63646'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63653'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63663'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63666'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.00477'
    scoring_system: epss
    scoring_elements: '0.63652'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.01256'
    scoring_system: epss
    scoring_elements: '0.7825'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: '0.06009'
    scoring_system: epss
    scoring_elements: '0.84076'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-qc9x-gjcv-465w
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/pipenv/PYSEC-2022-6.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/pipenv/PYSEC-2022-6.yaml
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/pipenv
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/pipenv
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/pipenv/commit/439782a8ae36c4762c88e43d5f0d8e563371b46f
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/pipenv/commit/439782a8ae36c4762c88e43d5f0d8e563371b46f
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/pipenv/releases/tag/v2022.1.8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/pipenv/releases/tag/v2022.1.8
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/pipenv/security/advisories/GHSA-qc9x-gjcv-465w
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/56HBA3EOSLEDNCCBJVHE6DO34P56EOUM
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/56HBA3EOSLEDNCCBJVHE6DO34P56EOUM
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KCROBYHUS6DKQPCXBRPCZ5CDBNQTYAWT
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KCROBYHUS6DKQPCXBRPCZ5CDBNQTYAWT
  - score: '8.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QHQRIWKDP3SVJABAPEXBIQPKDI6UP7G4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QHQRIWKDP3SVJABAPEXBIQPKDI6UP7G4
  - score: '9.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:C/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21668
  - score: '8.6'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21668
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21668
weaknesses:
  - CWE-20
  - CWE-1284
  - CWE-937
  - CWE-1035
  - CWE-190
  - CWE-77
  - CWE-78
  - CWE-791
  - CWE-427
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-21668
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pipenv/PYSEC-2022-6.yaml
    reference_type:
    reference_id:
  - url: https://github.com/pypa/pipenv
    reference_type:
    reference_id:
  - url: https://github.com/pypa/pipenv/commit/439782a8ae36c4762c88e43d5f0d8e563371b46f
    reference_type:
    reference_id:
  - url: https://github.com/pypa/pipenv/releases/tag/v2022.1.8
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/56HBA3EOSLEDNCCBJVHE6DO34P56EOUM/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KCROBYHUS6DKQPCXBRPCZ5CDBNQTYAWT/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QHQRIWKDP3SVJABAPEXBIQPKDI6UP7G4/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/56HBA3EOSLEDNCCBJVHE6DO34P56EOUM
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/56HBA3EOSLEDNCCBJVHE6DO34P56EOUM/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KCROBYHUS6DKQPCXBRPCZ5CDBNQTYAWT
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KCROBYHUS6DKQPCXBRPCZ5CDBNQTYAWT/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QHQRIWKDP3SVJABAPEXBIQPKDI6UP7G4
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QHQRIWKDP3SVJABAPEXBIQPKDI6UP7G4/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:pypa:pipenv:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:pypa:pipenv:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-21668
    reference_type:
    reference_id: CVE-2022-21668
  - url: https://github.com/advisories/GHSA-qc9x-gjcv-465w
    reference_type:
    reference_id: GHSA-qc9x-gjcv-465w
  - url: https://github.com/pypa/pipenv/security/advisories/GHSA-qc9x-gjcv-465w
    reference_type:
    reference_id: GHSA-qc9x-gjcv-465w
