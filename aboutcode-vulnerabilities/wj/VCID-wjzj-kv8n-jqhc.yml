vulnerability_id: VCID-wjzj-kv8n-jqhc
aliases:
  - GHSA-hf3c-wxg2-49q9
summary: "vLLM vulnerable to Denial of Service by abusing xgrammar cache\n### Impact\n\nThis\
  \ report is to highlight a vulnerability in XGrammar, a library used by the structured output\
  \ feature in vLLM. The XGrammar advisory is here: https://github.com/mlc-ai/xgrammar/security/advisories/GHSA-389x-67px-mjg3\n\
  \nThe [xgrammar](https://xgrammar.mlc.ai/docs/) library is the default backend used by vLLM\
  \ to support structured output (a.k.a. guided decoding). Xgrammar provides a required, built-in\
  \ cache for its compiled grammars stored in RAM. xgrammar is available by default through\
  \ the OpenAI compatible API server with both the V0 and V1 engines.\n\nA malicious user can\
  \ send a stream of very short decoding requests with unique schemas, resulting in an addition\
  \ to the cache for each request. This can result in a Denial of Service by consuming all of\
  \ the system's RAM.\n\nNote that even if vLLM was configured to use a different backend by\
  \ default, it is still possible to choose xgrammar on a per-request basis using the `guided_decoding_backend`\
  \ key of the `extra_body` field of the request with the V0 engine. This per-request choice\
  \ is not available when using the V1 engine. \n### Patches\n\n* https://github.com/vllm-project/vllm/pull/16283\n\
  \n### Workarounds\n\nThere is no way to workaround this issue in existing versions of vLLM\
  \ other than preventing untrusted access to the OpenAI compatible API server.\n\n### References\n\
  \n* https://github.com/mlc-ai/xgrammar/security/advisories/GHSA-389x-67px-mjg3"
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-hf3c-wxg2-49q9
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/mlc-ai/xgrammar/security/advisories/GHSA-389x-67px-mjg3
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mlc-ai/xgrammar/security/advisories/GHSA-389x-67px-mjg3
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/vllm-project/vllm
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/vllm-project/vllm/commit/cb84e45ac75b42ba6795145923e8eb323bb825ad
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm/commit/cb84e45ac75b42ba6795145923e8eb323bb825ad
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/vllm-project/vllm/pull/16283
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm/pull/16283
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/vllm-project/vllm/security/advisories/GHSA-hf3c-wxg2-49q9
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm/security/advisories/GHSA-hf3c-wxg2-49q9
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm/security/advisories/GHSA-hf3c-wxg2-49q9
weaknesses:
  - CWE-1395
  - CWE-770
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/vllm-project/vllm
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/commit/cb84e45ac75b42ba6795145923e8eb323bb825ad
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/pull/16283
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/security/advisories/GHSA-hf3c-wxg2-49q9
    reference_type:
    reference_id:
  - url: https://github.com/mlc-ai/xgrammar/security/advisories/GHSA-389x-67px-mjg3
    reference_type:
    reference_id: GHSA-389x-67px-mjg3
  - url: https://github.com/advisories/GHSA-hf3c-wxg2-49q9
    reference_type:
    reference_id: GHSA-hf3c-wxg2-49q9
