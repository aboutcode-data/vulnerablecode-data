vulnerability_id: VCID-w3fj-h4rg-v7ff
aliases:
  - GHSA-jj94-6f5c-65r8
summary: |
  ZITADEL Allows Unauthorized Access After Organization or Project Deactivation
  ### Summary
  In Zitadel, even after an organization is deactivated, associated projects, respectively their applications remain active. Users across other organizations can still log in and access through these applications, leading to unauthorized access.
  Additionally, if a project was deactivated access to applications was also still possible.

  ### Details
  The issue stems from the fact that when an organization is deactivated in Zitadel, the applications associated with it do not automatically deactivate. The application lifecycle is not tightly coupled with the organization's lifecycle, leading to a situation where the organization or project is marked as inactive, but its resources remain accessible.

  ### PoC
  - Create a new Organization, create new project and setup OpenID connect.
  - Deactivate an Organization
  - Setup authentication without selecting Check for Project on Authentication
  - User is able to login despite the organization is deactivated

  ### Impact
  This vulnerability allows for unauthorized access to projects and their resources, which should have been restricted post-organization deactivation.

  ### Patches

  2.x versions are fixed on >= [2.62.1](https://github.com/zitadel/zitadel/releases/tag/v2.62.1)
  2.61.x versions are fixed on >= [2.61.1](https://github.com/zitadel/zitadel/releases/tag/v2.61.1)
  2.60.x versions are fixed on >= [2.60.2](https://github.com/zitadel/zitadel/releases/tag/v2.60.2)
  2.59.x versions are fixed on >= [2.59.3](https://github.com/zitadel/zitadel/releases/tag/v2.59.3)
  2.58.x versions are fixed on >= [2.58.5](https://github.com/zitadel/zitadel/releases/tag/v2.58.5)
  2.57.x versions are fixed on >= [2.57.5](https://github.com/zitadel/zitadel/releases/tag/v2.57.5)
  2.56.x versions are fixed on >= [2.56.6](https://github.com/zitadel/zitadel/releases/tag/v2.56.6)
  2.55.x versions are fixed on >= [2.55.8](https://github.com/zitadel/zitadel/releases/tag/v2.55.8)
  2.54.x versions are fixed on >= [2.54.10](https://github.com/zitadel/zitadel/releases/tag/v2.54.10)

  ### Workaround
  Unpatched versions can explicitly disable the application to make sure the client is not allowed anymore.

  ### Questions
  If you have any questions or comments about this advisory, please email us at [security@zitadel.com](mailto:security@zitadel.com)

  ### Credits
  Thanks to @prdp1137 for reporting this!
severities:
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/zitadel/zitadel
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/zitadel/zitadel/security/advisories/GHSA-jj94-6f5c-65r8
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel/security/advisories/GHSA-jj94-6f5c-65r8
weaknesses:
  - CWE-672
references:
  - url: https://github.com/zitadel/zitadel
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-jj94-6f5c-65r8
    reference_type:
    reference_id:
