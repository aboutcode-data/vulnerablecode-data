vulnerability_id: VCID-cck4-9s7w-x7fz
aliases:
  - CVE-2025-38455
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  KVM: SVM: Reject SEV{-ES} intra host migration if vCPU creation is in-flight

  Reject migration of SEV{-ES} state if either the source or destination VM
  is actively creating a vCPU, i.e. if kvm_vm_ioctl_create_vcpu() is in the
  section between incrementing created_vcpus and online_vcpus.  The bulk of
  vCPU creation runs _outside_ of kvm->lock to allow creating multiple vCPUs
  in parallel, and so sev_info.es_active can get toggled from false=>true in
  the destination VM after (or during) svm_vcpu_create(), resulting in an
  SEV{-ES} VM effectively having a non-SEV{-ES} vCPU.

  The issue manifests most visibly as a crash when trying to free a vCPU's
  NULL VMSA page in an SEV-ES VM, but any number of things can go wrong.

    BUG: unable to handle page fault for address: ffffebde00000000
    #PF: supervisor read access in kernel mode
    #PF: error_code(0x0000) - not-present page
    PGD 0 P4D 0
    Oops: Oops: 0000 [#1] SMP KASAN NOPTI
    CPU: 227 UID: 0 PID: 64063 Comm: syz.5.60023 Tainted: G     U     O        6.15.0-smp-DEV #2 NONE
    Tainted: [U]=USER, [O]=OOT_MODULE
    Hardware name: Google, Inc. Arcadia_IT_80/Arcadia_IT_80, BIOS 12.52.0-0 10/28/2024
    RIP: 0010:constant_test_bit arch/x86/include/asm/bitops.h:206 [inline]
    RIP: 0010:arch_test_bit arch/x86/include/asm/bitops.h:238 [inline]
    RIP: 0010:_test_bit include/asm-generic/bitops/instrumented-non-atomic.h:142 [inline]
    RIP: 0010:PageHead include/linux/page-flags.h:866 [inline]
    RIP: 0010:___free_pages+0x3e/0x120 mm/page_alloc.c:5067
    Code: <49> f7 06 40 00 00 00 75 05 45 31 ff eb 0c 66 90 4c 89 f0 4c 39 f0
    RSP: 0018:ffff8984551978d0 EFLAGS: 00010246
    RAX: 0000777f80000001 RBX: 0000000000000000 RCX: ffffffff918aeb98
    RDX: 0000000000000000 RSI: 0000000000000008 RDI: ffffebde00000000
    RBP: 0000000000000000 R08: ffffebde00000007 R09: 1ffffd7bc0000000
    R10: dffffc0000000000 R11: fffff97bc0000001 R12: dffffc0000000000
    R13: ffff8983e19751a8 R14: ffffebde00000000 R15: 1ffffd7bc0000000
    FS:  0000000000000000(0000) GS:ffff89ee661d3000(0000) knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: ffffebde00000000 CR3: 000000793ceaa000 CR4: 0000000000350ef0
    DR0: 0000000000000000 DR1: 0000000000000b5f DR2: 0000000000000000
    DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
    Call Trace:
     <TASK>
     sev_free_vcpu+0x413/0x630 arch/x86/kvm/svm/sev.c:3169
     svm_vcpu_free+0x13a/0x2a0 arch/x86/kvm/svm/svm.c:1515
     kvm_arch_vcpu_destroy+0x6a/0x1d0 arch/x86/kvm/x86.c:12396
     kvm_vcpu_destroy virt/kvm/kvm_main.c:470 [inline]
     kvm_destroy_vcpus+0xd1/0x300 virt/kvm/kvm_main.c:490
     kvm_arch_destroy_vm+0x636/0x820 arch/x86/kvm/x86.c:12895
     kvm_put_kvm+0xb8e/0xfb0 virt/kvm/kvm_main.c:1310
     kvm_vm_release+0x48/0x60 virt/kvm/kvm_main.c:1369
     __fput+0x3e4/0x9e0 fs/file_table.c:465
     task_work_run+0x1a9/0x220 kernel/task_work.c:227
     exit_task_work include/linux/task_work.h:40 [inline]
     do_exit+0x7f0/0x25b0 kernel/exit.c:953
     do_group_exit+0x203/0x2d0 kernel/exit.c:1102
     get_signal+0x1357/0x1480 kernel/signal.c:3034
     arch_do_signal_or_restart+0x40/0x690 arch/x86/kernel/signal.c:337
     exit_to_user_mode_loop kernel/entry/common.c:111 [inline]
     exit_to_user_mode_prepare include/linux/entry-common.h:329 [inline]
     __syscall_exit_to_user_mode_work kernel/entry/common.c:207 [inline]
     syscall_exit_to_user_mode+0x67/0xb0 kernel/entry/common.c:218
     do_syscall_64+0x7c/0x150 arch/x86/entry/syscall_64.c:100
     entry_SYSCALL_64_after_hwframe+0x76/0x7e
    RIP: 0033:0x7f87a898e969
     </TASK>
    Modules linked in: gq(O)
    gsmi: Log Shutdown Reason 0x03
    CR2: ffffebde00000000
    ---[ end trace 0000000000000000 ]---

  Deliberately don't check for a NULL VMSA when freeing the vCPU, as crashing
  the host is likely desirable due to the VMSA being consumed by hardware.
  E.g. if KVM manages to allow VMRUN on the vCPU, hardware may read/write a
  bogus VMSA page.  Accessing P
  ---truncated---
severities:
  - score: '4.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38455.json
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04219'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.04216'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04539'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04528'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04559'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04594'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0449'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0452'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04529'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05489'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05469'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05564'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05579'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05619'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05521'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05464'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05515'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05484'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05578'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05454'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05512'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06144'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06141'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06126'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06164'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06129'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06111'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06146'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06211'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06245'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06261'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.0625'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06202'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06182'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06172'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06183'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06166'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06163'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06145'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06156'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06246'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.06222'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
  - score: '6.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-362
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38455.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38455
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38455
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8c8e8d4d7544bb783e15078eda8ba2580e192246
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b5725213149597cd9c2b075b87bc4e0f87e906c1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e0d9a7cf37ca09c513420dc88e0d0e805a4f0820
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ecf371f8b02d5e31b9aa1da7f159f1b2107bdb01
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/fd044c99d831e9f837518816c7c366b04014d405
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2383474
    reference_type:
    reference_id: 2383474
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38455
    reference_type:
    reference_id: CVE-2025-38455
  - url: https://usn.ubuntu.com/7879-1/
    reference_type:
    reference_id: USN-7879-1
  - url: https://usn.ubuntu.com/7879-2/
    reference_type:
    reference_id: USN-7879-2
  - url: https://usn.ubuntu.com/7879-3/
    reference_type:
    reference_id: USN-7879-3
  - url: https://usn.ubuntu.com/7879-4/
    reference_type:
    reference_id: USN-7879-4
  - url: https://usn.ubuntu.com/7880-1/
    reference_type:
    reference_id: USN-7880-1
  - url: https://usn.ubuntu.com/7934-1/
    reference_type:
    reference_id: USN-7934-1
