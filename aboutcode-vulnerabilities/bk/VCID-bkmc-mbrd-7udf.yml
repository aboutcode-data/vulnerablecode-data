vulnerability_id: VCID-bkmc-mbrd-7udf
aliases:
  - CVE-2025-68954
  - GHSA-8c39-xppg-479c
summary: |
  Pterodactyl does not revoke SFTP access when server is deleted or permissions reduced
  ### Summary
  Pterodactyl does not revoke _active_ SFTP connections when a user is removed from a server instance or has their permissions changes with respect to file access over SFTP. This allows a user that was already connected to SFTP to remain connected and access files even after their permissions are revoked.

  ### Details
  When a user opens a connection to a server using the Wings SFTP server instance the permissions are checked and returned from the authentication API call made to the Panel. However, credentials are not checked again after the initial handshake. Thus, if a user is removed from a server in the panel or have their permissions modified, those permissions are not updated in the SFTP connection.

  As a result, a user that has already gained access to a server's files via the SFTP subsystem will maintain those permissions until disconnected (via Wings restart, or a manual disconnection on their end).

  > [!NOTE]
  >
  > This issue impacts the SFTP subsystem for server files specifically. There is no exposure of Wings private data, or any data outside of a server's local filesystem. Additionally, a user must have been _connected to SFTP at the time of their permissions being revoked_ in order for this issue to be exploited. If a user was not connected, they would not be able to connect once their permissions were reduced.

  ### Fix
  Please upgrade to `wings@1.12.0` and `panel@1.12.0` to resolve this issue. Patches are available via the implementation PRs, but it is recommended to apply by upgrading the entire instance.
severities:
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.07221'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68954
  - score: '0.00028'
    scoring_system: epss
    scoring_elements: '0.07251'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68954
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-8c39-xppg-479c
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pterodactyl/panel
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/pterodactyl/panel/commit/2bd9d8baddb0e0606e4a9d5be402f48678ac88d5
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pterodactyl/panel/commit/2bd9d8baddb0e0606e4a9d5be402f48678ac88d5
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2026-01-06T14:23:44Z/
    published_at: None
    url: https://github.com/pterodactyl/panel/commit/2bd9d8baddb0e0606e4a9d5be402f48678ac88d5
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/pterodactyl/panel/releases/tag/v1.12.0
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pterodactyl/panel/releases/tag/v1.12.0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2026-01-06T14:23:44Z/
    published_at: None
    url: https://github.com/pterodactyl/panel/releases/tag/v1.12.0
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/pterodactyl/panel/security/advisories/GHSA-8c39-xppg-479c
  - score: '7.5'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/pterodactyl/panel/security/advisories/GHSA-8c39-xppg-479c
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pterodactyl/panel/security/advisories/GHSA-8c39-xppg-479c
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2026-01-06T14:23:44Z/
    published_at: None
    url: https://github.com/pterodactyl/panel/security/advisories/GHSA-8c39-xppg-479c
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-68954
weaknesses:
  - CWE-613
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-68954
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/panel
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/panel/commit/2bd9d8baddb0e0606e4a9d5be402f48678ac88d5
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/panel/releases/tag/v1.12.0
    reference_type:
    reference_id:
  - url: https://github.com/pterodactyl/panel/security/advisories/GHSA-8c39-xppg-479c
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68954
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-8c39-xppg-479c
    reference_type:
    reference_id: GHSA-8c39-xppg-479c
