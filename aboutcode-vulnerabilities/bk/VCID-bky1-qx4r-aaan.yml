vulnerability_id: VCID-bky1-qx4r-aaan
aliases:
  - CVE-2021-47578
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  scsi: scsi_debug: Don't call kcalloc() if size arg is zero

  If the size arg to kcalloc() is zero, it returns ZERO_SIZE_PTR.  Because of
  that, for a following NULL pointer check to work on the returned pointer,
  kcalloc() must not be called with the size arg equal to zero. Return early
  without error before the kcalloc() call if size arg is zero.

  BUG: KASAN: null-ptr-deref in memcpy include/linux/fortify-string.h:191 [inline]
  BUG: KASAN: null-ptr-deref in sg_copy_buffer+0x138/0x240 lib/scatterlist.c:974
  Write of size 4 at addr 0000000000000010 by task syz-executor.1/22789

  CPU: 1 PID: 22789 Comm: syz-executor.1 Not tainted 5.15.0-syzk #1
  Hardware name: Red Hat KVM, BIOS 1.13.0-2
  Call Trace:
   __dump_stack lib/dump_stack.c:88 [inline]
   dump_stack_lvl+0x89/0xb5 lib/dump_stack.c:106
   __kasan_report mm/kasan/report.c:446 [inline]
   kasan_report.cold.14+0x112/0x117 mm/kasan/report.c:459
   check_region_inline mm/kasan/generic.c:183 [inline]
   kasan_check_range+0x1a3/0x210 mm/kasan/generic.c:189
   memcpy+0x3b/0x60 mm/kasan/shadow.c:66
   memcpy include/linux/fortify-string.h:191 [inline]
   sg_copy_buffer+0x138/0x240 lib/scatterlist.c:974
   do_dout_fetch drivers/scsi/scsi_debug.c:2954 [inline]
   do_dout_fetch drivers/scsi/scsi_debug.c:2946 [inline]
   resp_verify+0x49e/0x930 drivers/scsi/scsi_debug.c:4276
   schedule_resp+0x4d8/0x1a70 drivers/scsi/scsi_debug.c:5478
   scsi_debug_queuecommand+0x8c9/0x1ec0 drivers/scsi/scsi_debug.c:7533
   scsi_dispatch_cmd drivers/scsi/scsi_lib.c:1520 [inline]
   scsi_queue_rq+0x16b0/0x2d40 drivers/scsi/scsi_lib.c:1699
   blk_mq_dispatch_rq_list+0xb9b/0x2700 block/blk-mq.c:1639
   __blk_mq_sched_dispatch_requests+0x28f/0x590 block/blk-mq-sched.c:325
   blk_mq_sched_dispatch_requests+0x105/0x190 block/blk-mq-sched.c:358
   __blk_mq_run_hw_queue+0xe5/0x150 block/blk-mq.c:1761
   __blk_mq_delay_run_hw_queue+0x4f8/0x5c0 block/blk-mq.c:1838
   blk_mq_run_hw_queue+0x18d/0x350 block/blk-mq.c:1891
   blk_mq_sched_insert_request+0x3db/0x4e0 block/blk-mq-sched.c:474
   blk_execute_rq_nowait+0x16b/0x1c0 block/blk-exec.c:62
   blk_execute_rq+0xdb/0x360 block/blk-exec.c:102
   sg_scsi_ioctl drivers/scsi/scsi_ioctl.c:621 [inline]
   scsi_ioctl+0x8bb/0x15c0 drivers/scsi/scsi_ioctl.c:930
   sg_ioctl_common+0x172d/0x2710 drivers/scsi/sg.c:1112
   sg_ioctl+0xa2/0x180 drivers/scsi/sg.c:1165
   vfs_ioctl fs/ioctl.c:51 [inline]
   __do_sys_ioctl fs/ioctl.c:874 [inline]
   __se_sys_ioctl fs/ioctl.c:860 [inline]
   __x64_sys_ioctl+0x19d/0x220 fs/ioctl.c:860
   do_syscall_x64 arch/x86/entry/common.c:50 [inline]
   do_syscall_64+0x3a/0x80 arch/x86/entry/common.c:80
   entry_SYSCALL_64_after_hwframe+0x44/0xae
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47578.json
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06427'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06465'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06481'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06497'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06502'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06485'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.0648'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06482'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06486'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06494'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06448'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06434'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06433'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06332'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00034'
    scoring_system: epss
    scoring_elements: '0.06306'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09008'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09023'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09073'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09182'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09248'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09231'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09209'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09148'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09129'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09079'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09069'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09066'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09082'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09075'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '0.00142'
    scoring_system: epss
    scoring_elements: '0.21949'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
  - score: '4.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47578
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47578
weaknesses:
  - CWE-476
  - CWE-770
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47578.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47578
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47578
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3344b58b53a76199dae48faa396e9fc37bf86992
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/47d11d35203b0aa13533634e270fe2c3610e531b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/aa1f912712a109b6306746133de7e5343f016b26
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2293251
    reference_type:
    reference_id: 2293251
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47578
    reference_type:
    reference_id: CVE-2021-47578
