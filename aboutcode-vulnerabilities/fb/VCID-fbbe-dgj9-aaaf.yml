vulnerability_id: VCID-fbbe-dgj9-aaaf
aliases:
  - CVE-2023-28754
  - GHSA-3cxh-xp3g-jxjm
summary: |
  Deserialization of Untrusted Data vulnerability in Apache ShardingSphere-Agent, which allows attackers to execute arbitrary code by constructing a special YAML configuration file.

  The attacker needs to have permission to modify the ShardingSphere Agent YAML configuration file on the target machine, and the target machine can access the URL with the arbitrary code JAR.
  An attacker can use SnakeYAML to deserialize java.net.URLClassLoader and make it load a JAR from a specified URL, and then deserialize javax.script.ScriptEngineManager to load code using that ClassLoader. When the ShardingSphere JVM process starts and uses the ShardingSphere-Agent, the arbitrary code specified by the attacker will be executed during the deserialization of the YAML configuration file by the Agent.

  This issue affects ShardingSphere-Agent: through 5.3.2. This vulnerability is fixed in Apache ShardingSphere 5.4.0.
severities:
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31014'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31241'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31295'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31394'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31020'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31022'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31009'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30824'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.31392'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30850'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30962'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30959'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30462'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30758'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30965'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00066'
    scoring_system: epss
    scoring_elements: '0.30980'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39712'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39735'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39741'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39746'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39802'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39736'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39664'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39739'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.3974'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.3984'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39677'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39838'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.00175'
    scoring_system: epss
    scoring_elements: '0.39751'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77304'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77217'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77212'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77281'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77283'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.773'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77312'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77314'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77329'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77332'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.7734'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77331'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.77333'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.0122'
    scoring_system: epss
    scoring_elements: '0.7733'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: '0.03359'
    scoring_system: epss
    scoring_elements: '0.78723'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-3cxh-xp3g-jxjm
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-3cxh-xp3g-jxjm
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/shardingsphere
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/shardingsphere
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.apache.org/thread/p8onhqox5kkwow9lc6gs03z28wtyp1cg
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/p8onhqox5kkwow9lc6gs03z28wtyp1cg
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-28754
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-28754
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/07/19/3
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/07/19/3
weaknesses:
  - CWE-502
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-28754
    reference_type:
    reference_id:
  - url: https://github.com/apache/shardingsphere
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/p8onhqox5kkwow9lc6gs03z28wtyp1cg
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/07/19/3
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:shardingsphere:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:shardingsphere:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-28754
    reference_type:
    reference_id: CVE-2023-28754
  - url: https://github.com/advisories/GHSA-3cxh-xp3g-jxjm
    reference_type:
    reference_id: GHSA-3cxh-xp3g-jxjm
