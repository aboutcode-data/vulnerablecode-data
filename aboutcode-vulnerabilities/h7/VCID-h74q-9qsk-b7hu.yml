vulnerability_id: VCID-h74q-9qsk-b7hu
aliases:
  - CVE-2022-50818
summary: 'In the Linux kernel, the following vulnerability has been resolved:  scsi: pm8001:
  Fix running_req for internal abort commands  Disabling the remote phy for a SATA disk causes
  a hang:  root@(none)$ more /sys/class/sas_phy/phy-0:0:8/target_port_protocols sata root@(none)$
  echo 0 > sys/class/sas_phy/phy-0:0:8/enable root@(none)$ [   67.855950] sas: ex 500e004aaaaaaa1f
  phy08 change count has changed [   67.920585] sd 0:0:2:0: [sdc] Synchronizing SCSI cache [   67.925780]
  sd 0:0:2:0: [sdc] Synchronize Cache(10) failed: Result: hostbyte=0x04 driverbyte=DRIVER_OK
  [   67.935094] sd 0:0:2:0: [sdc] Stopping disk [   67.939305] sd 0:0:2:0: [sdc] Start/Stop
  Unit failed: Result: hostbyte=0x04 driverbyte=DRIVER_OK ... [  123.998998] INFO: task kworker/u192:1:642
  blocked for more than 30 seconds. [  124.005960]   Not tainted 6.0.0-rc1-205202-gf26f8f761e83
  #218 [  124.012049] "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.
  [  124.019872] task:kworker/u192:1  state:D stack:0 pid:  642 ppid: 2 flags:0x00000008 [  124.028223]
  Workqueue: 0000:04:00.0_event_q sas_port_event_worker [  124.034319] Call trace: [  124.036758]  __switch_to+0x128/0x278
  [  124.040333]  __schedule+0x434/0xa58 [  124.043820]  schedule+0x94/0x138 [  124.047045]  schedule_timeout+0x2fc/0x368
  [  124.051052]  wait_for_completion+0xdc/0x200 [  124.055234]  __flush_workqueue+0x1a8/0x708
  [  124.059328]  sas_porte_broadcast_rcvd+0xa8/0xc0 [  124.063858]  sas_port_event_worker+0x60/0x98
  [  124.068126]  process_one_work+0x3f8/0x660 [  124.072134]  worker_thread+0x70/0x700 [  124.075793]  kthread+0x1a4/0x1b8
  [  124.079014]  ret_from_fork+0x10/0x20  The issue is that the per-device running_req read
  in pm8001_dev_gone_notify() never goes to zero and we never make progress. This is caused
  by missing accounting for running_req for when an internal abort command completes.  In commit
  2cbbf489778e ("scsi: pm8001: Use libsas internal abort support") we started to send internal
  abort commands as a proper sas_task. In this when we deliver a sas_task to HW the per-device
  running_req is incremented in pm8001_queue_command(). However it is never decremented for
  internal abort commnds, so decrement in pm8001_mpi_task_abort_resp().'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50818.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0513'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50818
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05111'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-50818
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-50818.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-50818
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2426120
    reference_type:
    reference_id: 2426120
