vulnerability_id: VCID-h7tv-gsrm-aaab
aliases:
  - CVE-2023-28842
  - GHSA-6wrf-mxfj-pf5p
summary: Moby) is an open source container framework developed by Docker Inc. that is distributed
  as Docker, Mirantis Container Runtime, and various other downstream projects/products. The
  Moby daemon component (`dockerd`), which is developed as moby/moby is commonly referred to
  as *Docker*. Swarm Mode, which is compiled in and delivered by default in `dockerd` and is
  thus present in most major Moby downstreams, is a simple, built-in container orchestrator
  that is implemented through a combination of SwarmKit and supporting network code. The `overlay`
  network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow
  communication between containers and services across the cluster. This driver is an implementation/user
  of VXLAN, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame
  with the VXLAN metadata, including a VXLAN Network ID (VNI) that identifies the originating
  overlay network. In addition, the overlay network driver supports an optional, off-by-default
  encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network
  between nodes. Encrypted overlay networks function by encapsulating the VXLAN datagrams through
  the use of the IPsec Encapsulating Security Payload protocol in Transport mode. By deploying
  IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication
  through cryptographic proof, data integrity through check-summing, and confidentiality through
  encryption. When setting an endpoint up on an encrypted overlay network, Moby installs three
  iptables (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These
  rules rely on the `u32` iptables extension provided by the `xt_u32` kernel module to directly
  filter on a VXLAN packet's VNI field, so that IPSec guarantees can be enforced on encrypted
  overlay networks without interfering with other overlay networks or other users of VXLAN.
  The `overlay` driver dynamically and lazily defines the kernel configuration for the VXLAN
  network on each node as containers are attached and detached. Routes and encryption parameters
  are only defined for destination nodes that participate in the network. The iptables rules
  that prevent encrypted overlay networks from accepting unencrypted packets are not created
  until a peer is available with which to communicate. Encrypted overlay networks silently accept
  cleartext VXLAN datagrams that are tagged with the VNI of an encrypted overlay network. As
  a result, it is possible to inject arbitrary Ethernet frames into the encrypted overlay network
  by encapsulating them in VXLAN datagrams. The implications of this can be quite dire, and
  GHSA-vwm3-crmr-xfxw should be referenced for a deeper exploration. Patches are available in
  Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime's 20.10 releases are numbered
  differently, users of that platform should update to 20.10.16. Some workarounds are available.
  In multi-node clusters, deploy a global ‘pause’ container for each encrypted overlay network,
  on every node. For a single-node cluster, do not use overlay networks of any sort. Bridge
  networks provide the same connectivity on a single node and have no multi-node features. The
  Swarm ingress feature is implemented using an overlay network, but can be disabled by publishing
  ports in `host` mode instead of `ingress` mode (allowing the use of an external load balancer),
  and removing the `ingress` network. If encrypted overlay networks are in exclusive use, block
  UDP port 4789 from traffic that has not been validated by IPSec.
severities:
  - score: '6.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-28842.json
  - score: '0.0025'
    scoring_system: epss
    scoring_elements: '0.45663'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.0025'
    scoring_system: epss
    scoring_elements: '0.45689'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.0025'
    scoring_system: epss
    scoring_elements: '0.45583'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.46244'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.46385'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.46402'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.46412'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.46439'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.46423'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.464'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.46377'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.4639'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.4641'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.46399'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00257'
    scoring_system: epss
    scoring_elements: '0.4638'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.69403'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.69195'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.69214'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.69212'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70399'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70405'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70415'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70471'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70488'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70520'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70297'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70337'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70351'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70396'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00303'
    scoring_system: epss
    scoring_elements: '0.70156'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00333'
    scoring_system: epss
    scoring_elements: '0.55278'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00403'
    scoring_system: epss
    scoring_elements: '0.59774'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00403'
    scoring_system: epss
    scoring_elements: '0.59789'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00403'
    scoring_system: epss
    scoring_elements: '0.59788'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00496'
    scoring_system: epss
    scoring_elements: '0.64475'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00496'
    scoring_system: epss
    scoring_elements: '0.64378'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00496'
    scoring_system: epss
    scoring_elements: '0.64411'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00496'
    scoring_system: epss
    scoring_elements: '0.64471'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00496'
    scoring_system: epss
    scoring_elements: '0.64445'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00496'
    scoring_system: epss
    scoring_elements: '0.64441'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.006'
    scoring_system: epss
    scoring_elements: '0.6819'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.006'
    scoring_system: epss
    scoring_elements: '0.68201'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.006'
    scoring_system: epss
    scoring_elements: '0.68205'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.006'
    scoring_system: epss
    scoring_elements: '0.68192'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '0.00769'
    scoring_system: epss
    scoring_elements: '0.58311'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-10T21:32:48Z/
    published_at: None
    url: https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/moby/moby
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/moby
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-10T21:32:48Z/
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-10T21:32:48Z/
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-10T21:32:48Z/
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-10T21:32:48Z/
    published_at: None
    url: https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LYZOKMMVX4SIEHPJW3SJUQGMO5YZCPHC/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-10T21:32:48Z/
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LYZOKMMVX4SIEHPJW3SJUQGMO5YZCPHC/
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XNF4OLYZRQE75EB5TW5N42FSXHBXGWFE/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-10T21:32:48Z/
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XNF4OLYZRQE75EB5TW5N42FSXHBXGWFE/
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZTE4ITXXPIWZEQ4HYQCB6N6GZIMWXDAI/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-02-10T21:32:48Z/
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZTE4ITXXPIWZEQ4HYQCB6N6GZIMWXDAI/
  - score: '6.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-28842
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-28842
weaknesses:
  - CWE-420
  - CWE-755
  - CWE-636
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-28842.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-28842
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-28842
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333
    reference_type:
    reference_id:
  - url: https://github.com/moby/moby
    reference_type:
    reference_id:
  - url: https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp
    reference_type:
    reference_id:
  - url: https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237
    reference_type:
    reference_id:
  - url: https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p
    reference_type:
    reference_id:
  - url: https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LYZOKMMVX4SIEHPJW3SJUQGMO5YZCPHC/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XNF4OLYZRQE75EB5TW5N42FSXHBXGWFE/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZTE4ITXXPIWZEQ4HYQCB6N6GZIMWXDAI/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2184688
    reference_type:
    reference_id: 2184688
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mobyproject:moby:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mobyproject:moby:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-28842
    reference_type:
    reference_id: CVE-2023-28842
  - url: https://security.gentoo.org/glsa/202409-29
    reference_type:
    reference_id: GLSA-202409-29
