vulnerability_id: VCID-pa99-5ddw-23eb
aliases:
  - CVE-2025-14761
  - GHSA-x8cp-jf6f-r4xh
summary: "AWS SDK for PHP's S3 Encryption Client has a Key Commitment Issue\n## Summary\n\n\
  S3 Encryption Client for PHP is an open-source client-side encryption library used to facilitate\
  \ writing and reading encrypted records to S3.  \n\nWhen the encrypted data key (EDK) is stored\
  \ in an \"Instruction File\" instead of S3's metadata record, the EDK is exposed to an \"\
  Invisible Salamanders\" attack  (https://eprint.iacr.org/2019/016), which could allow the\
  \ EDK to be replaced with a new key. \n\n\n\n## Impact\n\n### Background - Key Commitment\n\
  \nThere is a cryptographic property whereby under certain conditions, a single ciphertext\
  \ can be decrypted into 2 different plaintexts by using different encryption keys. To address\
  \ this issue, strong encryption schemes use what is known as \"key commitment\", a process\
  \ by which an encrypted message can only be decrypted by one key; the key used to originally\
  \ encrypt the message. \n\nIn older versions of S3EC, when customers are also using a feature\
  \ called \"Instruction File\" to store EDKs, key commitment is not implemented because multiple\
  \ EDKs could be associated to an underlying encrypted message object.  For such customers\
  \ an attack that leverages the lack of key commitment is possible. A bad actor would need\
  \ two things to leverage this issue: (i) the ability to create a separate, rogue, EDK that\
  \ will also decrypt the underlying object to produce desired plaintext, and (ii) permission\
  \ to upload a new instruction file to the S3 bucket to replace the existing instruction file\
  \ placed there by the user using the S3C. Any future attempt to decrypt the underlying encrypted\
  \ message with the S3EC will unwittingly use the rogue EDK to produce a valid plaintext message.\n\
  \nImpacted versions: <= 3.367.0\n\n\n\n## Patches\n\nWe are introducing the concept of \"\
  key commitment\" to S3EC where the EDK is cryptographically bound to the ciphertext in order\
  \ to address this issue.  In order to maintain compatibility for in-flight messages we are\
  \ releasing the fix in two versions.  A code-compatible minor version that can read messages\
  \ with key-commitment but not write them, and a new major version that can both read and write\
  \ messages with key-commitment.  For maximum safety customers are asked to upgrade to the\
  \ latest major version: 3.368.0 or later.\n\n\n\n## Workarounds\n\nThere are no workarounds,\
  \ please upgrade to the suggested version of S3EC.\n\n## References\n\nIf customeres have\
  \ any questions or comments about this advisory, AWS SDK for PHP asks that they contact AWS\
  \ Security via the issue reporting page or directly via email to [aws-security@amazon.com](mailto:aws-security@amazon.com).\
  \ Please do not create a public GitHub issue."
severities:
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01471'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-14761
  - score: '0.00013'
    scoring_system: epss
    scoring_elements: '0.01445'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-14761
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://aws.amazon.com/security/security-bulletins/AWS-2025-032
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://aws.amazon.com/security/security-bulletins/AWS-2025-032
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://aws.amazon.com/security/security-bulletins/AWS-2025-032/
  - score: 6
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://aws.amazon.com/security/security-bulletins/AWS-2025-032/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-17T20:36:01Z/
    published_at: None
    url: https://aws.amazon.com/security/security-bulletins/AWS-2025-032/
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-x8cp-jf6f-r4xh
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/aws/aws-sdk-php
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-sdk-php
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/aws/aws-sdk-php/commit/6827cac70397dca07e6e86f7cf630954ec2bc6bf
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-sdk-php/commit/6827cac70397dca07e6e86f7cf630954ec2bc6bf
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/aws/aws-sdk-php/releases/tag/3.368.0
  - score: 6
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/aws/aws-sdk-php/releases/tag/3.368.0
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-sdk-php/releases/tag/3.368.0
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-17T20:36:01Z/
    published_at: None
    url: https://github.com/aws/aws-sdk-php/releases/tag/3.368.0
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/aws/aws-sdk-php/security/advisories/GHSA-x8cp-jf6f-r4xh
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-sdk-php/security/advisories/GHSA-x8cp-jf6f-r4xh
  - score: 6
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/aws/aws-sdk-php/security/advisories/GHSA-x8cp-jf6f-r4xh
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-sdk-php/security/advisories/GHSA-x8cp-jf6f-r4xh
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-17T20:36:01Z/
    published_at: None
    url: https://github.com/aws/aws-sdk-php/security/advisories/GHSA-x8cp-jf6f-r4xh
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/aws/aws-sdk-php/CVE-2025-14761.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FriendsOfPHP/security-advisories/blob/master/aws/aws-sdk-php/CVE-2025-14761.yaml
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-14761
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-14761
weaknesses:
  - CWE-327
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-14761
    reference_type:
    reference_id:
  - url: https://aws.amazon.com/security/security-bulletins/AWS-2025-032
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sdk-php
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sdk-php/commit/6827cac70397dca07e6e86f7cf630954ec2bc6bf
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sdk-php/releases/tag/3.368.0
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-sdk-php/security/advisories/GHSA-x8cp-jf6f-r4xh
    reference_type:
    reference_id:
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/aws/aws-sdk-php/CVE-2025-14761.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-14761
    reference_type:
    reference_id:
  - url: https://aws.amazon.com/security/security-bulletins/AWS-2025-032/
    reference_type:
    reference_id: AWS-2025-032
  - url: https://github.com/advisories/GHSA-x8cp-jf6f-r4xh
    reference_type:
    reference_id: GHSA-x8cp-jf6f-r4xh
