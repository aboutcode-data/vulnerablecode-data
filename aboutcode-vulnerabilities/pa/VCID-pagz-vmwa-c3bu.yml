vulnerability_id: VCID-pagz-vmwa-c3bu
aliases:
  - CVE-2021-4454
summary: "In the Linux kernel, the following vulnerability has been resolved:  can: j1939: fix\
  \ errant WARN_ON_ONCE in j1939_session_deactivate  The conclusion \"j1939_session_deactivate()\
  \ should be called with a session ref-count of at least 2\" is incorrect. In some concurrent\
  \ scenarios, j1939_session_deactivate can be called with the session ref-count less than 2.\
  \ But there is not any problem because it will check the session active state before session\
  \ putting in j1939_session_deactivate_locked().  Here is the concurrent scenario of the problem\
  \ reported by syzbot and my reproduction log.          cpu0                            cpu1\
  \                                 j1939_xtp_rx_eoma j1939_xtp_rx_abort_one               \
  \                  j1939_session_get_by_addr [kref == 2] j1939_session_get_by_addr [kref ==\
  \ 3] j1939_session_deactivate [kref == 2] j1939_session_put [kref == 1] \t\t\t\tj1939_session_completed\
  \ \t\t\t\tj1939_session_deactivate \t\t\t\tWARN_ON_ONCE(kref < 2)  =====================================================\
  \ WARNING: CPU: 1 PID: 21 at net/can/j1939/transport.c:1088 j1939_session_deactivate+0x5f/0x70\
  \ CPU: 1 PID: 21 Comm: ksoftirqd/1 Not tainted 5.14.0-rc7+ #32 Hardware name: QEMU Standard\
  \ PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1 04/01/2014 RIP: 0010:j1939_session_deactivate+0x5f/0x70\
  \ Call Trace:  j1939_session_deactivate_activate_next+0x11/0x28  j1939_xtp_rx_eoma+0x12a/0x180\
  \  j1939_tp_recv+0x4a2/0x510  j1939_can_recv+0x226/0x380  can_rcv_filter+0xf8/0x220  can_receive+0x102/0x220\
  \  ? process_backlog+0xf0/0x2c0  can_rcv+0x53/0xf0  __netif_receive_skb_one_core+0x67/0x90\
  \  ? process_backlog+0x97/0x2c0  __netif_receive_skb+0x22/0x80"
severities:
  - score: '3.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-4454.json
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-4454.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02508'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02551'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00019'
    scoring_system: epss
    scoring_elements: '0.0195'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03735'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0375'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03752'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03771'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03803'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03799'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03796'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03789'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03775'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04779'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04804'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04835'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04815'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04811'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04788'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04746'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04741'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04749'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04751'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04755'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04764'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03736'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03725'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03724'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03727'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-20
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-4454.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-4454
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4454
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1740a1e45eee65099a92fb502e1e67e63aad277d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6950df42a03c9ac9290503ced3f371199cb68fa9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9ab896775f98ff54b68512f345eed178bf961084
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b6d44072117bba057d50f7a2f96e5d070c65926d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d0553680f94c49bbe0e39eb50d033ba563b4212d
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355529
    reference_type:
    reference_id: 2355529
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-4454
    reference_type:
    reference_id: CVE-2021-4454
