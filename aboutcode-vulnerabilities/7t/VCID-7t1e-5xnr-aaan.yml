vulnerability_id: VCID-7t1e-5xnr-aaan
aliases:
  - CVE-2024-22032
  - GHSA-q6c7-56cq-g2wm
summary: "Rancher's RKE1 Encryption Config kept in plain-text within cluster AppliedSpec\n###\
  \ Impact\nThis issue is only relevant to clusters provisioned using RKE1 with secrets encryption\
  \ configuration enabled.\n\nA vulnerability has been identified in which an RKE1 cluster keeps\
  \ constantly reconciling when secrets encryption configuration is enabled (please see the\
  \ [RKE documentation](https://rke.docs.rancher.com/config-options/secrets-encryption)). When\
  \ reconciling, the Kube API secret values are written in plaintext on the AppliedSpec. Cluster\
  \ owners, Cluster members, and Project members (for projects within the cluster), all have\
  \ RBAC permissions to view the cluster object from the apiserver.\n\nThis could lead to an\
  \ unauthorized user gaining access to the entire secrets encryption config specific for the\
  \ cluster, only on the applied spec.\n\nSince this affects only custom encryption configurations,\
  \ users need to manually rotate the keys by editing the cluster. For more information, please\
  \ refer to the [RKE secrets encryption documentation](https://rke.docs.rancher.com/config-options/secrets-encryption#key-rotation).\n\
  \nThe full custom configuration example:\n\n```yaml\nservices:\n  kube-api:\n    secrets_encryption_config:\n\
  \      enabled: true\n      custom_config:\n        apiVersion: apiserver.config.k8s.io/v1\n\
  \        kind: EncryptionConfiguration\n        resources:\n        - resources:\n       \
  \   - secrets\n          providers:\n          - aescbc:\n              keys:\n          \
  \    - name: k-fw5hn\n                secret: RTczRjFDODMwQzAyMDVBREU4NDJBMUZFNDhCNzM5N0I=\
  \ #<--- needs to be changed\n          - identity: {}\n```\n\nPlease consult the associated\
  \  [MITRE ATT&CK - Technique - Unsecured Credentials](https://attack.mitre.org/techniques/T1552/)\
  \ for further information about this category of attack.\n\n### Patches\nTo address this issue,\
  \ the fix introduces a new change that copies the AppliedSpec before mutating. As such, the\
  \ next time the cluster is reconciled and the AppliedSpec is set, all references to sensitive\
  \ data will be removed. \n\nPatched versions include releases `2.7.14` and `2.8.5`.\n\n###\
  \ Workarounds\nThere are no workarounds for this issue. Users are recommended to upgrade,\
  \ as soon as possible, to a version of RKE/Rancher Manager which contains the fixes. \n\n\
  ### References\n- [CVE-2024-22032](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-22032)\n\
  \nIf you have any questions or comments about this advisory:\n- Reach out to the [SUSE Rancher\
  \ Security team](https://github.com/rancher/rancher/security/policy) for security-related\
  \ inquiries.\n- Open an issue in the [Rancher](https://github.com/rancher/rancher/issues/new/choose)\
  \ repository.\n- Verify with our [support matrix](https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/)\
  \ and [product support lifecycle](https://www.suse.com/lifecycle/)."
severities:
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11138'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11147'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11236'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11174'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11218'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11159'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11158'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11168'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11184'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10992'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11046'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11153'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.11228'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09991'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09924'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10023'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10034'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10065'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10092'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.1008'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10116'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10137'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10106'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10075'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10051'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09998'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10103'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.14252'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-22032
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-22032
  - score: '9.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/rancher/rancher
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-22032
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-22032
weaknesses:
  - CWE-256
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-22032
    reference_type:
    reference_id:
  - url: https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-22032
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher
    reference_type:
    reference_id:
  - url: https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-22032
    reference_type:
    reference_id:
