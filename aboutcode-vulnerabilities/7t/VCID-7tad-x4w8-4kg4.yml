vulnerability_id: VCID-7tad-x4w8-4kg4
aliases:
  - CVE-2025-38687
summary: 'In the Linux kernel, the following vulnerability has been resolved:  comedi: fix race
  between polling and detaching  syzbot reports a use-after-free in comedi in the below link,
  which is due to comedi gladly removing the allocated async area even though poll requests
  are still active on the wait_queue_head inside of it. This can cause a use-after-free when
  the poll entries are later triggered or removed, as the memory for the wait_queue_head has
  been freed.  We need to check there are no tasks queued on any of the subdevices'' wait queues
  before allowing the device to be detached by the `COMEDI_DEVCONFIG` ioctl.  Tasks will read-lock
  `dev->attach_lock` before adding themselves to the subdevice wait queue, so fix the problem
  in the `COMEDI_DEVCONFIG` ioctl handler by write-locking `dev->attach_lock` before checking
  that all of the subdevices are safe to be deleted.  This includes testing for any sleepers
  on the subdevices'' wait queues.  It remains locked until the device has been detached.  This
  requires the `comedi_device_detach()` function to be refactored slightly, moving the bulk
  of it into new function `comedi_device_detach_locked()`.  Note that the refactor of `comedi_device_detach()`
  results in `comedi_device_cancel_all()` now being called while `dev->attach_lock` is write-locked,
  which wasn''t the case previously, but that does not matter.  Thanks to Jens Axboe for diagnosing
  the problem and co-developing this patch.'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38687.json
  - score: '0.0003'
    scoring_system: epss
    scoring_elements: '0.08095'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07804'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00033'
    scoring_system: epss
    scoring_elements: '0.07821'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12515'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12466'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12391'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21433'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21388'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.21386'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23458'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23383'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23352'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23282'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23409'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23391'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23468'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23451'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23455'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23299'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.23393'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.2339'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24904'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24866'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24876'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.2484'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24899'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24903'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.2489'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24885'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24841'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.2481'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24894'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24881'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24873'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00082'
    scoring_system: epss
    scoring_elements: '0.24871'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '0.00092'
    scoring_system: epss
    scoring_elements: '0.26564'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38687.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38687
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38687
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2393181
    reference_type:
    reference_id: 2393181
  - url: https://usn.ubuntu.com/7909-1/
    reference_type:
    reference_id: USN-7909-1
  - url: https://usn.ubuntu.com/7909-2/
    reference_type:
    reference_id: USN-7909-2
  - url: https://usn.ubuntu.com/7909-3/
    reference_type:
    reference_id: USN-7909-3
  - url: https://usn.ubuntu.com/7909-4/
    reference_type:
    reference_id: USN-7909-4
  - url: https://usn.ubuntu.com/7909-5/
    reference_type:
    reference_id: USN-7909-5
  - url: https://usn.ubuntu.com/7910-1/
    reference_type:
    reference_id: USN-7910-1
  - url: https://usn.ubuntu.com/7910-2/
    reference_type:
    reference_id: USN-7910-2
  - url: https://usn.ubuntu.com/7933-1/
    reference_type:
    reference_id: USN-7933-1
  - url: https://usn.ubuntu.com/7938-1/
    reference_type:
    reference_id: USN-7938-1
