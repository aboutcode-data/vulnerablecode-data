vulnerability_id: VCID-3xsx-j577-aaad
aliases:
  - CVE-2024-37900
  - GHSA-wf3x-jccf-5g5g
summary: |
  XWiki Platform vulnerable to Cross-site Scripting through attachment filename in uploader
  ### Impact
  When uploading an attachment with a malicious filename, malicious JavaScript code could be executed. This requires a social engineering attack to get the victim into uploading a file with a malicious name. The malicious code is solely executed during the upload and affects only the user uploading the attachment. While this allows performing actions in the name of that user, it seems unlikely that a user wouldn't notice the malicious filename while uploading the attachment.

  In order to reproduce, as any user, create a file named `"><img src=1 onerror=alert(1)>.jpg`. Then go to any page where you have edit rights and upload the file in the attachments tab. If alerts appear and display "1", then the instance is vulnerable.

  ### Patches
  This has been patched in XWiki 14.10.21, 15.5.5, 15.10.6 and 16.0.0.

  ### Workarounds
  We're not aware of any workaround except upgrading.

  ### References
  * https://jira.xwiki.org/browse/XWIKI-19611
  * https://jira.xwiki.org/browse/XWIKI-21769
  * https://jira.xwiki.org/browse/XWIKI-19602
  * https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949

  ### Attribution

  This vulnerability has been independently reported by Aleksey Solovev (Positive Technologies) and Georgios Roumeliotis for TwelveSec.
severities:
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56201'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.55509'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56195'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56200'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.55222'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.55210'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.55189'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56453'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56408'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56371'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56227'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56133'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56113'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56191'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.56046'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00179'
    scoring_system: epss
    scoring_elements: '0.55780'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00195'
    scoring_system: epss
    scoring_elements: '0.42038'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.56585'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.56511'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.56569'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.56544'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.56529'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.56537'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.56493'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.56549'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0035'
    scoring_system: epss
    scoring_elements: '0.56567'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.59014'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.59007'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0039'
    scoring_system: epss
    scoring_elements: '0.59011'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.74842'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.74858'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.74863'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.74879'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.74881'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.74875'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.74868'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.7485'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.74861'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.0098'
    scoring_system: epss
    scoring_elements: '0.74847'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.00984'
    scoring_system: epss
    scoring_elements: '0.62906'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.01193'
    scoring_system: epss
    scoring_elements: '0.77023'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.01193'
    scoring_system: epss
    scoring_elements: '0.77027'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.01193'
    scoring_system: epss
    scoring_elements: '0.77044'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.01193'
    scoring_system: epss
    scoring_elements: '0.76958'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: '0.01193'
    scoring_system: epss
    scoring_elements: '0.76959'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-wf3x-jccf-5g5g
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-wf3x-jccf-5g5g
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/9df46f8e5313af46f93bccd1ebc682e28126573f
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/9df46f8e5313af46f93bccd1ebc682e28126573f
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/commit/9df46f8e5313af46f93bccd1ebc682e28126573f
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wf3x-jccf-5g5g
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wf3x-jccf-5g5g
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wf3x-jccf-5g5g
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wf3x-jccf-5g5g
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-19602
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-19602
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-19602
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-19611
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-19611
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-19611
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-21769
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-21769
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://jira.xwiki.org/browse/XWIKI-21769
  - score: '4.6'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37900
  - score: '4.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37900
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37900
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37900
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37900
weaknesses:
  - CWE-94
  - CWE-937
  - CWE-1035
  - CWE-96
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-37900
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/commit/9df46f8e5313af46f93bccd1ebc682e28126573f
    reference_type:
    reference_id:
  - url: https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wf3x-jccf-5g5g
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19602
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-19611
    reference_type:
    reference_id:
  - url: https://jira.xwiki.org/browse/XWIKI-21769
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37900
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:16.0.0:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:16.0.0:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:16.0:rc-1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:16.0:rc-1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:4.2:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:4.2:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:4.2:milestone-3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:4.2:milestone-3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xwiki:xwiki:4.2:milestone3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xwiki:xwiki:4.2:milestone3:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-wf3x-jccf-5g5g
    reference_type:
    reference_id: GHSA-wf3x-jccf-5g5g
