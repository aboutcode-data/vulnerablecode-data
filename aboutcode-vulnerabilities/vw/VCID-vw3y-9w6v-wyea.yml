vulnerability_id: VCID-vw3y-9w6v-wyea
aliases:
  - CVE-2025-46722
  - GHSA-c65p-x677-fgj6
  - PYSEC-2025-43
summary: "vLLM has a Weakness in MultiModalHasher Image Hashing Implementation\n## Summary\n\
  \nIn the file `vllm/multimodal/hasher.py`, the `MultiModalHasher` class has a security and\
  \ data integrity issue in its image hashing method. Currently, it serializes `PIL.Image.Image`\
  \ objects using only `obj.tobytes()`, which returns only the raw pixel data, without including\
  \ metadata such as the image’s shape (width, height, mode). As a result, two images of different\
  \ sizes (e.g., 30x100 and 100x30) with the same pixel byte sequence could generate the same\
  \ hash value. This may lead to hash collisions, incorrect cache hits, and even data leakage\
  \ or security risks.\n\n## Details\n\n- **Affected file:** `vllm/multimodal/hasher.py`\n-\
  \ **Affected method:** `MultiModalHasher.serialize_item`\nhttps://github.com/vllm-project/vllm/blob/9420a1fc30af1a632bbc2c66eb8668f3af41f026/vllm/multimodal/hasher.py#L34-L35\n\
  - **Current behavior:** For `Image.Image` instances, only `obj.tobytes()` is used for hashing.\n\
  - **Problem description:** `obj.tobytes()` does not include the image’s width, height, or\
  \ mode metadata.\n- **Impact:** Two images with the same pixel byte sequence but different\
  \ sizes could be regarded as the same image by the cache and hashing system, which may result\
  \ in:\n    - Incorrect cache hits, leading to abnormal responses\n    - Deliberate construction\
  \ of images with different meanings but the same hash value\n\n\n## Recommendation\n\nIn the\
  \ `serialize_item` method, **serialization of `Image.Image` objects should include not only\
  \ pixel data, but also all critical metadata**—such as dimensions (`size`), color mode (`mode`),\
  \ format, and especially the `info` dictionary. The `info` dictionary is particularly important\
  \ in palette-based images (e.g., mode `'P'`), where the palette itself is stored in `info`.\
  \ Ignoring `info` can result in hash collisions between visually distinct images with the\
  \ same pixel bytes but different palettes or metadata. This can lead to incorrect cache hits\
  \ or even data leakage.\n\n**Summary:**  \nSerializing only the raw pixel data is insecure.\
  \ Always include all image metadata (`size`, `mode`, `format`, `info`) in the hash calculation\
  \ to prevent collisions, especially in cases like palette-based images.\n\n**Impact for other\
  \ modalities**\nFor the influence of other modalities, since the video modality is transformed\
  \ into a multi-dimensional array containing the length, width, time, etc. of the video, the\
  \ same problem exists due to the incorrect sequence of numpy as well.\n\nFor audio, since\
  \ the momo function is not enabled in librosa.load, the loaded audio is automatically encoded\
  \ into single channels by librosa and returns a one-dimensional array of numpy, thus keeping\
  \ the structure of numpy fixed and not affected by this issue.\n\n## Fixes\n\n* https://github.com/vllm-project/vllm/pull/17378"
severities:
  - score: '4.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-46722.json
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16946'
    published_at: '2025-06-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16961'
    published_at: '2025-06-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.1692'
    published_at: '2025-05-31 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00054'
    scoring_system: epss
    scoring_elements: '0.16904'
    published_at: '2025-05-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19218'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.193'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19178'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19161'
    published_at: '2025-06-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19152'
    published_at: '2025-06-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19187'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19214'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19226'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0006'
    scoring_system: epss
    scoring_elements: '0.19155'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.21665'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.2161'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23512'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23488'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23532'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.23514'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00079'
    scoring_system: epss
    scoring_elements: '0.2432'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00079'
    scoring_system: epss
    scoring_elements: '0.24318'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00081'
    scoring_system: epss
    scoring_elements: '0.24681'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27158'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27119'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27191'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27197'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.2722'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27204'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27273'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27297'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27275'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.27357'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29659'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29766'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29719'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29752'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29743'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29733'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29726'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29662'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29684'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29697'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29649'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29673'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29714'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29737'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29681'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29691'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.29665'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.2965'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34676'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34794'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34767'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.3488'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34873'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34886'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.3472'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34694'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34697'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34668'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34732'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.3474'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34737'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34712'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.3466'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: '0.0014'
    scoring_system: epss
    scoring_elements: '0.34753'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-c65p-x677-fgj6
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/vllm/PYSEC-2025-43.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/vllm/PYSEC-2025-43.yaml
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/vllm-project/vllm
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/vllm-project/vllm/commit/99404f53c72965b41558aceb1bc2380875f5d848
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm/commit/99404f53c72965b41558aceb1bc2380875f5d848
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-05-29T18:12:29Z/
    published_at: None
    url: https://github.com/vllm-project/vllm/commit/99404f53c72965b41558aceb1bc2380875f5d848
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/vllm-project/vllm/pull/17378
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm/pull/17378
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-05-29T18:12:29Z/
    published_at: None
    url: https://github.com/vllm-project/vllm/pull/17378
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://github.com/vllm-project/vllm/security/advisories/GHSA-c65p-x677-fgj6
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm/security/advisories/GHSA-c65p-x677-fgj6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vllm-project/vllm/security/advisories/GHSA-c65p-x677-fgj6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-05-29T18:12:29Z/
    published_at: None
    url: https://github.com/vllm-project/vllm/security/advisories/GHSA-c65p-x677-fgj6
  - score: '4.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-46722
  - score: '7.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-46722
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-46722
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-1023
  - CWE-1288
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-46722.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-46722
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vllm/PYSEC-2025-43.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/commit/99404f53c72965b41558aceb1bc2380875f5d848
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/pull/17378
    reference_type:
    reference_id:
  - url: https://github.com/vllm-project/vllm/security/advisories/GHSA-c65p-x677-fgj6
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2369221
    reference_type:
    reference_id: 2369221
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vllm:vllm:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:vllm:vllm:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-46722
    reference_type:
    reference_id: CVE-2025-46722
  - url: https://github.com/advisories/GHSA-c65p-x677-fgj6
    reference_type:
    reference_id: GHSA-c65p-x677-fgj6
