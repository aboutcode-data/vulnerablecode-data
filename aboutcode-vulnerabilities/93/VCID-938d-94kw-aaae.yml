vulnerability_id: VCID-938d-94kw-aaae
aliases:
  - CVE-2022-31151
  - GHSA-q768-x9m6-m9qp
summary: 'Authorization headers are cleared on cross-origin redirect. However, cookie headers
  which are sensitive headers and are official headers found in the spec, remain uncleared.
  There are active users using cookie headers in undici. This may lead to accidental leakage
  of cookie to a 3rd-party site or a malicious attacker who can control the redirection target
  (ie. an open redirector) to leak the cookie to the 3rd party site. This was patched in v5.7.1.
  By default, this vulnerability is not exploitable. Do not enable redirections, i.e. `maxRedirections:
  0` (the default).'
severities:
  - score: '3.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-31151.json
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.48871'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.49039'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.48959'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.48939'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.48591'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.49310'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.49235'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.49211'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.49055'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.49047'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.49031'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00128'
    scoring_system: epss
    scoring_elements: '0.49034'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.52528'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.52239'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.52227'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00154'
    scoring_system: epss
    scoring_elements: '0.52202'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.403'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36608'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36573'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36697'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36709'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36708'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36731'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36699'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36667'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36685'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.3671'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36741'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36745'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36715'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36675'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.36654'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.4037'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.40431'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.40468'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.40466'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.4035'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.4034'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.40353'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.40349'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.40341'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.40358'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.40319'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.0018'
    scoring_system: epss
    scoring_elements: '0.40286'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: '0.00417'
    scoring_system: epss
    scoring_elements: '0.44816'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=2121396
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-q768-x9m6-m9qp
  - score: '2.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/nodejs/undici
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nodejs/undici
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/nodejs/undici/blob/main/lib/handler/redirect.js#L189
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nodejs/undici/blob/main/lib/handler/redirect.js#L189
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/nodejs/undici/commit/0a5bee9465e627be36bac88edf7d9bbc9626126d
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nodejs/undici/commit/0a5bee9465e627be36bac88edf7d9bbc9626126d
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/nodejs/undici/issues/872
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nodejs/undici/issues/872
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:45:24Z/
    published_at: None
    url: https://github.com/nodejs/undici/issues/872
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/nodejs/undici/pull/1441
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nodejs/undici/pull/1441
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/nodejs/undici/releases/tag/v5.8.0
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/nodejs/undici/releases/tag/v5.8.0
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp
  - score: '3.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:45:24Z/
    published_at: None
    url: https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-17T13:10:30Z/
    published_at: None
    url: https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://hackerone.com/reports/1635514
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://hackerone.com/reports/1635514
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:45:24Z/
    published_at: None
    url: https://hackerone.com/reports/1635514
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31151
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31151
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220909-0006
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220909-0006
  - score: '3.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220909-0006/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-22T15:45:24Z/
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220909-0006/
weaknesses:
  - CWE-601
  - CWE-937
  - CWE-1035
  - CWE-346
  - CWE-93
  - CWE-200
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-31151.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-31151
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/undici
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/undici/blob/main/lib/handler/redirect.js#L189
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/undici/commit/0a5bee9465e627be36bac88edf7d9bbc9626126d
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/undici/issues/872
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/undici/pull/1441
    reference_type:
    reference_id:
  - url: https://github.com/nodejs/undici/releases/tag/v5.8.0
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1635514
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220909-0006
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220909-0006/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2121396
    reference_type:
    reference_id: 2121396
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:nodejs:undici:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:nodejs:undici:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31151
    reference_type:
    reference_id: CVE-2022-31151
  - url: https://github.com/advisories/GHSA-q768-x9m6-m9qp
    reference_type:
    reference_id: GHSA-q768-x9m6-m9qp
  - url: https://github.com/nodejs/undici/security/advisories/GHSA-q768-x9m6-m9qp
    reference_type:
    reference_id: GHSA-q768-x9m6-m9qp
  - url: https://access.redhat.com/errata/RHSA-2022:6696
    reference_type:
    reference_id: RHSA-2022:6696
