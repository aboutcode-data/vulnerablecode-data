vulnerability_id: VCID-kekb-qkme-aaag
aliases:
  - CVE-2024-41031
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm/filemap: skip to create PMD-sized page cache if needed

  On ARM64, HPAGE_PMD_ORDER is 13 when the base page size is 64KB.  The
  PMD-sized page cache can't be supported by xarray as the following error
  messages indicate.

  ------------[ cut here ]------------
  WARNING: CPU: 35 PID: 7484 at lib/xarray.c:1025 xas_split_alloc+0xf8/0x128
  Modules linked in: nft_fib_inet nft_fib_ipv4 nft_fib_ipv6 nft_fib  \
  nft_reject_inet nf_reject_ipv4 nf_reject_ipv6 nft_reject nft_ct    \
  nft_chain_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4    \
  ip_set rfkill nf_tables nfnetlink vfat fat virtio_balloon drm      \
  fuse xfs libcrc32c crct10dif_ce ghash_ce sha2_ce sha256_arm64      \
  sha1_ce virtio_net net_failover virtio_console virtio_blk failover \
  dimlib virtio_mmio
  CPU: 35 PID: 7484 Comm: test Kdump: loaded Tainted: G W 6.10.0-rc5-gavin+ #9
  Hardware name: QEMU KVM Virtual Machine, BIOS edk2-20240524-1.el9 05/24/2024
  pstate: 83400005 (Nzcv daif +PAN -UAO +TCO +DIT -SSBS BTYPE=--)
  pc : xas_split_alloc+0xf8/0x128
  lr : split_huge_page_to_list_to_order+0x1c4/0x720
  sp : ffff800087a4f6c0
  x29: ffff800087a4f6c0 x28: ffff800087a4f720 x27: 000000001fffffff
  x26: 0000000000000c40 x25: 000000000000000d x24: ffff00010625b858
  x23: ffff800087a4f720 x22: ffffffdfc0780000 x21: 0000000000000000
  x20: 0000000000000000 x19: ffffffdfc0780000 x18: 000000001ff40000
  x17: 00000000ffffffff x16: 0000018000000000 x15: 51ec004000000000
  x14: 0000e00000000000 x13: 0000000000002000 x12: 0000000000000020
  x11: 51ec000000000000 x10: 51ece1c0ffff8000 x9 : ffffbeb961a44d28
  x8 : 0000000000000003 x7 : ffffffdfc0456420 x6 : ffff0000e1aa6eb8
  x5 : 20bf08b4fe778fca x4 : ffffffdfc0456420 x3 : 0000000000000c40
  x2 : 000000000000000d x1 : 000000000000000c x0 : 0000000000000000
  Call trace:
   xas_split_alloc+0xf8/0x128
   split_huge_page_to_list_to_order+0x1c4/0x720
   truncate_inode_partial_folio+0xdc/0x160
   truncate_inode_pages_range+0x1b4/0x4a8
   truncate_pagecache_range+0x84/0xa0
   xfs_flush_unmap_range+0x70/0x90 [xfs]
   xfs_file_fallocate+0xfc/0x4d8 [xfs]
   vfs_fallocate+0x124/0x2e8
   ksys_fallocate+0x4c/0xa0
   __arm64_sys_fallocate+0x24/0x38
   invoke_syscall.constprop.0+0x7c/0xd8
   do_el0_svc+0xb4/0xd0
   el0_svc+0x44/0x1d8
   el0t_64_sync_handler+0x134/0x150
   el0t_64_sync+0x17c/0x180

  Fix it by skipping to allocate PMD-sized page cache when its size is
  larger than MAX_PAGECACHE_ORDER.  For this specific case, we will fall to
  regular path where the readahead window is determined by BDI's sysfs file
  (read_ahead_kb).
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-41031.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28827'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28664'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28723'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28783'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28823'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28764'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28748'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28708'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.2871'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30669'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30627'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30668'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30688'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30641'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.27567'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.27612'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.27714'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.2919'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.29197'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.2923'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.2926'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.29261'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.29215'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.29232'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.29267'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.29227'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.29236'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.00136'
    scoring_system: epss
    scoring_elements: '0.30273'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '0.005'
    scoring_system: epss
    scoring_elements: '0.48841'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
  - score: '3.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-99
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-41031.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-41031
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/06b5a69c27ec405a3c3f2da8520ff1ee70b94a21
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1ef650d3b1b2a16473981b447f38705fe9b93972
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3390916aca7af1893ed2ebcdfee1d6fdb65bb058
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2300395
    reference_type:
    reference_id: 2300395
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-41031
    reference_type:
    reference_id: CVE-2024-41031
  - url: https://access.redhat.com/errata/RHSA-2024:10771
    reference_type:
    reference_id: RHSA-2024:10771
  - url: https://access.redhat.com/errata/RHSA-2024:6744
    reference_type:
    reference_id: RHSA-2024:6744
  - url: https://access.redhat.com/errata/RHSA-2024:6745
    reference_type:
    reference_id: RHSA-2024:6745
  - url: https://usn.ubuntu.com/7089-1/
    reference_type:
    reference_id: USN-7089-1
  - url: https://usn.ubuntu.com/7089-2/
    reference_type:
    reference_id: USN-7089-2
  - url: https://usn.ubuntu.com/7089-3/
    reference_type:
    reference_id: USN-7089-3
  - url: https://usn.ubuntu.com/7089-4/
    reference_type:
    reference_id: USN-7089-4
  - url: https://usn.ubuntu.com/7089-5/
    reference_type:
    reference_id: USN-7089-5
  - url: https://usn.ubuntu.com/7089-6/
    reference_type:
    reference_id: USN-7089-6
  - url: https://usn.ubuntu.com/7089-7/
    reference_type:
    reference_id: USN-7089-7
  - url: https://usn.ubuntu.com/7090-1/
    reference_type:
    reference_id: USN-7090-1
  - url: https://usn.ubuntu.com/7095-1/
    reference_type:
    reference_id: USN-7095-1
  - url: https://usn.ubuntu.com/7156-1/
    reference_type:
    reference_id: USN-7156-1
