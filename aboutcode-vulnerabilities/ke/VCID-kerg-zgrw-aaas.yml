vulnerability_id: VCID-kerg-zgrw-aaas
aliases:
  - GHSA-45w3-v3g4-54pm
summary: "Chrono has potential segfault issue in SPIFFE authenticator\n### Impact\nSeveral vulnerabilities\
  \ have been reported in the `time` and `chrono` crates related to handling of calls to `localtime_r`.\
  \ You can follow some of the discussions [here](https://github.com/chronotope/chrono/issues/602)\
  \ and [here](https://github.com/time-rs/time/issues/293), and the associated CVE [here](https://nvd.nist.gov/vuln/detail/CVE-2020-26235).\
  \ In our case, the issue with the dependency was flagged by our nightly CI build running [`cargo-audit`](https://github.com/parallaxsecond/parsec/issues/544).\
  \ \n\nThe vulnerability leads to a segfault in specific circumstances - namely, when one of\
  \ a number of functions in the `time` crate is called while any other thread is setting an\
  \ environment variable. Given that in the case of the Parsec service this affects the SPIFFE\
  \ authenticator, Parsec service users can encounter the issue only when the JWT SVID authenticator\
  \ is enabled and being used. We have not undergone any manual tracing to understand if the\
  \ vulnerable methods are called anywhere in our stack, however it seems reasonable to expect\
  \ that if that were to be the case, the issue would lie in JWT validation (i.e. when handling\
  \ the dates found within a Json Web Token). JWT validation could thus fail, bringing down\
  \ the thread in which the request happens. The rest of the threads continue to work. Since\
  \ the threadpool implementation that we use [continues replenishing the pool](https://docs.rs/threadpool/latest/threadpool/)\
  \ when one thread panics, the impact on the service should be minimal.\n\n### Patches\nNo\
  \ current patches exist as the problems lie in a number of dependencies that are not under\
  \ our control (see more details [here](https://github.com/parallaxsecond/parsec/issues/544#issuecomment-1024185688)).\n\
  \nThe issue tracking the required change in the `rust-spiffe` crate (through which the vulnerable\
  \ dependencies are imported in Parsec) can be seen [here](https://github.com/maxlambrecht/rust-spiffe/issues/17).\
  \ Once updates happen in our dependency chain that allow us to update beyond the vulnerable\
  \ versions of `time` and `chrono`, a new version of the Parsec service will be tagged and\
  \ released with the appropriate notifications.\n\n### Workarounds\nThe only complete workaround\
  \ is to use a different type of authenticator with the Parsec service. \n\n### References\n\
  As quoted in the initial paragraph, you can find out more information:\n* in the `chrono`\
  \ repo issue [here](https://github.com/chronotope/chrono/issues/602)\n* in the `time` repo\
  \ issue [here](https://github.com/time-rs/time/issues/293)\n* in the official CVE report [here](https://nvd.nist.gov/vuln/detail/CVE-2020-26235)\n\
  * in our tracking issue [here](https://github.com/parallaxsecond/parsec/issues/544)\n\n###\
  \ For more information:\nIf you have any questions or comments about this advisory:\n* Open\
  \ an issue in [the Parsec service repo](https://github.com/parallaxsecond/parsec)\n* Email\
  \ us at [cncf-parsec-maintainers@lists.cncf.io](mailto:cncf-parsec-maintainers@lists.cncf.io)"
severities:
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-45w3-v3g4-54pm
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/chronotope/chrono/issues/602
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/parallaxsecond/parsec
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/parallaxsecond/parsec/issues/544
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/parallaxsecond/parsec/issues/544#issuecomment-1024185688
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/parallaxsecond/parsec/security/advisories/GHSA-45w3-v3g4-54pm
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/time-rs/time/issues/293
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/time-rs/time/issues/293
  - score: '3.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-26235
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-26235
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2020-26235
weaknesses:
  - CWE-476
references:
  - url: https://github.com/chronotope/chrono/issues/602
    reference_type:
    reference_id:
  - url: https://github.com/parallaxsecond/parsec
    reference_type:
    reference_id:
  - url: https://github.com/parallaxsecond/parsec/issues/544
    reference_type:
    reference_id:
  - url: https://github.com/parallaxsecond/parsec/issues/544#issuecomment-1024185688
    reference_type:
    reference_id:
  - url: https://github.com/parallaxsecond/parsec/security/advisories/GHSA-45w3-v3g4-54pm
    reference_type:
    reference_id:
  - url: https://github.com/time-rs/time/issues/293
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2020-26235
    reference_type:
    reference_id: CVE-2020-26235
  - url: https://github.com/advisories/GHSA-45w3-v3g4-54pm
    reference_type:
    reference_id: GHSA-45w3-v3g4-54pm
