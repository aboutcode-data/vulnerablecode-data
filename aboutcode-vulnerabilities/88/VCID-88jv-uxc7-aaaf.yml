vulnerability_id: VCID-88jv-uxc7-aaaf
aliases:
  - CVE-2023-52765
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mfd: qcom-spmi-pmic: Fix revid implementation

  The Qualcomm SPMI PMIC revid implementation is broken in multiple ways.

  First, it assumes that just because the sibling base device has been
  registered that means that it is also bound to a driver, which may not
  be the case (e.g. due to probe deferral or asynchronous probe). This
  could trigger a NULL-pointer dereference when attempting to access the
  driver data of the unbound device.

  Second, it accesses driver data of a sibling device directly and without
  any locking, which means that the driver data may be freed while it is
  being accessed (e.g. on driver unbind).

  Third, it leaks a struct device reference to the sibling device which is
  looked up using the spmi_device_from_of() every time a function (child)
  device is calling the revid function (e.g. on probe).

  Fix this mess by reimplementing the revid lookup so that it is done only
  at probe of the PMIC device; the base device fetches the revid info from
  the hardware, while any secondary SPMI device fetches the information
  from the base device and caches it so that it can be accessed safely
  from its children. If the base device has not been probed yet then probe
  of a secondary device is deferred.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52765.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15453'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15228'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15292'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15387'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15466'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15467'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15443'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15422'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15409'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15415'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15426'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.15446'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23682'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23857'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23863'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23869'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23822'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23789'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23805'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23831'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23864'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23851'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23807'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23791'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23765'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23745'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00093'
    scoring_system: epss
    scoring_elements: '0.23832'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '0.00395'
    scoring_system: epss
    scoring_elements: '0.43432'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/4ce77b023d42a9f1062eecf438df1af4b4072eb2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-14T16:54:35Z/
    published_at: None
    url: https://git.kernel.org/stable/c/4ce77b023d42a9f1062eecf438df1af4b4072eb2
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/7b439aaa62fee474a0d84d67a25f4984467e7b95
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-14T16:54:35Z/
    published_at: None
    url: https://git.kernel.org/stable/c/7b439aaa62fee474a0d84d67a25f4984467e7b95
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/affae18838db5e6b463ee30c821385695af56dc2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-14T16:54:35Z/
    published_at: None
    url: https://git.kernel.org/stable/c/affae18838db5e6b463ee30c821385695af56dc2
  - score: '6.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/db98de0809f12b0edb9cd1be78e1ec1bfeba8f40
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-01-14T16:54:35Z/
    published_at: None
    url: https://git.kernel.org/stable/c/db98de0809f12b0edb9cd1be78e1ec1bfeba8f40
weaknesses:
  - CWE-413
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52765.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52765
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/4ce77b023d42a9f1062eecf438df1af4b4072eb2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7b439aaa62fee474a0d84d67a25f4984467e7b95
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/affae18838db5e6b463ee30c821385695af56dc2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/db98de0809f12b0edb9cd1be78e1ec1bfeba8f40
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2282774
    reference_type:
    reference_id: 2282774
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52765
    reference_type:
    reference_id: CVE-2023-52765
