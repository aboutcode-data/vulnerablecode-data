vulnerability_id: VCID-h59n-w72m-wfhj
aliases:
  - CVE-2025-38557
summary: 'In the Linux kernel, the following vulnerability has been resolved:  HID: apple: validate
  feature-report field count to prevent NULL pointer dereference  A malicious HID device with
  quirk APPLE_MAGIC_BACKLIGHT can trigger a NULL pointer dereference whilst the power feature-report
  is toggled and sent to the device in apple_magic_backlight_report_set(). The power feature-report
  is expected to have two data fields, but if the descriptor declares one field then accessing
  field[1] and dereferencing it in apple_magic_backlight_report_set() becomes invalid since
  field[1] will be NULL.  An example of a minimal descriptor which can cause the crash is something
  like the following where the report with ID 3 (power report) only references a single 1-byte
  field. When hid core parses the descriptor it will encounter the final feature tag, allocate
  a hid_report (all members of field[] will be zeroed out), create field structure and populate
  it, increasing the maxfield to 1. The subsequent field[1] access and dereference causes the
  crash.    Usage Page (Vendor Defined 0xFF00)   Usage (0x0F)   Collection (Application)     Report
  ID (1)     Usage (0x01)     Logical Minimum (0)     Logical Maximum (255)     Report Size
  (8)     Report Count (1)     Feature (Data,Var,Abs)      Usage (0x02)     Logical Maximum
  (32767)     Report Size (16)     Report Count (1)     Feature (Data,Var,Abs)      Report ID
  (3)     Usage (0x03)     Logical Minimum (0)     Logical Maximum (1)     Report Size (8)     Report
  Count (1)     Feature (Data,Var,Abs)   End Collection  Here we see the KASAN splat when the
  kernel dereferences the NULL pointer and crashes:    [   15.164723] Oops: general protection
  fault, probably for non-canonical address 0xdffffc0000000006: 0000 [#1] SMP KASAN NOPTI   [   15.165691]
  KASAN: null-ptr-deref in range [0x0000000000000030-0x0000000000000037]   [   15.165691] CPU:
  0 UID: 0 PID: 10 Comm: kworker/0:1 Not tainted 6.15.0 #31 PREEMPT(voluntary)   [   15.165691]
  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014   [   15.165691]
  RIP: 0010:apple_magic_backlight_report_set+0xbf/0x210   [   15.165691] Call Trace:   [   15.165691]  <TASK>   [   15.165691]  apple_probe+0x571/0xa20   [   15.165691]  hid_device_probe+0x2e2/0x6f0   [   15.165691]  really_probe+0x1ca/0x5c0   [   15.165691]  __driver_probe_device+0x24f/0x310   [   15.165691]  driver_probe_device+0x4a/0xd0   [   15.165691]  __device_attach_driver+0x169/0x220   [   15.165691]  bus_for_each_drv+0x118/0x1b0   [   15.165691]  __device_attach+0x1d5/0x380   [   15.165691]  device_initial_probe+0x12/0x20   [   15.165691]  bus_probe_device+0x13d/0x180   [   15.165691]  device_add+0xd87/0x1510   [...]  To
  fix this issue we should validate the number of fields that the backlight and power reports
  have and if they do not have the required number of fields then bail.'
severities:
  - score: '4.6'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38557.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38557.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0281'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.0278'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02751'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05224'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.05204'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04648'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04617'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04556'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04588'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04593'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04578'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00023'
    scoring_system: epss
    scoring_elements: '0.04702'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05633'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05662'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05644'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05618'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05599'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05604'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05587'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05578'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05584'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05394'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05364'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05454'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05453'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05451'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05617'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05606'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05645'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05595'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0557'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05602'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0563'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05962'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05981'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06087'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.06061'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0596'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38557.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38557
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2389511
    reference_type:
    reference_id: 2389511
  - url: https://usn.ubuntu.com/7879-1/
    reference_type:
    reference_id: USN-7879-1
  - url: https://usn.ubuntu.com/7879-2/
    reference_type:
    reference_id: USN-7879-2
  - url: https://usn.ubuntu.com/7879-3/
    reference_type:
    reference_id: USN-7879-3
  - url: https://usn.ubuntu.com/7879-4/
    reference_type:
    reference_id: USN-7879-4
  - url: https://usn.ubuntu.com/7880-1/
    reference_type:
    reference_id: USN-7880-1
  - url: https://usn.ubuntu.com/7934-1/
    reference_type:
    reference_id: USN-7934-1
