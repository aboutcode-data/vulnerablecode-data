vulnerability_id: VCID-edcb-qe8p-kkhg
aliases:
  - CVE-2024-45159
summary: An issue was discovered in Mbed TLS 3.x before 3.6.1. With TLS 1.3, when a server enables
  optional authentication of the client, if the client-provided certificate does not have appropriate
  values in if keyUsage or extKeyUsage extensions, then the return value of mbedtls_ssl_get_verify_result()
  would incorrectly have the MBEDTLS_X509_BADCERT_KEY_USAGE and MBEDTLS_X509_BADCERT_KEY_USAGE
  bits clear. As a result, an attacker that had a certificate valid for uses other than TLS
  client authentication would nonetheless be able to use it for TLS client authentication. Only
  TLS 1.3 servers were affected, and only with optional authentication (with required authentication,
  the handshake would be aborted with a fatal alert).
severities:
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.32210'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31104'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31404'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31483'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31508'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31619'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31618'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31624'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31643'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31668'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31889'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31947'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.32042'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31838'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31843'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31823'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35926'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35855'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35921'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35991'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.36035'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.36041'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35953'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35956'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35965'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35967'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35987'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.3598'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00144'
    scoring_system: epss
    scoring_elements: '0.35949'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00189'
    scoring_system: epss
    scoring_elements: '0.37776'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00189'
    scoring_system: epss
    scoring_elements: '0.37873'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00189'
    scoring_system: epss
    scoring_elements: '0.37846'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00189'
    scoring_system: epss
    scoring_elements: '0.37811'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.3796'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.0019'
    scoring_system: epss
    scoring_elements: '0.37922'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41688'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41707'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41677'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41654'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41665'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41693'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.4172'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41675'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00218'
    scoring_system: epss
    scoring_elements: '0.41682'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '0.00447'
    scoring_system: epss
    scoring_elements: '0.46386'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Mbed-TLS/mbedtls/releases/
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Mbed-TLS/mbedtls/releases/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-02-03T18:17:13Z/
    published_at: None
    url: https://github.com/Mbed-TLS/mbedtls/releases/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-02-03T18:17:13Z/
    published_at: None
    url: https://github.com/Mbed-TLS/mbedtls/releases/
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-02-03T18:17:13Z/
    published_at: None
    url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-02-03T18:17:13Z/
    published_at: None
    url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-3/
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-3/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-02-03T18:17:13Z/
    published_at: None
    url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-3/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:T/P:M/B:A/M:M/D:T/2025-02-03T18:17:13Z/
    published_at: None
    url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-3/
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-45159
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-45159
weaknesses:
  - CWE-295
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-45159
    reference_type:
    reference_id:
  - url: https://github.com/Mbed-TLS/mbedtls/releases/
    reference_type:
    reference_id:
  - url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/
    reference_type:
    reference_id:
  - url: https://mbed-tls.readthedocs.io/en/latest/security-advisories/mbedtls-security-advisory-2024-08-3/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:arm:mbed_tls:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:arm:mbed_tls:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-45159
    reference_type:
    reference_id: CVE-2024-45159
