vulnerability_id: VCID-edfa-7t7q-skd2
aliases:
  - CVE-2025-68614
  - GHSA-c89f-8g7g-59wj
summary: |
  Please find POC file here https://trendmicro-my.sharepoint.com/:u:/p/kholoud_altookhy/IQCfcnOE5ykQSb6Fm-HFI872AZ_zeIJxU-3aDk0jh_eX_NE?e=zkN76d

  ZDI-CAN-28575: LibreNMS Alert Rule API Cross-Site Scripting Vulnerability

  -- CVSS -----------------------------------------

  4.3: AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:L

  -- ABSTRACT -------------------------------------

  Trend Micro's Zero Day Initiative has identified a vulnerability affecting the following products:
  LibreNMS - LibreNMS

  -- VULNERABILITY DETAILS ------------------------
  * Version tested:  25.10.0
  * Installer file:  NA
  * Platform tested: NA

  ---

  ### Analysis

  LibreNMS Alert Rule API Stored Cross-Site Scripting

  # Overview
  Alert rules can be created or updated via LibreNMS API. The alert rule name is not properly sanitized, and can be used to inject HTML code.

  # Affected versions
  The latest version at the time of writing (25.10.0) is vulnerable.

  # Root cause
  When an alert rule is created or updated via the API, function `add_edit_rule()` in `includes/html/api_functions.inc.php` is called to add/update the entry in the database. When an alert rule is created via the web interface, HTML tags are stripped from the rule name, however this is not the case when using the API.

  As such, it is possible to create an alert rule where the name is:
  ```
  <script>alert(1)</script>
  ```

  Later, when a victim browses to the Alerts > Alert Rule page, PHP script\xc2\xa0`includes/html/print-alert/rules.php`\xc2\xa0is called. It notably includes the file\xc2\xa0`includes/html/modal/alert_rule_list.inc.php`, which returns HTML code for a modal window that searches alert rules.

  The modal window includes an HTML table with all rules, including their name, and an inline JavaScript that calls the\xc2\xa0`bootgrid()`\xc2\xa0function ([http://www.jquery-bootgrid.com/](http://www.jquery-bootgrid.com/)) for styling and enhancing the table.

  `alert_rule.list.inc.php` sanitizes the rule name with the function `e()` before including it in the table, which XML encodes all special characters. However the\xc2\xa0`bootgrid()`\xc2\xa0function rewrites the table cells content when enhancing the table, and as a side effect, XML character references are decoded. After the script updated the table, the browser now interprets the payload as HTML tags and includes the code to the DOM.

  # Detection guidance
  - inspect HTTP POST and PUT requests to a Request-URI that includes the string\xc2\xa0`/api/v0/rules`
  - check if the\xc2\xa0`name`\xc2\xa0JSON value includes a `<` character

  # PoC
  The proof-of-concept can be run as such:
  ```
  python3 poc.py ip_addr -T <token>
  ```


  -- CREDIT ---------------------------------------
  This vulnerability was discovered by:
  Simon Humbert of Trend Research of Trend Micro

  -- FURTHER DETAILS ------------------------------

  Supporting files:


  If supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number.

  Please confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 120 days of the reported date. If you are ready to release a patch at any point leading up to the deadline, please coordinate with us so that we may release our advisory detailing the issue. If the 120-day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations, so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time:

  Zero Day Initiative
  zdi-disclosures@trendmicro.com

  The PGP key used for all ZDI vendor communications is available from:

    http://www.zerodayinitiative.com/documents/disclosures-pgp-key.asc

  -- INFORMATION ABOUT THE ZDI --------------------
  Established by TippingPoint and acquired by Trend Micro, the Zero Day Initiative (ZDI) neither re-sells vulnerability details nor exploit code. Instead, upon notifying the affected product vendor, the ZDI provides its Trend Micro TippingPoint customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available.

  Please contact us for further details or refer to:

    http://www.zerodayinitiative.com

  -- DISCLOSURE POLICY ----------------------------

  Our vulnerability disclosure policy is available online at:

    http://www.zerodayinitiative.com/advisories/disclosure_policy/
severities:
  - score: 2e-05
    scoring_system: epss
    scoring_elements: '0.00023'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68614
  - score: 2e-05
    scoring_system: epss
    scoring_elements: '0.00024'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-68614
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-c89f-8g7g-59wj
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/librenms/librenms
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/librenms/librenms/commit/ebe6c79bf4ce0afeb575c1285afe3934e44001f1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/commit/ebe6c79bf4ce0afeb575c1285afe3934e44001f1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-22T23:55:04Z/
    published_at: None
    url: https://github.com/librenms/librenms/commit/ebe6c79bf4ce0afeb575c1285afe3934e44001f1
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-c89f-8g7g-59wj
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-c89f-8g7g-59wj
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-c89f-8g7g-59wj
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-12-22T23:55:04Z/
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-c89f-8g7g-59wj
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:L
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-68614
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-68614
weaknesses:
  - CWE-79
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-68614
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/ebe6c79bf4ce0afeb575c1285afe3934e44001f1
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-c89f-8g7g-59wj
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-68614
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-c89f-8g7g-59wj
    reference_type:
    reference_id: GHSA-c89f-8g7g-59wj
