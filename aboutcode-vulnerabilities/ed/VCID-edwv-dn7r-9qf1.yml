vulnerability_id: VCID-edwv-dn7r-9qf1
aliases:
  - CVE-2023-52981
summary: 'In the Linux kernel, the following vulnerability has been resolved:  drm/i915: Fix
  request ref counting during error capture & debugfs dump  When GuC support was added to error
  capture, the reference counting around the request object was broken. Fix it up.  The context
  based search manages the spinlocking around the search internally. So it needs to grab the
  reference count internally as well. The execlist only request based search relies on external
  locking, so it needs an external reference count but within the spinlock not outside it.  The
  only other caller of the context based search is the code for dumping engine state to debugfs.
  That code wasn''t previously getting an explicit reference at all as it does everything while
  holding the execlist specific spinlock. So, that needs updaing as well as that spinlock doesn''t
  help when using GuC submission. Rather than trying to conditionally get/put depending on submission
  model, just change it to always do the get/put.  v2: Explicitly document adding an extra blank
  line in some dense code (Andy Shevchenko). Fix multiple potential null pointer derefs in case
  of no request found (some spotted by Tvrtko, but there was more!). Also fix a leaked request
  in case of !started and another in __guc_reset_context now that intel_context_find_active_request
  is actually reference counting the returned request. v3: Add a _get suffix to intel_context_find_active_request
  now that it grabs a reference (Daniele). v4: Split the intel_guc_find_hung_context change
  to a separate patch and rename intel_context_find_active_request_get to intel_context_get_active_request
  (Tvrtko). v5: s/locking/reference counting/ in commit message (Tvrtko)  (cherry picked from
  commit 3700e353781e27f1bc7222f51f2cc36cbeb9b4ec)'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52981.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.01571'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02645'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.02651'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03829'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03837'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03861'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03859'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03881'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03912'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03906'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03901'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03895'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03882'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04946'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04969'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05001'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04986'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04962'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04951'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04923'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04919'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04929'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04931'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04937'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04944'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03839'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03828'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.03826'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05568'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-52981.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-52981
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/86d8ddc74124c3fdfc139f246ba6da15e45e86e3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9467397f417dd7b5d0db91452f0474e79716a527
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355444
    reference_type:
    reference_id: 2355444
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-52981
    reference_type:
    reference_id: CVE-2023-52981
