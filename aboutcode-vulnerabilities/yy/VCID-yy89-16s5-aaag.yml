vulnerability_id: VCID-yy89-16s5-aaag
aliases:
  - CVE-2024-26725
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  dpll: fix possible deadlock during netlink dump operation

  Recently, I've been hitting following deadlock warning during dpll pin
  dump:

  [52804.637962] ======================================================
  [52804.638536] WARNING: possible circular locking dependency detected
  [52804.639111] 6.8.0-rc2jiri+ #1 Not tainted
  [52804.639529] ------------------------------------------------------
  [52804.640104] python3/2984 is trying to acquire lock:
  [52804.640581] ffff88810e642678 (nlk_cb_mutex-GENERIC){+.+.}-{3:3}, at: netlink_dump+0xb3/0x780
  [52804.641417]
                 but task is already holding lock:
  [52804.642010] ffffffff83bde4c8 (dpll_lock){+.+.}-{3:3}, at: dpll_lock_dumpit+0x13/0x20
  [52804.642747]
                 which lock already depends on the new lock.

  [52804.643551]
                 the existing dependency chain (in reverse order) is:
  [52804.644259]
                 -> #1 (dpll_lock){+.+.}-{3:3}:
  [52804.644836]        lock_acquire+0x174/0x3e0
  [52804.645271]        __mutex_lock+0x119/0x1150
  [52804.645723]        dpll_lock_dumpit+0x13/0x20
  [52804.646169]        genl_start+0x266/0x320
  [52804.646578]        __netlink_dump_start+0x321/0x450
  [52804.647056]        genl_family_rcv_msg_dumpit+0x155/0x1e0
  [52804.647575]        genl_rcv_msg+0x1ed/0x3b0
  [52804.648001]        netlink_rcv_skb+0xdc/0x210
  [52804.648440]        genl_rcv+0x24/0x40
  [52804.648831]        netlink_unicast+0x2f1/0x490
  [52804.649290]        netlink_sendmsg+0x36d/0x660
  [52804.649742]        __sock_sendmsg+0x73/0xc0
  [52804.650165]        __sys_sendto+0x184/0x210
  [52804.650597]        __x64_sys_sendto+0x72/0x80
  [52804.651045]        do_syscall_64+0x6f/0x140
  [52804.651474]        entry_SYSCALL_64_after_hwframe+0x46/0x4e
  [52804.652001]
                 -> #0 (nlk_cb_mutex-GENERIC){+.+.}-{3:3}:
  [52804.652650]        check_prev_add+0x1ae/0x1280
  [52804.653107]        __lock_acquire+0x1ed3/0x29a0
  [52804.653559]        lock_acquire+0x174/0x3e0
  [52804.653984]        __mutex_lock+0x119/0x1150
  [52804.654423]        netlink_dump+0xb3/0x780
  [52804.654845]        __netlink_dump_start+0x389/0x450
  [52804.655321]        genl_family_rcv_msg_dumpit+0x155/0x1e0
  [52804.655842]        genl_rcv_msg+0x1ed/0x3b0
  [52804.656272]        netlink_rcv_skb+0xdc/0x210
  [52804.656721]        genl_rcv+0x24/0x40
  [52804.657119]        netlink_unicast+0x2f1/0x490
  [52804.657570]        netlink_sendmsg+0x36d/0x660
  [52804.658022]        __sock_sendmsg+0x73/0xc0
  [52804.658450]        __sys_sendto+0x184/0x210
  [52804.658877]        __x64_sys_sendto+0x72/0x80
  [52804.659322]        do_syscall_64+0x6f/0x140
  [52804.659752]        entry_SYSCALL_64_after_hwframe+0x46/0x4e
  [52804.660281]
                 other info that might help us debug this:

  [52804.661077]  Possible unsafe locking scenario:

  [52804.661671]        CPU0                    CPU1
  [52804.662129]        ----                    ----
  [52804.662577]   lock(dpll_lock);
  [52804.662924]                                lock(nlk_cb_mutex-GENERIC);
  [52804.663538]                                lock(dpll_lock);
  [52804.664073]   lock(nlk_cb_mutex-GENERIC);
  [52804.664490]

  The issue as follows: __netlink_dump_start() calls control->start(cb)
  with nlk->cb_mutex held. In control->start(cb) the dpll_lock is taken.
  Then nlk->cb_mutex is released and taken again in netlink_dump(), while
  dpll_lock still being held. That leads to ABBA deadlock when another
  CPU races with the same operation.

  Fix this by moving dpll_lock taking into dumpit() callback which ensures
  correct lock taking order.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26725.json
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09356'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09415'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09438'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09423'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09428'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09441'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0946'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09515'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09533'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0955'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09483'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.09367'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.0932'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12739'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12726'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12684'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12621'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12715'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12699'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12686'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12697'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.1272'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12681'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12638'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12472'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12497'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.0005'
    scoring_system: epss
    scoring_elements: '0.12643'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '0.00219'
    scoring_system: epss
    scoring_elements: '0.30224'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26725
weaknesses:
  - CWE-667
  - CWE-833
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26725.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-26725
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/087739cbd0d0b87b6cec2c0799436ac66e24acc8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/53c0441dd2c44ee93fddb5473885fd41e4bc2361
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2273130
    reference_type:
    reference_id: 2273130
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26725
    reference_type:
    reference_id: CVE-2024-26725
  - url: https://access.redhat.com/errata/RHSA-2024:9315
    reference_type:
    reference_id: RHSA-2024:9315
