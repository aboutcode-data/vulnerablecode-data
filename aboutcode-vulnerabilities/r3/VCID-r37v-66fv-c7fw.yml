vulnerability_id: VCID-r37v-66fv-c7fw
aliases:
  - CVE-2025-38684
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net/sched: ets:
  use old ''nbands'' while purging unused classes  Shuang reported sch_ets test-case [1] crashing
  in ets_class_qlen_notify() after recent changes from Lion [2]. The problem is: in ets_qdisc_change()
  we purge unused DWRR queues; the value of ''q->nbands'' is the new one, and the cleanup should
  be done with the old one. The problem is here since my first attempts to fix ets_qdisc_change(),
  but it surfaced again after the recent qdisc len accounting fixes. Fix it purging idle DWRR
  queues before assigning a new value of ''q->nbands'', so that all purge operations find a
  consistent configuration:   - old ''q->nbands'' because it''s needed by ets_class_find()  -
  old ''q->nstrict'' because it''s needed by ets_class_is_strict()   BUG: kernel NULL pointer
  dereference, address: 0000000000000000  #PF: supervisor read access in kernel mode  #PF: error_code(0x0000)
  - not-present page  PGD 0 P4D 0  Oops: Oops: 0000 [#1] SMP NOPTI  CPU: 62 UID: 0 PID: 39457
  Comm: tc Kdump: loaded Not tainted 6.12.0-116.el10.x86_64 #1 PREEMPT(voluntary)  Hardware
  name: Dell Inc. PowerEdge R640/06DKY5, BIOS 2.12.2 07/09/2021  RIP: 0010:__list_del_entry_valid_or_report+0x4/0x80  Code:
  ff 4c 39 c7 0f 84 39 19 8e ff b8 01 00 00 00 c3 cc cc cc cc 66 90 90 90 90 90 90 90 90 90
  90 90 90 90 90 90 90 90 f3 0f 1e fa <48> 8b 17 48 8b 4f 08 48 85 d2 0f 84 56 19 8e ff 48 85
  c9 0f 84 ab  RSP: 0018:ffffba186009f400 EFLAGS: 00010202  RAX: 00000000000000d6 RBX: 0000000000000000
  RCX: 0000000000000004  RDX: ffff9f0fa29b69c0 RSI: 0000000000000000 RDI: 0000000000000000  RBP:
  ffffffffc12c2400 R08: 0000000000000008 R09: 0000000000000004  R10: ffffffffffffffff R11: 0000000000000004
  R12: 0000000000000000  R13: ffff9f0f8cfe0000 R14: 0000000000100005 R15: 0000000000000000  FS:  00007f2154f37480(0000)
  GS:ffff9f269c1c0000(0000) knlGS:0000000000000000  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033  CR2:
  0000000000000000 CR3: 00000001530be001 CR4: 00000000007726f0  DR0: 0000000000000000 DR1: 0000000000000000
  DR2: 0000000000000000  DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400  PKRU:
  55555554  Call Trace:   <TASK>   ets_class_qlen_notify+0x65/0x90 [sch_ets]   qdisc_tree_reduce_backlog+0x74/0x110   ets_qdisc_change+0x630/0xa40
  [sch_ets]   __tc_modify_qdisc.constprop.0+0x216/0x7f0   tc_modify_qdisc+0x7c/0x120   rtnetlink_rcv_msg+0x145/0x3f0   netlink_rcv_skb+0x53/0x100   netlink_unicast+0x245/0x390   netlink_sendmsg+0x21b/0x470   ____sys_sendmsg+0x39d/0x3d0   ___sys_sendmsg+0x9a/0xe0   __sys_sendmsg+0x7a/0xd0   do_syscall_64+0x7d/0x160   entry_SYSCALL_64_after_hwframe+0x76/0x7e  RIP:
  0033:0x7f2155114084  Code: 89 02 b8 ff ff ff ff eb bb 66 2e 0f 1f 84 00 00 00 00 00 0f 1f
  00 f3 0f 1e fa 80 3d 25 f0 0c 00 00 74 13 b8 2e 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3
  0f 1f 00 48 83 ec 28 89 54 24 1c 48 89  RSP: 002b:00007fff1fd7a988 EFLAGS: 00000202 ORIG_RAX:
  000000000000002e  RAX: ffffffffffffffda RBX: 0000560ec063e5e0 RCX: 00007f2155114084  RDX:
  0000000000000000 RSI: 00007fff1fd7a9f0 RDI: 0000000000000003  RBP: 00007fff1fd7aa60 R08: 0000000000000010
  R09: 000000000000003f  R10: 0000560ee9b3a010 R11: 0000000000000202 R12: 00007fff1fd7aae0  R13:
  000000006891ccde R14: 0000560ec063e5e0 R15: 00007fff1fd7aad0   </TASK>   [1] https://lore.kernel.org/netdev/e08c7f4a6882f260011909a868311c6e9b54f3e4.1639153474.git.dcaratti@redhat.com/  [2]
  https://lore.kernel.org/netdev/d912cbd7-193b-4269-9857-525bee8bbb6a@gmail.com/'
severities:
  - score: '5.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38684.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38684.json
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04981'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05033'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05084'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07777'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0781'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07772'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07843'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0783'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0801'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08001'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08009'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08145'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0808'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08136'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07549'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07653'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07628'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.07738'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09228'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09208'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09261'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09305'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09348'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09362'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09374'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09308'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09293'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09402'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.0934'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09352'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09363'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09383'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09511'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00035'
    scoring_system: epss
    scoring_elements: '0.09468'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '0.00064'
    scoring_system: epss
    scoring_elements: '0.20127'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38684.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38684
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-38684
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2393190
    reference_type:
    reference_id: 2393190
  - url: https://access.redhat.com/errata/RHSA-2025:15011
    reference_type:
    reference_id: RHSA-2025:15011
  - url: https://access.redhat.com/errata/RHSA-2025:15035
    reference_type:
    reference_id: RHSA-2025:15035
  - url: https://access.redhat.com/errata/RHSA-2025:15447
    reference_type:
    reference_id: RHSA-2025:15447
  - url: https://access.redhat.com/errata/RHSA-2025:15785
    reference_type:
    reference_id: RHSA-2025:15785
  - url: https://usn.ubuntu.com/7909-1/
    reference_type:
    reference_id: USN-7909-1
  - url: https://usn.ubuntu.com/7909-2/
    reference_type:
    reference_id: USN-7909-2
  - url: https://usn.ubuntu.com/7909-3/
    reference_type:
    reference_id: USN-7909-3
  - url: https://usn.ubuntu.com/7909-4/
    reference_type:
    reference_id: USN-7909-4
  - url: https://usn.ubuntu.com/7909-5/
    reference_type:
    reference_id: USN-7909-5
  - url: https://usn.ubuntu.com/7910-1/
    reference_type:
    reference_id: USN-7910-1
  - url: https://usn.ubuntu.com/7910-2/
    reference_type:
    reference_id: USN-7910-2
  - url: https://usn.ubuntu.com/7933-1/
    reference_type:
    reference_id: USN-7933-1
  - url: https://usn.ubuntu.com/7938-1/
    reference_type:
    reference_id: USN-7938-1
