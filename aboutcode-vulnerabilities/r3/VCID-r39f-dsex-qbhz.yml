vulnerability_id: VCID-r39f-dsex-qbhz
aliases:
  - CVE-2026-21859
  - GHSA-8v65-47jx-7mfr
summary: "Mailpit Proxy Endpoint has Server-Side Request Forgery (SSRF) vulnerability\n## Summary\n\
  \nA Server-Side Request Forgery (SSRF) vulnerability exists in Mailpit's `/proxy` endpoint\
  \ that allows attackers to make requests to internal network resources.\n\n\n## Description\n\
  \nThe `/proxy` endpoint allows requests to internal network resources. While it validates\
  \ `http://` and `https://` schemes, it does not block internal IP addresses, allowing attackers\
  \ to access internal services and APIs.\n\n## Proof of Concept\n\n### Basic SSRF Request\n\
  ```\nGET /proxy?url=http://127.0.0.1:8025/api/v1/info\n```\n\nThis returns internal API data\
  \ including database path and runtime statistics.\n \n## Impact Assessment\n\n### 1. Internal\
  \ Network Scanning\nAttacker can probe and discover internal services on the network.\n\n\
  ### 2. Information Disclosure\nAccess to internal API data, database paths, and runtime statistics.\n\
  \n### 3. Email Content Access\nAbility to read all captured emails via internal API endpoints.\n\
  \n### 4. Cloud Metadata Access\nIf deployed in cloud environments (AWS/GCP/Azure), potential\
  \ access to instance metadata services (e.g., `http://169.254.169.254/`).\n\n## Attack Scenarios\n\
  \n### Scenario 1: Development Environment Exposure\nIf Mailpit is accidentally exposed to\
  \ the internet, attackers can leverage SSRF to access internal development resources and services.\n\
  \n### Scenario 2: Container Escape Information\nIn containerized deployments, SSRF can reveal\
  \ container metadata and internal service configurations.\n\n### Scenario 3: Lateral Movement\n\
  In corporate networks, SSRF can be used to discover and interact with internal services, facilitating\
  \ lateral movement.\n\n## Mitigating Factors\nThis vulnerability is limited to HTTP GET requests\
  \ with minimal headers. Additionally, Mailpit's web UI & API should be protected by basic\
  \ authentication when exposed to the internet, which prevents access to the proxy endpoint.\
  \ \n\n## Resources\n\n- [MDN Web Security - SSRF Attacks](https://developer.mozilla.org/en-US/docs/Web/Security/Attacks/SSRF)\n\
  - [CWE-918: Server-Side Request Forgery](https://cwe.mitre.org/data/definitions/918.html)\n\
  - [OWASP SSRF Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html)"
severities:
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.0072'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2026-21859
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.0071'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2026-21859
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/axllent/mailpit
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/axllent/mailpit
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/axllent/mailpit/commit/3b9b470c093b3d20b7d751722c1c24f3eed2e19d
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/axllent/mailpit/commit/3b9b470c093b3d20b7d751722c1c24f3eed2e19d
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-08T19:23:19Z/
    published_at: None
    url: https://github.com/axllent/mailpit/commit/3b9b470c093b3d20b7d751722c1c24f3eed2e19d
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/axllent/mailpit/security/advisories/GHSA-8v65-47jx-7mfr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/axllent/mailpit/security/advisories/GHSA-8v65-47jx-7mfr
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2026-01-08T19:23:19Z/
    published_at: None
    url: https://github.com/axllent/mailpit/security/advisories/GHSA-8v65-47jx-7mfr
  - score: '5.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21859
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2026-21859
weaknesses:
  - CWE-918
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2026-21859
    reference_type:
    reference_id:
  - url: https://github.com/axllent/mailpit
    reference_type:
    reference_id:
  - url: https://github.com/axllent/mailpit/commit/3b9b470c093b3d20b7d751722c1c24f3eed2e19d
    reference_type:
    reference_id:
  - url: https://github.com/axllent/mailpit/security/advisories/GHSA-8v65-47jx-7mfr
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2026-21859
    reference_type:
    reference_id:
