vulnerability_id: VCID-dhh5-tz8w-pyge
aliases:
  - CVE-2025-64173
  - GHSA-x33c-7c2v-mrj9
summary: |
  Apollo Router Affected by an Access Control Bypass on Polymorphic Types
  # Summary

  A vulnerability in Apollo Router allowed for unauthenticated queries to access data that required additional access controls. Router incorrectly handled access control directives on interface types/fields and their implementing object types/fields, applying them to interface types/fields while ignoring directives on their implementing object types/fields when all implementations had the same requirements.

  ## Details

  Apollo Federation allows users to specify access control directives ([`@authenticated`, `@requiresScopes`, and `@policy`](https://www.apollographql.com/docs/graphos/routing/security/authorization#authorization-directives)) to protect object and interface types and fields. However, the GraphQL specification does not define inheritance rules for directives from interfaces to their implementations. Apollo Router will enforce any directives on the interface types/fields but ignore any directives on the implementation object types/fields (as long as all implementations have the same requirements). This inconsistent enforcement behavior leads to unexpected runtime security gaps.

  ## Who is impacted

  This vulnerability impacts Apollo Router customers defining `@authenticated`, `@requiresScopes`, or `@policy` directives inconsistently on polymorphic types (i.e., object types that implement interface types).  Specifically, if the same access control directives are applied to all implementing types/fields but not on their implemented interface types/fields, they could be impacted.

  ### Scope of Impact

  This vulnerability could allow a malicious actor to craft a query that can bypass access control requirements on the object types/fields by instead querying them via implemented interface types/fields that don't have the same access control requirements.

  ## Patches

  This vulnerability has been fixed at runtime in Apollo Router. You may update Router to one of the following versions:

  - 1.61.12+
  - 2.8.1+

  ## Workarounds

  - If you are not immediately updating Router to a patched version, you should apply any included access control requirements to *both* the appropriate interface types/fields and their implementations.
  - Customers not using Apollo Router access control features (`@authenticated`, `@requiresScopes`, or `@policy` directives) or not specifying inconsistent access control requirements on polymorphic types/fields are not affected and do not need to take action.
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.13032'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64173
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.12996'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64173
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-x33c-7c2v-mrj9
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/apollographql/router
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apollographql/router
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/apollographql/router/commit/75ca43ecb9d38423b63d09896702f9da425cc754
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apollographql/router/commit/75ca43ecb9d38423b63d09896702f9da425cc754
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/apollographql/router/releases/tag/v2.8.1
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apollographql/router/releases/tag/v2.8.1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-11-07T13:48:28Z/
    published_at: None
    url: https://github.com/apollographql/router/releases/tag/v2.8.1
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/apollographql/router/security/advisories/GHSA-x33c-7c2v-mrj9
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/apollographql/router/security/advisories/GHSA-x33c-7c2v-mrj9
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apollographql/router/security/advisories/GHSA-x33c-7c2v-mrj9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-11-07T13:48:28Z/
    published_at: None
    url: https://github.com/apollographql/router/security/advisories/GHSA-x33c-7c2v-mrj9
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-64173
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-64173
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://www.apollographql.com/docs/graphos/routing/security/authorization#authorization-directives
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.apollographql.com/docs/graphos/routing/security/authorization#authorization-directives
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:Y/T:P/P:M/B:A/M:M/D:T/2025-11-07T13:48:28Z/
    published_at: None
    url: https://www.apollographql.com/docs/graphos/routing/security/authorization#authorization-directives
weaknesses:
  - CWE-288
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-64173
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/commit/75ca43ecb9d38423b63d09896702f9da425cc754
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/releases/tag/v2.8.1
    reference_type:
    reference_id:
  - url: https://github.com/apollographql/router/security/advisories/GHSA-x33c-7c2v-mrj9
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64173
    reference_type:
    reference_id:
  - url: https://www.apollographql.com/docs/graphos/routing/security/authorization#authorization-directives
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-x33c-7c2v-mrj9
    reference_type:
    reference_id: GHSA-x33c-7c2v-mrj9
