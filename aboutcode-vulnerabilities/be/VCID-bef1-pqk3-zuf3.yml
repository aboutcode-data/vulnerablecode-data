vulnerability_id: VCID-bef1-pqk3-zuf3
aliases:
  - CVE-2025-64717
  - GHSA-j4g7-v4m4-77px
summary: |
  ZITADEL is vulnerable to Account Takeover with deactivated Instance IdP
  ### Summary

  A vulnerability in ZITADEL's federation process allowed auto-linking users from external identity providers to existing users in ZITADEL even if the corresponding IdP was not active or if the organization did not allow federated authentication.

  ### Impact

  This vulnerability stems from the platform's failure to correctly check or enforce an organization's specific security settings during the authentication flow. An Organization Administrator can explicitly disable an IdP or disallow federation, but this setting was not being honored during the auto-linking process.

  This allowed an unauthenticated attacker to initiate a login using an IdP that should have been disabled for that organization. The platform would incorrectly validate the login and, based on a matching criteria, link the attacker's external identity to an existing internal user account.

  This may result in a full Account Takeover, bypassing the organization's mandated security controls. Note that accounts with MFA enabled can not be taken over by this attack. Also note that only IdPs create on an instance level would allow this to work. IdPs registered on another organization would always be denied in the (auto-)linking process.

  ### Affected Versions

  Systems running one of the following versions are affected:
  - **v4.x**: `4.0.0-rc.1` through `4.6.5`
  - **v3.x**: `3.0.0-rc.1` through `3.4.3`
  - **v2.x**: `2.50.0` through `2.71.18`

  ### Patches

  The vulnerability has been addressed in the latest release. The patch resolves the issue by correctly validating the organization's login policy before auto-linking an external user.

  - v4.x: Upgrade to version [4.6.6](https://github.com/zitadel/zitadel/releases/tag/v4.6.6) or later.
  - v3.x: Update to version [3.4.4](https://github.com/zitadel/zitadel/releases/tag/v3.4.4) or later.
  - v2.x: Update to version [2.71.19](https://github.com/zitadel/zitadel/releases/tag/v2.71.19) or later.

  ### Workarounds

  Upgrading to a patched version is the recommended solution.

  ### Questions

  If you have any questions or comments about this advisory, please email Zitadel at [security@zitadel.com](mailto:security@zitadel.com)

  ### Credits

  Thanks to Jan KÃ¼hnlein - kultify for finding and reporting the vulnerability.
severities:
  - score: '0.00451'
    scoring_system: epss
    scoring_elements: '0.6315'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64717
  - score: '0.00451'
    scoring_system: epss
    scoring_elements: '0.63135'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-64717
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel/commit/33c51deb20402dd5720e32cfb0c1d5fdc752f2e0
  - score: '7.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/zitadel/zitadel/releases/tag/v2.71.19
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel/releases/tag/v2.71.19
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-11-13T17:08:48Z/
    published_at: None
    url: https://github.com/zitadel/zitadel/releases/tag/v2.71.19
  - score: '7.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/zitadel/zitadel/releases/tag/v3.4.4
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel/releases/tag/v3.4.4
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-11-13T17:08:48Z/
    published_at: None
    url: https://github.com/zitadel/zitadel/releases/tag/v3.4.4
  - score: '7.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/zitadel/zitadel/releases/tag/v4.6.6
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel/releases/tag/v4.6.6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-11-13T17:08:48Z/
    published_at: None
    url: https://github.com/zitadel/zitadel/releases/tag/v4.6.6
  - score: '7.4'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:P/PR:H/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/zitadel/zitadel/security/advisories/GHSA-j4g7-v4m4-77px
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/zitadel/zitadel/security/advisories/GHSA-j4g7-v4m4-77px
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-11-13T17:08:48Z/
    published_at: None
    url: https://github.com/zitadel/zitadel/security/advisories/GHSA-j4g7-v4m4-77px
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-64717
weaknesses:
  - CWE-287
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-64717
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/commit/33c51deb20402dd5720e32cfb0c1d5fdc752f2e0
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v2.71.19
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v3.4.4
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/releases/tag/v4.6.6
    reference_type:
    reference_id:
  - url: https://github.com/zitadel/zitadel/security/advisories/GHSA-j4g7-v4m4-77px
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-64717
    reference_type:
    reference_id:
