vulnerability_id: VCID-82te-z91c-77bp
aliases:
  - CVE-2023-54112
summary: 'In the Linux kernel, the following vulnerability has been resolved:  kcm: Fix memory
  leak in error path of kcm_sendmsg()  syzbot reported a memory leak like below:  BUG: memory
  leak unreferenced object 0xffff88810b088c00 (size 240):   comm "syz-executor186", pid 5012,
  jiffies 4294943306 (age 13.680s)   hex dump (first 32 bytes):     00 89 08 0b 81 88 ff ff
  00 00 00 00 00 00 00 00  ................     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  00  ................   backtrace:     [<ffffffff83e5d5ff>] __alloc_skb+0x1ef/0x230 net/core/skbuff.c:634     [<ffffffff84606e59>]
  alloc_skb include/linux/skbuff.h:1289 [inline]     [<ffffffff84606e59>] kcm_sendmsg+0x269/0x1050
  net/kcm/kcmsock.c:815     [<ffffffff83e479c6>] sock_sendmsg_nosec net/socket.c:725 [inline]     [<ffffffff83e479c6>]
  sock_sendmsg+0x56/0xb0 net/socket.c:748     [<ffffffff83e47f55>] ____sys_sendmsg+0x365/0x470
  net/socket.c:2494     [<ffffffff83e4c389>] ___sys_sendmsg+0xc9/0x130 net/socket.c:2548     [<ffffffff83e4c536>]
  __sys_sendmsg+0xa6/0x120 net/socket.c:2577     [<ffffffff84ad7bb8>] do_syscall_x64 arch/x86/entry/common.c:50
  [inline]     [<ffffffff84ad7bb8>] do_syscall_64+0x38/0xb0 arch/x86/entry/common.c:80     [<ffffffff84c0008b>]
  entry_SYSCALL_64_after_hwframe+0x63/0xcd  In kcm_sendmsg(), kcm_tx_msg(head)->last_skb is
  used as a cursor to append newly allocated skbs to ''head''. If some bytes are copied, an
  error occurred, and jumped to out_error label, ''last_skb'' is left unmodified. A later kcm_sendmsg()
  will use an obsoleted ''last_skb'' reference, corrupting the ''head'' frag_list and causing
  the leak.  This patch fixes this issue by properly updating the last allocated skb in ''last_skb''.'
severities:
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0895'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54112
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08909'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54112
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54112.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-54112
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-54112
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2425118
    reference_type:
    reference_id: 2425118
