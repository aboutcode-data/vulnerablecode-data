vulnerability_id: VCID-sk33-ath9-aaaf
aliases:
  - CVE-2021-41580
  - GHSA-f794-r6xc-hf3v
summary: |
  Improper Authentication
  ** DISPUTED ** The passport-oauth2 package for Node.js mishandles the error condition of failure to obtain an access token. This is exploitable in certain use cases where an OAuth identity provider uses an HTTP status code for authentication-failure error reports, and an application grants authorization upon simply receiving the access token (i.e., does not try to use the token). NOTE: the passport-oauth2 vendor does not consider this a passport-oauth2 vulnerability.
severities:
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.37921'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38040'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.37565'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.37841'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.37950'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38409'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38333'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38269'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38077'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38065'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38047'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00086'
    scoring_system: epss
    scoring_elements: '0.38035'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46822'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46529'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46531'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46506'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63478'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62062'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62047'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63399'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63439'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63475'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.635'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63505'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63473'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63472'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63476'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63477'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63484'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63494'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63496'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.63482'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.61943'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.61895'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.61992'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.61996'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62024'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62043'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62023'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62015'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62017'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62035'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62051'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62073'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00474'
    scoring_system: epss
    scoring_elements: '0.62072'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: '0.00565'
    scoring_system: epss
    scoring_elements: '0.51629'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-f794-r6xc-hf3v
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/jaredhanson/passport-oauth2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jaredhanson/passport-oauth2
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/jaredhanson/passport-oauth2/commit/8e3bcdff145a2219033bd782fc517229fe3e05ea
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jaredhanson/passport-oauth2/commit/8e3bcdff145a2219033bd782fc517229fe3e05ea
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/jaredhanson/passport-oauth2/compare/v1.6.0...v1.6.1
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jaredhanson/passport-oauth2/compare/v1.6.0...v1.6.1
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/jaredhanson/passport-oauth2/pull/144
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/jaredhanson/passport-oauth2/pull/144
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://medium.com/passportjs/no-access-token-no-service-7fb017c9e262
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://medium.com/passportjs/no-access-token-no-service-7fb017c9e262
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41580
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41580
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41580
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-287
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-41580
    reference_type:
    reference_id:
  - url: https://github.com/jaredhanson/passport-oauth2
    reference_type:
    reference_id:
  - url: https://github.com/jaredhanson/passport-oauth2/commit/8e3bcdff145a2219033bd782fc517229fe3e05ea
    reference_type:
    reference_id:
  - url: https://github.com/jaredhanson/passport-oauth2/compare/v1.6.0...v1.6.1
    reference_type:
    reference_id:
  - url: https://github.com/jaredhanson/passport-oauth2/pull/144
    reference_type:
    reference_id:
  - url: https://medium.com/passportjs/no-access-token-no-service-7fb017c9e262
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:passportjs:passport-oauth2:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:passportjs:passport-oauth2:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41580
    reference_type:
    reference_id: CVE-2021-41580
  - url: https://github.com/advisories/GHSA-f794-r6xc-hf3v
    reference_type:
    reference_id: GHSA-f794-r6xc-hf3v
