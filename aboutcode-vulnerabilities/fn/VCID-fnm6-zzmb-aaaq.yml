vulnerability_id: VCID-fnm6-zzmb-aaaq
aliases:
  - CVE-2021-32839
  - GHSA-p5w8-wqhj-9hhf
  - PYSEC-2021-333
summary: sqlparse is a non-validating SQL parser module for Python. In sqlparse versions 0.4.0
  and 0.4.1 there is a regular Expression Denial of Service in sqlparse vulnerability. The regular
  expression may cause exponential backtracking on strings containing many repetitions of '\r\n'
  in SQL comments. Only the formatting feature that removes comments from SQL statements is
  affected by this regular expression. As a workaround don't use the sqlformat.format function
  with keyword strip_comments=True or the --strip-comments command line flag when using the
  sqlformat command line tool. The issues has been fixed in sqlparse 0.4.2.
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2021/CVE-2021-32839.html
  - score: Moderate
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:5498
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-32839.json
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44592'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44426'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44407'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44393'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44383'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44392'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44315'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44292'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.43958'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44207'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44684'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.44623'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.2987'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25774'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25747'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25759'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25791'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25823'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25818'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25782'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25775'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25754'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29845'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29908'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29971'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.30021'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.3002'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29952'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29934'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29896'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29894'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29899'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29922'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29903'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.29874'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25696'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25643'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25789'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25808'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25815'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00106'
    scoring_system: epss
    scoring_elements: '0.25821'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00114'
    scoring_system: epss
    scoring_elements: '0.46147'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00114'
    scoring_system: epss
    scoring_elements: '0.45854'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00114'
    scoring_system: epss
    scoring_elements: '0.45872'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.00114'
    scoring_system: epss
    scoring_elements: '0.45849'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: '0.0032'
    scoring_system: epss
    scoring_elements: '0.38631'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=2005072
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32839
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p5w8-wqhj-9hhf
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/andialbrecht/sqlparse
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/andialbrecht/sqlparse
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/andialbrecht/sqlparse/commit/8238a9e450ed1524e40cb3a8b0b3c00606903aeb
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/andialbrecht/sqlparse/commit/8238a9e450ed1524e40cb3a8b0b3c00606903aeb
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/andialbrecht/sqlparse/security/advisories/GHSA-p5w8-wqhj-9hhf
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/sqlparse/PYSEC-2021-333.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/sqlparse/PYSEC-2021-333.yaml
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32839
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32839
  - score: High
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2401
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://securitylab.github.com/advisories/GHSL-2021-107-andialbrecht-sqlparse
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://securitylab.github.com/advisories/GHSL-2021-107-andialbrecht-sqlparse
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-5085-1
weaknesses:
  - CWE-400
  - CWE-937
  - CWE-1035
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2021/CVE-2021-32839.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-32839.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-32839
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-32839
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/andialbrecht/sqlparse
    reference_type:
    reference_id:
  - url: https://github.com/andialbrecht/sqlparse/commit/8238a9e450ed1524e40cb3a8b0b3c00606903aeb
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/sqlparse/PYSEC-2021-333.yaml
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2021-107-andialbrecht-sqlparse
    reference_type:
    reference_id:
  - url: https://securitylab.github.com/advisories/GHSL-2021-107-andialbrecht-sqlparse/
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-5085-1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2005072
    reference_type:
    reference_id: 2005072
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=994841
    reference_type:
    reference_id: 994841
  - url: https://security.archlinux.org/AVG-2401
    reference_type:
    reference_id: AVG-2401
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:sqlparse_project:sqlparse:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:sqlparse_project:sqlparse:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-32839
    reference_type:
    reference_id: CVE-2021-32839
  - url: https://github.com/advisories/GHSA-p5w8-wqhj-9hhf
    reference_type:
    reference_id: GHSA-p5w8-wqhj-9hhf
  - url: https://github.com/andialbrecht/sqlparse/security/advisories/GHSA-p5w8-wqhj-9hhf
    reference_type:
    reference_id: GHSA-p5w8-wqhj-9hhf
  - url: https://access.redhat.com/errata/RHSA-2022:5498
    reference_type:
    reference_id: RHSA-2022:5498
  - url: https://usn.ubuntu.com/5085-1/
    reference_type:
    reference_id: USN-5085-1
