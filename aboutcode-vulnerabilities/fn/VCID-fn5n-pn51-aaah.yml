vulnerability_id: VCID-fn5n-pn51-aaah
aliases:
  - CVE-2021-21291
  - GHSA-4mf2-f3wh-gvf2
summary: OAuth2 Proxy is an open-source reverse proxy and static file server that provides authentication
  using Providers (Google, GitHub, and others) to validate accounts by email, domain or group.
  In OAuth2 Proxy before version 7.0.0, for users that use the whitelist domain feature, a domain
  that ended in a similar way to the intended domain could have been allowed as a redirect.
  For example, if a whitelist domain was configured for ".example.com", the intention is that
  subdomains of example.com are allowed. Instead, "example.com" and "badexample.com" could also
  match. This is fixed in version 7.0.0 onwards. As a workaround, one can disable the whitelist
  domain feature and run separate OAuth2 Proxy instances for each subdomain.
severities:
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49154'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49058'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49081'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49161'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49157'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49170'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49433'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49358'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49335'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.49180'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.48712'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00129'
    scoring_system: epss
    scoring_elements: '0.48990'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53490'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53208'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53196'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.53171'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00288'
    scoring_system: epss
    scoring_elements: '0.36049'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54871'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54819'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54879'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54905'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54919'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54839'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54872'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54881'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54884'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.5489'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54909'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54901'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52698'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52683'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52777'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52783'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52805'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52827'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52802'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52803'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52826'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52847'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52855'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52828'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.52812'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '0.00328'
    scoring_system: epss
    scoring_elements: '0.54777'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/oauth2-proxy/oauth2-proxy/commit/780ae4f3c99b579cb2ea9845121caebb6192f725
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/oauth2-proxy/oauth2-proxy/commit/780ae4f3c99b579cb2ea9845121caebb6192f725
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/oauth2-proxy/oauth2-proxy/releases/tag/v7.0.0
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/oauth2-proxy/oauth2-proxy/releases/tag/v7.0.0
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-4mf2-f3wh-gvf2
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-4mf2-f3wh-gvf2
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21291
  - score: '6.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21291
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-21291
  - score: '5.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    published_at: None
    url: https://pkg.go.dev/github.com/oauth2-proxy/oauth2-proxy/v7
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/github.com/oauth2-proxy/oauth2-proxy/v7
weaknesses:
  - CWE-601
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-21291
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/commit/780ae4f3c99b579cb2ea9845121caebb6192f725
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/releases/tag/v7.0.0
    reference_type:
    reference_id:
  - url: https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-4mf2-f3wh-gvf2
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/github.com/oauth2-proxy/oauth2-proxy/v7
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:oauth2_proxy_project:oauth2_proxy:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:oauth2_proxy_project:oauth2_proxy:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-21291
    reference_type:
    reference_id: CVE-2021-21291
