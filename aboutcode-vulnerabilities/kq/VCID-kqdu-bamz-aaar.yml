vulnerability_id: VCID-kqdu-bamz-aaar
aliases:
  - CVE-2021-40828
  - GHSA-94jq-q5v2-76wj
  - PYSEC-2021-861
summary: 'Connections initialized by the AWS IoT Device SDK v2 for Java (versions prior to 1.3.3),
  Python (versions prior to 1.5.18), C++ (versions prior to 1.12.7) and Node.js (versions prior
  to 1.5.1) did not verify server certificate hostname during TLS handshake when overriding
  Certificate Authorities (CA) in their trust stores on Windows. This issue has been addressed
  in aws-c-io submodule versions 0.9.13 onward. This issue affects: Amazon Web Services AWS
  IoT Device SDK v2 for Java versions prior to 1.3.3 on Microsoft Windows. Amazon Web Services
  AWS IoT Device SDK v2 for Python versions prior to 1.5.18 on Microsoft Windows. Amazon Web
  Services AWS IoT Device SDK v2 for C++ versions prior to 1.12.7 on Microsoft Windows. Amazon
  Web Services AWS IoT Device SDK v2 for Node.js versions prior to 1.5.3 on Microsoft Windows.'
severities:
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29239'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29276'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29297'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29358'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.2931'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29243'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25266'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.2918'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25176'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25258'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25199'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25141'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.2525'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25079'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25227'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.2521'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25245'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25259'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25198'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25187'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.25216'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29214'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29217'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29246'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29262'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.29245'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.44593'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.44816'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45060'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45145'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45165'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45245'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45237'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45262'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45288'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45466'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45493'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.45570'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.44617'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.44590'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00109'
    scoring_system: epss
    scoring_elements: '0.44905'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: '0.00255'
    scoring_system: epss
    scoring_elements: '0.33195'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-94jq-q5v2-76wj
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-cpp-v2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-cpp-v2
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-java-v2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-java-v2
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-java-v2/commit/67950ad2a02f2f9355c310b69dc9226b017f32f2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-java-v2/commit/67950ad2a02f2f9355c310b69dc9226b017f32f2
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-js-v2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-js-v2
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-js-v2/commit/4be41394f1aee979e6f4b012fcb01eecabd0c08d
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-js-v2/commit/4be41394f1aee979e6f4b012fcb01eecabd0c08d
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-python-v2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-python-v2
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-python-v2/commit/fd4c0ba04b35eab9e20c635af5548fcc5a92d8be
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/aws/aws-iot-device-sdk-python-v2/commit/fd4c0ba04b35eab9e20c635af5548fcc5a92d8be
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/awslabs/aws-c-io
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/awslabs/aws-c-io
  - score: '6.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/awsiotsdk/PYSEC-2021-861.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/awsiotsdk/PYSEC-2021-861.yaml
  - score: '5.8'
    scoring_system: cvssv2
    scoring_elements: AV:A/AC:L/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40828
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40828
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-40828
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-295
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-40828
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-cpp-v2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-java-v2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-java-v2/commit/67950ad2a02f2f9355c310b69dc9226b017f32f2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-js-v2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-js-v2/commit/4be41394f1aee979e6f4b012fcb01eecabd0c08d
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-python-v2
    reference_type:
    reference_id:
  - url: https://github.com/aws/aws-iot-device-sdk-python-v2/commit/fd4c0ba04b35eab9e20c635af5548fcc5a92d8be
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/aws-c-io
    reference_type:
    reference_id:
  - url: https://github.com/awslabs/aws-c-io/
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/awsiotsdk/PYSEC-2021-861.yaml
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-40828
    reference_type:
    reference_id: CVE-2021-40828
  - url: https://github.com/advisories/GHSA-94jq-q5v2-76wj
    reference_type:
    reference_id: GHSA-94jq-q5v2-76wj
