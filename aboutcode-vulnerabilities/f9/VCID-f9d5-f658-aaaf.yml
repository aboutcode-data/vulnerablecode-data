vulnerability_id: VCID-f9d5-f658-aaaf
aliases:
  - CVE-2022-31107
  - GHSA-mx47-6497-3fv2
summary: Grafana is an open-source platform for monitoring and observability. In versions 5.3
  until 9.0.3, 8.5.9, 8.4.10, and 8.3.10, it is possible for a malicious user who has authorization
  to log into a Grafana instance via a configured OAuth IdP which provides a login name to take
  over the account of another user in that Grafana instance. This can occur when the malicious
  user is authorized to log in to Grafana via OAuth, the malicious user's external user id is
  not already associated with an account in Grafana, the malicious user's email address is not
  already associated with an account in Grafana, and the malicious user knows the Grafana username
  of the target user. If these conditions are met, the malicious user can set their username
  in the OAuth provider to that of the target user, then go through the OAuth flow to log in
  to Grafana. Due to the way that external and internal user accounts are linked together during
  login, if the conditions above are all met then the malicious user will be able to log in
  to the target user's Grafana account. Versions 9.0.3, 8.5.9, 8.4.10, and 8.3.10 contain a
  patch for this issue. As a workaround, concerned users can disable OAuth login to their Grafana
  instance, or ensure that all users authorized to log in via OAuth have a corresponding user
  account in Grafana linked to their email address.
severities:
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:5716
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:5717
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:5718
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:5719
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2022:5720
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-31107.json
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54362'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54351'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54356'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54287'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54267'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.53929'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54212'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54611'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54569'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54544'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54404'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.54378'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54684'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52409'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52394'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52493'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52498'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52523'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52547'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52525'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52506'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52524'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52546'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52567'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52577'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.52531'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54541'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54585'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54643'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54671'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54602'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54634'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54644'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54647'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54652'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.5467'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.5466'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54648'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00325'
    scoring_system: epss
    scoring_elements: '0.54625'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00334'
    scoring_system: epss
    scoring_elements: '0.70844'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00334'
    scoring_system: epss
    scoring_elements: '0.71023'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00334'
    scoring_system: epss
    scoring_elements: '0.70858'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00334'
    scoring_system: epss
    scoring_elements: '0.70863'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: '0.00761'
    scoring_system: epss
    scoring_elements: '0.58033'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
  - score: high
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=2104367
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/grafana/grafana
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/grafana
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://github.com/grafana/grafana/security/advisories/GHSA-mx47-6497-3fv2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/grafana/grafana/security/advisories/GHSA-mx47-6497-3fv2
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:51:22Z/
    published_at: None
    url: https://github.com/grafana/grafana/security/advisories/GHSA-mx47-6497-3fv2
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-4-10
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-4-10
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-4-10/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:51:22Z/
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-4-10/
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-5-9
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-5-9
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-5-9/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:51:22Z/
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-5-9/
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-9-0-3
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-9-0-3
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-9-0-3/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:51:22Z/
    published_at: None
    url: https://grafana.com/docs/grafana/next/release-notes/release-notes-9-0-3/
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31107
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-31107
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220901-0010
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220901-0010
  - score: '7.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220901-0010/
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:51:22Z/
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20220901-0010/
weaknesses:
  - CWE-863
  - CWE-287
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-31107.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-31107
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana
    reference_type:
    reference_id:
  - url: https://github.com/grafana/grafana/security/advisories/GHSA-mx47-6497-3fv2
    reference_type:
    reference_id:
  - url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-4-10
    reference_type:
    reference_id:
  - url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-4-10/
    reference_type:
    reference_id:
  - url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-5-9
    reference_type:
    reference_id:
  - url: https://grafana.com/docs/grafana/next/release-notes/release-notes-8-5-9/
    reference_type:
    reference_id:
  - url: https://grafana.com/docs/grafana/next/release-notes/release-notes-9-0-3
    reference_type:
    reference_id:
  - url: https://grafana.com/docs/grafana/next/release-notes/release-notes-9-0-3/
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220901-0010
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20220901-0010/
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2104367
    reference_type:
    reference_id: 2104367
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:netapp:e-series_performance_analyzer:-:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:netapp:e-series_performance_analyzer:-:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-31107
    reference_type:
    reference_id: CVE-2022-31107
  - url: https://access.redhat.com/errata/RHSA-2022:5716
    reference_type:
    reference_id: RHSA-2022:5716
  - url: https://access.redhat.com/errata/RHSA-2022:5717
    reference_type:
    reference_id: RHSA-2022:5717
  - url: https://access.redhat.com/errata/RHSA-2022:5718
    reference_type:
    reference_id: RHSA-2022:5718
  - url: https://access.redhat.com/errata/RHSA-2022:5719
    reference_type:
    reference_id: RHSA-2022:5719
  - url: https://access.redhat.com/errata/RHSA-2022:5720
    reference_type:
    reference_id: RHSA-2022:5720
  - url: https://access.redhat.com/errata/RHSA-2023:3642
    reference_type:
    reference_id: RHSA-2023:3642
