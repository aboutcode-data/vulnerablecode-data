vulnerability_id: VCID-b2ug-dcxg-bbbf
aliases:
  - GHSA-3rw9-wmc8-8948
summary: "Coder accepts an APIKey beyond the linked OIDC expiry if there is no refresh token\n\
  ### Summary\nIf users log in to Coder via OIDC, and the OpenID Identity Provider does not\
  \ return a refresh token, then Coder may allow their web session to continue beyond the expiration\
  \ of the token returned by the OpenID Identity Provider.\n\n### Details\nWhen a user logs\
  \ in via OIDC, Coder stores the OIDC token and refresh token (if any) in its datastore and\
  \ sets an APIKey in the user's cookies. If there is a refresh token, then when the OIDC token\
  \ is expired and a request is made with the APIKey, we attempt to refresh the OIDC token.\
  \ If refresh fails, the Coder API request is also failed and the user needs to log in again.\n\
  \nHowever, if there is no refresh token provided, then affected versions of Coder fail to\
  \ enforce the expiry of the OIDC token, and allow users to make API requests even if it is\
  \ expired so long as their APIKey stored in cookies has not expired.\n\nCoder APIKeys have\
  \ an expiry and lifetime of 24 hours, but Coder is configured to extend the lifetime of the\
  \ APIKey by up to 24 hours from the time it is used successfully. So, an APIKey that is used\
  \ at least once every 24 hours will not expire. (This behavior can be disabled by configuration).\
  \ \n\n### Impact\nThis could allow a user to access the Coder service beyond the lifetime\
  \ of the token issued by the OpenID provider, potentially indefinitely, even if they are no\
  \ loner authorized via OIDC."
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/coder
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/coder/commit/1a4160803589034ce1518e24a78f232c8d08f996
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/coder/coder/security/advisories/GHSA-3rw9-wmc8-8948
weaknesses:
  - CWE-324
references:
  - url: https://github.com/coder/coder
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/commit/1a4160803589034ce1518e24a78f232c8d08f996
    reference_type:
    reference_id:
  - url: https://github.com/coder/coder/security/advisories/GHSA-3rw9-wmc8-8948
    reference_type:
    reference_id:
