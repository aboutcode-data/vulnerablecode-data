vulnerability_id: VCID-8y8g-d5tg-xbhy
aliases:
  - GHSA-vv6c-69r6-chg9
summary: |
  Go-Landlock in best-effort mode did not restrict TCP bind and connect operations correctly
  ### Impact
  When using the recommended "best-effort" mode, Go-Landlock did not restrict the TCP bind() and connect() operations any more when they were requested.  This affects Go-Landlock users to whom both of the following conditions apply:

  * They use Landlock rulesets that are supposed to restrict networking (through `landlock.V4`, `landlock.V5`, or self-configured).
  * These Landlock rulesets are used in best-effort mode.

  Typically, affected code uses the Go-Landlock API like this (the crucial part being the combination of `V4`/`V5` and `.BestEffort()`):

  ```
  err := landlock.V5.BestEffort().Restrict(...)
  ```

  * This is a bug in the Go-Landlock library and does not affect programs that use Landlock via C or other language bindings.
  * The bug only affects networking restrictions. File system restrictions continue to work as expected.

  ### Patches
  Patched in: https://github.com/landlock-lsm/go-landlock/commit/fb3ad845df462d013f9c8a965c496617c6a5778b
  Users should upgrade to: v0.0.0-20241013234402-fb3ad845df46

  Go package dependencies can be updated using `go get -u` from the project directory.

  Projects on Github might get notified by Dependabot, once this advisory is public.

  ### Workarounds
  None.

  ### References
  Currently none.

  [The existing users of Go-Landlock on Github](https://pkg.go.dev/github.com/landlock-lsm/go-landlock/landlock?tab=importedby) have the following bugs filed:
  * https://github.com/Foxboron/ssh-the-planet/issues/1
  * https://github.com/ngergs/websrv/issues/15
  * https://github.com/pufferffish/wireproxy/issues/142
severities:
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/landlock-lsm/go-landlock
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/landlock-lsm/go-landlock/commit/fb3ad845df462d013f9c8a965c496617c6a5778b
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/landlock-lsm/go-landlock/security/advisories/GHSA-vv6c-69r6-chg9
weaknesses: []
references:
  - url: https://github.com/landlock-lsm/go-landlock
    reference_type:
    reference_id:
  - url: https://github.com/landlock-lsm/go-landlock/commit/fb3ad845df462d013f9c8a965c496617c6a5778b
    reference_type:
    reference_id:
  - url: https://github.com/landlock-lsm/go-landlock/security/advisories/GHSA-vv6c-69r6-chg9
    reference_type:
    reference_id:
