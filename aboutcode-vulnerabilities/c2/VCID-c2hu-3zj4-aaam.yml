vulnerability_id: VCID-c2hu-3zj4-aaam
aliases:
  - CVE-2024-37160
  - GHSA-5pxr-7m4j-jjc6
summary: |
  Cross-site scripting (XSS) vulnerability in Description metadata
  ### Summary
  Regardless of the role or privileges, no user should be able to inject malicious JavaScript (JS) scripts into the body HTML. an XSS (Cross-Site Scripting) vulnerability, specifically a Stored XSS, which affects all pages of the website. Once the JS script is embedded in the body HTML, the XSS will trigger on any page a victim visits, such as the about, blog, contact, or any other pages, except for the panel.

  ### Impact
  This vulnerability allows attackers to inject malicious JS or HTML through a crafted payload into the vulnerable spot, achieving persistence and attacking numerous visitors or anyone accessing the website. The attack can be widespread and affect many users because the malicious JS will execute on every page, unlike an injection on a specific page (e.g., injecting on the About page would only affect that page). In this case, a single injection point leads to the execution of the malicious JS on all pages.

  ### Patches
  - [**Formwork 1.13.1**](https://github.com/getformwork/formwork/releases/tag/1.13.1) has been released with a patch that solves this vulnerability by escaping all metadata attributes.
  - [**Formwork 2.x** (f531201)](https://github.com/getformwork/formwork/commit/f5312015a5a5e89b95ef2bd07e496f8474d579c5) also escapes metadata attributes.

  ### Details
  An attackers (requires administrator privilege) to execute arbitrary web scripts by modifying site options via /panel/options/site. This type of attack is suitable for persistence, affecting visitors across all pages (except the dashboard).

  ### PoC
  1. Log in with an Administrator user account.
  2. Navigate to /panel/options/site/.
  3. Inject the JS script by adding to the description field.
  4. Simulate a victim who is not a site member visiting the website. You will notice that the JS script executes on every page they vis

  ![image](https://github.com/getformwork/formwork/assets/170840940/1c40be24-3367-4c80-bb44-9db64ef88970)
  ![image](https://github.com/getformwork/formwork/assets/170840940/68dd5bff-9db1-441b-a3b3-a0c014565f59)
  ![image](https://github.com/getformwork/formwork/assets/170840940/3cd84c39-9b44-49d0-8b6a-6c8aeda7e49f)
  ![image](https://github.com/getformwork/formwork/assets/170840940/f45afd87-80e9-4cf1-8121-bb4e121849c9)
severities:
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21466'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.22421'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21477'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21494'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21527'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21784'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21852'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21948'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.22131'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.22118'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.22104'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.20995'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21281'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21369'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21402'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00051'
    scoring_system: epss
    scoring_elements: '0.21472'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28081'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28049'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.2807'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28086'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28073'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28083'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28098'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28113'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28164'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28167'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28124'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28022'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00095'
    scoring_system: epss
    scoring_elements: '0.28042'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00402'
    scoring_system: epss
    scoring_elements: '0.43963'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00445'
    scoring_system: epss
    scoring_elements: '0.60522'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00445'
    scoring_system: epss
    scoring_elements: '0.60572'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00445'
    scoring_system: epss
    scoring_elements: '0.60615'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64391'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64362'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64378'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64373'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64372'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64374'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64354'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64368'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64385'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.6438'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: '0.00523'
    scoring_system: epss
    scoring_elements: '0.64356'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-5pxr-7m4j-jjc6
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/getformwork/formwork
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getformwork/formwork
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/getformwork/formwork/commit/9d471204f7ebb51c3c27131581c2b834315b5e0b
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getformwork/formwork/commit/9d471204f7ebb51c3c27131581c2b834315b5e0b
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/getformwork/formwork/commit/f5312015a5a5e89b95ef2bd07e496f8474d579c5
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getformwork/formwork/commit/f5312015a5a5e89b95ef2bd07e496f8474d579c5
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/getformwork/formwork/security/advisories/GHSA-5pxr-7m4j-jjc6
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/getformwork/formwork/security/advisories/GHSA-5pxr-7m4j-jjc6
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/getformwork/formwork/security/advisories/GHSA-5pxr-7m4j-jjc6
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/getformwork/formwork/security/advisories/GHSA-5pxr-7m4j-jjc6
  - score: '4.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37160
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37160
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-37160
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-37160
    reference_type:
    reference_id:
  - url: https://github.com/getformwork/formwork
    reference_type:
    reference_id:
  - url: https://github.com/getformwork/formwork/commit/9d471204f7ebb51c3c27131581c2b834315b5e0b
    reference_type:
    reference_id:
  - url: https://github.com/getformwork/formwork/commit/f5312015a5a5e89b95ef2bd07e496f8474d579c5
    reference_type:
    reference_id:
  - url: https://github.com/getformwork/formwork/security/advisories/GHSA-5pxr-7m4j-jjc6
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-37160
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:formwork_project:formwork:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:formwork_project:formwork:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-5pxr-7m4j-jjc6
    reference_type:
    reference_id: GHSA-5pxr-7m4j-jjc6
