vulnerability_id: VCID-51ct-zacq-aaas
aliases:
  - CVE-2023-45814
  - GHSA-jrf2-h5j6-3rrq
summary: Bunkum is an open-source protocol-agnostic request server for custom game servers.
  First, a little bit of background. So, in the beginning, Bunkum's `AuthenticationService`
  only supported injecting `IUser`s. However, as Refresh and SoundShapesServer implemented permissions
  systems support for injecting `IToken`s into endpoints was added. All was well until 4.0.
  Bunkum 4.0 then changed to enforce relations between `IToken`s and `IUser`s. This wasn't implemented
  in a very good way in the `AuthenticationService`, and ended up breaking caching in such a
  way that cached tokens would persist after the lifetime of the request - since we tried to
  cache both tokens and users. From that point until now, from what I understand, Bunkum was
  attempting to use that cached token at the start of the next request once cached. Naturally,
  when that token expired, downstream projects like Refresh would remove the object from Realm
  - and cause the object in the cache to be in a detached state, causing an exception from invalid
  use of `IToken.User`. So in other words, a use-after-free since Realm can't manage the lifetime
  of the cached token. Security-wise, the scope is fairly limited, can only be pulled off on
  a couple endpoints given a few conditions, and you can't guarantee which token you're going
  to get. Also, the token *would* get invalidated properly if the endpoint had either a `IToken`
  usage or a `IUser` usage. The fix is to just wipe the token cache after the request was handled,
  which is now in `4.2.1`. Users are advised to upgrade. There are no known workarounds for
  this vulnerability.
severities:
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28392'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00063'
    scoring_system: epss
    scoring_elements: '0.28656'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31902'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31995'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31806'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31811'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31793'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31441'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.32181'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31466'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31577'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31583'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31623'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31599'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00068'
    scoring_system: epss
    scoring_elements: '0.31844'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.3346'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33449'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33451'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.3345'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33499'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33469'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33375'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.3344'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33546'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33417'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33543'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00127'
    scoring_system: epss
    scoring_elements: '0.33467'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.3848'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.384'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38366'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38473'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38483'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38482'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38509'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38457'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38497'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38526'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38499'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38467'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00194'
    scoring_system: epss
    scoring_elements: '0.38432'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: '0.00231'
    scoring_system: epss
    scoring_elements: '0.31236'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-jrf2-h5j6-3rrq
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/LittleBigRefresh/Bunkum
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/LittleBigRefresh/Bunkum
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/LittleBigRefresh/Bunkum/commit/6e109464ed9255f558182f001f475a378405ff76
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/LittleBigRefresh/Bunkum/commit/6e109464ed9255f558182f001f475a378405ff76
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/LittleBigRefresh/Bunkum/security/advisories/GHSA-jrf2-h5j6-3rrq
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/LittleBigRefresh/Bunkum/security/advisories/GHSA-jrf2-h5j6-3rrq
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-45814
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-45814
weaknesses:
  - CWE-772
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-45814
    reference_type:
    reference_id:
  - url: https://github.com/LittleBigRefresh/Bunkum
    reference_type:
    reference_id:
  - url: https://github.com/LittleBigRefresh/Bunkum/commit/6e109464ed9255f558182f001f475a378405ff76
    reference_type:
    reference_id:
  - url: https://github.com/LittleBigRefresh/Bunkum/security/advisories/GHSA-jrf2-h5j6-3rrq
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:littlebigfresh:bunkum:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:littlebigfresh:bunkum:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-45814
    reference_type:
    reference_id: CVE-2023-45814
  - url: https://github.com/advisories/GHSA-jrf2-h5j6-3rrq
    reference_type:
    reference_id: GHSA-jrf2-h5j6-3rrq
