vulnerability_id: VCID-4kmn-qqb5-aaad
aliases:
  - CVE-2023-0242
  - GHSA-g5vm-525q-r66c
summary: Rapid7 Velociraptor allows users to be created with different privileges on the server.
  Administrators are generally allowed to run any command on the server including writing arbitrary
  files. However, lower privilege users are generally forbidden from writing or modifying files
  on the server. The VQL copy() function applies permission checks for reading files but does
  not check for permission to write files. This allows a low privilege user (usually, users
  with the Velociraptor "investigator" role) to overwrite files on the server, including Velociraptor
  configuration files. To exploit this vulnerability, the attacker must already have a Velociraptor
  user account at a low privilege level (at least "analyst") and be able to log into the GUI
  and create a notebook where they can run the VQL query invoking the copy() VQL function. Typically,
  most users deploy Velociraptor with limited access to a trusted group (most users will be
  administrators within the GUI). This vulnerability is associated with program files https://github.Com/Velocidex/velociraptor/blob/master/vql/filesystem/copy.go
  https://github.Com/Velocidex/velociraptor/blob/master/vql/filesystem/copy.go and program routines
  copy(). This issue affects Velociraptor versions before 0.6.7-5. Version 0.6.7-5, released
  January 16, 2023, fixes the issue.
severities:
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43478'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44305'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43469'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43494'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43801'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43574'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43825'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43908'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.43931'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44015'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44006'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44016'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44031'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44048'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44212'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00104'
    scoring_system: epss
    scoring_elements: '0.44244'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.39091'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.39081'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.38976'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00198'
    scoring_system: epss
    scoring_elements: '0.39011'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.4359'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43645'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43708'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43735'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.4373'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43633'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43631'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43643'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43651'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43658'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43622'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40508'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40533'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40512'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40492'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40529'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40557'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40552'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40523'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40503'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.40484'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00209'
    scoring_system: epss
    scoring_elements: '0.43586'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '0.00343'
    scoring_system: epss
    scoring_elements: '0.40178'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://docs.velociraptor.app/announcements/2023-cves/#:~:text=to%20upgrade%20clients.-,CVE%2D2023%2D0242,-Insufficient%20Permission%20Check
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://docs.velociraptor.app/announcements/2023-cves/#:~:text=to%20upgrade%20clients.-,CVE%2D2023%2D0242,-Insufficient%20Permission%20Check
  - score: '4.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/Velocidex/velociraptor
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Velocidex/velociraptor
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Velocidex/velociraptor
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Velocidex/velociraptor
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-0242
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-0242
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-0242
weaknesses:
  - CWE-862
  - CWE-269
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-0242
    reference_type:
    reference_id:
  - url: https://docs.velociraptor.app/announcements/2023-cves/#:~:text=to%20upgrade%20clients.-,CVE%2D2023%2D0242,-Insufficient%20Permission%20Check
    reference_type:
    reference_id:
  - url: https://github.com/Velocidex/velociraptor
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:rapid7:velociraptor:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:rapid7:velociraptor:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-0242
    reference_type:
    reference_id: CVE-2023-0242
