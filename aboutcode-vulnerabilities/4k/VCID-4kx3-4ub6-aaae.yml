vulnerability_id: VCID-4kx3-4ub6-aaae
aliases:
  - CVE-2022-34321
  - GHSA-c35h-w8hj-mm55
summary: |
  Improper Authentication vulnerability in Apache Pulsar Proxy allows an attacker to connect to the /proxy-stats endpoint without authentication. The vulnerable endpoint exposes detailed statistics about live connections, along with the capability to modify the logging level of proxied connections without requiring proper authentication credentials.

  This issue affects Apache Pulsar versions from 2.6.0 to 2.10.5, from 2.11.0 to 2.11.2, from 3.0.0 to 3.0.1, and 3.1.0.

  The known risks include exposing sensitive information such as connected client IP and unauthorized logging level manipulation which could lead to a denial-of-service condition by significantly increasing the proxy's logging overhead. When deployed via the Apache Pulsar Helm chart within Kubernetes environments, the actual client IP might not be revealed through the load balancer's default behavior, which typically obscures the original source IP addresses when externalTrafficPolicy is being configured to "Cluster" by default. The /proxy-stats endpoint contains topic level statistics, however, in the default configuration, the topic level statistics aren't known to be exposed.

  2.10 Pulsar Proxy users should upgrade to at least 2.10.6.
  2.11 Pulsar Proxy users should upgrade to at least 2.11.3.
  3.0 Pulsar Proxy users should upgrade to at least 3.0.2.
  3.1 Pulsar Proxy users should upgrade to at least 3.1.1.

  Users operating versions prior to those listed above should upgrade to the aforementioned patched versions or newer versions. Additionally, it's imperative to recognize that the Apache Pulsar Proxy is not intended for direct exposure to the internet. The architectural design of Pulsar Proxy assumes that it will operate within a secured network environment, safeguarded by appropriate perimeter defenses.
severities:
  - score: '8.2'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-34321.json
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05302'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05851'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05814'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05815'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05805'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00027'
    scoring_system: epss
    scoring_elements: '0.05811'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11403'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.1141'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.0004'
    scoring_system: epss
    scoring_elements: '0.11393'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17257'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17286'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17365'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17359'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17381'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17443'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17545'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17861'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17946'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.18045'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17769'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17736'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17755'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.18058'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16880'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17165'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33464'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33358'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33314'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33453'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33467'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33485'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33449'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33417'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33429'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33466'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33497'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.335'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33468'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37711'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37778'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.3785'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37895'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.37899'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: '0.00301'
    scoring_system: epss
    scoring_elements: '0.37074'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-c35h-w8hj-mm55
  - score: '6.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/apache/pulsar
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://github.com/apache/pulsar
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/pulsar
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/pulsar
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://lists.apache.org/thread/ods5tq2hpl390hvjnvxv0bcg4rfpgjj8
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L
    published_at: None
    url: https://lists.apache.org/thread/ods5tq2hpl390hvjnvxv0bcg4rfpgjj8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/ods5tq2hpl390hvjnvxv0bcg4rfpgjj8
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-34321
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-34321
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: https://pulsar.apache.org/security/CVE-2022-34321
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pulsar.apache.org/security/CVE-2022-34321
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/03/12/8
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/03/12/8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2024/03/12/8
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-306
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-34321.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-34321
    reference_type:
    reference_id:
  - url: https://github.com/apache/pulsar
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/ods5tq2hpl390hvjnvxv0bcg4rfpgjj8
    reference_type:
    reference_id:
  - url: https://pulsar.apache.org/security/CVE-2022-34321/
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2024/03/12/8
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2269250
    reference_type:
    reference_id: 2269250
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:pulsar:3.1.0:-:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:pulsar:3.1.0:-:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-34321
    reference_type:
    reference_id: CVE-2022-34321
  - url: https://pulsar.apache.org/security/CVE-2022-34321
    reference_type:
    reference_id: CVE-2022-34321
  - url: https://github.com/advisories/GHSA-c35h-w8hj-mm55
    reference_type:
    reference_id: GHSA-c35h-w8hj-mm55
