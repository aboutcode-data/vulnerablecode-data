vulnerability_id: VCID-9nj7-ws6z-aaam
aliases:
  - CVE-2024-36882
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  mm: use memalloc_nofs_save() in page_cache_ra_order()

  See commit f2c817bed58d ("mm: use memalloc_nofs_save in readahead path"),
  ensure that page_cache_ra_order() do not attempt to reclaim file-backed
  pages too, or it leads to a deadlock, found issue when test ext4 large
  folio.

   INFO: task DataXceiver for:7494 blocked for more than 120 seconds.
   "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.
   task:DataXceiver for state:D stack:0     pid:7494  ppid:1      flags:0x00000200
   Call trace:
    __switch_to+0x14c/0x240
    __schedule+0x82c/0xdd0
    schedule+0x58/0xf0
    io_schedule+0x24/0xa0
    __folio_lock+0x130/0x300
    migrate_pages_batch+0x378/0x918
    migrate_pages+0x350/0x700
    compact_zone+0x63c/0xb38
    compact_zone_order+0xc0/0x118
    try_to_compact_pages+0xb0/0x280
    __alloc_pages_direct_compact+0x98/0x248
    __alloc_pages+0x510/0x1110
    alloc_pages+0x9c/0x130
    folio_alloc+0x20/0x78
    filemap_alloc_folio+0x8c/0x1b0
    page_cache_ra_order+0x174/0x308
    ondemand_readahead+0x1c8/0x2b8
    page_cache_async_ra+0x68/0xb8
    filemap_readahead.isra.0+0x64/0xa8
    filemap_get_pages+0x3fc/0x5b0
    filemap_splice_read+0xf4/0x280
    ext4_file_splice_read+0x2c/0x48 [ext4]
    vfs_splice_read.part.0+0xa8/0x118
    splice_direct_to_actor+0xbc/0x288
    do_splice_direct+0x9c/0x108
    do_sendfile+0x328/0x468
    __arm64_sys_sendfile64+0x8c/0x148
    invoke_syscall+0x4c/0x118
    el0_svc_common.constprop.0+0xc8/0xf0
    do_el0_svc+0x24/0x38
    el0_svc+0x4c/0x1f8
    el0t_64_sync_handler+0xc0/0xc8
    el0t_64_sync+0x188/0x190
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-36882.json
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10311'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.1037'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10427'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10446'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10436'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10439'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10449'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10464'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10517'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10539'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10531'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10465'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00038'
    scoring_system: epss
    scoring_elements: '0.10358'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18761'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18747'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18715'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18688'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18653'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18723'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18704'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18689'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18698'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18732'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18725'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18707'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.1869'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.1854'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.18578'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '0.00297'
    scoring_system: epss
    scoring_elements: '0.36765'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-36882
weaknesses:
  - CWE-667
  - CWE-833
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-36882.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-36882
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/30153e4466647a17eebfced13eede5cbe4290e69
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/468971c3f4b8187f25334503b68050a0e1370147
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7629ef6dda1564098aadeef38e5fbd11ee8627c4
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/cf6a1d16c6df3c30b03f0c6a92a2ba7f86dffb45
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2284273
    reference_type:
    reference_id: 2284273
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.9:rc7:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.9:rc7:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-36882
    reference_type:
    reference_id: CVE-2024-36882
  - url: https://access.redhat.com/errata/RHSA-2024:9315
    reference_type:
    reference_id: RHSA-2024:9315
  - url: https://usn.ubuntu.com/6949-1/
    reference_type:
    reference_id: USN-6949-1
  - url: https://usn.ubuntu.com/6949-2/
    reference_type:
    reference_id: USN-6949-2
  - url: https://usn.ubuntu.com/6952-1/
    reference_type:
    reference_id: USN-6952-1
  - url: https://usn.ubuntu.com/6952-2/
    reference_type:
    reference_id: USN-6952-2
  - url: https://usn.ubuntu.com/6955-1/
    reference_type:
    reference_id: USN-6955-1
