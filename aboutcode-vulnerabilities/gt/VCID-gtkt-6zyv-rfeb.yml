vulnerability_id: VCID-gtkt-6zyv-rfeb
aliases:
  - CVE-2024-47692
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  nfsd: return -EINVAL when namelen is 0

  When we have a corrupted main.sqlite in /var/lib/nfs/nfsdcld/, it may
  result in namelen being 0, which will cause memdup_user() to return
  ZERO_SIZE_PTR.
  When we access the name.data that has been assigned the value of
  ZERO_SIZE_PTR in nfs4_client_to_reclaim(), null pointer dereference is
  triggered.

  [ T1205] ==================================================================
  [ T1205] BUG: KASAN: null-ptr-deref in nfs4_client_to_reclaim+0xe9/0x260
  [ T1205] Read of size 1 at addr 0000000000000010 by task nfsdcld/1205
  [ T1205]
  [ T1205] CPU: 11 PID: 1205 Comm: nfsdcld Not tainted 5.10.0-00003-g2c1423731b8d #406
  [ T1205] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS ?-20190727_073836-buildvm-ppc64le-16.ppc.fedoraproject.org-3.fc31 04/01/2014
  [ T1205] Call Trace:
  [ T1205]  dump_stack+0x9a/0xd0
  [ T1205]  ? nfs4_client_to_reclaim+0xe9/0x260
  [ T1205]  __kasan_report.cold+0x34/0x84
  [ T1205]  ? nfs4_client_to_reclaim+0xe9/0x260
  [ T1205]  kasan_report+0x3a/0x50
  [ T1205]  nfs4_client_to_reclaim+0xe9/0x260
  [ T1205]  ? nfsd4_release_lockowner+0x410/0x410
  [ T1205]  cld_pipe_downcall+0x5ca/0x760
  [ T1205]  ? nfsd4_cld_tracking_exit+0x1d0/0x1d0
  [ T1205]  ? down_write_killable_nested+0x170/0x170
  [ T1205]  ? avc_policy_seqno+0x28/0x40
  [ T1205]  ? selinux_file_permission+0x1b4/0x1e0
  [ T1205]  rpc_pipe_write+0x84/0xb0
  [ T1205]  vfs_write+0x143/0x520
  [ T1205]  ksys_write+0xc9/0x170
  [ T1205]  ? __ia32_sys_read+0x50/0x50
  [ T1205]  ? ktime_get_coarse_real_ts64+0xfe/0x110
  [ T1205]  ? ktime_get_coarse_real_ts64+0xa2/0x110
  [ T1205]  do_syscall_64+0x33/0x40
  [ T1205]  entry_SYSCALL_64_after_hwframe+0x67/0xd1
  [ T1205] RIP: 0033:0x7fdbdb761bc7
  [ T1205] Code: 0f 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b7 0f 1f 00 f3 0f 1e fa 64 8b 04 25 18 00 00 00 85 c0 75 10 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 514
  [ T1205] RSP: 002b:00007fff8c4b7248 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
  [ T1205] RAX: ffffffffffffffda RBX: 000000000000042b RCX: 00007fdbdb761bc7
  [ T1205] RDX: 000000000000042b RSI: 00007fff8c4b75f0 RDI: 0000000000000008
  [ T1205] RBP: 00007fdbdb761bb0 R08: 0000000000000000 R09: 0000000000000001
  [ T1205] R10: 0000000000000000 R11: 0000000000000246 R12: 000000000000042b
  [ T1205] R13: 0000000000000008 R14: 00007fff8c4b75f0 R15: 0000000000000000
  [ T1205] ==================================================================

  Fix it by checking namelen.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47692.json
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47692.json
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.36800'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41326'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41963'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41890'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41851'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41675'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41454'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41666'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41538'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41564'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41656'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41657'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41650'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41328'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00096'
    scoring_system: epss
    scoring_elements: '0.41346'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.2818'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00122'
    scoring_system: epss
    scoring_elements: '0.2814'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00161'
    scoring_system: epss
    scoring_elements: '0.24122'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39464'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39489'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.3949'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39504'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39496'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39501'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39601'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.396'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39559'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39433'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35497'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35514'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35511'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35539'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35509'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35474'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35488'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.3552'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35558'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35564'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35532'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35508'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.35491'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39499'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '0.00172'
    scoring_system: epss
    scoring_elements: '0.39422'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:05:46Z/
    published_at: None
    url: https://git.kernel.org/stable/c/0f1d007bbea38a61cf9c5392708dc70ae9d84a3d
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:05:46Z/
    published_at: None
    url: https://git.kernel.org/stable/c/1ff8be8d008b9ddc8e7043fbddd37d5d451b271b
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:05:46Z/
    published_at: None
    url: https://git.kernel.org/stable/c/22451a16b7ab7debefce660672566be887db1637
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:05:46Z/
    published_at: None
    url: https://git.kernel.org/stable/c/318f70857caab3da9a6ada9bc8c1f4f7591b695e
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:05:46Z/
    published_at: None
    url: https://git.kernel.org/stable/c/6d07040ae5c2214e39c7444d898039c9e655a79a
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:05:46Z/
    published_at: None
    url: https://git.kernel.org/stable/c/766d5fbd78f7a52b3888449a0358760477b74602
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:05:46Z/
    published_at: None
    url: https://git.kernel.org/stable/c/84a563d136faf514fdad1ade28d7a142fd313cb8
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-21T13:05:46Z/
    published_at: None
    url: https://git.kernel.org/stable/c/b7b7a8df41ef18862dd6b22289fb46c2c12398af
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47692
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47692
weaknesses:
  - CWE-476
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47692.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47692
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47692
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/0f1d007bbea38a61cf9c5392708dc70ae9d84a3d
    reference_type:
    reference_id: 0f1d007bbea38a61cf9c5392708dc70ae9d84a3d
  - url: https://git.kernel.org/stable/c/1ff8be8d008b9ddc8e7043fbddd37d5d451b271b
    reference_type:
    reference_id: 1ff8be8d008b9ddc8e7043fbddd37d5d451b271b
  - url: https://git.kernel.org/stable/c/22451a16b7ab7debefce660672566be887db1637
    reference_type:
    reference_id: 22451a16b7ab7debefce660672566be887db1637
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2320173
    reference_type:
    reference_id: 2320173
  - url: https://git.kernel.org/stable/c/318f70857caab3da9a6ada9bc8c1f4f7591b695e
    reference_type:
    reference_id: 318f70857caab3da9a6ada9bc8c1f4f7591b695e
  - url: https://git.kernel.org/stable/c/6d07040ae5c2214e39c7444d898039c9e655a79a
    reference_type:
    reference_id: 6d07040ae5c2214e39c7444d898039c9e655a79a
  - url: https://git.kernel.org/stable/c/766d5fbd78f7a52b3888449a0358760477b74602
    reference_type:
    reference_id: 766d5fbd78f7a52b3888449a0358760477b74602
  - url: https://git.kernel.org/stable/c/84a563d136faf514fdad1ade28d7a142fd313cb8
    reference_type:
    reference_id: 84a563d136faf514fdad1ade28d7a142fd313cb8
  - url: https://git.kernel.org/stable/c/b7b7a8df41ef18862dd6b22289fb46c2c12398af
    reference_type:
    reference_id: b7b7a8df41ef18862dd6b22289fb46c2c12398af
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47692
    reference_type:
    reference_id: CVE-2024-47692
  - url: https://usn.ubuntu.com/7166-1/
    reference_type:
    reference_id: USN-7166-1
  - url: https://usn.ubuntu.com/7166-2/
    reference_type:
    reference_id: USN-7166-2
  - url: https://usn.ubuntu.com/7166-3/
    reference_type:
    reference_id: USN-7166-3
  - url: https://usn.ubuntu.com/7166-4/
    reference_type:
    reference_id: USN-7166-4
  - url: https://usn.ubuntu.com/7186-1/
    reference_type:
    reference_id: USN-7186-1
  - url: https://usn.ubuntu.com/7186-2/
    reference_type:
    reference_id: USN-7186-2
  - url: https://usn.ubuntu.com/7194-1/
    reference_type:
    reference_id: USN-7194-1
  - url: https://usn.ubuntu.com/7276-1/
    reference_type:
    reference_id: USN-7276-1
  - url: https://usn.ubuntu.com/7277-1/
    reference_type:
    reference_id: USN-7277-1
  - url: https://usn.ubuntu.com/7293-1/
    reference_type:
    reference_id: USN-7293-1
  - url: https://usn.ubuntu.com/7294-1/
    reference_type:
    reference_id: USN-7294-1
  - url: https://usn.ubuntu.com/7294-2/
    reference_type:
    reference_id: USN-7294-2
  - url: https://usn.ubuntu.com/7294-3/
    reference_type:
    reference_id: USN-7294-3
  - url: https://usn.ubuntu.com/7294-4/
    reference_type:
    reference_id: USN-7294-4
  - url: https://usn.ubuntu.com/7295-1/
    reference_type:
    reference_id: USN-7295-1
  - url: https://usn.ubuntu.com/7301-1/
    reference_type:
    reference_id: USN-7301-1
  - url: https://usn.ubuntu.com/7303-1/
    reference_type:
    reference_id: USN-7303-1
  - url: https://usn.ubuntu.com/7303-2/
    reference_type:
    reference_id: USN-7303-2
  - url: https://usn.ubuntu.com/7303-3/
    reference_type:
    reference_id: USN-7303-3
  - url: https://usn.ubuntu.com/7304-1/
    reference_type:
    reference_id: USN-7304-1
  - url: https://usn.ubuntu.com/7310-1/
    reference_type:
    reference_id: USN-7310-1
  - url: https://usn.ubuntu.com/7311-1/
    reference_type:
    reference_id: USN-7311-1
  - url: https://usn.ubuntu.com/7384-1/
    reference_type:
    reference_id: USN-7384-1
  - url: https://usn.ubuntu.com/7384-2/
    reference_type:
    reference_id: USN-7384-2
  - url: https://usn.ubuntu.com/7385-1/
    reference_type:
    reference_id: USN-7385-1
  - url: https://usn.ubuntu.com/7386-1/
    reference_type:
    reference_id: USN-7386-1
  - url: https://usn.ubuntu.com/7393-1/
    reference_type:
    reference_id: USN-7393-1
  - url: https://usn.ubuntu.com/7401-1/
    reference_type:
    reference_id: USN-7401-1
  - url: https://usn.ubuntu.com/7403-1/
    reference_type:
    reference_id: USN-7403-1
  - url: https://usn.ubuntu.com/7413-1/
    reference_type:
    reference_id: USN-7413-1
  - url: https://usn.ubuntu.com/7468-1/
    reference_type:
    reference_id: USN-7468-1
