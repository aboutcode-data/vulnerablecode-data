vulnerability_id: VCID-pt5s-913z-aaak
aliases:
  - CVE-2021-47068
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  net/nfc: fix use-after-free llcp_sock_bind/connect

  Commits 8a4cd82d ("nfc: fix refcount leak in llcp_sock_connect()")
  and c33b1cc62 ("nfc: fix refcount leak in llcp_sock_bind()")
  fixed a refcount leak bug in bind/connect but introduced a
  use-after-free if the same local is assigned to 2 different sockets.

  This can be triggered by the following simple program:
      int sock1 = socket( AF_NFC, SOCK_STREAM, NFC_SOCKPROTO_LLCP );
      int sock2 = socket( AF_NFC, SOCK_STREAM, NFC_SOCKPROTO_LLCP );
      memset( &addr, 0, sizeof(struct sockaddr_nfc_llcp) );
      addr.sa_family = AF_NFC;
      addr.nfc_protocol = NFC_PROTO_NFC_DEP;
      bind( sock1, (struct sockaddr*) &addr, sizeof(struct sockaddr_nfc_llcp) )
      bind( sock2, (struct sockaddr*) &addr, sizeof(struct sockaddr_nfc_llcp) )
      close(sock1);
      close(sock2);

  Fix this by assigning NULL to llcp_sock->local after calling
  nfc_llcp_local_put.

  This addresses CVE-2021-23134.
severities:
  - score: '7.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47068.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00784'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00781'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01057'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01042'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0104'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01047'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01051'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01063'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01059'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01062'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01067'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01055'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00775'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00772'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01045'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01052'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00776'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14371'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15033'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14976'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14691'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14611'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14556'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14541'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14548'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14482'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14461'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.10493'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14083'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15128'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.11263'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.11356'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1139'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.11429'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.11412'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.11425'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.1122'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.11352'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.2894'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/18175fe17ae043a0b81e5d511f8817825784c299
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-22T15:46:55Z/
    published_at: None
    url: https://git.kernel.org/stable/c/18175fe17ae043a0b81e5d511f8817825784c299
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/18ae4a192a4496e48a5490b52812645d2413307c
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-22T15:46:55Z/
    published_at: None
    url: https://git.kernel.org/stable/c/18ae4a192a4496e48a5490b52812645d2413307c
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/26157c82ba756767b2bd66d28a71b1bc454447f6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-22T15:46:55Z/
    published_at: None
    url: https://git.kernel.org/stable/c/26157c82ba756767b2bd66d28a71b1bc454447f6
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/374cdde4dcc9c909a60713abdbbf96d5e3e09f91
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-22T15:46:55Z/
    published_at: None
    url: https://git.kernel.org/stable/c/374cdde4dcc9c909a60713abdbbf96d5e3e09f91
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/48fba458fe54cc2a980a05c13e6c19b8b2cfb610
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-22T15:46:55Z/
    published_at: None
    url: https://git.kernel.org/stable/c/48fba458fe54cc2a980a05c13e6c19b8b2cfb610
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/6b7021ed36dabf29e56842e3408781cd3b82ef6e
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-22T15:46:55Z/
    published_at: None
    url: https://git.kernel.org/stable/c/6b7021ed36dabf29e56842e3408781cd3b82ef6e
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/c61760e6940dd4039a7f5e84a6afc9cdbf4d82b6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-22T15:46:55Z/
    published_at: None
    url: https://git.kernel.org/stable/c/c61760e6940dd4039a7f5e84a6afc9cdbf4d82b6
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/ccddad6dd28530e716448e594c9ca7c76ccd0570
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-22T15:46:55Z/
    published_at: None
    url: https://git.kernel.org/stable/c/ccddad6dd28530e716448e594c9ca7c76ccd0570
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/e32352070bcac22be6ed8ab635debc280bb65b8c
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-22T15:46:55Z/
    published_at: None
    url: https://git.kernel.org/stable/c/e32352070bcac22be6ed8ab635debc280bb65b8c
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47068
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47068
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47068.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47068
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47068
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/18175fe17ae043a0b81e5d511f8817825784c299
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/18ae4a192a4496e48a5490b52812645d2413307c
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/26157c82ba756767b2bd66d28a71b1bc454447f6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/374cdde4dcc9c909a60713abdbbf96d5e3e09f91
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/48fba458fe54cc2a980a05c13e6c19b8b2cfb610
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6b7021ed36dabf29e56842e3408781cd3b82ef6e
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/c61760e6940dd4039a7f5e84a6afc9cdbf4d82b6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ccddad6dd28530e716448e594c9ca7c76ccd0570
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/e32352070bcac22be6ed8ab635debc280bb65b8c
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2267190
    reference_type:
    reference_id: 2267190
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47068
    reference_type:
    reference_id: CVE-2021-47068
