vulnerability_id: VCID-4zu9-n3w8-aaap
aliases:
  - GHSA-6vjm-54vp-mxhx
summary: |
  Juju's unprivileged user running on charm node can leak any secret or relation data accessible to the local charm
  An issue was discovered in Juju that resulted in the leak of the sensitive context ID, which allows a local unprivileged attacker to access other sensitive data or relation accessible to the local charm. A potential exploit where a user can run a bash loop attempting to execute hook tools. If running while another hook is executing, we log an error with the context ID, making it possible for the user to then use that ID in a following call successfully. This means an unprivileged user can access anything available via a hook tool such as config, relation data and secrets.
severities:
  - score: '7.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:H
    published_at: None
    url: https://github.com/juju/juju
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/juju/juju
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/juju/juju/commit/da929676853092a29ddf8d589468cf85ba3efaf2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/juju/juju/commit/da929676853092a29ddf8d589468cf85ba3efaf2
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/juju/juju/security/advisories/GHSA-6vjm-54vp-mxhx
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/juju/juju/security/advisories/GHSA-6vjm-54vp-mxhx
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2024-3010
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2024-3010
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2024-3040
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pkg.go.dev/vuln/GO-2024-3040
weaknesses:
  - CWE-209
  - CWE-284
  - CWE-269
references:
  - url: https://github.com/juju/juju
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/commit/da929676853092a29ddf8d589468cf85ba3efaf2
    reference_type:
    reference_id:
  - url: https://github.com/juju/juju/security/advisories/GHSA-6vjm-54vp-mxhx
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3010
    reference_type:
    reference_id:
  - url: https://pkg.go.dev/vuln/GO-2024-3040
    reference_type:
    reference_id:
