vulnerability_id: VCID-8zxa-sj94-aaaj
aliases:
  - CVE-2024-34351
  - GHSA-fr5h-rqp8-mj6g
summary: "Next.js Server-Side Request Forgery in Server Actions\n### Impact\nA Server-Side Request\
  \ Forgery (SSRF) vulnerability was identified in Next.js Server Actions by security researchers\
  \ at Assetnote. If the `Host` header is modified, and the below conditions are also met, an\
  \ attacker may be able to make requests that appear to be originating from the Next.js application\
  \ server itself.\n\n#### Prerequisites\n* Next.js (`<14.1.1`) is running in a self-hosted*\
  \ manner.\n* The Next.js application makes use of Server Actions.\n* The Server Action performs\
  \ a redirect to a relative path which starts with a `/`.\n\n\\* Many hosting providers (including\
  \ Vercel) route requests based on the Host header, so we do not believe that this vulnerability\
  \ affects any Next.js applications where routing is done in this manner.\n\n### Patches\n\
  This vulnerability was patched in [#62561](https://github.com/vercel/next.js/pull/62561) and\
  \ fixed in Next.js `14.1.1`.\n \n### Workarounds\nThere are no official workarounds for this\
  \ vulnerability. We recommend upgrading to Next.js `14.1.1`.\n\n### Credit\nVercel and the\
  \ Next.js team thank Assetnote for responsibly disclosing this issue to us, and for working\
  \ with us to verify the fix. Thanks to:\n\nAdam Kues - Assetnote\nShubham Shah - Assetnote"
severities:
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43311'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43328'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43489'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43521'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43584'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42817'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42839'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42823'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43163'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42842'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43096'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43181'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43205'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43293'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43286'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43295'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98593'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98604'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98603'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98602'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98601'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.986'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98597'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98599'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98598'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98588'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98595'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98589'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.70653'
    scoring_system: epss
    scoring_elements: '0.98591'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.81036'
    scoring_system: epss
    scoring_elements: '0.99081'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.81036'
    scoring_system: epss
    scoring_elements: '0.99076'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.81036'
    scoring_system: epss
    scoring_elements: '0.99079'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.81036'
    scoring_system: epss
    scoring_elements: '0.99078'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.81036'
    scoring_system: epss
    scoring_elements: '0.9908'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.81036'
    scoring_system: epss
    scoring_elements: '0.99082'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: '0.81617'
    scoring_system: epss
    scoring_elements: '0.98957'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-fr5h-rqp8-mj6g
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/vercel/next.js
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vercel/next.js
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/vercel/next.js/commit/8f7a6ca7d21a97bc9f7a1bbe10427b5ad74b9085
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vercel/next.js/commit/8f7a6ca7d21a97bc9f7a1bbe10427b5ad74b9085
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/vercel/next.js/pull/62561
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vercel/next.js/pull/62561
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g
weaknesses:
  - CWE-918
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-34351
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js/commit/8f7a6ca7d21a97bc9f7a1bbe10427b5ad74b9085
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js/pull/62561
    reference_type:
    reference_id:
  - url: https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-34351
    reference_type:
    reference_id: CVE-2024-34351
  - url: https://github.com/advisories/GHSA-fr5h-rqp8-mj6g
    reference_type:
    reference_id: GHSA-fr5h-rqp8-mj6g
