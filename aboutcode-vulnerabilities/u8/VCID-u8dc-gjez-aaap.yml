vulnerability_id: VCID-u8dc-gjez-aaap
aliases:
  - CVE-2023-37895
  - GHSA-q8cm-3v62-jj79
summary: |
  Java object deserialization issue in Jackrabbit webapp/standalone on all platforms allows attacker to remotely execute code via RMIVersions up to (including) 2.20.10 (stable branch) and 2.21.17 (unstable branch) use the component "commons-beanutils", which contains a class that can be used for remote code execution over RMI.

  Users are advised to immediately update to versions 2.20.11 or 2.21.18. Note that earlier stable branches (1.0.x .. 2.18.x) have been EOLd already and do not receive updates anymore.

  In general, RMI support can expose vulnerabilities by the mere presence of an exploitable class on the classpath. Even if Jackrabbit itself does not contain any code known to be exploitable anymore, adding other components to your server can expose the same type of problem. We therefore recommend to disable RMI access altogether (see further below), and will discuss deprecating RMI support in future Jackrabbit releases.

  How to check whether RMI support is enabledRMI support can be over an RMI-specific TCP port, and over an HTTP binding. Both are by default enabled in Jackrabbit webapp/standalone.

  The native RMI protocol by default uses port 1099. To check whether it is enabled, tools like "netstat" can be used to check.

  RMI-over-HTTP in Jackrabbit by default uses the path "/rmi". So when running standalone on port 8080, check whether an HTTP GET request on localhost:8080/rmi returns 404 (not enabled) or 200 (enabled). Note that the HTTP path may be different when the webapp is deployed in a container as non-root context, in which case the prefix is under the user's control.

  Turning off RMIFind web.xml (either in JAR/WAR file or in unpacked web application folder), and remove the declaration and the mapping definition for the RemoteBindingServlet:

          <servlet>
              <servlet-name>RMI</servlet-name>
              <servlet-class>org.apache.jackrabbit.servlet.remote.RemoteBindingServlet</servlet-class>
          </servlet>

          <servlet-mapping>
              <servlet-name>RMI</servlet-name>
              <url-pattern>/rmi</url-pattern>
          </servlet-mapping>

  Find the bootstrap.properties file (in $REPOSITORY_HOME), and set

           rmi.enabled=false

      and also remove

           rmi.host
           rmi.port
           rmi.url-pattern

   If there is no file named bootstrap.properties in $REPOSITORY_HOME, it is located somewhere in the classpath. In this case, place a copy in $REPOSITORY_HOME and modify it as explained.

   

severities:
  - score: '0.01677'
    scoring_system: epss
    scoring_elements: '0.87350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.01677'
    scoring_system: epss
    scoring_elements: '0.87443'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.01677'
    scoring_system: epss
    scoring_elements: '0.87361'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.01677'
    scoring_system: epss
    scoring_elements: '0.87366'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90956'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90897'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90943'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90959'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90976'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90975'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90978'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90964'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90995'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.90999'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.02797'
    scoring_system: epss
    scoring_elements: '0.91007'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87301'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87228'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87297'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87299'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87294'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87286'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87277'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87283'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87272'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87261'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87304'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87302'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.03919'
    scoring_system: epss
    scoring_elements: '0.87244'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.90506'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.90481'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.90493'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.90508'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.90511'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.90517'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.9051'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.90507'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.90513'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.0644'
    scoring_system: epss
    scoring_elements: '0.90509'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '0.19986'
    scoring_system: epss
    scoring_elements: '0.9262'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://seclists.org/fulldisclosure/2023/Jul/43
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://seclists.org/fulldisclosure/2023/Jul/43
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-q8cm-3v62-jj79
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/jackrabbit
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/jackrabbit
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.apache.org/list.html?users@jackrabbit.apache.org
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/list.html?users@jackrabbit.apache.org
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.apache.org/thread/j03b3qdhborc2jrhdc4d765d3jkh8bfw
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/j03b3qdhborc2jrhdc4d765d3jkh8bfw
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-37895
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-37895
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/07/25/8
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/07/25/8
weaknesses:
  - CWE-502
  - CWE-937
  - CWE-1035
  - CWE-78
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-37895
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-37895
    reference_type:
    reference_id:
  - url: http://seclists.org/fulldisclosure/2023/Jul/43
    reference_type:
    reference_id:
  - url: https://github.com/apache/jackrabbit
    reference_type:
    reference_id:
  - url: https://lists.apache.org/list.html?users@jackrabbit.apache.org
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/j03b3qdhborc2jrhdc4d765d3jkh8bfw
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/07/25/8
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:jackrabbit:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:jackrabbit:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-37895
    reference_type:
    reference_id: CVE-2023-37895
  - url: https://github.com/advisories/GHSA-q8cm-3v62-jj79
    reference_type:
    reference_id: GHSA-q8cm-3v62-jj79
