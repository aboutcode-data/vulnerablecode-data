vulnerability_id: VCID-x34z-q3xq-jbgj
aliases:
  - CVE-2024-47874
  - GHSA-f96h-pmfr-66vw
summary: Starlette is an Asynchronous Server Gateway Interface (ASGI) framework/toolkit. Prior
  to version 0.40.0, Starlette treats `multipart/form-data` parts without a `filename` as text
  form fields and buffers those in byte strings with no size limit. This allows an attacker
  to upload arbitrary large form fields and cause Starlette to both slow down significantly
  due to excessive memory allocations and copy operations, and also consume more and more memory
  until the server starts swapping and grinds to a halt, or the OS terminates the server process
  with an OOM error. Uploading multiple such requests in parallel may be enough to render a
  service practically unusable, even if reasonable request size limits are enforced by a reverse
  proxy in front of Starlette. This Denial of service (DoS) vulnerability affects all applications
  built with Starlette (or FastAPI) accepting form requests. Verison 0.40.0 fixes this issue.
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47874.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10932'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.11287'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26335'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26312'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26329'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26307'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26301'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26292'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26318'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26337'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26379'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26378'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26227'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.2629'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00087'
    scoring_system: epss
    scoring_elements: '0.26297'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55664'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55591'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55534'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55636'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55641'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55662'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55682'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55648'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55667'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55689'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55708'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55717'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55703'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.00364'
    scoring_system: epss
    scoring_elements: '0.55673'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '0.01081'
    scoring_system: epss
    scoring_elements: '0.64523'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-f96h-pmfr-66vw
  - score: '0.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://github.com/encode/starlette
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/encode/starlette
  - score: '0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://github.com/encode/starlette/commit/fd038f3070c302bff17ef7d173dbb0b007617733
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/encode/starlette/commit/fd038f3070c302bff17ef7d173dbb0b007617733
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2024-10-15T16:23:43Z/
    published_at: None
    url: https://github.com/encode/starlette/commit/fd038f3070c302bff17ef7d173dbb0b007617733
  - score: '0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
    published_at: None
    url: https://github.com/encode/starlette/security/advisories/GHSA-f96h-pmfr-66vw
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/encode/starlette/security/advisories/GHSA-f96h-pmfr-66vw
  - score: '8.7'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N
    published_at: None
    url: https://github.com/encode/starlette/security/advisories/GHSA-f96h-pmfr-66vw
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2024-10-15T16:23:43Z/
    published_at: None
    url: https://github.com/encode/starlette/security/advisories/GHSA-f96h-pmfr-66vw
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-770
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-47874.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47874
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-47874
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/encode/starlette
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1085295
    reference_type:
    reference_id: 1085295
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2318801
    reference_type:
    reference_id: 2318801
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47874
    reference_type:
    reference_id: CVE-2024-47874
  - url: https://github.com/encode/starlette/commit/fd038f3070c302bff17ef7d173dbb0b007617733
    reference_type:
    reference_id: fd038f3070c302bff17ef7d173dbb0b007617733
  - url: https://github.com/advisories/GHSA-f96h-pmfr-66vw
    reference_type:
    reference_id: GHSA-f96h-pmfr-66vw
  - url: https://github.com/encode/starlette/security/advisories/GHSA-f96h-pmfr-66vw
    reference_type:
    reference_id: GHSA-f96h-pmfr-66vw
