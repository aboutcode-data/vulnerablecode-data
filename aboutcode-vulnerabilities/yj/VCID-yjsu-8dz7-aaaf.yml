vulnerability_id: VCID-yjsu-8dz7-aaaf
aliases:
  - CVE-2021-41131
  - GHSA-wjw6-2cqr-j4qr
  - PYSEC-2021-376
summary: 'python-tuf is a Python reference implementation of The Update Framework (TUF). In
  both clients (`tuf/client` and `tuf/ngclient`), there is a path traversal vulnerability that
  in the worst case can overwrite files ending in `.json` anywhere on the client system on a
  call to `get_one_valid_targetinfo()`. It occurs because the rolename is used to form the filename,
  and may contain path traversal characters (ie `../../name.json`). The impact is mitigated
  by a few facts: It only affects implementations that allow arbitrary rolename selection for
  delegated targets metadata, The attack requires the ability to A) insert new metadata for
  the path-traversing role and B) get the role delegated by an existing targets metadata, The
  written file content is heavily restricted since it needs to be a valid, signed targets file.
  The file extension is always .json. A fix is available in version 0.19 or newer. There are
  no workarounds that do not require code changes. Clients can restrict the allowed character
  set for rolenames, or they can store metadata in files named in a way that is not vulnerable:
  neither of these approaches is possible without modifying python-tuf.'
severities:
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51292'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.50684'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.50949'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51378'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51324'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51026'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51049'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51117'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51102'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51119'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00141'
    scoring_system: epss
    scoring_elements: '0.51143'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.57057'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.57065'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.57038'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00193'
    scoring_system: epss
    scoring_elements: '0.57341'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.6742'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67435'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67442'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.6743'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67423'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67409'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.674'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67405'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67416'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67381'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67396'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67376'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.67272'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00611'
    scoring_system: epss
    scoring_elements: '0.6729'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69382'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.68333'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69323'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69353'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.6938'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69402'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69403'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69381'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69375'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69383'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69389'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69401'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00644'
    scoring_system: epss
    scoring_elements: '0.69398'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: '0.00938'
    scoring_system: epss
    scoring_elements: '0.6207'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-wjw6-2cqr-j4qr
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-wjw6-2cqr-j4qr
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tuf/PYSEC-2021-376.yaml
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/tuf/PYSEC-2021-376.yaml
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:N
    published_at: None
    url: https://github.com/theupdateframework/python-tuf
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/theupdateframework/python-tuf
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/theupdateframework/python-tuf
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:N
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/commit/4ad7ae48fda594b640139c3b7eae21ed5155a102
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/commit/4ad7ae48fda594b640139c3b7eae21ed5155a102
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/commit/4ad7ae48fda594b640139c3b7eae21ed5155a102
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:N
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/issues/1527
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/issues/1527
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/issues/1527
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:N
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-wjw6-2cqr-j4qr
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-wjw6-2cqr-j4qr
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-wjw6-2cqr-j4qr
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-wjw6-2cqr-j4qr
  - score: '8.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:C/A:C
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41131
  - score: '8.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41131
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41131
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41131
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41131
weaknesses:
  - CWE-22
  - CWE-352
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-41131
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/tuf/PYSEC-2021-376.yaml
    reference_type:
    reference_id:
  - url: https://github.com/theupdateframework/python-tuf
    reference_type:
    reference_id:
  - url: https://github.com/theupdateframework/python-tuf/commit/4ad7ae48fda594b640139c3b7eae21ed5155a102
    reference_type:
    reference_id:
  - url: https://github.com/theupdateframework/python-tuf/issues/1527
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:linuxfoundation:the_update_framework:*:*:*:*:*:python:*:*
    reference_type:
    reference_id: cpe:2.3:a:linuxfoundation:the_update_framework:*:*:*:*:*:python:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41131
    reference_type:
    reference_id: CVE-2021-41131
  - url: https://github.com/advisories/GHSA-wjw6-2cqr-j4qr
    reference_type:
    reference_id: GHSA-wjw6-2cqr-j4qr
  - url: https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-wjw6-2cqr-j4qr
    reference_type:
    reference_id: GHSA-wjw6-2cqr-j4qr
