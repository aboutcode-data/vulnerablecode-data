vulnerability_id: VCID-1ydn-2a5x-3fb7
aliases:
  - CVE-2023-54274
summary: 'In the Linux kernel, the following vulnerability has been resolved:  RDMA/srpt: Add
  a check for valid ''mad_agent'' pointer  When unregistering MAD agent, srpt module has a non-null
  check for ''mad_agent'' pointer before invoking ib_unregister_mad_agent(). This check can
  pass if ''mad_agent'' variable holds an error value. The ''mad_agent'' can have an error value
  for a short window when srpt_add_one() and srpt_remove_one() is executed simultaneously.  In
  srpt module, added a valid pointer check for ''sport->mad_agent'' before unregistering MAD
  agent.  This issue can hit when RoCE driver unregisters ib_device  Stack Trace: ------------
  BUG: kernel NULL pointer dereference, address: 000000000000004d PGD 145003067 P4D 145003067
  PUD 2324fe067 PMD 0 Oops: 0002 [#1] PREEMPT SMP NOPTI CPU: 10 PID: 4459 Comm: kworker/u80:0
  Kdump: loaded Tainted: P Hardware name: Dell Inc. PowerEdge R640/06NR82, BIOS 2.5.4 01/13/2020
  Workqueue: bnxt_re bnxt_re_task [bnxt_re] RIP: 0010:_raw_spin_lock_irqsave+0x19/0x40 Call
  Trace:   ib_unregister_mad_agent+0x46/0x2f0 [ib_core]   IPv6: ADDRCONF(NETDEV_CHANGE): bond0:
  link becomes ready   ? __schedule+0x20b/0x560   srpt_unregister_mad_agent+0x93/0xd0 [ib_srpt]   srpt_remove_one+0x20/0x150
  [ib_srpt]   remove_client_context+0x88/0xd0 [ib_core]   bond0: (slave p2p1): link status definitely
  up, 100000 Mbps full duplex   disable_device+0x8a/0x160 [ib_core]   bond0: active interface
  up!   ? kernfs_name_hash+0x12/0x80  (NULL device *): Bonding Info Received: rdev: 000000006c0b8247   __ib_unregister_device+0x42/0xb0
  [ib_core]  (NULL device *):         Master: mode: 4 num_slaves:2   ib_unregister_device+0x22/0x30
  [ib_core]  (NULL device *):         Slave: id: 105069936 name:p2p1 link:0 state:0   bnxt_re_stopqps_and_ib_uninit+0x83/0x90
  [bnxt_re]   bnxt_re_alloc_lag+0x12e/0x4e0 [bnxt_re]'
severities:
  - score: '5.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54274.json
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.0895'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54274
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08909'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-54274
  - score: '4.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-366
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-54274.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-54274
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-54274
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2426026
    reference_type:
    reference_id: 2426026
  - url: https://access.redhat.com/errata/RHSA-2024:2394
    reference_type:
    reference_id: RHSA-2024:2394
  - url: https://access.redhat.com/errata/RHSA-2024:3138
    reference_type:
    reference_id: RHSA-2024:3138
