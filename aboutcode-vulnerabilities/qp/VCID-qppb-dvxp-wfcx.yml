vulnerability_id: VCID-qppb-dvxp-wfcx
aliases:
  - CVE-2024-47528
  - GHSA-x8gm-j36p-fppf
summary: |
  LibreNMS vulnerable to Stored Cross-site Scripting via File Upload
  ### Summary
  Stored Cross-Site Scripting (XSS) can archive via Uploading a new Background for a Custom Map.

  ### Details
  Users with "admin" role can set background for a custom map, this allow the upload of SVG file that can contain XSS payload which will trigger onload. This led to Stored Cross-Site Scripting (XSS).

  ### PoC
  1. Login using an Admin role account.

  2. Go over to "$URL/maps/custom", the Manage Custom Maps.
  ![image](https://github.com/user-attachments/assets/9d621532-7880-4010-b12d-efd377f0cfdd)

  3. Create a new map then choose to edit it.
  4. Choose the "Set Background" option.
  ![image](https://github.com/user-attachments/assets/dc2e9453-ef3e-4649-a42f-60b7a2ad8189)

  5. Choose to upload a SVG file that have this content.
  ```svg
  <svg xmlns="http://www.w3.org/2000/svg" onload="alert(document.domain)">
    <circle cx="50" cy="50" r="40" />
  </svg>
  ```

  6. Once uploaded, there should be a link to the SVG return in the POST request to the API "$URL/maps/custom/1/background".
  ![image](https://github.com/user-attachments/assets/dc224960-0bd3-42c9-ad49-2ec85b065939)

  7. Go over to that link on browser, should see a pop-up.
  ![image](https://github.com/user-attachments/assets/47a7db14-bd89-48fe-885a-fd80a052115e)

  ### Impact
  Attacker can use this to perform malicious java script code for malicious intent.
  This would impact other Admin role users and the Global Read role users. Normal users does not have permission to read the file, so they are not affected.
severities:
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00656'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00655'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00648'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00657'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00653'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00638'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00636'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00661'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00662'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00663'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00659'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.00641'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.01315'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10859'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10875'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10788'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10843'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10939'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15934'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.15638'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00291'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.0029'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: 6e-05
    scoring_system: epss
    scoring_elements: '0.00289'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00508'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00506'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00505'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: 8e-05
    scoring_system: epss
    scoring_elements: '0.00502'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00566'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: 9e-05
    scoring_system: epss
    scoring_elements: '0.00561'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-x8gm-j36p-fppf
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms/commit/d959bf1b366319eda16e3cd6dfda8a22beb203be
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms/commit/d959bf1b366319eda16e3cd6dfda8a22beb203be
  - score: '4.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/librenms/librenms/commit/d959bf1b366319eda16e3cd6dfda8a22beb203be
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/librenms/librenms/commit/d959bf1b366319eda16e3cd6dfda8a22beb203be
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/commit/d959bf1b366319eda16e3cd6dfda8a22beb203be
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-02T13:07:21Z/
    published_at: None
    url: https://github.com/librenms/librenms/commit/d959bf1b366319eda16e3cd6dfda8a22beb203be
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-x8gm-j36p-fppf
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-x8gm-j36p-fppf
  - score: '4.6'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:A/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-x8gm-j36p-fppf
  - score: '5.1'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-x8gm-j36p-fppf
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-x8gm-j36p-fppf
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-10-02T13:07:21Z/
    published_at: None
    url: https://github.com/librenms/librenms/security/advisories/GHSA-x8gm-j36p-fppf
  - score: '4.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47528
  - score: '4.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47528
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47528
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-47528
weaknesses:
  - CWE-79
  - CWE-937
  - CWE-1035
  - CWE-116
  - CWE-434
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-47528
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/commit/d959bf1b366319eda16e3cd6dfda8a22beb203be
    reference_type:
    reference_id:
  - url: https://github.com/librenms/librenms/security/advisories/GHSA-x8gm-j36p-fppf
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-47528
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-x8gm-j36p-fppf
    reference_type:
    reference_id: GHSA-x8gm-j36p-fppf
