vulnerability_id: VCID-ghaj-n4h2-8bhg
aliases:
  - GHSA-m4gq-x24j-jpmf
summary: |
  Mermaid allows prototype pollution in bundled version of DOMPurify
  The following bundled files within the Mermaid NPM package contain a bundled version of DOMPurify that is vulnerable to https://github.com/cure53/DOMPurify/security/advisories/GHSA-mmhx-hmjr-r674, potentially resulting in an XSS attack.

  This affects the built:

  - `dist/mermaid.min.js`
  - `dist/mermaid.js`
  - `dist/mermaid.esm.mjs`
  - `dist/mermaid.esm.min.mjs`

  This will also affect users that use the above files via a CDN link, e.g. `https://cdn.jsdelivr.net/npm/mermaid@10.9.2/dist/mermaid.min.js`

  **Users that use the default NPM export of `mermaid`, e.g. `import mermaid from 'mermaid'`, or the `dist/mermaid.core.mjs` file, do not use this bundled version of DOMPurify, and can easily update using their package manager with something like `npm audit fix`.**

  ### Patches

  - `develop` branch: 6c785c93166c151d27d328ddf68a13d9d65adc00
  - backport to v10: 92a07ffe40aab2769dd1c3431b4eb5beac282b34
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-m4gq-x24j-jpmf
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://github.com/cure53/DOMPurify/security/advisories/GHSA-mmhx-hmjr-r674
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/cure53/DOMPurify/security/advisories/GHSA-mmhx-hmjr-r674
  - score: '4.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N
    published_at: None
    url: https://github.com/mermaid-js/mermaid
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/6c785c93166c151d27d328ddf68a13d9d65adc00
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/6c785c93166c151d27d328ddf68a13d9d65adc00
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/92a07ffe40aab2769dd1c3431b4eb5beac282b34
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/commit/92a07ffe40aab2769dd1c3431b4eb5beac282b34
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:L
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-m4gq-x24j-jpmf
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-m4gq-x24j-jpmf
weaknesses:
  - CWE-1395
  - CWE-1321
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/cure53/DOMPurify/security/advisories/GHSA-mmhx-hmjr-r674
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/commit/6c785c93166c151d27d328ddf68a13d9d65adc00
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/commit/92a07ffe40aab2769dd1c3431b4eb5beac282b34
    reference_type:
    reference_id:
  - url: https://github.com/mermaid-js/mermaid/security/advisories/GHSA-m4gq-x24j-jpmf
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-m4gq-x24j-jpmf
    reference_type:
    reference_id: GHSA-m4gq-x24j-jpmf
