vulnerability_id: VCID-mh1w-vx86-aaan
aliases:
  - CVE-2021-28966
  - GHSA-46f2-3v63-3xrp
summary: In Ruby through 3.0 on Windows, a remote attacker can submit a crafted path when a
  Web application handles a parameter with TmpDir.
severities:
  - score: '0.00094'
    scoring_system: epss
    scoring_elements: '0.24003'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29831'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25678'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25645'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25632'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.2566'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25705'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25698'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25578'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25691'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25527'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25673'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29765'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29702'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25638'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25667'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25701'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29729'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.2973'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.2978'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29761'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29755'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29756'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.25709'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29794'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29812'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.2988'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00105'
    scoring_system: epss
    scoring_elements: '0.29879'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.57018'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.56611'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.56868'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.56938'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.56959'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.57021'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.57019'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.57030'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.57053'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.57184'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.57223'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00186'
    scoring_system: epss
    scoring_elements: '0.57267'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00366'
    scoring_system: epss
    scoring_elements: '0.41613'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00428'
    scoring_system: epss
    scoring_elements: '0.74126'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00428'
    scoring_system: epss
    scoring_elements: '0.74108'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00428'
    scoring_system: epss
    scoring_elements: '0.74310'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: '0.00428'
    scoring_system: epss
    scoring_elements: '0.74138'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-46f2-3v63-3xrp
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-46f2-3v63-3xrp
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/ruby/tmpdir
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ruby/tmpdir
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/ruby/tmpdir/commit/93798c01cb7c10476e50a4d80130a329ba47f348
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ruby/tmpdir/commit/93798c01cb7c10476e50a4d80130a329ba47f348
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/ruby/tmpdir/pull/8
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/ruby/tmpdir/pull/8
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://hackerone.com/reports/1131465
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://hackerone.com/reports/1131465
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28966
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28966
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-28966
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://rubygems.org/gems/tmpdir
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rubygems.org/gems/tmpdir
  - score: '7.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20210902-0004
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.netapp.com/advisory/ntap-20210902-0004
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://www.ruby-lang.org/en/news/2021/04/05/tempfile-path-traversal-on-windows-cve-2021-28966
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.ruby-lang.org/en/news/2021/04/05/tempfile-path-traversal-on-windows-cve-2021-28966
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://www.ruby-lang.org/en/news/2021/04/05/tempfile-path-traversal-on-windows-cve-2021-28966/
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-28966
    reference_type:
    reference_id:
  - url: https://github.com/ruby/tmpdir
    reference_type:
    reference_id:
  - url: https://github.com/ruby/tmpdir/commit/93798c01cb7c10476e50a4d80130a329ba47f348
    reference_type:
    reference_id:
  - url: https://github.com/ruby/tmpdir/pull/8
    reference_type:
    reference_id:
  - url: https://hackerone.com/reports/1131465
    reference_type:
    reference_id:
  - url: https://rubygems.org/gems/tmpdir
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20210902-0004
    reference_type:
    reference_id:
  - url: https://security.netapp.com/advisory/ntap-20210902-0004/
    reference_type:
    reference_id:
  - url: https://www.ruby-lang.org/en/news/2021/04/05/tempfile-path-traversal-on-windows-cve-2021-28966
    reference_type:
    reference_id:
  - url: https://www.ruby-lang.org/en/news/2021/04/05/tempfile-path-traversal-on-windows-cve-2021-28966/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-28966
    reference_type:
    reference_id: CVE-2021-28966
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/tmpdir/CVE-2021-28966.yml
    reference_type:
    reference_id: CVE-2021-28966.YML
  - url: https://github.com/advisories/GHSA-46f2-3v63-3xrp
    reference_type:
    reference_id: GHSA-46f2-3v63-3xrp
