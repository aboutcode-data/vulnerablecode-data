vulnerability_id: VCID-mhdd-6bvz-aaas
aliases:
  - CVE-2021-41281
  - GHSA-3hfw-x7gx-437c
  - PYSEC-2021-436
summary: Synapse is a package for Matrix homeservers written in Python 3/Twisted. Prior to version
  1.47.1, Synapse instances with the media repository enabled can be tricked into downloading
  a file from a remote server into an arbitrary directory. No authentication is required for
  the affected endpoint. The last 2 directories and file name of the path are chosen randomly
  by Synapse and cannot be controlled by an attacker, which limits the impact. Homeservers with
  the media repository disabled are unaffected. Homeservers with a federation whitelist are
  also unaffected, since Synapse will check the remote hostname, including the trailing `../`s,
  against the whitelist. Server administrators should upgrade to 1.47.1 or later. Server administrators
  using a reverse proxy could, at the expense of losing media functionality, may block the certain
  endpoints as a workaround. Alternatively, non-containerized deployments can be adapted to
  use the hardened systemd config.
severities:
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.50460'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.50894'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.50829'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.50806'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.50730'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.51155'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.51102'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.51070'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.50919'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.50895'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.50879'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.50886'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00178'
    scoring_system: epss
    scoring_elements: '0.55457'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00178'
    scoring_system: epss
    scoring_elements: '0.55169'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00178'
    scoring_system: epss
    scoring_elements: '0.55155'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.00178'
    scoring_system: epss
    scoring_elements: '0.55134'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65564'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64285'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64302'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.643'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64292'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64275'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65498'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65532'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65565'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.6559'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65592'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65558'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.6555'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65556'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.6556'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65569'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65583'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65587'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.65573'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64205'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64181'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64273'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64278'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64296'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64309'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.6429'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64289'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.64291'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0052'
    scoring_system: epss
    scoring_elements: '0.6427'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: '0.0106'
    scoring_system: epss
    scoring_elements: '0.64189'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-3hfw-x7gx-437c
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/matrix-org/synapse
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/synapse/commit/91f2bd090
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse/commit/91f2bd090
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/matrix-org/synapse/releases/tag/v1.47.1
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse/releases/tag/v1.47.1
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse/security/advisories/GHSA-3hfw-x7gx-437c
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-436.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-436.yaml
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EU7QRE55U4IUEDLKT5IYPWL3UXMELFAS
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EU7QRE55U4IUEDLKT5IYPWL3UXMELFAS
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/N3WY56LCEZ4ZECLWV5KMAXF2PSMUB4F2
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/N3WY56LCEZ4ZECLWV5KMAXF2PSMUB4F2
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41281
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-41281
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2581
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-41281
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/91f2bd090
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/releases/tag/v1.47.1
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-436.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/EU7QRE55U4IUEDLKT5IYPWL3UXMELFAS/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/N3WY56LCEZ4ZECLWV5KMAXF2PSMUB4F2/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EU7QRE55U4IUEDLKT5IYPWL3UXMELFAS
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EU7QRE55U4IUEDLKT5IYPWL3UXMELFAS/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/N3WY56LCEZ4ZECLWV5KMAXF2PSMUB4F2
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/N3WY56LCEZ4ZECLWV5KMAXF2PSMUB4F2/
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1000451
    reference_type:
    reference_id: 1000451
  - url: https://security.archlinux.org/AVG-2581
    reference_type:
    reference_id: AVG-2581
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-41281
    reference_type:
    reference_id: CVE-2021-41281
  - url: https://github.com/advisories/GHSA-3hfw-x7gx-437c
    reference_type:
    reference_id: GHSA-3hfw-x7gx-437c
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-3hfw-x7gx-437c
    reference_type:
    reference_id: GHSA-3hfw-x7gx-437c
