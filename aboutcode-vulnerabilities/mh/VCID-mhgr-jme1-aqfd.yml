vulnerability_id: VCID-mhgr-jme1-aqfd
aliases:
  - CVE-2025-38392
summary: "In the Linux kernel, the following vulnerability has been resolved:\n\nidpf: convert\
  \ control queue mutex to a spinlock\n\nWith VIRTCHNL2_CAP_MACFILTER enabled, the following\
  \ warning is generated\non module load:\n\n[  324.701677] BUG: sleeping function called from\
  \ invalid context at kernel/locking/mutex.c:578\n[  324.701684] in_atomic(): 1, irqs_disabled():\
  \ 0, non_block: 0, pid: 1582, name: NetworkManager\n[  324.701689] preempt_count: 201, expected:\
  \ 0\n[  324.701693] RCU nest depth: 0, expected: 0\n[  324.701697] 2 locks held by NetworkManager/1582:\n\
  [  324.701702]  #0: ffffffff9f7be770 (rtnl_mutex){....}-{3:3}, at: rtnl_newlink+0x791/0x21e0\n\
  [  324.701730]  #1: ff1100216c380368 (_xmit_ETHER){....}-{2:2}, at: __dev_open+0x3f0/0x870\n\
  [  324.701749] Preemption disabled at:\n[  324.701752] [<ffffffff9cd23b9d>] __dev_open+0x3dd/0x870\n\
  [  324.701765] CPU: 30 UID: 0 PID: 1582 Comm: NetworkManager Not tainted 6.15.0-rc5+ #2 PREEMPT(voluntary)\n\
  [  324.701771] Hardware name: Intel Corporation M50FCP2SBSTD/M50FCP2SBSTD, BIOS SE5C741.86B.01.01.0001.2211140926\
  \ 11/14/2022\n[  324.701774] Call Trace:\n[  324.701777]  <TASK>\n[  324.701779]  dump_stack_lvl+0x5d/0x80\n\
  [  324.701788]  ? __dev_open+0x3dd/0x870\n[  324.701793]  __might_resched.cold+0x1ef/0x23d\n\
  <..>\n[  324.701818]  __mutex_lock+0x113/0x1b80\n<..>\n[  324.701917]  idpf_ctlq_clean_sq+0xad/0x4b0\
  \ [idpf]\n[  324.701935]  ? kasan_save_track+0x14/0x30\n[  324.701941]  idpf_mb_clean+0x143/0x380\
  \ [idpf]\n<..>\n[  324.701991]  idpf_send_mb_msg+0x111/0x720 [idpf]\n[  324.702009]  idpf_vc_xn_exec+0x4cc/0x990\
  \ [idpf]\n[  324.702021]  ? rcu_is_watching+0x12/0xc0\n[  324.702035]  idpf_add_del_mac_filters+0x3ed/0xb50\
  \ [idpf]\n<..>\n[  324.702122]  __hw_addr_sync_dev+0x1cf/0x300\n[  324.702126]  ? find_held_lock+0x32/0x90\n\
  [  324.702134]  idpf_set_rx_mode+0x317/0x390 [idpf]\n[  324.702152]  __dev_open+0x3f8/0x870\n\
  [  324.702159]  ? __pfx___dev_open+0x10/0x10\n[  324.702174]  __dev_change_flags+0x443/0x650\n\
  <..>\n[  324.702208]  netif_change_flags+0x80/0x160\n[  324.702218]  do_setlink.isra.0+0x16a0/0x3960\n\
  <..>\n[  324.702349]  rtnl_newlink+0x12fd/0x21e0\n\nThe sequence is as follows:\n\trtnl_newlink()->\n\
  \t__dev_change_flags()->\n\t__dev_open()->\n\tdev_set_rx_mode() - >  # disables BH and grabs\
  \ \"dev->addr_list_lock\"\n\tidpf_set_rx_mode() ->  # proceed only if VIRTCHNL2_CAP_MACFILTER\
  \ is ON\n\t__dev_uc_sync() ->\n\tidpf_add_mac_filter ->\n\tidpf_add_del_mac_filters ->\n\t\
  idpf_send_mb_msg() ->\n\tidpf_mb_clean() ->\n\tidpf_ctlq_clean_sq()   # mutex_lock(cq_lock)\n\
  \nFix by converting cq_lock to a spinlock. All operations under the new\nlock are safe except\
  \ freeing the DMA memory, which may use vunmap(). Fix\nby requesting a contiguous physical\
  \ memory for the DMA mapping."
severities:
  - score: '7.3'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38392.json
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.01063'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00011'
    scoring_system: epss
    scoring_elements: '0.01081'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03996'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03989'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04026'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0406'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03962'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0398'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0399'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04758'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04736'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04798'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04828'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04881'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04826'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0478'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04836'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04823'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04953'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04776'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0496'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04955'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04804'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05416'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05507'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05497'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05534'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05478'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0545'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0548'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05504'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05513'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05542'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05517'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05487'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05468'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05442'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05467'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05444'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05429'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05436'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05526'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05512'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-767
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38392.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38392
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9a36715cd6bc6a6f16230e19a7f947bab34b3fe5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/b2beb5bb2cd90d7939e470ed4da468683f41baa3
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/dc6c3c2c9dfdaa3a3357f59a80a2904677a71a9a
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2383407
    reference_type:
    reference_id: 2383407
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38392
    reference_type:
    reference_id: CVE-2025-38392
  - url: https://access.redhat.com/errata/RHSA-2025:15429
    reference_type:
    reference_id: RHSA-2025:15429
  - url: https://access.redhat.com/errata/RHSA-2025:15782
    reference_type:
    reference_id: RHSA-2025:15782
  - url: https://access.redhat.com/errata/RHSA-2025:15785
    reference_type:
    reference_id: RHSA-2025:15785
  - url: https://access.redhat.com/errata/RHSA-2025:15786
    reference_type:
    reference_id: RHSA-2025:15786
  - url: https://access.redhat.com/errata/RHSA-2025:17958
    reference_type:
    reference_id: RHSA-2025:17958
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
