vulnerability_id: VCID-zzdw-x5cg-aaac
aliases:
  - CVE-2023-41041
  - GHSA-3fqm-frhg-7c85
  - GMS-2023-1861
summary: |
  Graylog is a free and open log management platform. In a multi-node Graylog cluster, after a user has explicitly logged out, a user session may still be used for API requests until it has reached its original expiry time. Each node maintains an in-memory cache of user sessions. Upon a cache-miss, the session is loaded from the database. After that, the node operates solely on the cached session. Modifications to sessions will update the cached version as well as the session persisted in the database. However, each node maintains their isolated version of the session. When the user logs out, the session is removed from the node-local cache and deleted from the database. The other nodes will however still use the cached session. These nodes will only fail to accept the session id if they intent to update the session in the database. They will then notice that the session is gone. This is true for most API requests originating from user interaction with the Graylog UI because these will lead to an update of the session's "last access" timestamp. If the session update is however prevented by setting the `X-Graylog-No-Session-Extension:true` header in the request, the node will consider the (cached) session valid until the session is expired according to its timeout setting. No session identifiers are leaked. After a user has logged out, the UI shows the login screen again, which gives the user the impression that their session is not valid anymore. However, if the session becomes compromised later, it can still be used to perform API requests against the Graylog cluster. The time frame for this is limited to the configured session lifetime, starting from the time when the user logged out. This issue has been addressed in versions 5.0.9 and 5.1.3. Users are advised to upgrade.


severities:
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.24792'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.24806'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.24846'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.25087'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.25153'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.25251'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.25481'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.25458'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.25448'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.24303'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.25832'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.24622'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.24708'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.24731'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.24798'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00056'
    scoring_system: epss
    scoring_elements: '0.24784'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32587'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.3271'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32734'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32753'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32784'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32775'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32743'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32704'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32695'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.3272'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32759'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32739'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32639'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32749'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00153'
    scoring_system: epss
    scoring_elements: '0.32735'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39176'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39158'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39235'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39297'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39338'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39341'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.3924'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39232'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39231'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39225'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39242'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39228'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00171'
    scoring_system: epss
    scoring_elements: '0.39205'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: '0.00319'
    scoring_system: epss
    scoring_elements: '0.38571'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-3fqm-frhg-7c85
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/Graylog2/graylog2-server
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Graylog2/graylog2-server
  - score: '2.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/Graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3
  - score: '2.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/Graylog2/graylog2-server/commit/ff90f3e2aa4ae2e0bb613d3236e52c40aa154b20
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Graylog2/graylog2-server/commit/ff90f3e2aa4ae2e0bb613d3236e52c40aa154b20
  - score: '2.6'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-3fqm-frhg-7c85
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-3fqm-frhg-7c85
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-3fqm-frhg-7c85
  - score: '3.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-41041
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-41041
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-613
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-41041
    reference_type:
    reference_id:
  - url: https://github.com/Graylog2/graylog2-server
    reference_type:
    reference_id:
  - url: https://github.com/Graylog2/graylog2-server/commit/bb88f3d0b2b0351669ab32c60b595ab7242a3fe3
    reference_type:
    reference_id:
  - url: https://github.com/Graylog2/graylog2-server/commit/ff90f3e2aa4ae2e0bb613d3236e52c40aa154b20
    reference_type:
    reference_id:
  - url: https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-3fqm-frhg-7c85
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:graylog:graylog:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:graylog:graylog:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-41041
    reference_type:
    reference_id: CVE-2023-41041
  - url: https://github.com/advisories/GHSA-3fqm-frhg-7c85
    reference_type:
    reference_id: GHSA-3fqm-frhg-7c85
