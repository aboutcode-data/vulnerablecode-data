vulnerability_id: VCID-muz5-apmc-aaae
aliases:
  - CVE-2022-24817
  - GHSA-vvmq-fwmg-2gjc
summary: Flux2 is an open and extensible continuous delivery solution for Kubernetes. Flux2
  versions between 0.1.0 and 0.29.0, helm-controller 0.1.0 to v0.19.0, and kustomize-controller
  0.1.0 to v0.23.0 are vulnerable to Code Injection via malicious Kubeconfig. In multi-tenancy
  deployments this can also lead to privilege escalation if the controller's service account
  has elevated permissions. Workarounds include disabling functionality via Validating Admission
  webhooks by restricting users from setting the `spec.kubeConfig` field in Flux `Kustomization`
  and `HelmRelease` objects. Additional mitigations include applying restrictive AppArmor and
  SELinux profiles on the controllerâ€™s pod to limit what binaries can be executed. This vulnerability
  is fixed in kustomize-controller v0.23.0 and helm-controller v0.19.0, both included in flux2
  v0.29.0
severities:
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.40315'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.40119'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.40130'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.40139'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.40376'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.40449'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.39633'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.39905'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.39992'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.40020'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.40114'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00090'
    scoring_system: epss
    scoring_elements: '0.40108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.43089'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42750'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42765'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00102'
    scoring_system: epss
    scoring_elements: '0.42742'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.303'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30432'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30368'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30354'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30341'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30334'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30342'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30362'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.3034'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30309'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26071'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26024'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26175'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26195'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26204'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26203'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.2616'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26132'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26143'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26176'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26212'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26209'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26167'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.26142'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30258'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30322'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30385'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00108'
    scoring_system: epss
    scoring_elements: '0.30433'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '0.00138'
    scoring_system: epss
    scoring_elements: '0.2142'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
  - score: '5.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:L
    published_at: None
    url: https://github.com/fluxcd/flux2
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fluxcd/flux2
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://github.com/fluxcd/flux2/security/advisories/GHSA-vvmq-fwmg-2gjc
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/fluxcd/flux2/security/advisories/GHSA-vvmq-fwmg-2gjc
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-04-23T15:53:22Z/
    published_at: None
    url: https://github.com/fluxcd/flux2/security/advisories/GHSA-vvmq-fwmg-2gjc
  - score: '6.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-24817
  - score: '9.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-24817
  - score: '9.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-24817
weaknesses:
  - CWE-94
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-24817
    reference_type:
    reference_id:
  - url: https://github.com/fluxcd/flux2
    reference_type:
    reference_id:
  - url: https://github.com/fluxcd/flux2/security/advisories/GHSA-vvmq-fwmg-2gjc
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fluxcd:flux2:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:fluxcd:flux2:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fluxcd:helm-controller:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:fluxcd:helm-controller:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:fluxcd:kustomize-controller:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:fluxcd:kustomize-controller:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-24817
    reference_type:
    reference_id: CVE-2022-24817
