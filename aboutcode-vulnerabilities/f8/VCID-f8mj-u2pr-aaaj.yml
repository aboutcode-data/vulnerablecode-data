vulnerability_id: VCID-f8mj-u2pr-aaaj
aliases:
  - CVE-2021-3838
  - GHSA-577p-7j7h-2jgf
summary: DomPDF before version 2.0.0 is vulnerable to PHAR deserialization due to a lack of
  checking on the protocol before passing it into the file_get_contents() function. An attacker
  who can upload files of any type to the server can pass in the phar:// protocol to unserialize
  the uploaded file and instantiate arbitrary PHP objects. This can lead to remote code execution,
  especially when DOMPdf is used with frameworks with documented POP chains like Laravel or
  vulnerable developer code.
severities:
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32944'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32935'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32461'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32571'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32573'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32575'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32598'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32624'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32843'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32901'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32988'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32952'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33312'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.32435'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.86987'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.8698'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.86971'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.86967'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.86973'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.86963'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.86993'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.86951'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.86953'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.86922'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.03742'
    scoring_system: epss
    scoring_elements: '0.8693'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.05352'
    scoring_system: epss
    scoring_elements: '0.89498'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.05352'
    scoring_system: epss
    scoring_elements: '0.8952'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.05352'
    scoring_system: epss
    scoring_elements: '0.89514'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.05352'
    scoring_system: epss
    scoring_elements: '0.8951'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.05352'
    scoring_system: epss
    scoring_elements: '0.89509'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.05352'
    scoring_system: epss
    scoring_elements: '0.89503'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.05352'
    scoring_system: epss
    scoring_elements: '0.89505'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.05352'
    scoring_system: epss
    scoring_elements: '0.89501'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.05352'
    scoring_system: epss
    scoring_elements: '0.89499'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.0578'
    scoring_system: epss
    scoring_elements: '0.89955'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.0578'
    scoring_system: epss
    scoring_elements: '0.8962'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.0578'
    scoring_system: epss
    scoring_elements: '0.89964'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.0578'
    scoring_system: epss
    scoring_elements: '0.89619'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.0578'
    scoring_system: epss
    scoring_elements: '0.89944'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.0578'
    scoring_system: epss
    scoring_elements: '0.89932'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: '0.33305'
    scoring_system: epss
    scoring_elements: '0.95189'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-577p-7j7h-2jgf
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/dompdf/dompdf
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dompdf/dompdf
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/dompdf/dompdf/commit/99aeec1efec9213e87098d42eb09439e7ee0bb6a
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/dompdf/dompdf/commit/99aeec1efec9213e87098d42eb09439e7ee0bb6a
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/dompdf/dompdf/commit/99aeec1efec9213e87098d42eb09439e7ee0bb6a
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-11-18T14:40:28Z/
    published_at: None
    url: https://github.com/dompdf/dompdf/commit/99aeec1efec9213e87098d42eb09439e7ee0bb6a
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://huntr.com/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://huntr.com/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e
  - score: Track*
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:T/P:M/B:A/M:M/D:R/2024-11-18T14:40:28Z/
    published_at: None
    url: https://huntr.com/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e
  - score: '9.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3838
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3838
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-3838
weaknesses:
  - CWE-502
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-3838
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3838
    reference_type:
    reference_id:
  - url: https://github.com/dompdf/dompdf
    reference_type:
    reference_id:
  - url: https://github.com/dompdf/dompdf/commit/99aeec1efec9213e87098d42eb09439e7ee0bb6a
    reference_type:
    reference_id:
  - url: https://huntr.com/bounties/0bdddc12-ff67-4815-ab9f-6011a974f48e
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-3838
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:dompdf_project:dompdf:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:dompdf_project:dompdf:*:*:*:*:*:*:*:*
  - url: https://github.com/advisories/GHSA-577p-7j7h-2jgf
    reference_type:
    reference_id: GHSA-577p-7j7h-2jgf
  - url: https://usn.ubuntu.com/6277-1/
    reference_type:
    reference_id: USN-6277-1
  - url: https://usn.ubuntu.com/6277-2/
    reference_type:
    reference_id: USN-6277-2
