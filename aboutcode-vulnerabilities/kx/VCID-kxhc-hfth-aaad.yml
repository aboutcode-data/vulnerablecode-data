vulnerability_id: VCID-kxhc-hfth-aaad
aliases:
  - CVE-2023-46247
  - GHSA-6m97-7527-mh74
  - PYSEC-2023-307
summary: Vyper is a Pythonic Smart Contract Language for the Ethereum Virtual Machine (EVM).
  Contracts containing large arrays might underallocate the number of slots they need by 1.
  Prior to v0.3.8, the calculation to determine how many slots a storage variable needed used
  `math.ceil(type_.size_in_bytes / 32)`. The intermediate floating point step can produce a
  rounding error if there are enough bits set in the IEEE-754 mantissa. Roughly speaking, if
  `type_.size_in_bytes` is large (> 2**46), and slightly less than a power of 2, the calculation
  can overestimate how many slots are needed by 1. If `type_.size_in_bytes` is slightly more
  than a power of 2, the calculation can underestimate how many slots are needed by 1. This
  issue is patched in version 0.3.8.
severities:
  - score: '0.00076'
    scoring_system: epss
    scoring_elements: '0.33743'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.36274'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.36306'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.36228'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.36160'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.35955'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.35950'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.35930'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.35923'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.35927'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.35831'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.35803'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00080'
    scoring_system: epss
    scoring_elements: '0.35731'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37138'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37083'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00089'
    scoring_system: epss
    scoring_elements: '0.39859'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40601'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40484'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40518'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.4061'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40606'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40631'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.4059'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40608'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40626'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40654'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40649'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40622'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40602'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.0021'
    scoring_system: epss
    scoring_elements: '0.40584'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00242'
    scoring_system: epss
    scoring_elements: '0.32121'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55611'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.5552'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55562'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55619'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55646'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55665'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55579'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55607'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55618'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55623'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55628'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55647'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55636'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: '0.00336'
    scoring_system: epss
    scoring_elements: '0.55625'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-6m97-7527-mh74
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2023-307.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2023-307.yaml
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/vyperlang/vyper
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/vyperlang/vyper
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/vyperlang/vyper/blob/6020b8bbf66b062d299d87bc7e4eddc4c9d1c157/vyper/semantics/validation/data_positions.py#L197
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper/blob/6020b8bbf66b062d299d87bc7e4eddc4c9d1c157/vyper/semantics/validation/data_positions.py#L197
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://github.com/vyperlang/vyper/security/advisories/GHSA-6m97-7527-mh74
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper/security/advisories/GHSA-6m97-7527-mh74
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/vyperlang/vyper/security/advisories/GHSA-6m97-7527-mh74
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-46247
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-46247
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-46247
weaknesses:
  - CWE-682
  - CWE-193
  - CWE-937
  - CWE-1035
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-46247
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2023-307.yaml
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/blob/6020b8bbf66b062d299d87bc7e4eddc4c9d1c157/vyper/semantics/validation/data_positions.py#L197
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/commit/0bb7203b584e771b23536ba065a6efda457161bb
    reference_type:
    reference_id:
  - url: https://github.com/vyperlang/vyper/security/advisories/GHSA-6m97-7527-mh74
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*
    reference_type:
    reference_id: cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-46247
    reference_type:
    reference_id: CVE-2023-46247
  - url: https://github.com/advisories/GHSA-6m97-7527-mh74
    reference_type:
    reference_id: GHSA-6m97-7527-mh74
