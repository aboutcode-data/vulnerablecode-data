vulnerability_id: VCID-x7rm-d729-aaae
aliases:
  - CVE-2015-2309
  - GHSA-p684-f7fh-jv2j
summary: |
  Unsafe methods in the Request class
  The `Symfony\Component\HttpFoundation\Request` class provides a mechanism that ensures it does not trust HTTP header values coming from a "non-trusted" client. Unfortunately, it assumes that the remote address is always a trusted client if at least one trusted proxy is involved in the request; this allows a man-in-the-middle attack between the latest trusted proxy and the web server. The following methods are impacted: `getPort()`, `isSecure()`, `getHost()` and `getClientIps()`.
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-2309.html
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2309
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-p684-f7fh-jv2j
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/symfony/symfony/commit/6c73f0ce9302a0091bbfbb96f317e400ce16ef84
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/symfony/symfony/commit/6c73f0ce9302a0091bbfbb96f317e400ce16ef84
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    published_at: None
    url: https://github.com/symfony/symfony/pull/14166
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/symfony/symfony/pull/14166
weaknesses:
  - CWE-1035
  - CWE-937
  - CWE-20
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-2309.html
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2309
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/commit/6c73f0ce9302a0091bbfbb96f317e400ce16ef84
    reference_type:
    reference_id:
  - url: https://github.com/symfony/symfony/pull/14166
    reference_type:
    reference_id:
  - url: https://symfony.com/cve-2015-2309
    reference_type:
    reference_id: CVE-2015-2309
  - url: http://symfony.com/blog/cve-2015-2309-unsafe-methods-in-the-request-class
    reference_type:
    reference_id: CVE-2015-2309-UNSAFE-METHODS-IN-THE-REQUEST-CLASS
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/http-foundation/CVE-2015-2309.yaml
    reference_type:
    reference_id: CVE-2015-2309.YAML
  - url: https://github.com/FriendsOfPHP/security-advisories/blob/master/symfony/symfony/CVE-2015-2309.yaml
    reference_type:
    reference_id: CVE-2015-2309.YAML
  - url: https://github.com/advisories/GHSA-p684-f7fh-jv2j
    reference_type:
    reference_id: GHSA-p684-f7fh-jv2j
