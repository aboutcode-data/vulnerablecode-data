vulnerability_id: VCID-ad8j-yuwq-aaam
aliases:
  - CVE-2024-35198
  - GHSA-wxcx-gg9c-fwp2
summary: |
  TorchServe vulnerable to bypass of allowed_urls configuration
  ### Impact
  TorchServe's check on allowed_urls configuration can be by-passed if the URL contains characters such as ".." but it does not prevent the model from being downloaded into the model store. Once a file is downloaded, it can be referenced without providing a URL the second time, which effectively bypasses the allowed_urls security check. Customers using PyTorch inference Deep Learning Containers (DLC) through Amazon SageMaker and EKS are not affected.

  ### Patches
  This issue in TorchServe has been fixed by validating the URL without characters such as ".." before downloading: [#3082](https://github.com/pytorch/serve/pull/3082).

  TorchServe release 0.11.0 includes the fix to address this vulnerability.

  ### References
  * [#3082](https://github.com/pytorch/serve/pull/3082)
  * [TorchServe release v0.11.0](https://github.com/pytorch/serve/releases/tag/v0.11.0)

  Thank Kroll Cyber Risk for for responsibly disclosing this issue.

  If you have any questions or comments about this advisory, we ask that you contact AWS Security via our [vulnerability reporting page](https://aws.amazon.com/security/vulnerability-reporting) or directly via email to [aws-security@amazon.com](mailto:aws-security@amazon.com). Please do not create a public GitHub issue.
severities:
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.2904'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.28999'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.28978'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.29027'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.29044'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.29025'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.2903'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.29069'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.29087'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.29146'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.29148'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.29104'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.001'
    scoring_system: epss
    scoring_elements: '0.28998'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00304'
    scoring_system: epss
    scoring_elements: '0.50611'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00304'
    scoring_system: epss
    scoring_elements: '0.50598'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00304'
    scoring_system: epss
    scoring_elements: '0.50702'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00342'
    scoring_system: epss
    scoring_elements: '0.53974'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00342'
    scoring_system: epss
    scoring_elements: '0.54017'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00342'
    scoring_system: epss
    scoring_elements: '0.53994'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00342'
    scoring_system: epss
    scoring_elements: '0.53976'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00342'
    scoring_system: epss
    scoring_elements: '0.54019'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00342'
    scoring_system: epss
    scoring_elements: '0.5404'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00342'
    scoring_system: epss
    scoring_elements: '0.54052'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00342'
    scoring_system: epss
    scoring_elements: '0.54042'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00342'
    scoring_system: epss
    scoring_elements: '0.53996'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00381'
    scoring_system: epss
    scoring_elements: '0.56727'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00381'
    scoring_system: epss
    scoring_elements: '0.56736'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: '0.00964'
    scoring_system: epss
    scoring_elements: '0.625'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-wxcx-gg9c-fwp2
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/pytorch/serve
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pytorch/serve
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pytorch/serve/commit/cdba0fd449c2fd23dcf37c54c0784035541d5114
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pytorch/serve/commit/cdba0fd449c2fd23dcf37c54c0784035541d5114
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pytorch/serve/pull/3082
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pytorch/serve/pull/3082
  - score: '8.2'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://github.com/pytorch/serve/releases/tag/v0.11.0
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pytorch/serve/releases/tag/v0.11.0
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pytorch/serve/security/advisories/GHSA-wxcx-gg9c-fwp2
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pytorch/serve/security/advisories/GHSA-wxcx-gg9c-fwp2
weaknesses:
  - CWE-22
  - CWE-937
  - CWE-1035
  - CWE-706
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-35198
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/commit/cdba0fd449c2fd23dcf37c54c0784035541d5114
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/pull/3082
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/releases/tag/v0.11.0
    reference_type:
    reference_id:
  - url: https://github.com/pytorch/serve/security/advisories/GHSA-wxcx-gg9c-fwp2
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35198
    reference_type:
    reference_id: CVE-2024-35198
  - url: https://github.com/advisories/GHSA-wxcx-gg9c-fwp2
    reference_type:
    reference_id: GHSA-wxcx-gg9c-fwp2
