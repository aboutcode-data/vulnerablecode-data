vulnerability_id: VCID-adu8-5csv-aaaf
aliases:
  - CVE-2017-15099
summary: INSERT ... ON CONFLICT DO UPDATE commands in PostgreSQL 10.x before 10.1, 9.6.x before
  9.6.6, and 9.5.x before 9.5.10 disclose table contents that the invoker lacks privilege to
  read. These exploits affect only tables where the attacker lacks full read access but has
  both INSERT and UPDATE privileges. Exploits bypass row level security policies and lack of
  SELECT privilege.
severities:
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-15099.html
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2018:2511
  - score: Important
    scoring_system: rhas
    scoring_elements:
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2018:2566
  - score: '3.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2017-15099.json
  - score: '0.00208'
    scoring_system: epss
    scoring_elements: '0.58684'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.68836'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.68845'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00295'
    scoring_system: epss
    scoring_elements: '0.68817'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80330'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80328'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80327'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80340'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80348'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80395'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80409'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80132'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80432'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80254'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80288'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.00667'
    scoring_system: epss
    scoring_elements: '0.80300'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.10191'
    scoring_system: epss
    scoring_elements: '0.92415'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.10191'
    scoring_system: epss
    scoring_elements: '0.92411'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.10191'
    scoring_system: epss
    scoring_elements: '0.92416'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.10191'
    scoring_system: epss
    scoring_elements: '0.92418'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.10191'
    scoring_system: epss
    scoring_elements: '0.92395'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.10191'
    scoring_system: epss
    scoring_elements: '0.92403'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.10191'
    scoring_system: epss
    scoring_elements: '0.92414'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.10191'
    scoring_system: epss
    scoring_elements: '0.92412'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.10191'
    scoring_system: epss
    scoring_elements: '0.92422'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93108'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.92908'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.92903'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.92897'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.92898'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93083'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93095'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93104'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93112'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93105'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93103'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93102'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93107'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.11281'
    scoring_system: epss
    scoring_elements: '0.93109'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: '0.36615'
    scoring_system: epss
    scoring_elements: '0.95595'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
  - score: low
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1508823
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15098
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15099
  - score: '4.3'
    scoring_system: cvssv2
    scoring_elements: AV:L/AC:L/Au:S/C:P/I:P/A:P
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '4.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-15099
  - score: '6.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-15099
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-485
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-486
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://ubuntu.com/security/notices/USN-3479-1
  - score: Medium
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.postgresql.org/about/news/1801/
  - score: '3.1'
    scoring_system: cvssv3
    scoring_elements: '[''AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N'']'
    published_at: None
    url: https://www.postgresql.org/support/security/CVE-2017-15099/
weaknesses:
  - CWE-200
references:
  - url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-15099.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2017-15099.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2017-15099
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15098
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15099
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://ubuntu.com/security/notices/USN-3479-1
    reference_type:
    reference_id:
  - url: https://www.debian.org/security/2017/dsa-4028
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/about/news/1801/
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/about/news/postgresql-101-966-9510-9415-9320-and-9224-released-1801/
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/support/security/
    reference_type:
    reference_id:
  - url: https://www.postgresql.org/support/security/CVE-2017-15099/
    reference_type:
    reference_id:
  - url: http://www.securityfocus.com/bid/101781
    reference_type:
    reference_id:
  - url: http://www.securitytracker.com/id/1039752
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=1508823
    reference_type:
    reference_id: 1508823
  - url: https://security.archlinux.org/ASA-201711-17
    reference_type:
    reference_id: ASA-201711-17
  - url: https://security.archlinux.org/ASA-201711-18
    reference_type:
    reference_id: ASA-201711-18
  - url: https://security.archlinux.org/AVG-485
    reference_type:
    reference_id: AVG-485
  - url: https://security.archlinux.org/AVG-486
    reference_type:
    reference_id: AVG-486
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:10.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:10.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5.1:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5.1:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5.2:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5.2:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5.3:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5.3:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5.4:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5.4:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5.5:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5.5:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5.6:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5.6:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5.7:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5.7:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5.8:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5.8:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.5.9:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.5.9:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.6:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.6:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.6.1:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.6.1:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.6.2:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.6.2:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.6.3:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.6.3:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.6.4:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.6.4:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:postgresql:postgresql:9.6.5:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:postgresql:postgresql:9.6.5:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2017-15099
    reference_type:
    reference_id: CVE-2017-15099
  - url: https://access.redhat.com/errata/RHSA-2018:2511
    reference_type:
    reference_id: RHSA-2018:2511
  - url: https://access.redhat.com/errata/RHSA-2018:2566
    reference_type:
    reference_id: RHSA-2018:2566
  - url: https://usn.ubuntu.com/3479-1/
    reference_type:
    reference_id: USN-3479-1
