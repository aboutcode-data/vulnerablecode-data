vulnerability_id: VCID-rzjj-s2w1-kuak
aliases:
  - CVE-2025-22094
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  powerpc/perf: Fix ref-counting on the PMU 'vpa_pmu'

  Commit 176cda0619b6 ("powerpc/perf: Add perf interface to expose vpa
  counters") introduced 'vpa_pmu' to expose Book3s-HV nested APIv2 provided
  L1<->L2 context switch latency counters to L1 user-space via
  perf-events. However the newly introduced PMU named 'vpa_pmu' doesn't
  assign ownership of the PMU to the module 'vpa_pmu'. Consequently the
  module 'vpa_pmu' can be unloaded while one of the perf-events are still
  active, which can lead to kernel oops and panic of the form below on a
  Pseries-LPAR:

  BUG: Kernel NULL pointer dereference on read at 0x00000058
  <snip>
   NIP [c000000000506cb8] event_sched_out+0x40/0x258
   LR [c00000000050e8a4] __perf_remove_from_context+0x7c/0x2b0
   Call Trace:
   [c00000025fc3fc30] [c00000025f8457a8] 0xc00000025f8457a8 (unreliable)
   [c00000025fc3fc80] [fffffffffffffee0] 0xfffffffffffffee0
   [c00000025fc3fcd0] [c000000000501e70] event_function+0xa8/0x120
  <snip>
   Kernel panic - not syncing: Aiee, killing interrupt handler!

  Fix this by adding the module ownership to 'vpa_pmu' so that the module
  'vpa_pmu' is ref-counted and prevented from being unloaded when perf-events
  are initialized.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22094.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02531'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02537'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.0253'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02545'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04294'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04283'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04247'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04275'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04273'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04281'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04282'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-22094.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-22094
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6cf045b51e2c5721db7e55305f09ee32741e00f9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/70ea7c5189197c6f5acdcfd8a2651be2c41e2faa
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff99d5b6a246715f2257123cdf6c4a29cb33aa78
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2360227
    reference_type:
    reference_id: 2360227
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-22094
    reference_type:
    reference_id: CVE-2025-22094
