vulnerability_id: VCID-4at1-k27t-aaan
aliases:
  - BIT-2022-33891
  - BIT-spark-2022-33891
  - CVE-2022-33891
  - GHSA-4x9r-j582-cgr8
  - PYSEC-2022-236
summary: The Apache Spark UI offers the possibility to enable ACLs via the configuration option
  spark.acls.enable. With an authentication filter, this checks whether a user has access permissions
  to view or modify the application. If ACLs are enabled, a code path in HttpSecurityFilter
  can allow someone to perform impersonation by providing an arbitrary user name. A malicious
  user might then be able to reach a permission check function that will ultimately build a
  Unix shell command based on their input, and execute it. This will result in arbitrary shell
  command execution as the user Spark is currently running as. This affects Apache Spark versions
  3.0.3 and earlier, versions 3.1.1 to 3.1.2, and versions 3.2.0 to 3.2.1.
severities:
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html
  - score: Attend
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:N/T:T/P:M/B:A/M:M/D:A/2025-02-04T14:13:50Z/
    published_at: None
    url: http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-33891.json
  - score: '0.9424'
    scoring_system: epss
    scoring_elements: '0.99924'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.9424'
    scoring_system: epss
    scoring_elements: '0.99923'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.9424'
    scoring_system: epss
    scoring_elements: '0.99922'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.9424'
    scoring_system: epss
    scoring_elements: '0.99921'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.9424'
    scoring_system: epss
    scoring_elements: '0.99914'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.9424'
    scoring_system: epss
    scoring_elements: '0.99913'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.94275'
    scoring_system: epss
    scoring_elements: '0.99929'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.94287'
    scoring_system: epss
    scoring_elements: '0.99928'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97051'
    scoring_system: epss
    scoring_elements: '0.99867'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97137'
    scoring_system: epss
    scoring_elements: '0.99892'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97137'
    scoring_system: epss
    scoring_elements: '0.99891'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97154'
    scoring_system: epss
    scoring_elements: '0.99849'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97154'
    scoring_system: epss
    scoring_elements: '0.99847'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97258'
    scoring_system: epss
    scoring_elements: '0.99886'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97258'
    scoring_system: epss
    scoring_elements: '0.99887'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97258'
    scoring_system: epss
    scoring_elements: '0.99888'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97258'
    scoring_system: epss
    scoring_elements: '0.99889'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '0.97286'
    scoring_system: epss
    scoring_elements: '0.99895'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-4x9r-j582-cgr8
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/apache/spark
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/apache/spark
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/pyspark/PYSEC-2022-236.yaml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/pyspark/PYSEC-2022-236.yaml
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://lists.apache.org/thread/p847l3kopoo5bjtmxrcwk21xp6tjxqlc
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.apache.org/thread/p847l3kopoo5bjtmxrcwk21xp6tjxqlc
  - score: Attend
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:N/T:T/P:M/B:A/M:M/D:A/2025-02-04T14:13:50Z/
    published_at: None
    url: https://lists.apache.org/thread/p847l3kopoo5bjtmxrcwk21xp6tjxqlc
  - score: '8.8'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-33891
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-33891
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-33891
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://www.openwall.com/lists/oss-security/2023/05/02/1
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.openwall.com/lists/oss-security/2023/05/02/1
  - score: '8.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/05/02/1
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/05/02/1
  - score: Attend
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:A/A:N/T:T/P:M/B:A/M:M/D:A/2025-02-04T14:13:50Z/
    published_at: None
    url: http://www.openwall.com/lists/oss-security/2023/05/02/1
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-77
  - CWE-78
references:
  - url: http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html
    reference_type:
    reference_id:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-33891.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-33891
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/apache/spark
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/pyspark/PYSEC-2022-236.yaml
    reference_type:
    reference_id:
  - url: https://lists.apache.org/thread/p847l3kopoo5bjtmxrcwk21xp6tjxqlc
    reference_type:
    reference_id:
  - url: https://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html
    reference_type:
    reference_id:
  - url: https://www.openwall.com/lists/oss-security/2023/05/02/1
    reference_type:
    reference_id:
  - url: http://www.openwall.com/lists/oss-security/2023/05/02/1
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2174263
    reference_type:
    reference_id: 2174263
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:apache:spark:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:apache:spark:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-33891
    reference_type:
    reference_id: CVE-2022-33891
  - url: https://github.com/advisories/GHSA-4x9r-j582-cgr8
    reference_type:
    reference_id: GHSA-4x9r-j582-cgr8
