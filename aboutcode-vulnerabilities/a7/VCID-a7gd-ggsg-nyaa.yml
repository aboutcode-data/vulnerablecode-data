vulnerability_id: VCID-a7gd-ggsg-nyaa
aliases:
  - CVE-2025-39770
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: gso: Forbid
  IPv6 TSO with extensions on devices with only IPV6_CSUM  When performing Generic Segmentation
  Offload (GSO) on an IPv6 packet that contains extension headers, the kernel incorrectly requests
  checksum offload if the egress device only advertises NETIF_F_IPV6_CSUM feature, which has
  a strict contract: it supports checksum offload only for plain TCP or UDP over IPv6 and explicitly
  does not support packets with extension headers. The current GSO logic violates this contract
  by failing to disable the feature for packets with extension headers, such as those used in
  GREoIPv6 tunnels.  This violation results in the device being asked to perform an operation
  it cannot support, leading to a `skb_warn_bad_offload` warning and a collapse of network throughput.
  While device TSO/USO is correctly bypassed in favor of software GSO for these packets, the
  GSO stack must be explicitly told not to request checksum offload.  Mask NETIF_F_IPV6_CSUM,
  NETIF_F_TSO6 and NETIF_F_GSO_UDP_L4 in gso_features_check if the IPv6 header contains extension
  headers to compute checksum in software.  The exception is a BIG TCP extension, which, as
  stated in commit 68e068cabd2c6c53 ("net: reenable NETIF_F_IPV6_CSUM offload for BIG TCP packets"):
  "The feature is only enabled on devices that support BIG TCP TSO. The header is only present
  for PF_PACKET taps like tcpdump, and not transmitted by physical devices."  kernel log output
  (truncated): WARNING: CPU: 1 PID: 5273 at net/core/dev.c:3535 skb_warn_bad_offload+0x81/0x140
  ... Call Trace:  <TASK>  skb_checksum_help+0x12a/0x1f0  validate_xmit_skb+0x1a3/0x2d0  validate_xmit_skb_list+0x4f/0x80  sch_direct_xmit+0x1a2/0x380  __dev_xmit_skb+0x242/0x670  __dev_queue_xmit+0x3fc/0x7f0  ip6_finish_output2+0x25e/0x5d0  ip6_finish_output+0x1fc/0x3f0  ip6_tnl_xmit+0x608/0xc00
  [ip6_tunnel]  ip6gre_tunnel_xmit+0x1c0/0x390 [ip6_gre]  dev_hard_start_xmit+0x63/0x1c0  __dev_queue_xmit+0x6d0/0x7f0  ip6_finish_output2+0x214/0x5d0  ip6_finish_output+0x1fc/0x3f0  ip6_xmit+0x2ca/0x6f0  ip6_finish_output+0x1fc/0x3f0  ip6_xmit+0x2ca/0x6f0  inet6_csk_xmit+0xeb/0x150  __tcp_transmit_skb+0x555/0xa80  tcp_write_xmit+0x32a/0xe90  tcp_sendmsg_locked+0x437/0x1110  tcp_sendmsg+0x2f/0x50
  ... skb linear:   00000000: e4 3d 1a 7d ec 30 e4 3d 1a 7e 5d 90 86 dd 60 0e skb linear:   00000010:
  00 0a 1b 34 3c 40 20 11 00 00 00 00 00 00 00 00 skb linear:   00000020: 00 00 00 00 00 12
  20 11 00 00 00 00 00 00 00 00 skb linear:   00000030: 00 00 00 00 00 11 2f 00 04 01 04 01
  01 00 00 00 skb linear:   00000040: 86 dd 60 0e 00 0a 1b 00 06 40 20 23 00 00 00 00 skb linear:   00000050:
  00 00 00 00 00 00 00 00 00 12 20 23 00 00 00 00 skb linear:   00000060: 00 00 00 00 00 00
  00 00 00 11 bf 96 14 51 13 f9 skb linear:   00000070: ae 27 a0 a8 2b e3 80 18 00 40 5b 6f
  00 00 01 01 skb linear:   00000080: 08 0a 42 d4 50 d5 4b 70 f8 1a'
severities:
  - score: '5.7'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39770.json
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39770.json
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03056'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00018'
    scoring_system: epss
    scoring_elements: '0.03048'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04755'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04762'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04748'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0488'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04887'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04879'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05054'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.05096'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04992'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04991'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04968'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04729'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04758'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04811'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05808'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05769'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05786'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.058'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05787'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05763'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.0575'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05733'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05746'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05729'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05725'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05706'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05714'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05732'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00026'
    scoring_system: epss
    scoring_elements: '0.05836'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00036'
    scoring_system: epss
    scoring_elements: '0.10603'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.14741'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-841
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-39770.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-39770
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-39770
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2394597
    reference_type:
    reference_id: 2394597
  - url: https://access.redhat.com/errata/RHSA-2025:15782
    reference_type:
    reference_id: RHSA-2025:15782
