vulnerability_id: VCID-a71p-46fy-aaar
aliases:
  - CVE-2021-37705
  - GHSA-q5vh-6whw-x745
  - PYSEC-2021-344
summary: OneFuzz is an open source self-hosted Fuzzing-As-A-Service platform. Starting with
  OneFuzz 2.12.0 or greater, an incomplete authorization check allows an authenticated user
  from any Azure Active Directory tenant to make authorized API calls to a vulnerable OneFuzz
  instance. To be vulnerable, a OneFuzz deployment must be both version 2.12.0 or greater and
  deployed with the non-default --multi_tenant_domain option. This can result in read/write
  access to private data such as software vulnerability and crash information, security testing
  tools and proprietary code and symbols. Via authorized API calls, this also enables tampering
  with existing data and unauthorized code execution on Azure compute resources. This issue
  is resolved starting in release 2.31.0, via the addition of application-level check of the
  bearer token's `issuer` against an administrator-configured allowlist. As a workaround users
  can restrict access to the tenant of a deployed OneFuzz instance < 2.31.0 by redeploying in
  the default configuration, which omits the `--multi_tenant_domain` option.
severities:
  - score: '0.00475'
    scoring_system: epss
    scoring_elements: '0.47752'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.80976'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.81016'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.80988'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.80825'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.80944'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.81105'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.81084'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.81072'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.81026'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.81025'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00709'
    scoring_system: epss
    scoring_elements: '0.81015'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.80430'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.80288'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.80293'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00713'
    scoring_system: epss
    scoring_elements: '0.80276'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71447'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70511'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70508'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70516'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70519'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70502'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71377'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71403'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71431'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71448'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71453'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71432'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71426'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71438'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71435'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71441'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.71449'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.7145'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70418'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.7041'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70489'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70496'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70512'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70528'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70506'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: '0.00732'
    scoring_system: epss
    scoring_elements: '0.70501'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-q5vh-6whw-x745
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/microsoft/onefuzz
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/microsoft/onefuzz
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/microsoft/onefuzz/commit/2fcb4998887959b4fa11894a068d689189742cb1
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/microsoft/onefuzz/commit/2fcb4998887959b4fa11894a068d689189742cb1
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/microsoft/onefuzz/pull/1153
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/microsoft/onefuzz/pull/1153
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/microsoft/onefuzz/releases/tag/2.31.0
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/microsoft/onefuzz/releases/tag/2.31.0
  - score: CRITICAL
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/microsoft/onefuzz/security/advisories/GHSA-q5vh-6whw-x745
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/onefuzz/PYSEC-2021-344.yaml
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/onefuzz/PYSEC-2021-344.yaml
  - score: '6.8'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:P/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37705
  - score: '10.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37705
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-37705
  - score: '10.0'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L
    published_at: None
    url: https://pypi.org/project/onefuzz
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://pypi.org/project/onefuzz
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-346
  - CWE-863
  - CWE-78
  - CWE-285
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-37705
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/onefuzz
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/onefuzz/commit/2fcb4998887959b4fa11894a068d689189742cb1
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/onefuzz/pull/1153
    reference_type:
    reference_id:
  - url: https://github.com/microsoft/onefuzz/releases/tag/2.31.0
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/onefuzz/PYSEC-2021-344.yaml
    reference_type:
    reference_id:
  - url: https://pypi.org/project/onefuzz
    reference_type:
    reference_id:
  - url: https://pypi.org/project/onefuzz/
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:microsoft:onefuzz:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:microsoft:onefuzz:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-37705
    reference_type:
    reference_id: CVE-2021-37705
  - url: https://github.com/advisories/GHSA-q5vh-6whw-x745
    reference_type:
    reference_id: GHSA-q5vh-6whw-x745
  - url: https://github.com/microsoft/onefuzz/security/advisories/GHSA-q5vh-6whw-x745
    reference_type:
    reference_id: GHSA-q5vh-6whw-x745
