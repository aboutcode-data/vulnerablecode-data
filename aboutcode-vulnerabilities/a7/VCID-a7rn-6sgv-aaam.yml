vulnerability_id: VCID-a7rn-6sgv-aaam
aliases:
  - CVE-2021-47617
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  PCI: pciehp: Fix infinite loop in IRQ handler upon power fault

  The Power Fault Detected bit in the Slot Status register differs from
  all other hotplug events in that it is sticky:  It can only be cleared
  after turning off slot power.  Per PCIe r5.0, sec. 6.7.1.8:

    If a power controller detects a main power fault on the hot-plug slot,
    it must automatically set its internal main power fault latch [...].
    The main power fault latch is cleared when software turns off power to
    the hot-plug slot.

  The stickiness used to cause interrupt storms and infinite loops which
  were fixed in 2009 by commits 5651c48cfafe ("PCI pciehp: fix power fault
  interrupt storm problem") and 99f0169c17f3 ("PCI: pciehp: enable
  software notification on empty slots").

  Unfortunately in 2020 the infinite loop issue was inadvertently
  reintroduced by commit 8edf5332c393 ("PCI: pciehp: Fix MSI interrupt
  race"):  The hardirq handler pciehp_isr() clears the PFD bit until
  pciehp's power_fault_detected flag is set.  That happens in the IRQ
  thread pciehp_ist(), which never learns of the event because the hardirq
  handler is stuck in an infinite loop.  Fix by setting the
  power_fault_detected flag already in the hardirq handler.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47617.json
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.10981'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.0866'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08692'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08736'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08767'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08746'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08728'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08721'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08714'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08712'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08682'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08709'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08687'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08564'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00039'
    scoring_system: epss
    scoring_elements: '0.08545'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12084'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12006'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12111'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12183'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12162'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12125'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12109'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12089'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12091'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12106'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12108'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00041'
    scoring_system: epss
    scoring_elements: '0.12098'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05108'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05119'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05115'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05124'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05073'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05091'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05100'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05105'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05128'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05078'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04987'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.04956'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05058'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00042'
    scoring_system: epss
    scoring_elements: '0.05065'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '0.00165'
    scoring_system: epss
    scoring_elements: '0.2455'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47617
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-47617
weaknesses:
  - CWE-835
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-47617.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-47617
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47617
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1db58c6584a72102e98af2e600ea184ddaf2b8af
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/23584c1ed3e15a6f4bfab8dc5a88d94ab929ee12
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3b4c966fb156ff3e70b2526d964952ff7c1574d9
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/464da38ba827f670deac6500a1de9a4f0f44c41d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6d6f1f0dac3e3441ecdb1103d4efb11b9ed24dd5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ff27f7d0333cff89ec85c419f431aca1b38fb16a
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2293292
    reference_type:
    reference_id: 2293292
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-47617
    reference_type:
    reference_id: CVE-2021-47617
