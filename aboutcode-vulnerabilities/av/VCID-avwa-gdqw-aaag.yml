vulnerability_id: VCID-avwa-gdqw-aaag
aliases:
  - CVE-2023-34454
  - GHSA-fjpj-2g6w-x25r
summary: |
  snappy-java is a fast compressor/decompressor for Java. Due to unchecked multiplications, an integer overflow may occur in versions prior to 1.1.10.1, causing an unrecoverable fatal error.

  The function `compress(char[] input)` in the file `Snappy.java` receives an array of characters and compresses it. It does so by multiplying the length by 2 and passing it to the rawCompress` function.

  Since the length is not tested, the multiplication by two can cause an integer overflow and become negative. The rawCompress function then uses the received length and passes it to the natively compiled maxCompressedLength function, using the returned value to allocate a byte array.

  Since the maxCompressedLength function treats the length as an unsigned integer, it doesn’t care that it is negative, and it returns a valid value, which is casted to a signed integer by the Java engine. If the result is negative, a `java.lang.NegativeArraySizeException` exception will be raised while trying to allocate the array `buf`. On the other side, if the result is positive, the `buf` array will successfully be allocated, but its size might be too small to use for the compression, causing a fatal Access Violation error.

  The same issue exists also when using the `compress` functions that receive double, float, int, long and short, each using a different multiplier that may cause the same issue. The issue most likely won’t occur when using a byte array, since creating a byte array of size 0x80000000 (or any other negative value) is impossible in the first place.

  Version 1.1.10.1 contains a patch for this issue.
severities:
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2023:7700
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2024-08-28T14:24:22Z/
    published_at: None
    url: https://access.redhat.com/errata/RHSA-2023:7700
  - score: '5.9'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-34454.json
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.46867'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.47228'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.47148'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.47246'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.47324'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00118'
    scoring_system: epss
    scoring_elements: '0.47330'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.51278'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.51055'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.51072'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.51094'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.51245'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00140'
    scoring_system: epss
    scoring_elements: '0.51330'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00145'
    scoring_system: epss
    scoring_elements: '0.51186'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00149'
    scoring_system: epss
    scoring_elements: '0.51338'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00149'
    scoring_system: epss
    scoring_elements: '0.51334'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00149'
    scoring_system: epss
    scoring_elements: '0.51315'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42748'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.39426'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.3945'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42738'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.39443'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42679'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.39422'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42678'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.39374'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.39406'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.39434'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.39465'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.39404'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42712'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.39466'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42733'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42825'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42829'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42799'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.4273'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42739'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42735'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.42736'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00201'
    scoring_system: epss
    scoring_elements: '0.4274'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40163'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40087'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40055'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40169'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00207'
    scoring_system: epss
    scoring_elements: '0.40166'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: '0.00462'
    scoring_system: epss
    scoring_elements: '0.47128'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-fjpj-2g6w-x25r
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/xerial/snappy-java
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xerial/snappy-java
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/xerial/snappy-java/blob/05c39b2ca9b5b7b39611529cc302d3d796329611/src/main/java/org/xerial/snappy/Snappy.java#L169
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xerial/snappy-java/blob/05c39b2ca9b5b7b39611529cc302d3d796329611/src/main/java/org/xerial/snappy/Snappy.java#L169
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-12T16:25:27Z/
    published_at: None
    url: https://github.com/xerial/snappy-java/blob/05c39b2ca9b5b7b39611529cc302d3d796329611/src/main/java/org/xerial/snappy/Snappy.java#L169
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/xerial/snappy-java/blob/05c39b2ca9b5b7b39611529cc302d3d796329611/src/main/java/org/xerial/snappy/Snappy.java#L422
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xerial/snappy-java/blob/05c39b2ca9b5b7b39611529cc302d3d796329611/src/main/java/org/xerial/snappy/Snappy.java#L422
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-12T16:25:27Z/
    published_at: None
    url: https://github.com/xerial/snappy-java/blob/05c39b2ca9b5b7b39611529cc302d3d796329611/src/main/java/org/xerial/snappy/Snappy.java#L422
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/xerial/snappy-java/blob/master/src/main/java/org/xerial/snappy/Snappy.java
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xerial/snappy-java/blob/master/src/main/java/org/xerial/snappy/Snappy.java
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-12T16:25:27Z/
    published_at: None
    url: https://github.com/xerial/snappy-java/blob/master/src/main/java/org/xerial/snappy/Snappy.java
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/xerial/snappy-java/commit/d0042551e4a3509a725038eb9b2ad1f683674d94
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xerial/snappy-java/commit/d0042551e4a3509a725038eb9b2ad1f683674d94
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-12T16:25:27Z/
    published_at: None
    url: https://github.com/xerial/snappy-java/commit/d0042551e4a3509a725038eb9b2ad1f683674d94
  - score: '5.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/xerial/snappy-java/security/advisories/GHSA-fjpj-2g6w-x25r
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/xerial/snappy-java/security/advisories/GHSA-fjpj-2g6w-x25r
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/xerial/snappy-java/security/advisories/GHSA-fjpj-2g6w-x25r
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:N/T:P/P:M/B:A/M:M/D:T/2024-12-12T16:25:27Z/
    published_at: None
    url: https://github.com/xerial/snappy-java/security/advisories/GHSA-fjpj-2g6w-x25r
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34454
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-34454
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-190
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-34454.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-34454
    reference_type:
    reference_id:
  - url: https://github.com/xerial/snappy-java
    reference_type:
    reference_id:
  - url: https://github.com/xerial/snappy-java/blob/05c39b2ca9b5b7b39611529cc302d3d796329611/src/main/java/org/xerial/snappy/Snappy.java#L169
    reference_type:
    reference_id:
  - url: https://github.com/xerial/snappy-java/blob/05c39b2ca9b5b7b39611529cc302d3d796329611/src/main/java/org/xerial/snappy/Snappy.java#L422
    reference_type:
    reference_id:
  - url: https://github.com/xerial/snappy-java/blob/master/src/main/java/org/xerial/snappy/Snappy.java
    reference_type:
    reference_id:
  - url: https://github.com/xerial/snappy-java/commit/d0042551e4a3509a725038eb9b2ad1f683674d94
    reference_type:
    reference_id:
  - url: https://github.com/xerial/snappy-java/security/advisories/GHSA-fjpj-2g6w-x25r
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2215394
    reference_type:
    reference_id: 2215394
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:xerial:snappy-java:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:xerial:snappy-java:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-34454
    reference_type:
    reference_id: CVE-2023-34454
  - url: https://github.com/advisories/GHSA-fjpj-2g6w-x25r
    reference_type:
    reference_id: GHSA-fjpj-2g6w-x25r
  - url: https://access.redhat.com/errata/RHSA-2023:5165
    reference_type:
    reference_id: RHSA-2023:5165
  - url: https://access.redhat.com/errata/RHSA-2023:7700
    reference_type:
    reference_id: RHSA-2023:7700
