vulnerability_id: VCID-t2wk-4hj9-aaad
aliases:
  - CVE-2024-23651
  - GHSA-m3r6-h7wv-7xxv
summary: BuildKit is a toolkit for converting source code to build artifacts in an efficient,
  expressive and repeatable manner. Two malicious build steps running in parallel sharing the
  same cache mounts with subpaths could cause a race condition that can lead to files from the
  host system being accessible to the build container. The issue has been fixed in v0.12.5.
  Workarounds include, avoiding using BuildKit frontend from an untrusted source or building
  an untrusted Dockerfile containing cache mounts with --mount=type=cache,source=... options.
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-23651.json
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31363'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31377'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31373'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31666'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31568'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31512'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31286'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31260'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.30730'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31246'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31030'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31105'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31131'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31242'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.31243'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.33202'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45089'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45214'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45231'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45272'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45262'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45241'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45197'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45235'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45251'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45237'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45226'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45117'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00247'
    scoring_system: epss
    scoring_elements: '0.45221'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55783'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.5569'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55731'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55788'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55813'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55831'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.5575'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55781'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.5579'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55794'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55799'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55819'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.0034'
    scoring_system: epss
    scoring_elements: '0.55809'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '0.00785'
    scoring_system: epss
    scoring_elements: '0.58705'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/moby/buildkit
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/buildkit
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/moby/buildkit/pull/4604
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/buildkit/pull/4604
  - score: '9.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://github.com/moby/buildkit/releases/tag/v0.12.5
  - score: CRITICAL
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/buildkit/releases/tag/v0.12.5
  - score: '8.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N
    published_at: None
    url: https://github.com/moby/buildkit/security/advisories/GHSA-m3r6-h7wv-7xxv
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/moby/buildkit/security/advisories/GHSA-m3r6-h7wv-7xxv
  - score: '7.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23651
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-23651
weaknesses:
  - CWE-362
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-23651.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-23651
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/pull/4604
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/releases/tag/v0.12.5
    reference_type:
    reference_id:
  - url: https://github.com/moby/buildkit/security/advisories/GHSA-m3r6-h7wv-7xxv
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2262224
    reference_type:
    reference_id: 2262224
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mobyproject:buildkit:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:mobyproject:buildkit:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-23651
    reference_type:
    reference_id: CVE-2024-23651
  - url: https://security.gentoo.org/glsa/202407-12
    reference_type:
    reference_id: GLSA-202407-12
  - url: https://security.gentoo.org/glsa/202407-25
    reference_type:
    reference_id: GLSA-202407-25
  - url: https://security.gentoo.org/glsa/202409-29
    reference_type:
    reference_id: GLSA-202409-29
