vulnerability_id: VCID-t2ff-bwrj-uubf
aliases:
  - GHSA-gmx7-gr5q-85w5
summary: |
  magic-crypt uses insecure cryptographic algorithms
  This crate uses a number of cryptographic algorithms that are no longer considered secure and it uses them in ways that do not guarantee the integrity of the encrypted data.

  `MagicCrypt64` uses the insecure DES block cipher in CBC mode without authentication. This allows for practical brute force and padding oracle attacks and does not protect the integrity of the encrypted data. Key and IV are generated from user input using CRC64, which is not at all a key derivation function.

  `MagicCrypt64`, `MagicCrypt128`, `MagicCrypt192`, and `MagicCrypt256` are all vulnerable to padding-oracle attacks. None of them protect the integrity of the ciphertext. Furthermore, none use password-based key derivation functions, even though the key is intended to be generated from a password.

  Each of the implementations are unsound in that they use uninitialized memory without `MaybeUninit` or equivalent structures.

  For more information, visit the [issue](https://github.com/magiclen/rust-magiccrypt/issues/17).
severities:
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-gmx7-gr5q-85w5
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/magiclen/rust-magiccrypt
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/magiclen/rust-magiccrypt/issues/17
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://rustsec.org/advisories/RUSTSEC-2024-0430.html
weaknesses:
  - CWE-326
references:
  - url: https://github.com/magiclen/rust-magiccrypt
    reference_type:
    reference_id:
  - url: https://github.com/magiclen/rust-magiccrypt/issues/17
    reference_type:
    reference_id:
  - url: https://rustsec.org/advisories/RUSTSEC-2024-0430.html
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-gmx7-gr5q-85w5
    reference_type:
    reference_id: GHSA-gmx7-gr5q-85w5
