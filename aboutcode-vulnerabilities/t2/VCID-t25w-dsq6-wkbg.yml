vulnerability_id: VCID-t25w-dsq6-wkbg
aliases:
  - CVE-2023-53584
summary: "In the Linux kernel, the following vulnerability has been resolved:  ubifs: ubifs_releasepage:\
  \ Remove ubifs_assert(0) to valid this process  There are two states for ubifs writing pages:\
  \ 1. Dirty, Private 2. Not Dirty, Not Private  The normal process cannot go to ubifs_releasepage()\
  \ which means there exists pages being private but not dirty. Reproducer[1] shows that it\
  \ could occur (which maybe related to [2]) with following process:       PA              \
  \       PB                    PC lock(page)[PA] ubifs_write_end   attach_page_private    \
  \     // set Private   __set_page_dirty_nobuffers  // set Dirty unlock(page)  write_cache_pages[PA]\
  \   lock(page)   clear_page_dirty_for_io(page)\t// clear Dirty   ubifs_writepage         \
  \                 do_truncation[PB] \t\t\t  truncate_setsize \t\t\t    i_size_write(inode,\
  \ newsize) // newsize = 0      i_size = i_size_read(inode)\t// i_size = 0     end_index =\
  \ i_size >> PAGE_SHIFT     if (page->index > end_index)       goto out // jump out: unlock(page)\
  \   // Private, Not Dirty  \t\t\t\t\t\tgeneric_fadvise[PC] \t\t\t\t\t\t  lock(page) \t\t\t\
  \t\t\t  invalidate_inode_page \t\t\t\t\t\t    try_to_release_page \t\t\t\t\t\t      ubifs_releasepage\
  \ \t\t\t\t\t\t        ubifs_assert(c, 0) \t\t                                        // bad\
  \ assertion! \t\t\t\t\t\t  unlock(page) \t\t\t  truncate_pagecache[PB]  Then we may get following\
  \ assertion failed:   UBIFS error (ubi0:0 pid 1683): ubifs_assert_failed [ubifs]:   UBIFS\
  \ assert failed: 0, in fs/ubifs/file.c:1513   UBIFS warning (ubi0:0 pid 1683): ubifs_ro_mode\
  \ [ubifs]:   switched to read-only mode, error -22   CPU: 2 PID: 1683 Comm: aa Not tainted\
  \ 5.16.0-rc5-00184-g0bca5994cacc-dirty #308   Call Trace:     dump_stack+0x13/0x1b     ubifs_ro_mode+0x54/0x60\
  \ [ubifs]     ubifs_assert_failed+0x4b/0x80 [ubifs]     ubifs_releasepage+0x67/0x1d0 [ubifs]\
  \     try_to_release_page+0x57/0xe0     invalidate_inode_page+0xfb/0x130     __invalidate_mapping_pages+0xb9/0x280\
  \     invalidate_mapping_pagevec+0x12/0x20     generic_fadvise+0x303/0x3c0     ksys_fadvise64_64+0x4c/0xb0\
  \  [1] https://bugzilla.kernel.org/show_bug.cgi?id=215373 [2] https://linux-mtd.infradead.narkive.com/NQoBeT1u/patch-rfc-ubifs-fix-assert-failed-in-ubifs-set-page-dirty"
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53584.json
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02779'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02795'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02807'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04491'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04486'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04477'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04459'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04467'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04445'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04438'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04415'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0442'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04436'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04515'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04542'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04482'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04496'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04499'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.06207'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.06202'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-367
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53584.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53584
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-53584
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2401564
    reference_type:
    reference_id: 2401564
