vulnerability_id: VCID-c8np-2gnz-aaak
aliases:
  - CVE-2021-39164
  - GHSA-3x4c-pq33-4w3q
  - PYSEC-2021-425
summary: 'Matrix is an ecosystem for open federated Instant Messaging and Voice over IP. In
  versions 1.41.0 and prior, unauthorised users can access the membership (list of members,
  with their display names) of a room if they know the ID of the room. The vulnerability is
  limited to rooms with `shared` history visibility. Furthermore, the unauthorised user must
  be using an account on a vulnerable homeserver that is in the room. Server administrators
  should upgrade to 1.41.1 or later in order to receive the patch. One workaround is available.
  Administrators of servers that use a reverse proxy could, with potentially unacceptable loss
  of functionality, block the endpoints: `/_matrix/client/r0/rooms/{room_id}/members` with `at`
  query parameter, and `/_matrix/client/unstable/rooms/{room_id}/members` with `at` query parameter.'
severities:
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35490'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35825'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35456'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00077'
    scoring_system: epss
    scoring_elements: '0.35499'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36970'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36959'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36940'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36932'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36935'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36842'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36814'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36743'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36461'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37321'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37246'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.37181'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64672'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63329'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63305'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63319'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.6334'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63337'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63326'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63313'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.646'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64633'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64667'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64693'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64696'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64665'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64661'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64669'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64671'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.6468'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64692'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.64676'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63244'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63221'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63316'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63317'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63339'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63355'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.63331'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.00502'
    scoring_system: epss
    scoring_elements: '0.6333'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: '0.01298'
    scoring_system: epss
    scoring_elements: '0.67353'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-3x4c-pq33-4w3q
  - score: '4.9'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/matrix-org/synapse
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/matrix-org/synapse/commit/cb35df940a
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse/commit/cb35df940a
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/matrix-org/synapse/releases/tag/v1.41.1
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse/releases/tag/v1.41.1
  - score: LOW
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/matrix-org/synapse/security/advisories/GHSA-3x4c-pq33-4w3q
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-425.yaml
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-425.yaml
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN
  - score: LOW
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN
  - score: '3.5'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:M/Au:S/C:P/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39164
  - score: '3.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39164
  - score: '3.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39164
  - score: Medium
    scoring_system: archlinux
    scoring_elements:
    published_at: None
    url: https://security.archlinux.org/AVG-2334
weaknesses:
  - CWE-937
  - CWE-1035
  - CWE-200
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2021-39164
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/commit/cb35df940a
    reference_type:
    reference_id:
  - url: https://github.com/matrix-org/synapse/releases/tag/v1.41.1
    reference_type:
    reference_id:
  - url: https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-425.yaml
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VHDEPCZ22GJFMZCWA2XZAGPOEV72POF/
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN
    reference_type:
    reference_id:
  - url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXT7ID7DNBRN2TVTETU3SYQHJKEG6PXN/
    reference_type:
    reference_id:
  - url: https://security.archlinux.org/AVG-2334
    reference_type:
    reference_id: AVG-2334
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2021-39164
    reference_type:
    reference_id: CVE-2021-39164
  - url: https://github.com/advisories/GHSA-3x4c-pq33-4w3q
    reference_type:
    reference_id: GHSA-3x4c-pq33-4w3q
  - url: https://github.com/matrix-org/synapse/security/advisories/GHSA-3x4c-pq33-4w3q
    reference_type:
    reference_id: GHSA-3x4c-pq33-4w3q
