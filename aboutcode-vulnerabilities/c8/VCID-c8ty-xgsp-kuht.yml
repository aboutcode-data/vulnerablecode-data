vulnerability_id: VCID-c8ty-xgsp-kuht
aliases:
  - CVE-2025-55303
  - GHSA-xf8x-j4p2-f749
summary: "Astro allows unauthorized third-party images in _image endpoint\n### Summary\n\nIn\
  \ affected versions of `astro`, the image optimization endpoint in projects deployed with\
  \ on-demand rendering allows images from unauthorized third-party domains to be served.\n\n\
  ### Details\n\nOn-demand rendered sites built with Astro include an `/_image` endpoint which\
  \ returns optimized versions of images.\n\nThe `/_image` endpoint is restricted to processing\
  \ local images bundled with the site and also supports remote images from domains the site\
  \ developer has manually authorized (using the [`image.domains`](https://docs.astro.build/en/reference/configuration-reference/#imagedomains)\
  \ or [`image.remotePatterns`](https://docs.astro.build/en/reference/configuration-reference/#imageremotepatterns)\
  \ options).\n\nHowever, a bug in impacted versions of `astro` allows an attacker to bypass\
  \ the third-party domain restrictions by using a protocol-relative URL as the image source,\
  \ e.g. `/_image?href=//example.com/image.png`.\n\n### Proof of Concept\n\n1. Create a new\
  \ minimal Astro project (`astro@5.13.0`).\n\n2. Configure it to use the Node adapter (`@astrojs/node@9.1.0`\
  \ — newer versions are not impacted):\n\n   ```js\n   // astro.config.mjs\n   import { defineConfig\
  \ } from 'astro/config';\n   import node from '@astrojs/node';\n\n   export default defineConfig({\n\
  \   \tadapter: node({ mode: 'standalone' }),\n   });\n   ```\n\n3. Build the site by running\
  \ `astro build`.\n\n4. Run the server, e.g. with `astro preview`.\n\n5. Append `/_image?href=//placehold.co/600x400`\
  \ to the preview URL, e.g. <http://localhost:4321/_image?href=//placehold.co/600x400>\n\n\
  6. The site will serve the image from the unauthorized `placehold.co` origin.\n\n### Impact\n\
  \nAllows a non-authorized third-party to create URLs on an impacted site’s origin that serve\
  \ unauthorized image content.\nIn the case of SVG images, this could include the risk of cross-site\
  \ scripting (XSS) if a user followed a link to a maliciously crafted SVG."
severities:
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.0491'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00021'
    scoring_system: epss
    scoring_elements: '0.04911'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.13805'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.13851'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00047'
    scoring_system: epss
    scoring_elements: '0.13854'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19651'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19579'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19529'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19601'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19723'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19693'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19674'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00062'
    scoring_system: epss
    scoring_elements: '0.19534'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21162'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21351'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21406'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21359'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21338'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21409'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21389'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21374'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21236'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21206'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21234'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21158'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21225'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21228'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21199'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21168'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21128'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21081'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.2117'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21164'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21264'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.00067'
    scoring_system: epss
    scoring_elements: '0.21355'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22027'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.2202'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22055'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22015'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: '0.0007'
    scoring_system: epss
    scoring_elements: '0.22031'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-xf8x-j4p2-f749
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/withastro/astro
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/withastro/astro
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/withastro/astro/commit/4d16de7f95db5d1ec1ce88610d2a95e606e83820
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/withastro/astro/commit/4d16de7f95db5d1ec1ce88610d2a95e606e83820
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/withastro/astro/commit/4d16de7f95db5d1ec1ce88610d2a95e606e83820
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-08-19T20:49:42Z/
    published_at: None
    url: https://github.com/withastro/astro/commit/4d16de7f95db5d1ec1ce88610d2a95e606e83820
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://github.com/withastro/astro/security/advisories/GHSA-xf8x-j4p2-f749
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/withastro/astro/security/advisories/GHSA-xf8x-j4p2-f749
  - score: '6.9'
    scoring_system: cvssv4
    scoring_elements: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N
    published_at: None
    url: https://github.com/withastro/astro/security/advisories/GHSA-xf8x-j4p2-f749
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/withastro/astro/security/advisories/GHSA-xf8x-j4p2-f749
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:P/A:Y/T:P/P:M/B:A/M:M/D:T/2025-08-19T20:49:42Z/
    published_at: None
    url: https://github.com/withastro/astro/security/advisories/GHSA-xf8x-j4p2-f749
  - score: '6.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-55303
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2025-55303
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
  - CWE-115
references:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-55303
    reference_type:
    reference_id:
  - url: https://github.com/withastro/astro
    reference_type:
    reference_id:
  - url: https://github.com/withastro/astro/commit/4d16de7f95db5d1ec1ce88610d2a95e606e83820
    reference_type:
    reference_id:
  - url: https://github.com/withastro/astro/security/advisories/GHSA-xf8x-j4p2-f749
    reference_type:
    reference_id:
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-55303
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-xf8x-j4p2-f749
    reference_type:
    reference_id: GHSA-xf8x-j4p2-f749
