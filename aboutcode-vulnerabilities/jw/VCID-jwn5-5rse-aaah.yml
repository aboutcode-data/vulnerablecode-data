vulnerability_id: VCID-jwn5-5rse-aaah
aliases:
  - CVE-2023-33953
  - GHSA-496j-2rq6-j6cc
summary: |
  gRPC contains a vulnerability that allows hpack table accounting errors could lead to unwanted disconnects between clients and servers in exceptional cases/ Three vectors were found that allow the following DOS attacks:

  - Unbounded memory buffering in the HPACK parser
  - Unbounded CPU consumption in the HPACK parser

  The unbounded CPU consumption is down to a copy that occurred per-input-block in the parser, and because that could be unbounded due to the memory copy bug we end up with an O(n^2) parsing loop, with n selected by the client.

  The unbounded memory buffering bugs:

  - The header size limit check was behind the string reading code, so we needed to first buffer up to a 4 gigabyte string before rejecting it as longer than 8 or 16kb.
  - HPACK varints have an encoding quirk whereby an infinite number of 0’s can be added at the start of an integer. gRPC’s hpack parser needed to read all of them before concluding a parse.
  - gRPC’s metadata overflow check was performed per frame, so that the following sequence of frames could cause infinite buffering: HEADERS: containing a: 1 CONTINUATION: containing a: 2 CONTINUATION: containing a: 3 etc…
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-33953.json
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34570'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34582'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34547'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34914'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34293'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33932'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33950'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34177'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.34232'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33360'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33689'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33775'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33801'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33903'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33904'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00075'
    scoring_system: epss
    scoring_elements: '0.33908'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28812'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28976'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28931'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00099'
    scoring_system: epss
    scoring_elements: '0.28871'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33317'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.3333'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33353'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33368'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.334'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33397'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.3326'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33367'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33215'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33351'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33366'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33363'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33384'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33349'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00158'
    scoring_system: epss
    scoring_elements: '0.33329'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.53815'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.5388'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.53797'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.53827'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.53838'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.53836'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.53845'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.53865'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.53852'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.00315'
    scoring_system: epss
    scoring_elements: '0.53837'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '0.0054'
    scoring_system: epss
    scoring_elements: '0.50672'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://cloud.google.com/support/bulletins#gcp-2023-022
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://cloud.google.com/support/bulletins#gcp-2023-022
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-496j-2rq6-j6cc
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/grpc/CVE-2023-33953.yml
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/grpc/CVE-2023-33953.yml
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-33953
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2023-33953
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://security.snyk.io/vuln/SNYK-RUBY-GRPC-5834442
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://security.snyk.io/vuln/SNYK-RUBY-GRPC-5834442
weaknesses:
  - CWE-834
  - CWE-937
  - CWE-1035
  - CWE-789
  - CWE-770
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-33953.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-33953
    reference_type:
    reference_id:
  - url: https://cloud.google.com/support/bulletins#gcp-2023-022
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-33953
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/grpc/CVE-2023-33953.yml
    reference_type:
    reference_id:
  - url: https://security.snyk.io/vuln/SNYK-RUBY-GRPC-5834442
    reference_type:
    reference_id:
  - url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1059279
    reference_type:
    reference_id: 1059279
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2230890
    reference_type:
    reference_id: 2230890
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:grpc:grpc:*:*:*:*:*:-:*:*
    reference_type:
    reference_id: cpe:2.3:a:grpc:grpc:*:*:*:*:*:-:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-33953
    reference_type:
    reference_id: CVE-2023-33953
  - url: https://github.com/advisories/GHSA-496j-2rq6-j6cc
    reference_type:
    reference_id: GHSA-496j-2rq6-j6cc
  - url: https://access.redhat.com/errata/RHSA-2024:10761
    reference_type:
    reference_id: RHSA-2024:10761
