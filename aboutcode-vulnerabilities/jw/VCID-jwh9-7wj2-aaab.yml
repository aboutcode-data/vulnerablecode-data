vulnerability_id: VCID-jwh9-7wj2-aaab
aliases:
  - CVE-2024-40975
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  platform/x86: x86-android-tablets: Unregister devices in reverse order

  Not all subsystems support a device getting removed while there are
  still consumers of the device with a reference to the device.

  One example of this is the regulator subsystem. If a regulator gets
  unregistered while there are still drivers holding a reference
  a WARN() at drivers/regulator/core.c:5829 triggers, e.g.:

   WARNING: CPU: 1 PID: 1587 at drivers/regulator/core.c:5829 regulator_unregister
   Hardware name: Intel Corp. VALLEYVIEW C0 PLATFORM/BYT-T FFD8, BIOS BLADE_21.X64.0005.R00.1504101516 FFD8_X64_R_2015_04_10_1516 04/10/2015
   RIP: 0010:regulator_unregister
   Call Trace:
    <TASK>
    regulator_unregister
    devres_release_group
    i2c_device_remove
    device_release_driver_internal
    bus_remove_device
    device_del
    device_unregister
    x86_android_tablet_remove

  On the Lenovo Yoga Tablet 2 series the bq24190 charger chip also provides
  a 5V boost converter output for powering USB devices connected to the micro
  USB port, the bq24190-charger driver exports this as a Vbus regulator.

  On the 830 (8") and 1050 ("10") models this regulator is controlled by
  a platform_device and x86_android_tablet_remove() removes platform_device-s
  before i2c_clients so the consumer gets removed first.

  But on the 1380 (13") model there is a lc824206xa micro-USB switch
  connected over I2C and the extcon driver for that controls the regulator.
  The bq24190 i2c-client *must* be registered first, because that creates
  the regulator with the lc824206xa listed as its consumer. If the regulator
  has not been registered yet the lc824206xa driver will end up getting
  a dummy regulator.

  Since in this case both the regulator provider and consumer are I2C
  devices, the only way to ensure that the consumer is unregistered first
  is to unregister the I2C devices in reverse order of in which they were
  created.

  For consistency and to avoid similar problems in the future change
  x86_android_tablet_remove() to unregister all device types in reverse
  order.
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-40975.json
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.09902'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10184'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10278'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10302'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10364'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10366'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10377'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10484'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00043'
    scoring_system: epss
    scoring_elements: '0.10429'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30657'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30579'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30643'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30709'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30755'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30759'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30691'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30674'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30668'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30658'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30688'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30669'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.0011'
    scoring_system: epss
    scoring_elements: '0.30641'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00136'
    scoring_system: epss
    scoring_elements: '0.30293'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00136'
    scoring_system: epss
    scoring_elements: '0.30334'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00136'
    scoring_system: epss
    scoring_elements: '0.30305'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00136'
    scoring_system: epss
    scoring_elements: '0.30314'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00136'
    scoring_system: epss
    scoring_elements: '0.3019'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00136'
    scoring_system: epss
    scoring_elements: '0.30299'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00136'
    scoring_system: epss
    scoring_elements: '0.30146'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.3257'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.32609'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.32638'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.3265'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.32617'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.32601'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.32577'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00152'
    scoring_system: epss
    scoring_elements: '0.3256'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '0.00576'
    scoring_system: epss
    scoring_elements: '0.52038'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
  - score: '2.1'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:P/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:02:40Z/
    published_at: None
    url: https://git.kernel.org/stable/c/36ff963c133a25ed1166a25c3ba8b357ea010fda
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:02:40Z/
    published_at: None
    url: https://git.kernel.org/stable/c/3de0f2627ef849735f155c1818247f58404dddfe
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-09-10T17:02:40Z/
    published_at: None
    url: https://git.kernel.org/stable/c/f0c982853d665597d17e4995ff479fbbf79a9cf6
weaknesses:
  - CWE-911
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-40975.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-40975
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-40975
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/3de0f2627ef849735f155c1818247f58404dddfe
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f0c982853d665597d17e4995ff479fbbf79a9cf6
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2297559
    reference_type:
    reference_id: 2297559
  - url: https://git.kernel.org/stable/c/36ff963c133a25ed1166a25c3ba8b357ea010fda
    reference_type:
    reference_id: 36ff963c133a25ed1166a25c3ba8b357ea010fda
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-40975
    reference_type:
    reference_id: CVE-2024-40975
  - url: https://usn.ubuntu.com/6999-1/
    reference_type:
    reference_id: USN-6999-1
  - url: https://usn.ubuntu.com/6999-2/
    reference_type:
    reference_id: USN-6999-2
  - url: https://usn.ubuntu.com/7004-1/
    reference_type:
    reference_id: USN-7004-1
  - url: https://usn.ubuntu.com/7005-1/
    reference_type:
    reference_id: USN-7005-1
  - url: https://usn.ubuntu.com/7005-2/
    reference_type:
    reference_id: USN-7005-2
  - url: https://usn.ubuntu.com/7008-1/
    reference_type:
    reference_id: USN-7008-1
  - url: https://usn.ubuntu.com/7029-1/
    reference_type:
    reference_id: USN-7029-1
