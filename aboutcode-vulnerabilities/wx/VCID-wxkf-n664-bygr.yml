vulnerability_id: VCID-wxkf-n664-bygr
aliases:
  - CVE-2025-38402
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  idpf: return 0 size for RSS key if not supported

  Returning -EOPNOTSUPP from function returning u32 is leading to
  cast and invalid size value as a result.

  -EOPNOTSUPP as a size probably will lead to allocation fail.

  Command: ethtool -x eth0
  It is visible on all devices that don't have RSS caps set.

  [  136.615917] Call Trace:
  [  136.615921]  <TASK>
  [  136.615927]  ? __warn+0x89/0x130
  [  136.615942]  ? __alloc_frozen_pages_noprof+0x322/0x330
  [  136.615953]  ? report_bug+0x164/0x190
  [  136.615968]  ? handle_bug+0x58/0x90
  [  136.615979]  ? exc_invalid_op+0x17/0x70
  [  136.615987]  ? asm_exc_invalid_op+0x1a/0x20
  [  136.616001]  ? rss_prepare_get.constprop.0+0xb9/0x170
  [  136.616016]  ? __alloc_frozen_pages_noprof+0x322/0x330
  [  136.616028]  __alloc_pages_noprof+0xe/0x20
  [  136.616038]  ___kmalloc_large_node+0x80/0x110
  [  136.616072]  __kmalloc_large_node_noprof+0x1d/0xa0
  [  136.616081]  __kmalloc_noprof+0x32c/0x4c0
  [  136.616098]  ? rss_prepare_get.constprop.0+0xb9/0x170
  [  136.616105]  rss_prepare_get.constprop.0+0xb9/0x170
  [  136.616114]  ethnl_default_doit+0x107/0x3d0
  [  136.616131]  genl_family_rcv_msg_doit+0x100/0x160
  [  136.616147]  genl_rcv_msg+0x1b8/0x2c0
  [  136.616156]  ? __pfx_ethnl_default_doit+0x10/0x10
  [  136.616168]  ? __pfx_genl_rcv_msg+0x10/0x10
  [  136.616176]  netlink_rcv_skb+0x58/0x110
  [  136.616186]  genl_rcv+0x28/0x40
  [  136.616195]  netlink_unicast+0x19b/0x290
  [  136.616206]  netlink_sendmsg+0x222/0x490
  [  136.616215]  __sys_sendto+0x1fd/0x210
  [  136.616233]  __x64_sys_sendto+0x24/0x30
  [  136.616242]  do_syscall_64+0x82/0x160
  [  136.616252]  ? __sys_recvmsg+0x83/0xe0
  [  136.616265]  ? syscall_exit_to_user_mode+0x10/0x210
  [  136.616275]  ? do_syscall_64+0x8e/0x160
  [  136.616282]  ? __count_memcg_events+0xa1/0x130
  [  136.616295]  ? count_memcg_events.constprop.0+0x1a/0x30
  [  136.616306]  ? handle_mm_fault+0xae/0x2d0
  [  136.616319]  ? do_user_addr_fault+0x379/0x670
  [  136.616328]  ? clear_bhb_loop+0x45/0xa0
  [  136.616340]  ? clear_bhb_loop+0x45/0xa0
  [  136.616349]  ? clear_bhb_loop+0x45/0xa0
  [  136.616359]  entry_SYSCALL_64_after_hwframe+0x76/0x7e
  [  136.616369] RIP: 0033:0x7fd30ba7b047
  [  136.616376] Code: 0c 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b8 0f 1f 00 f3 0f 1e fa 80 3d bd d5 0c 00 00 41 89 ca 74 10 b8 2c 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 71 c3 55 48 83 ec 30 44 89 4c 24 2c 4c 89 44
  [  136.616381] RSP: 002b:00007ffde1796d68 EFLAGS: 00000202 ORIG_RAX: 000000000000002c
  [  136.616388] RAX: ffffffffffffffda RBX: 000055d7bd89f2a0 RCX: 00007fd30ba7b047
  [  136.616392] RDX: 0000000000000028 RSI: 000055d7bd89f3b0 RDI: 0000000000000003
  [  136.616396] RBP: 00007ffde1796e10 R08: 00007fd30bb4e200 R09: 000000000000000c
  [  136.616399] R10: 0000000000000000 R11: 0000000000000202 R12: 000055d7bd89f340
  [  136.616403] R13: 000055d7bd89f3b0 R14: 000055d78943f200 R15: 0000000000000000
severities:
  - score: '2.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:N/I:N/A:L
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38402.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01385'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01409'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03996'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03989'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04026'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0406'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.03962'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0398'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0399'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04758'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04736'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04798'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04828'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04881'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04826'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0478'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04836'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04823'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04953'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04776'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0496'
    published_at: '2025-09-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04955'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04804'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05416'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05507'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05497'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05534'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05478'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0545'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0548'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05504'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05513'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05542'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05517'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05487'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05468'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05442'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05467'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05444'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05429'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05436'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05526'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05512'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-704
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38402.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38402
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/018ff57fd79c38be989b8b3248bbe69bcfb77160
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/326e384ee7acbebf0541ac064ac7a4dd1f1dde1d
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/f77bf1ebf8ff6301ccdbc346f7b52db928f9cbf8
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2383419
    reference_type:
    reference_id: 2383419
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38402
    reference_type:
    reference_id: CVE-2025-38402
  - url: https://usn.ubuntu.com/7833-1/
    reference_type:
    reference_id: USN-7833-1
  - url: https://usn.ubuntu.com/7833-2/
    reference_type:
    reference_id: USN-7833-2
  - url: https://usn.ubuntu.com/7833-3/
    reference_type:
    reference_id: USN-7833-3
  - url: https://usn.ubuntu.com/7833-4/
    reference_type:
    reference_id: USN-7833-4
  - url: https://usn.ubuntu.com/7834-1/
    reference_type:
    reference_id: USN-7834-1
  - url: https://usn.ubuntu.com/7856-1/
    reference_type:
    reference_id: USN-7856-1
