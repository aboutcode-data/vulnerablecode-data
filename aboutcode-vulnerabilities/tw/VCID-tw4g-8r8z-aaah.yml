vulnerability_id: VCID-tw4g-8r8z-aaah
aliases:
  - CVE-2024-26853
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  igc: avoid returning frame twice in XDP_REDIRECT

  When a frame can not be transmitted in XDP_REDIRECT
  (e.g. due to a full queue), it is necessary to free
  it by calling xdp_return_frame_rx_napi.

  However, this is the responsibility of the caller of
  the ndo_xdp_xmit (see for example bq_xmit_all in
  kernel/bpf/devmap.c) and thus calling it inside
  igc_xdp_xmit (which is the ndo_xdp_xmit of the igc
  driver) as well will lead to memory corruption.

  In fact, bq_xmit_all expects that it can return all
  frames after the last successfully transmitted one.
  Therefore, break for the first not transmitted frame,
  but do not call xdp_return_frame_rx_napi in igc_xdp_xmit.
  This is equally implemented in other Intel drivers
  such as the igb.

  There are two alternatives to this that were rejected:
  1. Return num_frames as all the frames would have been
     transmitted and release them inside igc_xdp_xmit.
     While it might work technically, it is not what
     the return value is meant to represent (i.e. the
     number of SUCCESSFULLY transmitted packets).
  2. Rework kernel/bpf/devmap.c and all drivers to
     support non-consecutively dropped packets.
     Besides being complex, it likely has a negative
     performance impact without a significant gain
     since it is anyway unlikely that the next frame
     can be transmitted if the previous one was dropped.

  The memory corruption can be reproduced with
  the following script which leads to a kernel panic
  after a few seconds.  It basically generates more
  traffic than a i225 NIC can transmit and pushes it
  via XDP_REDIRECT from a virtual interface to the
  physical interface where frames get dropped.

     #!/bin/bash
     INTERFACE=enp4s0
     INTERFACE_IDX=`cat /sys/class/net/$INTERFACE/ifindex`

     sudo ip link add dev veth1 type veth peer name veth2
     sudo ip link set up $INTERFACE
     sudo ip link set up veth1
     sudo ip link set up veth2

     cat << EOF > redirect.bpf.c

     SEC("prog")
     int redirect(struct xdp_md *ctx)
     {
         return bpf_redirect($INTERFACE_IDX, 0);
     }

     char _license[] SEC("license") = "GPL";
     EOF
     clang -O2 -g -Wall -target bpf -c redirect.bpf.c -o redirect.bpf.o
     sudo ip link set veth2 xdp obj redirect.bpf.o

     cat << EOF > pass.bpf.c

     SEC("prog")
     int pass(struct xdp_md *ctx)
     {
         return XDP_PASS;
     }

     char _license[] SEC("license") = "GPL";
     EOF
     clang -O2 -g -Wall -target bpf -c pass.bpf.c -o pass.bpf.o
     sudo ip link set $INTERFACE xdp obj pass.bpf.o

     cat << EOF > trafgen.cfg

     {
       /* Ethernet Header */
       0xe8, 0x6a, 0x64, 0x41, 0xbf, 0x46,
       0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
       const16(ETH_P_IP),

       /* IPv4 Header */
       0b01000101, 0,   # IPv4 version, IHL, TOS
       const16(1028),   # IPv4 total length (UDP length + 20 bytes (IP header))
       const16(2),      # IPv4 ident
       0b01000000, 0,   # IPv4 flags, fragmentation off
       64,              # IPv4 TTL
       17,              # Protocol UDP
       csumip(14, 33),  # IPv4 checksum

       /* UDP Header */
       10,  0, 1, 1,    # IP Src - adapt as needed
       10,  0, 1, 2,    # IP Dest - adapt as needed
       const16(6666),   # UDP Src Port
       const16(6666),   # UDP Dest Port
       const16(1008),   # UDP length (UDP header 8 bytes + payload length)
       csumudp(14, 34), # UDP checksum

       /* Payload */
       fill('W', 1000),
     }
     EOF

     sudo trafgen -i trafgen.cfg -b3000MB -o veth1 --cpp
severities:
  - score: '4.4'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26853.json
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16666'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.16947'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17041'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17069'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17147'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17142'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17164'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17226'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17329'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17645'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17732'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17830'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17350'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17315'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17624'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00045'
    scoring_system: epss
    scoring_elements: '0.17338'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16093'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1607'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16063'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16064'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16082'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16107'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16102'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13114'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13149'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13188'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1316'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13144'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13161'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1318'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13207'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13194'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13163'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.13087'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15873'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.15944'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.1604'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16115'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16118'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00052'
    scoring_system: epss
    scoring_elements: '0.16091'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.36756'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.3672'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00181'
    scoring_system: epss
    scoring_elements: '0.36839'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '0.00764'
    scoring_system: epss
    scoring_elements: '0.58123'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2024-26853
weaknesses:
  - CWE-20
  - CWE-787
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-26853.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-26853
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/1b3b8231386a572bac8cd5b6fd7e944b84f9bb1f
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/63a3c1f3c9ecc654d851e7906d05334cd0c236e2
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/8df393af9e7e8dfd62e9c41dbaa4d2ff53bf794a
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ef27f655b438bed4c83680e4f01e1cde2739854b
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2275748
    reference_type:
    reference_id: 2275748
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc5:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.8:rc6:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.8:rc6:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-26853
    reference_type:
    reference_id: CVE-2024-26853
  - url: https://access.redhat.com/errata/RHSA-2024:5101
    reference_type:
    reference_id: RHSA-2024:5101
  - url: https://access.redhat.com/errata/RHSA-2024:5102
    reference_type:
    reference_id: RHSA-2024:5102
  - url: https://access.redhat.com/errata/RHSA-2024:5363
    reference_type:
    reference_id: RHSA-2024:5363
  - url: https://access.redhat.com/errata/RHSA-2024:5672
    reference_type:
    reference_id: RHSA-2024:5672
  - url: https://access.redhat.com/errata/RHSA-2024:5673
    reference_type:
    reference_id: RHSA-2024:5673
  - url: https://access.redhat.com/errata/RHSA-2024:6206
    reference_type:
    reference_id: RHSA-2024:6206
