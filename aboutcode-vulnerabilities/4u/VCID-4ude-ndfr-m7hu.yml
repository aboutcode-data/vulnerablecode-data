vulnerability_id: VCID-4ude-ndfr-m7hu
aliases:
  - CVE-2025-38106
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  io_uring: fix use-after-free of sq->thread in __io_uring_show_fdinfo()

  syzbot reports:

  BUG: KASAN: slab-use-after-free in getrusage+0x1109/0x1a60
  Read of size 8 at addr ffff88810de2d2c8 by task a.out/304

  CPU: 0 UID: 0 PID: 304 Comm: a.out Not tainted 6.16.0-rc1 #1 PREEMPT(voluntary)
  Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
  Call Trace:
   <TASK>
   dump_stack_lvl+0x53/0x70
   print_report+0xd0/0x670
   ? __pfx__raw_spin_lock_irqsave+0x10/0x10
   ? getrusage+0x1109/0x1a60
   kasan_report+0xce/0x100
   ? getrusage+0x1109/0x1a60
   getrusage+0x1109/0x1a60
   ? __pfx_getrusage+0x10/0x10
   __io_uring_show_fdinfo+0x9fe/0x1790
   ? ksys_read+0xf7/0x1c0
   ? do_syscall_64+0xa4/0x260
   ? vsnprintf+0x591/0x1100
   ? __pfx___io_uring_show_fdinfo+0x10/0x10
   ? __pfx_vsnprintf+0x10/0x10
   ? mutex_trylock+0xcf/0x130
   ? __pfx_mutex_trylock+0x10/0x10
   ? __pfx_show_fd_locks+0x10/0x10
   ? io_uring_show_fdinfo+0x57/0x80
   io_uring_show_fdinfo+0x57/0x80
   seq_show+0x38c/0x690
   seq_read_iter+0x3f7/0x1180
   ? inode_set_ctime_current+0x160/0x4b0
   seq_read+0x271/0x3e0
   ? __pfx_seq_read+0x10/0x10
   ? __pfx__raw_spin_lock+0x10/0x10
   ? __mark_inode_dirty+0x402/0x810
   ? selinux_file_permission+0x368/0x500
   ? file_update_time+0x10f/0x160
   vfs_read+0x177/0xa40
   ? __pfx___handle_mm_fault+0x10/0x10
   ? __pfx_vfs_read+0x10/0x10
   ? mutex_lock+0x81/0xe0
   ? __pfx_mutex_lock+0x10/0x10
   ? fdget_pos+0x24d/0x4b0
   ksys_read+0xf7/0x1c0
   ? __pfx_ksys_read+0x10/0x10
   ? do_user_addr_fault+0x43b/0x9c0
   do_syscall_64+0xa4/0x260
   entry_SYSCALL_64_after_hwframe+0x77/0x7f
  RIP: 0033:0x7f0f74170fc9
  Code: 00 c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 8
  RSP: 002b:00007fffece049e8 EFLAGS: 00000206 ORIG_RAX: 0000000000000000
  RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f0f74170fc9
  RDX: 0000000000001000 RSI: 00007fffece049f0 RDI: 0000000000000004
  RBP: 00007fffece05ad0 R08: 0000000000000000 R09: 00007fffece04d90
  R10: 0000000000000000 R11: 0000000000000206 R12: 00005651720a1100
  R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
   </TASK>

  Allocated by task 298:
   kasan_save_stack+0x33/0x60
   kasan_save_track+0x14/0x30
   __kasan_slab_alloc+0x6e/0x70
   kmem_cache_alloc_node_noprof+0xe8/0x330
   copy_process+0x376/0x5e00
   create_io_thread+0xab/0xf0
   io_sq_offload_create+0x9ed/0xf20
   io_uring_setup+0x12b0/0x1cc0
   do_syscall_64+0xa4/0x260
   entry_SYSCALL_64_after_hwframe+0x77/0x7f

  Freed by task 22:
   kasan_save_stack+0x33/0x60
   kasan_save_track+0x14/0x30
   kasan_save_free_info+0x3b/0x60
   __kasan_slab_free+0x37/0x50
   kmem_cache_free+0xc4/0x360
   rcu_core+0x5ff/0x19f0
   handle_softirqs+0x18c/0x530
   run_ksoftirqd+0x20/0x30
   smpboot_thread_fn+0x287/0x6c0
   kthread+0x30d/0x630
   ret_from_fork+0xef/0x1a0
   ret_from_fork_asm+0x1a/0x30

  Last potentially related work creation:
   kasan_save_stack+0x33/0x60
   kasan_record_aux_stack+0x8c/0xa0
   __call_rcu_common.constprop.0+0x68/0x940
   __schedule+0xff2/0x2930
   __cond_resched+0x4c/0x80
   mutex_lock+0x5c/0xe0
   io_uring_del_tctx_node+0xe1/0x2b0
   io_uring_clean_tctx+0xb7/0x160
   io_uring_cancel_generic+0x34e/0x760
   do_exit+0x240/0x2350
   do_group_exit+0xab/0x220
   __x64_sys_exit_group+0x39/0x40
   x64_sys_call+0x1243/0x1840
   do_syscall_64+0xa4/0x260
   entry_SYSCALL_64_after_hwframe+0x77/0x7f

  The buggy address belongs to the object at ffff88810de2cb00
   which belongs to the cache task_struct of size 3712
  The buggy address is located 1992 bytes inside of
   freed 3712-byte region [ffff88810de2cb00, ffff88810de2d980)

  which is caused by the task_struct pointed to by sq->thread being
  released while it is being used in the function
  __io_uring_show_fdinfo(). Holding ctx->uring_lock does not prevent ehre
  relase or exit of sq->thread.

  Fix this by assigning and looking up ->thread under RCU, and grabbing a
  reference to the task_struct. This e
  ---truncated---
severities:
  - score: '7.0'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38106.json
  - score: '7.1'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38106.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.01406'
    published_at: '2026-01-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.0143'
    published_at: '2026-01-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.02582'
    published_at: '2025-07-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04168'
    published_at: '2025-07-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04146'
    published_at: '2025-07-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04154'
    published_at: '2025-07-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04126'
    published_at: '2025-07-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04107'
    published_at: '2025-07-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04115'
    published_at: '2025-07-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04106'
    published_at: '2025-07-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.0407'
    published_at: '2025-07-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00022'
    scoring_system: epss
    scoring_elements: '0.04056'
    published_at: '2025-07-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04674'
    published_at: '2025-08-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04804'
    published_at: '2025-09-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04641'
    published_at: '2025-08-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04612'
    published_at: '2025-08-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.0461'
    published_at: '2025-08-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04564'
    published_at: '2025-08-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04601'
    published_at: '2025-08-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00024'
    scoring_system: epss
    scoring_elements: '0.04594'
    published_at: '2025-08-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05517'
    published_at: '2025-10-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05487'
    published_at: '2025-10-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05468'
    published_at: '2025-10-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05442'
    published_at: '2025-10-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05467'
    published_at: '2025-10-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05444'
    published_at: '2025-10-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05429'
    published_at: '2025-10-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05416'
    published_at: '2025-10-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05436'
    published_at: '2025-10-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05403'
    published_at: '2025-10-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05206'
    published_at: '2025-09-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05214'
    published_at: '2025-09-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05191'
    published_at: '2025-09-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05209'
    published_at: '2025-09-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05307'
    published_at: '2025-09-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05324'
    published_at: '2025-09-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05367'
    published_at: '2025-09-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05281'
    published_at: '2025-09-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05273'
    published_at: '2025-09-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05242'
    published_at: '2025-09-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05321'
    published_at: '2025-09-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05326'
    published_at: '2025-09-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05507'
    published_at: '2025-10-01 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05497'
    published_at: '2025-10-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05534'
    published_at: '2025-10-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05478'
    published_at: '2025-10-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0545'
    published_at: '2025-10-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.0548'
    published_at: '2025-10-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05504'
    published_at: '2025-10-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05513'
    published_at: '2025-10-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00025'
    scoring_system: epss
    scoring_elements: '0.05542'
    published_at: '2025-10-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08328'
    published_at: '2025-11-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '0.00032'
    scoring_system: epss
    scoring_elements: '0.08359'
    published_at: '2025-11-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
  - score: '6.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
weaknesses:
  - CWE-911
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2025-38106.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2025-38106
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/ac0b8b327a5677dc6fecdf353d808161525b1ff0
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/af8c13f9ee040b9a287ba246cf0055f7c77b7cc8
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d0932758a0a77b38ba1b39564f3b7aba12407061
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2376077
    reference_type:
    reference_id: 2376077
  - url: https://nvd.nist.gov/vuln/detail/CVE-2025-38106
    reference_type:
    reference_id: CVE-2025-38106
  - url: https://usn.ubuntu.com/7769-1/
    reference_type:
    reference_id: USN-7769-1
  - url: https://usn.ubuntu.com/7769-2/
    reference_type:
    reference_id: USN-7769-2
  - url: https://usn.ubuntu.com/7769-3/
    reference_type:
    reference_id: USN-7769-3
  - url: https://usn.ubuntu.com/7770-1/
    reference_type:
    reference_id: USN-7770-1
  - url: https://usn.ubuntu.com/7771-1/
    reference_type:
    reference_id: USN-7771-1
  - url: https://usn.ubuntu.com/7789-1/
    reference_type:
    reference_id: USN-7789-1
  - url: https://usn.ubuntu.com/7789-2/
    reference_type:
    reference_id: USN-7789-2
