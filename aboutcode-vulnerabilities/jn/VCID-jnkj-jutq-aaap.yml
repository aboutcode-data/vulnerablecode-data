vulnerability_id: VCID-jnkj-jutq-aaap
aliases:
  - CVE-2022-29167
  - GHSA-44pw-h2cw-w3vq
summary: |
  Regular Expression Denial of Service
  Hawk is an HTTP authentication scheme providing mechanisms for making authenticated HTTP requests with partial cryptographic verification of the request and response, covering the HTTP method, request URI, host, and optionally the request payload. Hawk used a regular expression to parse `Host` HTTP header (`Hawk.utils.parseHost()`), which was subject to regular expression DoS attack - meaning each added character in the attacker's input increases the computation time exponentially. `parseHost()` was patched in `9.0.1` to use built-in `URL` class to parse hostname instead. `Hawk.authenticate()` accepts `options` argument. If that contains `host` and `port`, those would be used instead of a call to `utils.parseHost()`.
severities:
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-29167.json
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.1897'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18979'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.19018'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18864'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.1901'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18997'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18824'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.1898'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22509'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.2253'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22537'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22484'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22432'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22369'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18934'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.2251'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22518'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22523'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22504'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22497'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22487'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.22499'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18967'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18994'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.19026'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.19036'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.18985'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00071'
    scoring_system: epss
    scoring_elements: '0.19004'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36869'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36366'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36645'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36716'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36744'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36835'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36831'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36838'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00083'
    scoring_system: epss
    scoring_elements: '0.36856'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37866'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37727'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37976'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37788'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37647'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37683'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.00084'
    scoring_system: epss
    scoring_elements: '0.37679'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: '0.0017'
    scoring_system: epss
    scoring_elements: '0.25017'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
  - score: medium
    scoring_system: rhbs
    scoring_elements:
    published_at: None
    url: https://bugzilla.redhat.com/show_bug.cgi?id=2082387
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-44pw-h2cw-w3vq
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/mozilla/hawk
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mozilla/hawk
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/mozilla/hawk/commit/d10d72ca82db967f6c5fcf866ff78e3ca25ce1ab
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mozilla/hawk/commit/d10d72ca82db967f6c5fcf866ff78e3ca25ce1ab
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/mozilla/hawk/pull/286
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mozilla/hawk/pull/286
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:07:46Z/
    published_at: None
    url: https://github.com/mozilla/hawk/pull/286
  - score: '7.4'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:N/A:H
    published_at: None
    url: https://github.com/mozilla/hawk/security/advisories/GHSA-44pw-h2cw-w3vq
  - score: HIGH
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/mozilla/hawk/security/advisories/GHSA-44pw-h2cw-w3vq
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/mozilla/hawk/security/advisories/GHSA-44pw-h2cw-w3vq
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2025-04-23T14:07:46Z/
    published_at: None
    url: https://github.com/mozilla/hawk/security/advisories/GHSA-44pw-h2cw-w3vq
  - score: '5.0'
    scoring_system: cvssv2
    scoring_elements: AV:N/AC:L/Au:N/C:N/I:N/A:P
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29167
  - score: '7.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29167
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-29167
  - score: '5.3'
    scoring_system: cvssv3
    scoring_elements:
    published_at: None
    url: https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
  - score: '7.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
weaknesses:
  - CWE-400
  - CWE-937
  - CWE-1035
  - CWE-1333
  - CWE-770
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-29167.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2022-29167
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29167
    reference_type:
    reference_id:
  - url: https://github.com/mozilla/hawk
    reference_type:
    reference_id:
  - url: https://github.com/mozilla/hawk/commit/d10d72ca82db967f6c5fcf866ff78e3ca25ce1ab
    reference_type:
    reference_id:
  - url: https://github.com/mozilla/hawk/pull/286
    reference_type:
    reference_id:
  - url: https://github.com/mozilla/hawk/security/advisories/GHSA-44pw-h2cw-w3vq
    reference_type:
    reference_id:
  - url: https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2082387
    reference_type:
    reference_id: 2082387
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mozilla:hawk:*:*:*:*:*:node.js:*:*
    reference_type:
    reference_id: cpe:2.3:a:mozilla:hawk:*:*:*:*:*:node.js:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2022-29167
    reference_type:
    reference_id: CVE-2022-29167
  - url: https://github.com/advisories/GHSA-44pw-h2cw-w3vq
    reference_type:
    reference_id: GHSA-44pw-h2cw-w3vq
  - url: https://usn.ubuntu.com/6116-1/
    reference_type:
    reference_id: USN-6116-1
