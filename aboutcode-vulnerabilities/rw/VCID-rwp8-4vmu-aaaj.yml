vulnerability_id: VCID-rwp8-4vmu-aaaj
aliases:
  - CVE-2024-35809
summary: |
  In the Linux kernel, the following vulnerability has been resolved:

  PCI/PM: Drain runtime-idle callbacks before driver removal

  A race condition between the .runtime_idle() callback and the .remove()
  callback in the rtsx_pcr PCI driver leads to a kernel crash due to an
  unhandled page fault [1].

  The problem is that rtsx_pci_runtime_idle() is not expected to be running
  after pm_runtime_get_sync() has been called, but the latter doesn't really
  guarantee that.  It only guarantees that the suspend and resume callbacks
  will not be running when it returns.

  However, if a .runtime_idle() callback is already running when
  pm_runtime_get_sync() is called, the latter will notice that the runtime PM
  status of the device is RPM_ACTIVE and it will return right away without
  waiting for the former to complete.  In fact, it cannot wait for
  .runtime_idle() to complete because it may be called from that callback (it
  arguably does not make much sense to do that, but it is not strictly
  prohibited).

  Thus in general, whoever is providing a .runtime_idle() callback needs
  to protect it from running in parallel with whatever code runs after
  pm_runtime_get_sync().  [Note that .runtime_idle() will not start after
  pm_runtime_get_sync() has returned, but it may continue running then if it
  has started earlier.]

  One way to address that race condition is to call pm_runtime_barrier()
  after pm_runtime_get_sync() (not before it, because a nonzero value of the
  runtime PM usage counter is necessary to prevent runtime PM callbacks from
  being invoked) to wait for the .runtime_idle() callback to complete should
  it be running at that point.  A suitable place for doing that is in
  pci_device_remove() which calls pm_runtime_get_sync() before removing the
  driver, so it may as well call pm_runtime_barrier() subsequently, which
  will prevent the race in question from occurring, not just in the rtsx_pcr
  driver, but in any PCI drivers providing .runtime_idle() callbacks.
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-35809.json
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14083'
    published_at: '2024-11-01 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14371'
    published_at: '2024-11-18 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15080'
    published_at: '2025-01-16 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14767'
    published_at: '2024-12-27 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14726'
    published_at: '2024-12-19 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14714'
    published_at: '2024-12-17 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15128'
    published_at: '2024-12-15 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.15033'
    published_at: '2024-12-13 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14976'
    published_at: '2024-12-11 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14691'
    published_at: '2024-12-03 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14611'
    published_at: '2024-11-28 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14556'
    published_at: '2024-11-26 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14541'
    published_at: '2024-11-24 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14548'
    published_at: '2024-11-23 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14461'
    published_at: '2024-11-20 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00044'
    scoring_system: epss
    scoring_elements: '0.14482'
    published_at: '2024-11-21 00:00:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18486'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1535'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15371'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15413'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15418'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15386'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15363'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15314'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18319'
    published_at: '2025-04-15 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18388'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18443'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18508'
    published_at: '2025-04-18 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.185'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18485'
    published_at: '2025-04-20 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18459'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18452'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18465'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18472'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18493'
    published_at: '2025-04-25 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.18497'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1849'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15182'
    published_at: '2025-03-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1514'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15315'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15324'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15344'
    published_at: '2025-04-04 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.1538'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15355'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00058'
    scoring_system: epss
    scoring_elements: '0.15348'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '0.00259'
    scoring_system: epss
    scoring_elements: '0.33504'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
  - score: '4.7'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/47d8aafcfe313511a98f165a54d0adceb34e54b1
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:40:16Z/
    published_at: None
    url: https://git.kernel.org/stable/c/47d8aafcfe313511a98f165a54d0adceb34e54b1
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/6347348c6aba52dda0b33296684cbb627bdc6970
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:40:16Z/
    published_at: None
    url: https://git.kernel.org/stable/c/6347348c6aba52dda0b33296684cbb627bdc6970
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/7cc94dd36e48879e76ae7a8daea4ff322b7d9674
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:40:16Z/
    published_at: None
    url: https://git.kernel.org/stable/c/7cc94dd36e48879e76ae7a8daea4ff322b7d9674
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/900b81caf00c89417172afe0e7e49ac4eb110f4b
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:40:16Z/
    published_at: None
    url: https://git.kernel.org/stable/c/900b81caf00c89417172afe0e7e49ac4eb110f4b
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/9a87375bb586515c0af63d5dcdcd58ec4acf20a6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:40:16Z/
    published_at: None
    url: https://git.kernel.org/stable/c/9a87375bb586515c0af63d5dcdcd58ec4acf20a6
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/9d5286d4e7f68beab450deddbb6a32edd5ecf4bf
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:40:16Z/
    published_at: None
    url: https://git.kernel.org/stable/c/9d5286d4e7f68beab450deddbb6a32edd5ecf4bf
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/bbe068b24409ef740657215605284fc7cdddd491
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:40:16Z/
    published_at: None
    url: https://git.kernel.org/stable/c/bbe068b24409ef740657215605284fc7cdddd491
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/d534198311c345e4b062c4b88bb609efb8bd91d5
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:40:16Z/
    published_at: None
    url: https://git.kernel.org/stable/c/d534198311c345e4b062c4b88bb609efb8bd91d5
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/d86ad8c3e152349454b82f37007ff6ba45f26989
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:P/P:M/B:A/M:M/D:T/2024-05-31T18:40:16Z/
    published_at: None
    url: https://git.kernel.org/stable/c/d86ad8c3e152349454b82f37007ff6ba45f26989
weaknesses: []
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2024-35809.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2024-35809
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-35809
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/47d8aafcfe313511a98f165a54d0adceb34e54b1
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/6347348c6aba52dda0b33296684cbb627bdc6970
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/7cc94dd36e48879e76ae7a8daea4ff322b7d9674
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/900b81caf00c89417172afe0e7e49ac4eb110f4b
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9a87375bb586515c0af63d5dcdcd58ec4acf20a6
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/9d5286d4e7f68beab450deddbb6a32edd5ecf4bf
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/bbe068b24409ef740657215605284fc7cdddd491
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d534198311c345e4b062c4b88bb609efb8bd91d5
    reference_type:
    reference_id:
  - url: https://git.kernel.org/stable/c/d86ad8c3e152349454b82f37007ff6ba45f26989
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html
    reference_type:
    reference_id:
  - url: https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2281217
    reference_type:
    reference_id: 2281217
  - url: https://nvd.nist.gov/vuln/detail/CVE-2024-35809
    reference_type:
    reference_id: CVE-2024-35809
  - url: https://access.redhat.com/errata/RHSA-2024:7000
    reference_type:
    reference_id: RHSA-2024:7000
  - url: https://access.redhat.com/errata/RHSA-2024:7001
    reference_type:
    reference_id: RHSA-2024:7001
  - url: https://access.redhat.com/errata/RHSA-2024:9315
    reference_type:
    reference_id: RHSA-2024:9315
  - url: https://access.redhat.com/errata/RHSA-2025:3021
    reference_type:
    reference_id: RHSA-2025:3021
  - url: https://usn.ubuntu.com/6816-1/
    reference_type:
    reference_id: USN-6816-1
  - url: https://usn.ubuntu.com/6817-1/
    reference_type:
    reference_id: USN-6817-1
  - url: https://usn.ubuntu.com/6817-2/
    reference_type:
    reference_id: USN-6817-2
  - url: https://usn.ubuntu.com/6817-3/
    reference_type:
    reference_id: USN-6817-3
  - url: https://usn.ubuntu.com/6878-1/
    reference_type:
    reference_id: USN-6878-1
  - url: https://usn.ubuntu.com/6896-1/
    reference_type:
    reference_id: USN-6896-1
  - url: https://usn.ubuntu.com/6896-2/
    reference_type:
    reference_id: USN-6896-2
  - url: https://usn.ubuntu.com/6896-3/
    reference_type:
    reference_id: USN-6896-3
  - url: https://usn.ubuntu.com/6896-4/
    reference_type:
    reference_id: USN-6896-4
  - url: https://usn.ubuntu.com/6896-5/
    reference_type:
    reference_id: USN-6896-5
  - url: https://usn.ubuntu.com/6898-1/
    reference_type:
    reference_id: USN-6898-1
  - url: https://usn.ubuntu.com/6898-2/
    reference_type:
    reference_id: USN-6898-2
  - url: https://usn.ubuntu.com/6898-3/
    reference_type:
    reference_id: USN-6898-3
  - url: https://usn.ubuntu.com/6898-4/
    reference_type:
    reference_id: USN-6898-4
  - url: https://usn.ubuntu.com/6917-1/
    reference_type:
    reference_id: USN-6917-1
  - url: https://usn.ubuntu.com/6919-1/
    reference_type:
    reference_id: USN-6919-1
  - url: https://usn.ubuntu.com/6927-1/
    reference_type:
    reference_id: USN-6927-1
  - url: https://usn.ubuntu.com/7019-1/
    reference_type:
    reference_id: USN-7019-1
