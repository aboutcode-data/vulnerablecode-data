vulnerability_id: VCID-vdsr-ceh9-wkcq
aliases:
  - CVE-2023-53023
summary: 'In the Linux kernel, the following vulnerability has been resolved:  net: nfc: Fix
  use-after-free in local_cleanup()  Fix a use-after-free that occurs in kfree_skb() called
  from local_cleanup(). This could happen when killing nfc daemon (e.g. neard) after detaching
  an nfc device. When detaching an nfc device, local_cleanup() called from nfc_llcp_unregister_device()
  frees local->rx_pending and decreases local->ref by kref_put() in nfc_llcp_local_put(). In
  the terminating process, nfc daemon releases all sockets and it leads to decreasing local->ref.
  After the last release of local->ref, local_cleanup() called from local_release() frees local->rx_pending
  again, which leads to the bug.  Setting local->rx_pending to NULL in local_cleanup() could
  prevent use-after-free when local_cleanup() is called twice.  Found by a modified version
  of syzkaller.  BUG: KASAN: use-after-free in kfree_skb()  Call Trace: dump_stack_lvl (lib/dump_stack.c:106)
  print_address_description.constprop.0.cold (mm/kasan/report.c:306) kasan_check_range (mm/kasan/generic.c:189)
  kfree_skb (net/core/skbuff.c:955) local_cleanup (net/nfc/llcp_core.c:159) nfc_llcp_local_put.part.0
  (net/nfc/llcp_core.c:172) nfc_llcp_local_put (net/nfc/llcp_core.c:181) llcp_sock_destruct
  (net/nfc/llcp_sock.c:959) __sk_destruct (net/core/sock.c:2133) sk_destruct (net/core/sock.c:2181)
  __sk_free (net/core/sock.c:2192) sk_free (net/core/sock.c:2203) llcp_sock_release (net/nfc/llcp_sock.c:646)
  __sock_release (net/socket.c:650) sock_close (net/socket.c:1365) __fput (fs/file_table.c:306)
  task_work_run (kernel/task_work.c:179) ptrace_notify (kernel/signal.c:2354) syscall_exit_to_user_mode_prepare
  (kernel/entry/common.c:278) syscall_exit_to_user_mode (kernel/entry/common.c:296) do_syscall_64
  (arch/x86/entry/common.c:86) entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:106)  Allocated
  by task 4719: kasan_save_stack (mm/kasan/common.c:45) __kasan_slab_alloc (mm/kasan/common.c:325)
  slab_post_alloc_hook (mm/slab.h:766) kmem_cache_alloc_node (mm/slub.c:3497) __alloc_skb (net/core/skbuff.c:552)
  pn533_recv_response (drivers/nfc/pn533/usb.c:65) __usb_hcd_giveback_urb (drivers/usb/core/hcd.c:1671)
  usb_giveback_urb_bh (drivers/usb/core/hcd.c:1704) tasklet_action_common.isra.0 (kernel/softirq.c:797)
  __do_softirq (kernel/softirq.c:571)  Freed by task 1901: kasan_save_stack (mm/kasan/common.c:45)
  kasan_set_track (mm/kasan/common.c:52) kasan_save_free_info (mm/kasan/genericdd.c:518) __kasan_slab_free
  (mm/kasan/common.c:236) kmem_cache_free (mm/slub.c:3809) kfree_skbmem (net/core/skbuff.c:874)
  kfree_skb (net/core/skbuff.c:931) local_cleanup (net/nfc/llcp_core.c:159) nfc_llcp_unregister_device
  (net/nfc/llcp_core.c:1617) nfc_unregister_device (net/nfc/core.c:1179) pn53x_unregister_nfc
  (drivers/nfc/pn533/pn533.c:2846) pn533_usb_disconnect (drivers/nfc/pn533/usb.c:579) usb_unbind_interface
  (drivers/usb/core/driver.c:458) device_release_driver_internal (drivers/base/dd.c:1279) bus_remove_device
  (drivers/base/bus.c:529) device_del (drivers/base/core.c:3665) usb_disable_device (drivers/usb/core/message.c:1420)
  usb_disconnect (drivers/usb/core.c:2261) hub_event (drivers/usb/core/hub.c:5833) process_one_work
  (arch/x86/include/asm/jump_label.h:27 include/linux/jump_label.h:212 include/trace/events/workqueue.h:108
  kernel/workqueue.c:2281) worker_thread (include/linux/list.h:282 kernel/workqueue.c:2423)
  kthread (kernel/kthread.c:319) ret_from_fork (arch/x86/entry/entry_64.S:301)'
severities:
  - score: '5.5'
    scoring_system: cvssv3
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53023.json
  - score: '0.00012'
    scoring_system: epss
    scoring_elements: '0.00874'
    published_at: '2025-03-30 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01527'
    published_at: '2025-04-23 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01524'
    published_at: '2025-04-22 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01536'
    published_at: '2025-04-21 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01549'
    published_at: '2025-04-19 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01544'
    published_at: '2025-04-24 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01547'
    published_at: '2025-04-17 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01557'
    published_at: '2025-04-16 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01537'
    published_at: '2025-04-26 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01165'
    published_at: '2025-04-14 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01173'
    published_at: '2025-04-12 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01191'
    published_at: '2025-04-11 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.0118'
    published_at: '2025-04-10 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01176'
    published_at: '2025-04-09 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01171'
    published_at: '2025-04-08 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01167'
    published_at: '2025-04-02 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01163'
    published_at: '2025-04-03 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01164'
    published_at: '2025-04-13 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01158'
    published_at: '2025-04-05 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01161'
    published_at: '2025-04-07 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01156'
    published_at: '2025-04-06 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00014'
    scoring_system: epss
    scoring_elements: '0.01531'
    published_at: '2025-04-27 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00016'
    scoring_system: epss
    scoring_elements: '0.02182'
    published_at: '2025-04-28 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '0.00017'
    scoring_system: epss
    scoring_elements: '0.01509'
    published_at: '2025-03-29 12:55:00+00:00'
    url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
  - score: '5.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/4bb4db7f3187c6e3de6b229ffc87cdb30a2d22b6
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-27T17:01:08Z/
    published_at: None
    url: https://git.kernel.org/stable/c/4bb4db7f3187c6e3de6b229ffc87cdb30a2d22b6
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/54f7be61584b8ec4c6df405f479495b9397bae4a
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-27T17:01:08Z/
    published_at: None
    url: https://git.kernel.org/stable/c/54f7be61584b8ec4c6df405f479495b9397bae4a
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/7f129927feaf7c10b1c38bbce630172e9a08c834
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-27T17:01:08Z/
    published_at: None
    url: https://git.kernel.org/stable/c/7f129927feaf7c10b1c38bbce630172e9a08c834
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/a59cdbda3714e11aa3ab579132864c4c8c6d54f9
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-27T17:01:08Z/
    published_at: None
    url: https://git.kernel.org/stable/c/a59cdbda3714e11aa3ab579132864c4c8c6d54f9
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/ad1baab3a5c03692d22ce446f38596a126377f6a
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-27T17:01:08Z/
    published_at: None
    url: https://git.kernel.org/stable/c/ad1baab3a5c03692d22ce446f38596a126377f6a
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/b09ae26f08aaf2d85f96ea7f90ddd3387f62216f
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-27T17:01:08Z/
    published_at: None
    url: https://git.kernel.org/stable/c/b09ae26f08aaf2d85f96ea7f90ddd3387f62216f
  - score: '7.8'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    published_at: None
    url: https://git.kernel.org/stable/c/d3605282ec3502ec8847915eb2cf1f340493ff79
  - score: Track
    scoring_system: ssvc
    scoring_elements: SSVCv2/E:N/A:N/T:T/P:M/B:A/M:M/D:T/2025-03-27T17:01:08Z/
    published_at: None
    url: https://git.kernel.org/stable/c/d3605282ec3502ec8847915eb2cf1f340493ff79
weaknesses:
  - CWE-416
references:
  - url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2023-53023.json
    reference_type:
    reference_id:
  - url: https://api.first.org/data/v1/epss?cve=CVE-2023-53023
    reference_type:
    reference_id:
  - url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-53023
    reference_type:
    reference_id:
  - url: https://ftp.suse.com/pub/projects/security/yaml/suse-cvss-scores.yaml
    reference_type:
    reference_id:
  - url: https://bugzilla.redhat.com/show_bug.cgi?id=2355533
    reference_type:
    reference_id: 2355533
  - url: https://git.kernel.org/stable/c/4bb4db7f3187c6e3de6b229ffc87cdb30a2d22b6
    reference_type:
    reference_id: 4bb4db7f3187c6e3de6b229ffc87cdb30a2d22b6
  - url: https://git.kernel.org/stable/c/54f7be61584b8ec4c6df405f479495b9397bae4a
    reference_type:
    reference_id: 54f7be61584b8ec4c6df405f479495b9397bae4a
  - url: https://git.kernel.org/stable/c/7f129927feaf7c10b1c38bbce630172e9a08c834
    reference_type:
    reference_id: 7f129927feaf7c10b1c38bbce630172e9a08c834
  - url: https://git.kernel.org/stable/c/a59cdbda3714e11aa3ab579132864c4c8c6d54f9
    reference_type:
    reference_id: a59cdbda3714e11aa3ab579132864c4c8c6d54f9
  - url: https://git.kernel.org/stable/c/ad1baab3a5c03692d22ce446f38596a126377f6a
    reference_type:
    reference_id: ad1baab3a5c03692d22ce446f38596a126377f6a
  - url: https://git.kernel.org/stable/c/b09ae26f08aaf2d85f96ea7f90ddd3387f62216f
    reference_type:
    reference_id: b09ae26f08aaf2d85f96ea7f90ddd3387f62216f
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc1:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc2:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc3:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
    reference_type:
    reference_id: cpe:2.3:o:linux:linux_kernel:6.2:rc4:*:*:*:*:*:*
  - url: https://nvd.nist.gov/vuln/detail/CVE-2023-53023
    reference_type:
    reference_id: CVE-2023-53023
  - url: https://git.kernel.org/stable/c/d3605282ec3502ec8847915eb2cf1f340493ff79
    reference_type:
    reference_id: d3605282ec3502ec8847915eb2cf1f340493ff79
