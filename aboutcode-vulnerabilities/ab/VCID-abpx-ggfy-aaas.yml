vulnerability_id: VCID-abpx-ggfy-aaas
aliases:
  - GHSA-jm4v-58r5-66hj
summary: |
  Uncaught Exception in surrealdb
  Although custom parameters and functions are only supported at the database level, it was allowed to invoke those entities at the root or namespace level. This would cause a panic which would crash the SurrealDB server, leading to denial of service.

  ### Impact

  A client that is authorized to run queries at the root or namespace level in a SurrealDB server is able to run a query invoking a parameter or a function at that level, which will cause a panic. This will crash the server, leading to denial of service.

  ### Patches

  - Version 1.1.1 and later are not affected by this issue.

  ### Workarounds

  Concerned users unable to update may want to limit the ability of untrusted users to run arbitrary SurrealQL queries in the affected versions of SurrealDB to the database level. To limit the impact of the denial of service, SurrealDB administrators may also want to ensure that the SurrealDB process is running so that it can be automatically re-started after a crash.

  ### References

  - #3297
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-jm4v-58r5-66hj
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/surrealdb/surrealdb
  - score: HIGH
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/surrealdb/surrealdb/commit/618a4d1b422df0d12772532bb2c195f830b40399
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb/commit/618a4d1b422df0d12772532bb2c195f830b40399
  - score: '6.5'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
    published_at: None
    url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-jm4v-58r5-66hj
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-jm4v-58r5-66hj
weaknesses:
  - CWE-248
references:
  - url: https://github.com/surrealdb/surrealdb
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/commit/618a4d1b422df0d12772532bb2c195f830b40399
    reference_type:
    reference_id:
  - url: https://github.com/surrealdb/surrealdb/security/advisories/GHSA-jm4v-58r5-66hj
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-jm4v-58r5-66hj
    reference_type:
    reference_id: GHSA-jm4v-58r5-66hj
