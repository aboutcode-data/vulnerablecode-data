vulnerability_id: VCID-tu7a-emmr-nqer
aliases:
  - GHSA-m895-2hj3-8cg9
summary: |
  Shopware vulnerable to MediaVisibilityRestrictionSubscriber bypass when reading media entities by aggregating fields individually
  In Shopware core and platform versions before 6.6.10.7 and 6.7.3.1, media visibility restrictions applied by MediaVisibilityRestrictionSubscriber are not enforced for aggregation API requests. Authorization filters are only injected during standard entity reads; aggregation queries can be constructed to bypass these checks and enumerate private media records such as invoices or other restricted documents. A lowâ€‘privilege backend user (e.g., product editor) can chain normal business flows (creating or viewing orders) with aggregation queries to disclose sensitive customer data including addresses and payment-related information contained within associated private media. The issue is resolved in 6.6.10.7 and 6.7.3.1.
severities:
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/advisories/GHSA-m895-2hj3-8cg9
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/shopware/shopware
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/shopware/shopware/commit/0965b35a527756faab2cec5a4ff172d79b0f99be
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/commit/0965b35a527756faab2cec5a4ff172d79b0f99be
  - score: '5.3'
    scoring_system: cvssv3.1
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-m895-2hj3-8cg9
  - score: MODERATE
    scoring_system: cvssv3.1_qr
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-m895-2hj3-8cg9
  - score: MODERATE
    scoring_system: generic_textual
    scoring_elements:
    published_at: None
    url: https://github.com/shopware/shopware/security/advisories/GHSA-m895-2hj3-8cg9
weaknesses:
  - CWE-863
  - CWE-1035
  - CWE-937
references:
  - url: https://github.com/shopware/shopware
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/commit/0965b35a527756faab2cec5a4ff172d79b0f99be
    reference_type:
    reference_id:
  - url: https://github.com/shopware/shopware/security/advisories/GHSA-m895-2hj3-8cg9
    reference_type:
    reference_id:
  - url: https://github.com/advisories/GHSA-m895-2hj3-8cg9
    reference_type:
    reference_id: GHSA-m895-2hj3-8cg9
